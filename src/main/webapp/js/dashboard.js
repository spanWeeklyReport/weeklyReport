/**
 * IMPORTANT NOTE: This compressed javascript includes thirdparty javascripts
 * listed at http://reports.zoho.com/html/thirdparty.html
 * The original javascript sources are available in the above location.
 */

function getCookie(a,b){var c=b==null?document:b.document,d=a+"=",e=d.length,f=c.cookie.length,g=0;while(g<f){var h=g+e;if(c.cookie.substring(g,h)==d)return getCookieVal(h,c);g=c.cookie.indexOf(" ",g)+1;if(g==0)break}return null}function getCookieVal(a,b){var c=b.cookie.indexOf(";",a);return c==-1&&(c=b.cookie.length),decodeURIComponent(b.cookie.substring(a,c))}function setCookie(a,b){var c=setCookie.arguments,d=setCookie.arguments.length,e=d>2?c[2]:null,f=d>3?c[3]:null,g=d>4?c[4]:null,h=d>5?c[5]:!1;document.cookie=a+"="+encodeURIComponent(b)+(e==null?"":"; expires="+e.toGMTString())+(f==null?"":"; path="+f)+(g==null?"":"; domain="+g)+(h==1?"; secure":"")}function deleteCookie(a,b,c){var d=c==null?document:c.document,e=new Date;e.setTime(e.getTime()-1);var f=getCookie(a);b||(b="/"),d.cookie=a+"="+f+"; expires="+e.toGMTString()+"; path="+b}function appendSubRequestArgs(a){return getURLSuffixed(a)+"SUBREQUEST=true"}function getCSRFCookie(a,b){var c=getCookie(a,b);return c==null?"__EMPTY":c}function parseRequestParams(a){var b=a.indexOf("&"),c=a.indexOf("?");c>=0&&c<b&&(a=a.substring(c+1,a.length));var d=a.split("&"),e=new Object;for(var f=0;f<d.length;f++){var g=d[f],h=g.substring(0,g.indexOf("=")),i=g.substring(g.indexOf("=")+1,g.length);e[h]==null&&(e[h]=new Array);var j=e[h];j[j.length]=i}return e}function parseTemplateParams(a){var b=parseRequestParams(a),c=new Array;for(var d in b){var e=new Array,f=b[d][b[d].length-1];e[0]=d,f.indexOf("$R{")>=0?(e[1]=f.substring(f.indexOf("$R{")+3,f.length-1),e[2]=1):f.indexOf("$S{")>=0?(e[1]=f.substring(f.indexOf("$S{")+3,f.length-1),e[2]=2):f.indexOf("$D{")>=0?(e[1]=f.substring(f.indexOf("$D{")+3,f.length-1),e[2]=3):(e[1]=b[d],e[2]=0),c[c.length]=e}return c}function getURLSuffixed(a){return a==null?null:(a.lastIndexOf("?")==-1?a+="?":a.indexOf("?")>0&&a.charAt(a.length-1)!="&"&&(a+="&"),a)}function appendParamToUrl(a,b,c){return c==null?a:getURLSuffixed(a)+b+"="+encodeURIComponent(c)}function appendParamsToUrl(a,b){return b==null?a:getURLSuffixed(a)+b}function hasDataModelTplReference(a){if(a==null)return!1;var b=parseTemplateParams(a);for(var c=0;c<b.length;c++){var d=b[c];if(d[2]==3)return!0}return!1}function hasTplReference(a){if(a==null)return!1;var b=parseTemplateParams(a);for(var c=0;c<b.length;c++){var d=b[c];if(d[2]==3||d[2]==2||d[2]==1)return!0}return!1}function splitURL(a){var b=a.indexOf("?");return b==-1?{resource:a,query:""}:{resource:a.substring(0,b),query:a.substring(b+1)}}function getAsQueryString(a){var b="";for(var c in a)b+=c+"="+encodeURIComponent(a[c])+"&";return b}function ZRSerialize(a){if(!a||a.nodeName!=="FORM")return;var b,c,d,e=[];for(b=0,d=a.elements.length;b<d;b+=1){if(a.elements[b].name==="")continue;switch(a.elements[b].nodeName){case"INPUT":switch(a.elements[b].type){case"text":case"hidden":case"password":case"button":case"reset":case"submit":e.push(a.elements[b].name+"="+encodeURIComponent(a.elements[b].value));break;case"checkbox":case"radio":a.elements[b].checked&&e.push(a.elements[b].name+"="+encodeURIComponent(a.elements[b].value));break;case"file":}break;case"TEXTAREA":e.push(a.elements[b].name+"="+encodeURIComponent(a.elements[b].value));break;case"SELECT":switch(a.elements[b].type){case"select-one":e.push(a.elements[b].name+"="+encodeURIComponent(a.elements[b].value));break;case"select-multiple":for(c=a.elements[b].options.length-1;c>=0;c-=1)a.elements[b].options[c].selected&&e.push(a.elements[b].name+"="+encodeURIComponent(a.elements[b].options[c].value))}break;case"BUTTON":switch(a.elements[b].type){case"reset":case"submit":case"button":e.push(a.elements[b].name+"="+encodeURIComponent(a.elements[b].value))}}}return e.join("&")}function $(a){return typeof a=="string"?a=document.getElementById(a):a}function ZDBInitializeUserAnalytics(a,b,c,d){ZDBGlobal.isUserAnalyticsEnabled&&(window.ZRUserAnalytics_Options={USERANALYTICSID:a,ZUID:ZDBGlobal.zuID,EMAILID:b,MODULE:c,ADDITIONALPARAMS:{},LIMIT:d},ZRUserAnalytics.initialize(),ZRUserAnalyticsObject.timers[c]=new ZRUserAnalyticsTimer(c),ZRUserAnalyticsObject.timers[c].startTimer())}function lazyLoadJSAndCssFiles(){var a=["ZDBGridList","ZDBAnalysisViewList","ZRDashboardView","ZAVMFilterList","ZAAnalysisFields"],b=["ZDBAnalysisEditList","ZDBDashEdit","ZDBChartSetting","ZRQueryEditor","ZDBExportNShare"];ZDBGlobal.ZCTYPE>0&&(a[1]="ZDBAnalysisViewList_NEW",a.splice(2,0,"ZRJSChartsList"),b[0]="ZDBAnalysisEditList_NEW");var c=["CSSLIST_QUERYEDITOR","CSSLIST_GRIDSTYLES","CSSLIST_ANALYSISVIEWSTYLES","CSSLIST_DASHBOARDSTYLES","CSSLIST_VMFILTERSTYLES"];if(!ZDBLazyLoadUtil.loadJsAlone(a,"APPENDTODOC",lazyLoadJSAndCssFiles))return;if(!ZDBLazyLoadUtil.loadJsAlone(b,"APPENDTODOC",lazyLoadJSAndCssFiles))return;if(!ZDBLazyLoadUtil.loadCssOnly(c,"APPENDTODOC",null))return}function addPlaceHolder(a){a.placeholder=a.getAttribute("placeholder"),a.onfocus=function(){this.value==this.placeholder&&(this.value="",a.style.opacity="1")},a.onblur=function(){this.value.length==0&&(this.value=this.placeholder,a.style.opacity="0.5")},a.onblur()}function AjaxOptions(a){this.v=function(a,b){var c=this[a.toUpperCase()];c==null&&(c=b);if(c==null)throw new Error("OptionNotPresent:"+a+" is not present");return c},this.vu=function(a){return this.v(a).toUpperCase()},this.isTrue=function(a,b){var c=this.v(a,b);return c==1||c=="true"},this.fn=function(a){var b=this.v(a);if(b instanceof Function)return b;var c=(new Function("return "+b))();if(!c)throw new Error("FunctionNotPresent: "+b+" is not declared in current window");if(c instanceof Function)return c;throw new Error("IllegalOption : "+b+" is not a function.")},this.form=function(a){var b=DOMUtils.getForm(this.v(a));if(b==null)throw new Error(" FormNotFound : "+this.v(a)+" not found");return b},this.setV=function(a,b){this[a.toUpperCase()]=b},this.update=function(a){for(property in a){var b=a[property];this[property.toUpperCase()]=b}},this.encode=function(){var a="",b=new AjaxOptions;for(var c in this){if(this[c]instanceof Object)continue;if(b[c]==this[c])continue;if(c=="URL"||c=="METHOD")continue;var d=c.lastIndexOf("_RN");if(d==c.length-"_RN".length)continue;var e=c=="ONSUCCESSFUNC"?"_OS":c;a+=e+"="+this[c]+"&"}return a.length>1&&(a=a.substring(0,a.length-1)),a},this.update({METHOD:"POST",ASYNCHRONOUS:!0,STATUSFUNC:"AjaxAPI.showRespMsg",ONFAILUREFUNC:AjaxAPI.onFailureFunc});if(typeof a=="string"){a=parseRequestParams(a);for(var b in a)a[b]=a[b][0];a["_OS"]!=null&&(a.ONSUCCESSFUNC=a._OS)}this.update(a)}function AjaxResponse(transportUsed){this.responseText=null,this.htmlContent=null,this.scripts=null,this.transport=transportUsed,this.opStatus=StatusMsgAPI.OPSTATUS.STARTED,this.isHttpReqSuccess=function(){try{return this.transport.status==undefined||this.transport.status==0||this.transport.status>=200&&this.transport.status<300}catch(a){return!1}},this.getResponseStatus=function(){try{return this.transport.status}catch(a){return 999999}},this.getResponseStatusText=function(){try{return this.transport.statusText}catch(a){return null}},this.getResponsePart=function(a){return AjaxUtils.extractFromResponse(this.responseText,a)},this.getResponseParams=function(){var paramString=AjaxUtils.extractFromResponse(this.responseText,"RESPONSE_PARAMS");return paramString!=null?eval(paramString):{}},this.getOnlyHtml=function(){return this.splitResponse(),this.htmlContent},this.getScripts=function(){return this.splitResponse(),this.scripts},this.invokeScripts=function(){this.alreadyInvoked||(AjaxUtils.invokeScripts(this.getScripts()),this.alreadyInvoked=!0)},this.splitResponse=function(){if(this.htmlContent!=null)return;var a=AjaxUtils.separateScriptAndHtml(this.responseText);this.htmlContent=a.html,this.scripts=a.scripts}}function rem$(a){var b=document.getElementById(a);return b!=null?b.parentNode.removeChild(b):console.log(a+" is null"),b}function remId$(a){var b=$(a);return b!=null&&(b.id=""),b}function getObj(a,b){var c,d,e;b||(b=document),(c=a.indexOf("?"))>0&&parent.frames.length&&(b=parent.frames[a.substring(c+1)].document,a=a.substring(0,c)),!(e=b[a])&&b.all&&(e=b.all[a]);for(d=0;!e&&d<b.forms.length;d++)e=b.forms[d][a];for(d=0;!e&&b.layers&&d<b.layers.length;d++)e=getObj(a,b.layers[d].document);return!e&&b.getElementById&&(e=b.getElementById(a)),e}function executeFunction(a,b){if(a==null||b==null)return;var c=b.name+"Obj",d=!0;return window[c]&&window[c][a]?d=window[c][a](b):d=validateForm(b),d?handleStateForForm(b):!1}function createFormMethodContainer(a){var b=null;window[a+"Obj"]!=null?b=window[a+"Obj"]:(b=new Object,window[a+"Obj"]=b),b["ValidateForm"]==null&&(b.ValidateForm=validateForm)}function validateAndSubmitForm(a){return executeFunction("validateForm",a)}function setFailedFocus(a){a.getAttribute("setfailedfocus")!=null&&a.getAttribute("setfailedfocus")=="false"&&(_FRM_SET_FAILED_FOCUS=!1)}function validateForm(a){return validateFormElements(a.elements,a)}function validateFormElements(a,b){var c=a.length,d=!1,e=null;setFailedFocus(b);for(var f=0;f<c;f++){var g=a[f],h=isElVisible(g,b),i=g.getAttribute("validatemethod"),j=g.style.display;if(i!=null&&i!=""&&!g.disabled&&j!="none"&&h&&!executeElementCall(i,g)){d=!0;var k=b.getAttribute("alerttype");if(k==null||k.indexOf("Complete")<0)return!1;e==null&&(e=g)}}return e!=null&&(_FRM_SET_FAILED_FOCUS&&e.focus(),e=null),d?!1:!0}function executeElementCall(a,b){var c=b.form,d=b.getAttribute("isnullable"),e=b.value;return d!="true"||e!=""&&e!=null?c!=null&&window[c.name+"Obj"]!=null&&window[c.name+"Obj"][a]!=null?window[c.name+"Obj"][a](b.value,b):validateElement(a,b):!0}function disableEditMode(a,b){var c=b.form,d=c.name;c.getAttribute("viewname")!=null&&(d=c.getAttribute("viewname")),document.getElementById(d+"ReadMode").className="show",document.getElementById(d+"EditMode").className="hide"}function trimAll(a){if(a==null)return"";var b=/^(\s*)$/;if(b.test(a)){a=a.replace(b,"");if(a.length==0)return a}return b=/^(\s*)([\W\w]*)(\b\s*$)/,b.test(a)&&(a=a.replace(b,"$2")),a}function isEmailId(a){a=trimAll(a);var b=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return b.test(a)}function isMultipleEmailId(a){var b=a.split(",");for(var c=0;c<b.length;c++)if(!isEmailId(b[c]))return!1;return!0}function isNotEmpty(a){var b=trimAll(a);return b.length>0?!0:!1}function isIpAddress(a){var b=a.split(".");if(b.length!=4)return!1;for(i=0;i<b.length;i++){if(!isPositiveInteger(b[i]))return!1;var c=parseInt(b[i],10);if(c>255)return!1}return!0}function isInteger(a){var b=/(^-?\d\d*$)/;return b.test(a)}function isPositiveInteger(a){var b=parseInt(a,10);if(isNaN(b)||b.toString().length!=a.length)return!1;var c=/(^\d\d*$)/;return c.test(b)}function isDate(a){var b=/^\d{1,2}(\-|\/|\.)\d{1,2}\1\d{4}$/;return b.test(a)}function isCharacter(a){var b=/^\w$/;return b.test(a)}function isTrueFalse(a){return a!="true"&&a!="false"?!1:!0}function isInArray(a,b){var c=b.length;for(var d=0;d<c;d++)if(a==b[d])return!0;return!1}function isInAllowedValues(a,b){var c=b.getAttribute("allowedvalues"),d=c.split(",");return isInArray(a,d)}function isWithinRange(a,b){if(!isInteger(a))return!1;a=parseInt(a);if(b.getAttribute("maxvalue")!=null){maxValue=parseInt(b.getAttribute("maxvalue"));if(a>maxValue)return!1}if(b.getAttribute("minvalue")!=null){minValue=parseInt(b.getAttribute("minvalue"));if(a<minValue)return!1}return!0}function validateElement(methodName,formElement){setFailedFocus(formElement.form);var fun=null;try{fun=eval(methodName)}catch(error){}if(fun==null)return alert("Wrong configuration.The validation method : "+methodName+" is not loaded"),!1;var message=null,isNullable=formElement.getAttribute("isnullable"),elemVal=formElement.value;if(isNullable!="true"||elemVal!=""&&elemVal!=null){var result;elemVal==null||elemVal==""?result=!1:result=fun(elemVal,formElement);if(result==1){var alertType=formElement.form.getAttribute("alerttype");return alertType!=null&&alertType.indexOf("Complete")>=0&&(document.getElementById(formElement.name+"_DIV")!=null?document.getElementById(formElement.name+"_DIV").style.display="none":document.getElementById(formElement.id+"_DIV")!=null?document.getElementById(formElement.id+"_DIV").style.display="none":hideCustomMessage()),!0}result==0?message=formElement.getAttribute("errormsg"):message=result;if(message!=null){formElement.getAttribute("displayname")!=null&&(message=message.replace("${COLUMNALIAS}",formElement.getAttribute("displayname")));var alertType=formElement.form.getAttribute("alerttype");alertType!=null&&alertType=="Custom"?showCustomMessage(message,formElement):alertType!=null&&alertType.indexOf("Complete")>=0?document.getElementById(formElement.name+"_DIV")!=null?(document.getElementById(formElement.name+"_DIV").innerHTML=message,document.getElementById(formElement.name+"_DIV").style.display="block",document.getElementById(formElement.name+"_DIV").className="errorMsg"):document.getElementById(formElement.id+"_DIV")!=null?(document.getElementById(formElement.id+"_DIV").innerHTML=message,document.getElementById(formElement.id+"_DIV").style.display="block",document.getElementById(formElement.id+"_DIV").className="errorMsg"):alert(message):alert(message)}return _FRM_SET_FAILED_FOCUS&&formElement.focus(),!1}return!0}function getCustomAlert(a){a==null&&(a="customAlert");var b=document.getElementById("CUSTOM_BUBBLE");return b==null?(b="<Table class='"+a+"' cellspacing=0 cellpadding=0><tr><td class='caTopLeft'></td><td class='caTopCenter' colspan='2'></td><td class='caTopRight'></td></tr>",b=b.concat("<tr><td class='caMiddleLeft'></td><td class='caMessage'>$MESSAGE</td><td class='caClose'><button class='caCloseButton' onClick='hideCustomMessage()'></td><td class='caMiddleRight'></td></tr>"),b=b.concat("<tr><td class='caBottomLeft'></td><td class='caBottomCenter' colspan='2'></td><td class='caBottomRight'></td></tr>"),b=b.concat("</table>")):b=b.innerHTML,b}function showCustomMessage(a,b,c){_FRM_CURRENT_ERROR_FIELD=b;var d=document.getElementById("customAlertMessage"),e=document.getElementById("_CUSTOMALERTFRAME");if(e==null){var f=document.createElement("iframe");if(browser_ie)f.id="_CUSTOMALERTFRAME",f.style.position="absolute",f.style.cursor="default",f.style.display="none",f.style.border="0px solid",f.frameBorder="0",f.scrolling="no",window["CONTEXT_PATH"]!=null&&(f.src=CONTEXT_PATH+"/framework/html/blank.html");else if(browser_nn4||browser_nn6)f.setAttribute("id","_CUSTOMALERTFRAME"),f.setAttribute("frameBorder","0"),f.setAttribute("style","position: absolute; cursor: default; display:none;");document.body.appendChild(f),e=f}if(d==null){var f=document.createElement("DIV");if(browser_ie)f.id="customAlertMessage",f.style.position="absolute",f.style.cursor="default",f.style.display="none";else if(browser_nn4||browser_nn6)f.setAttribute("id","customAlertMessage"),f.setAttribute("style","position: absolute; cursor: default; display:none;");document.body.appendChild(f),d=f}var g=getCustomAlert(c);g=g.replace("$MESSAGE",a),d.innerHTML=g,d.style.left=findPosX(b),d.style.top=findPosY(b)+b.offsetHeight,d.style.width=b.parentNode.offsetWidth+"px",d.style.zIndex=150,e.style.left=findPosX(b),e.style.top=findPosY(b)+b.offsetHeight+15,e.style.width=b.parentNode.offsetWidth-5+"px",e.style.height="28px",e.style.zIndex=d.style.zIndex-1,e.style.display="block",d.style.display="block"}function hideCustomMessage(){_FRM_CURRENT_ERROR_FIELD!=null&&(document.getElementById("_CUSTOMALERTFRAME").style.display="none",document.getElementById("customAlertMessage").style.display="none",_FRM_SET_FAILED_FOCUS&&_FRM_CURRENT_ERROR_FIELD.focus&&_FRM_CURRENT_ERROR_FIELD.focus(),_FRM_CURRENT_ERROR_FIELD=null)}function isNumeric(a,b){var c=/^[0-9]+$/;return c.test(a)?!0:!1}function isAlphaNumeric(a,b){var c=/^[a-zA-Z0-9]+$/;return c.test(a)?!0:!1}function isAlphaNumericWithMinus(a,b){var c=/^[a-zA-Z0-9\-]+$/;return c.test(a)?!0:!1}function isAlphaNumericWithMinusAndSpace(a,b){var c=/^[a-zA-Z0-9\-\ ]+$/;return c.test(a)?!0:!1}function isString(a,b){var c=/^[a-zA-Z]+$/;return c.test(a)?!0:!1}function isMinute(a,b){a=trimAll(a);if(a=="")return!1;var c=/^[0-9]+$/;return c.test(a)&&a<=59?!0:!1}function isHour(a,b){a=trimAll(a);if(a=="")return!1;var c=/^[0-9]+$/;return c.test(a)&&a<=23?!0:!1}function isSearchDataNumeric(a,b){return trimAll(a),a!=null&&a!=""?isNumeric(a,b):!0}function compareValues(str,formElement){var elemVal=trimAll(formElement.value),formObj=formElement.form,compareFieldName=formElement.getAttribute("checkwith"),compareFieldValue=trimAll(formObj.elements[compareFieldName].value),checkType=trimAll(formElement.getAttribute("checktype").toUpperCase());if(isNaN(elemVal)||elemVal.length==0)elemVal="'"+elemVal+"'";if(isNaN(compareFieldValue)||compareFieldValue.length==0)compareFieldValue="'"+compareFieldValue+"'";return eval(elemVal+checkType+compareFieldValue)}function isDummyNotSelected(a,b){return a!=b.getAttribute("dummyvalue")}function isAtleastOneChecked(a,b){var c=b.form[b.name];if(c.length==null||c.length==undefined)return c.checked;for(var d=0;d<c.length;d++)if(c[d].checked)return!0;return!1}function updateFormWithData(a,b){var c=DOMUtils.getChildElsWithAttr(DOMUtils.getForm(a),"name","*");DOMUtils.fillData(c,b)}function isElVisible(a,b){while(a.style.display!="none"){a=a.parentNode;if(a==b)break}return a.style.display!="none"}function isDomainName(a){a=trimAll(a);var b=/^((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{1,10}(?:\.[a-z]{2})?)$/i;return b.test(a)}function appendParent(a){var b=a.parentNode;b.style.overflow="hidden";var c=document.createElement("div");c.style.overflow="hidden",c.className="innerDiv",c.setAttribute("__MC_HOLDERDIV","true"),b.replaceChild(c,a),c.appendChild(a)}function replaceParent(a){var b=a.parentNode;if(b.getAttribute("__MC_HOLDERDIV")==null)return;b.parentNode.replaceChild(a,b)}function closeOnFade(elementID){var element=document.getElementById(elementID),reqOptions=element.___REQOPT,obj=reqOptions.ONCLOSE;obj!=null&&eval(obj)(reqOptions)}function getDataIndex(a,b,c,d){var e=a.options,f=e.length,g="";c=c.toString();for(var h=d?1:0;h<f;++h){b==null?optvalue=e[h].trim():g=e[h].getAttribute(b)?e[h].getAttribute(b):"";if(g.toUpperCase()==c.toUpperCase())return h}return-1}function firstCharUpper(){return firstCharUpper.arguments[1].toUpperCase()}function getTouchX(a){return a.changedTouches[0].pageX}function getTouchY(a){return a.changedTouches[0].pageY}function ZMstopEventBubble(a){a&&a.stopPropagation?(a.preventDefault(),a.stopPropagation()):window.event&&(window.event.cancelBubble=!0,window.event.returnValue=!1)}function ZDBStrBuf(){this.buf=[]}function DummyView(a,b,c,d){this.objId=a,this.modified=0,this.displayName=b,this.type=c,this.isDummyView=!0,this.permissions=ZDBConst.ALLPERMS,this.viewComp=d,ZDBClientViewAPI.initFns(this)}function ZDBDefViewCtx(a){this.isValid=!0,this.loadIndicator="ZDBMainLoader",this.standAlone=!0,this.menuItems=!0,this.singleChild=!0;if(a!=null)for(var b in a)this[b]=a[b]}function ZDBUIViewCtx(a){this.base=ZDBDefViewCtx,this.base(),this.standAlone=ZDBClientUI.standAlone,this.parComp=ZDBClientUI.placeHolder,this.tab=a,this.loadIndicator=ZDBUIViewCtx.getViewLoadingDiv(ZDBClientUI.placeHolder),this.initConfig()}function ZDBCell(a,b,c,d,e,f,g,h,i,j,k,l,m){d&&((""+d).indexOf("&nbsp;")>=0&&(d=(d+"").replace(/&nbsp;/g," ")),(""+d).indexOf("\n")>=0&&(d=(d+"").replace(/\n/g,"<br />"))),this.colObj=b,this.rowObj=a,this.modifiedValue=null,this.displayNode=null,this.cellEl=null,this.errorMsg=null,this.className=e?e:"zdbDataCell",this.isHtml=g==null?b&&b.typeObj.isHtml:g,this.startIndex=-1,this.endIndex=-1;if(a.objType==ZDBConst.FILLER)return;this.reset(c,d),this.groupStatus=h===undefined?ZDBConst.GROUPNONE:f==null?ZDBConst.GROUPMIDDLE:f,this.groupCount=h,this.hiddenDispValue=i?i:"",this.editBackup=null;var n=this.displayValue.length;a.txtLength<n&&n>ZDBConst.DISLEN&&(a.heightObj=this,a.txtLength=n),b.type=="MULTI_LINE"&&a.multiLine.push(this),this.bgCol=j,this.fontCol=k,this.geoInfo=null,l!=null&&(this.geoInfo=new Object,this.geoInfo.role=l,this.geoInfo.std=m)}function ZDBColHeader(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z){this.instId=ZDBColHeader.COLINSTID++,this.parGrid=a,this.colId=b,this.colName=c,this.colName==="FIELDNAME"&&(this.validateColFunc=ZDBValidator.isUnique),this.colName==="DATATYPE"&&(this.validateColFunc=ZDBValidator.isUniqueANC),this.displayNode=null,this.displayName=d,this.isPK=e,this.isAuto=f,this.isNullable=g,this.type=h,this.typeObj=null,h=="RELCOL"?(this.refTblName=R,this.refDispCol=S,this.refViewType=V):(this.refTblName=i,this.refColName=j,this.refDispCol=k),l||(l=ZDBGlobal.stdCellWidth),this.width=l,this.left=ZDBConst.NOTSET,this.cellPos=m,this.sortOrder=p,this.sortIndex=q,this.grouped=t,this.visible=n!=null?n:!0,this.isAuto&&(this.visible=!1),this.tobeListed=K!=null?K:!0,this.freeze=r?r:!1,this.status=s?s:ZDBConst.CLEAR,this.defaultVal=o,this.defCellClass="zdbDataCell",h&&ZDBColumnType[h]?this.typeObj=ZDBColumnType[h]:(this.type="PLAIN",this.typeObj=ZDBColumnType.PLAIN),this.typeMetadata=u,this.fnArr=[],this.formula=v,this.derivedFunction=this.formula?ZDBFunctions.needSave:null,this.dervIndex=x,this.isColCellsEditable=!0,v!=null&&(this.isColCellsEditable=!1),h=="AUTO_NUMBER"&&(this.isColCellsEditable=!1),this.section=y,this.refColType=z,this.reorder=!t&&!y,this.description=A,this.currencyFormat=B,this.unitsSymbol=U,this.className=C,this.parentViewId=D,this.objType=ZDBConst.COLHEAD,this.colObj=this,this.startIndex=-1,this.alignment=E,this.thousandSeparator=F,this.decimalPlaces=G,this.showSymbol=H,this.dateFormat=I,this.showNegativeSign=J,this.vudPerm=!0,this.dataColRefIdx=L,this.decimalSeparator=M,this.userLocale=N,this.condFormat=Y,this.cellSelArr=Z,this.altText=O,this.relColType=Q,this.relColTypeID=P,this.refColConstriant=T,X===null||typeof X=="undefined"?this.isSysCol=!1:(this.isSysCol=X[0],this.sysRefCol=ZDBEscapeUtil.escSplCharAsHTMLWithSpaceEncode(X[1]+"."+X[2]),this.connName=X[3]),this.parGrid.isJSONOrXMLImp&&(this.jsonNodePath=this.parGrid.nodesList[m]),this.rowHeaderEl=ZDBUtil.getCloned("zdbRowDiv"),this.rowDataEl=ZDBUtil.getCloned("zdbRowDiv"),W&&W!==null&&(this.geoRole=W[0],this.geoRoleName=W[1])}function ZDBRow(a,b,c,d,e,f){this.txtLength=0,this.heightObj=null,this.multiLine=[],this.objType=c,this.status=ZDBConst.CLEAR,this.sentStatus=0,this.parGrid=a,this.className=d?d:"dRow",f||this.setValues(b),this.height=a.type=="TableDesign"?ZDBGlobal.stdEditGridCellHeight:e||ZDBGlobal.stdCellHeight,this.top=ZDBConst.NOTSET,this.rowDataEl=ZDBUtil.getCloned("zdbRowDiv"),this.rowDataEl.setAttribute("refElname",c==ZDBConst.COLHEAD?"chArea":"dArea"),this.rowHeaderEl=ZDBUtil.getCloned("zdbRowDiv"),this.rowHeaderEl.setAttribute("refElname",c==ZDBConst.COLHEAD?"tcArea":"rhArea")}function ZDBFormatColHeader(a){this.type=ZDBUtil.dataTypeNumVsSubtypeDisp[a];var b=a?ZDBUtil.datatypeVsFormatType[this.type]:null;this.typeNo=a,this.alignment=a&&b!="Text"&&b!="Date"?"Right":"Left",this.altText=null,this.dateFormat="dd MMM, yyyy HH:mm:ss",this.userLocale=!1,this.thousandSeparator=a==ZDBConst.CURRENCY?1:0,this.decimalSeparator=0,this.decimalPlaces=a==ZDBConst.CURRENCY?2:-1,this.currencyFormat="en;US;",this.showSymbol=a==ZDBConst.CURRENCY?!1:!0,this.showNegativeSign=!0}function ZDBDataGrid(){var a=this;ZDBDataGrid.addInstance(this),this.displayOptions=function(){var a=$("ZDBDESIGN_OPTION"),b=a.getElementsByTagName("tr");$("ZDBD_ABORT").setAttribute("checked",!0);for(var c=0;c<b.length;c++){var d=b[c];d.getAttribute&&d.getAttribute("type")!=null&&(d.style.display=ZDBUtil.visibleTrStyle)}},this.submitOptionDlg=function(a,b){var c=ZDBUtil.getPropertyFromEl(a,"gridObj","object"),d=["ABORT","DEFAULT","EMPTY"],e="",f="";a?f="ZDBPopUpTypeChange_":(a=c.ZDBDESIGN_SETTINGS.src,f="ZDBD_");for(var g=0;g<d.length;g++)if($(f+d[g]).checked){if(d[g]=="DEFAULT"){var h=a.header.defaultVal;if(h==null){ZDBDialogUtil.closeDialog();var i=a.header.displayName;ZDBMsgBox.showInfo(ZDBI18NMap.f("zrpt.common.tbleditdesign.showinfo.js.noDefValErr",ZDBEscapeUtil.encodeForHtml(i)));return}}e=d[g];break}ZDBMetaDataChange.changeDataType(a.header,a.selType,e),ZDBDialogUtil.closeDialog()},this.closeOptionDlg=function(a,b){var c=ZDBUtil.getPropertyFromEl(srcEl,"gridObj","object"),d=c.selectedCols,e=c.ZDBDESIGN_SETTINGS.src;if(d.length==1){var f=getDataIndex(e,"defaultvaltype",d[0].type);e[f].selected=!0}return!0},this.setupBaseRow=function(){var a={values:[]};a.objType=ZDBConst.COLHEAD,a.gridObj=this,a.parGrid=this,a.height=this.type=="TableDesign"?ZDBGlobal.stdEditGridCellHeight:ZDBGlobal.stdColHeight,this.baseRow=a,this.colHeaders=a.values},this.resetColumnProps=function(){this.pkCols=[],this.setupBaseRow(),this.rowData[0]=this.baseRow,this.tcWidth=ZDBConst.NOTSET,this.chWidth=ZDBConst.NOTSET},this.init=function(){ZDBGlobal.isGlobalSet||ZDBDataGrid.setGlobals(),this.permissions=ZDBConst.ALLPERMS,this.pkCols=[],this.setupBaseRow(),this.rowData=[this.baseRow],this.newRid=1,this.recordStart=0,this.recordEnd=0,this.totalRecords=0,this.overAllSumCount=0,this.rowsToUpdate=[],this.newRows=[],this.selectedRows=[],this.selectedCols=[],this.lastFocusPos=null,this.domCache=new ZDBGridDomCache(this),this.dataCache=new ZDBGridDataCache(this),this.drag=!1,this.isEdit=!1,this.isFilterEdit=!1,this.freezeIndex=-1,this.scrollUp=!1,this.colHeadFocus=this.rowHeadFocus=this.dataFocus=this.filterFocus=!1,this.tcArea=null,this.chArea=null,this.rhArea=null,this.dArea=null,this.tcWidth=ZDBConst.NOTSET,this.chWidth=ZDBConst.NOTSET,this.dWidth=ZDBConst.NOTSET,this.tcHeight=ZDBConst.NOTSET,this.rhHeight=ZDBConst.NOTSET,this.fHeight=ZDBConst.NOTSET,this.dHeight=ZDBConst.NOTSET,this.modified=0,this.sent=0,this.gWidth=0,this.gDataWidth=0,this.gHeight=0,this.gDataHeight=0,this.resizeable=!0,this.selectable=!0,this.deletedCount=0,this.rowIdObj={},this.createZdbGrid(300,300),this.type=="QueryTable"&&this.setAsReadOnly(),this.simpleFilterData=[]},this.setGridProp=function(){this.reorderDisabled=!0,this.showDatatype=!1,this.showCheck=!1,this.showIcon=!0,this.isFreeze=!1,this.rowMenuDisabled=!0,this.editDisabled=!0,this.unfreezeDisabled=!1,this.showSortIcon=!0,this.readOnly=!0,this.gridSizeBasedOnData=!1,this.showRenameIcon=!1,this.showNavVisibility=ZDBGlobal.IS_MOBILE?!0:!1;var a=this.type;switch(a){case"Table":case undefined:this.reorderDisabled=!1,this.contextDisabled=!1,this.showDatatype=!0,this.rowMenuDisabled=!1,this.editDisabled=!1,this.readOnly=!1;break;case"Report":case undefined:this.reorderDisabled=!1,this.contextDisabled=!1,this.showDatatype=!0;break;case"QueryTable":this.contextDisabled=!1,this.showDatatype=!0,this.reorderDisabled=!1;break;case"TableDesign":this.showDatatype=!1,this.showIcon=!1,this.editDisabled=!1,this.unfreezeDisabled=!0,this.readOnly=!1,this.gridSizeBasedOnData=!0;break;case"SummarySheet":this.showDatatype=!1,this.showIcon=!0,this.showCheck=!1,this.unfreezeDisabled=!0,this.focusDisabled=!0,this.gridSizeBasedOnData=!0,this.showRenameIcon=!0,this.showNavVisibility=!0,this.selectionDisabled=!0;break;case"PivotSheet":this.selectionDisabled=!0,this.focusDisabled=!0,this.editDisabled=!0,this.showDatatype=!1,this.unfreezeDisabled=!0,this.gridSizeBasedOnData=!0,this.showRenameIcon=!0,this.showNavVisibility=!0;break;case"VUDSheet":this.reorderDisabled=!1,this.showSortIcon=!0;break;case"AnalysisSheet":this.showSortIcon=!1,this.gridSizeBasedOnData=!0,this.showNavVisibility=!0,this.gridSizeBasedOnData=!0}this.subtype&&this.subtype=="EnterData"&&(this.noUISave=!0,this.readOnly=!1,this.reorderDisabled=!0),this.isForImport&&(this.showDatatype=!1,this.showIcon=!1,this.showCheck=!0,this.reorderDisabled=!0,this.focusDisabled=!0,this.selectionDisabled=!0,this.editDisabled=!0),ZDBClientUI.readOnlyMode&&(this.editDisabled=!0)},this.createZdbGrid=function(a,b){this.setGridProp(),ZDBDataGrid.setTemplateLayout(this),this.gArea.gridObj=this,this.setGridDimension(a,b),this.dArea.gridObj=this,this.gAreaClass!=null&&(this.gArea.className=this.gAreaClass),this.setRoughWorkArea(),this.OUTER={},this.freezeIcon=ZDBGlobal.freezeIcon.cloneNode(!0),this.gArea.appendChild(this.freezeIcon),ZDBDataGrid.setIndices(this)},this.calculateWidth=function(a,b,c,d){var e=ZDBGlobal.dummyCell,f=b?"&nbsp;":"";return a=f+a+f,e.innerHTML=c?"<nobr>"+a+"</nobr>":a,ZDBUtil.getStyleNumeric(e,"width")},this.resizeGrid=function(a,b){if(!a||!b)return;var c=2;this.viewCtx&&this.viewCtx.dashView&&(a=parseInt(this.viewCtx.dashChildDiv.dlgBody.style.width),b=this.type==="PivotSheet"||this.type==="SummarySheet"?b:parseInt(this.viewCtx.dashChildDiv.dlgBody.style.height),c=this.type==="PivotSheet"||this.type==="SummarySheet"?0:c),a-=c,b-=2;if(a&&a==this.gArea.clientWidth&&b&&b==this.gArea.clientHeight)return;var d=this.gArea.parentNode;d!=null&&d.removeChild(this.gArea),this.setGridDimension(a,b),d!=null&&d.appendChild(this.gArea),this.setShowHide(),this.maintainRowCount(),this.adjustDimension(),this.adjustRowFill(!0),this.adjustColFill(),this.adjustFilterAreaDimension(),ZDBGlobal.IS_MOBILE&&this.scroller&&this.scroller.resizeScroller(this.dArea),this.selectedCols!==null&&this.selectedCols.length>0&&this.selectColumn(),ZDBGridScroll.checkAndShowScroll(this,null,null)},this.finalAdjustments=function(){var a=this.type,b=a=="TableDesign";if(a!="PivotSheet"&&a!="SummarySheet"&&!b&&!this.isForImport)return;var c=this.gLeftArea,d=this.gRightArea,e=this.dArea,f=this.chArea,g=parseInt(c.clientWidth),h=parseInt(d.clientWidth);this.isForImport&&(h+=parseInt(30)),e.style.width=h+"px",f.style.width=h+"px";var i=this.checkIsScrollable(),j=i?ZDBGlobal.scrollThick:0,k=g+h>=this.gWidth?h-j:h;f.style.width=(k>0?k:0)+"px";var l=g+h>=this.gWidth?h:h+j;e.style.width=(l>0?l:0)+"px"},this.checkIsScrollable=function(){var a=this.dArea,b=a.scrollHeight,c=parseInt(a.style.height),d=c<b;return d},this.getRowHeight=function(a,b,c){var d=c.objType,e,f=0;if(d===ZDBConst.COLHEAD)for(var g=0;g<b;++g){e=a[g];if(e===c)break;f+=e.height}else for(var g=0;g<b;++g){e=a[g];if(e.objType===ZDBConst.COLHEAD||e.status==ZDBConst.DELETED)continue;if(e==c)break;f+=e.height}return f},this.adjustRowFill=function(a){var b=this.rowData,c=b.length;if(c==0)return;this.gridSizeBasedOnData===!0&&(this.adjustRowHeadAreaDimension(),this.adjustDataAreaDimension());var d=this.rowData[c-1];if(d.objType!==ZDBConst.FILLER)return;this.rhHeight===ZDBConst.NOTSET&&this.adjustRowHeadAreaDimension();var e=this.rhHeight,f=this.getRowHeight(b,c,d),g=e-f;g<0&&(g=0),!(g<10);var h=d.height;d.visible=g?!0:!1,d.height=g,d.rowHeaderEl.style.display=d.visible&&g>0?"inline-block":"none",d.rowDataEl.style.display=d.visible&&g>0?"inline-block":"none";if(h!=g){var i=parseInt(d.rowDataEl.style.height)-h+g;d.rowDataEl.style.height=i+"px",d.rowHeaderEl.style.height=i+"px"}var j=d.values,k=a?!0:g!=0;for(var l=0;l<j.length&&k;++l)this.placeCellElement(j[l],[!0,!1,!0,!1],[!1,!1,!1,!0])},this.adjustColFill=function(a){if(!this.visible)return;var b=this.rowData,c=b.length,d=this.colHeaders,e=d.length;if(e<1||d[e-1].objType!==ZDBConst.FILLER)return;this.chWidth===ZDBConst.NOTSET&&this.adjustColHeadAreaDimension();var f=this.chWidth-this.getChAreaWidth();f<0&&(f=0),!(f<10);var g=d[e-1],h=g.width;this.isForImport&&(f+=parseInt(30)),g.width=f;var i=parseInt(this.chAreaRowDiv.style.width)-h+f;h!=f&&(this.chAreaRowDiv.style.width=i+"px"),g.visible=f?!0:!1;if(g.visible&&this.isFilterApplied){var k=this.filterOptionRow.values[e-1],l=this.filterDataRow.values[e-1];k.width=f,l.width=f,this.placeCellElement(k,[!1,!0,!1,!0],[!1,a,!1,!0]),this.placeCellElement(l,[!1,!0,!1,!0],[!1,a,!1,!0])}var m,n,o;for(j=0;j<c;++j)m=b[j],o=m.values,n=o[o.length-1],h!=f&&m instanceof ZDBRow&&(m.rowDataEl.style.width=i+"px"),this.placeCellElement(n,[!1,!0,!1,!0],[!1,a,!1,!0])},this.adjustDimension=function(){if(!this.visible)return;this.adjustTableControlAreaDimension(),this.adjustColHeadAreaDimension(),this.adjustRowHeadAreaDimension(),this.adjustDataAreaDimension(),this.position=ZDBUtil.getObjCoordinates(this.parNode),this.tcArea.className=this.hideRhId?"zdbTcAreaHidden":"zdbTcArea",this.rhArea.className=this.hideRhId?"zdbRhAreaHidden":"zdbRhArea"},this.getTcAreaWidth=function(){var a=this.colHeaders,b=a.length,c=0,d=null;for(var e=0;e<b;++e){d=a[e].colObj;if(!d.freeze)break;d.visible&&(c+=d.width)}var f=a[0].parGrid.hideRhId;return f?c+1:c},this.getTcAreaHeight=function(){var a=this.rowData,b=a.length,c=0;for(var d=0;d<b;++d){if(a[d].objType!==ZDBConst.COLHEAD)break;c+=a[d].height}return c},this.getTableOffsetHeight=function(a){var b=a.childNodes,c=b.length,d=0;for(var e=0;e<c;++e)d+=parseInt(ZDBUtil.getStyle(b[e],"height"),10);return d},this.getChAreaWidth=function(){var a=this.colHeaders,b=a.length,c=0,d=null;for(var e=0;e<b;++e)d=a[e],d.visible&&d.freeze==0&&d.objType!=ZDBConst.FILLER&&(c+=d.width);return c},this.setGridDimension=function(
a,b){if(!a||!b){console.trace();return}this.gWidth=a,this.gHeight=b,this.gArea.style.width=a+"px",this.gArea.style.height=b+"px",this.minRows=Math.ceil(this.gHeight/ZDBGlobal.stdCellHeight)+5},this.adjustGridAreaDimension=function(){this.gArea.style.width=this.gWidth+"px",this.gArea.style.height=this.gHeight+"px"},this.adjustColHeadAreaDimension=function(a){this.tcWidth===ZDBConst.NOTSET&&this.adjustTableControlAreaDimension(),this.chWidth=this.setAndGetGridWidth()-this.tcWidth-this.getScrollThick(),this.chWidth<0&&(this.chWidth=0),this.gRightArea.style.width=this.chWidth+this.getScrollThick()+"px",this.chArea.style.width=this.chWidth+"px",this.chArea.style.height=this.tcHeight+"px";if(this.viewObj!=undefined){var b=this.viewObj.currentList,c=ZDBUtil.getElementsWithAttribute(b,"viewType","TEXTAXIS"),d=ZDBUtil.getElementsWithAttribute(b,"viewType","XAXIS"),e=this.gLeftArea.offsetWidth,f=this.gArea.offsetWidth;(e&&f&&e+100>f||d.length+c.length==0&&this.freeze!=0)&&this.unfreezeColumn(!0)}},this.getScrollThick=function(){if(ZDBGlobal.IS_MOBILE)return 0;if(this.isForImport)return this.gLeftArea.style.display="none",0;if(this.gridSizeBasedOnData===!1)return ZDBGlobal.scrollThick;var a=this.gridSizeBasedOnData===!0&&(this.gWidth<this.gDataWidth||this.gHeight<this.gDataHeight),b=!1;return this.dArea.style.overflow=a||b?"auto":"hidden",this.gWidth<this.gDataWidth||this.gHeight<this.gDataHeight||b?ZDBGlobal.scrollThick:0},this.setAndGetGridWidth=function(){if(this.gridSizeBasedOnData===!1)return this.gWidth;var a=0,b=this.colHeaders,c=b.length,d;for(var e=0;e<c;++e)d=this.colHeaders[e],d.visible&&d.objType!=ZDBConst.FILLER&&(a+=d.width);return this.gWidth<this.gDataWidth?a+=this.getScrollThick():this.hideRhId&&a++,this.gDataWidth=a,a<this.gWidth?a:this.gWidth},this.adjustDataAreaDimension=function(){var a=this.rhHeight+this.getScrollThick(),b=this.chWidth+this.getScrollThick(),c=this;b<0&&(b=0),this.dArea.style.width=b+"px",this.dArea.style.height=a+"px",this.dWidth=b,this.dHeight=a;if(ZDBGlobal.IS_MOBILE){if(!this.scroller&&!this.scrollDisabled){var d={V_SCROLL_ELS:[this.rhArea],H_SCROLL_ELS:[this.chArea,this.fArea1],ONSCROLLDOWN_LAZYLOAD:function(){ZDBGridScroll.addRowsToGrid(c,!1,!1,ZDBCallBack.dummyCallBack)},ONSCROLLUP_LAZYLOAD:function(){ZDBGridScroll.addRowsToGrid(c,!0,!1,ZDBCallBack.dummyCallBack)},ONSCROLL_START:function(){ZDBGridScroll.positionIpadNavComp(c),c.clearScrollTimeout()},ONTOUCH_START:function(){ZDBGridScroll.showRowNavigComp(c)},ONSCROLL_STOPS:function(){ZDBGridScroll.positionIpadNavComp(c,!0)}};this.scroller=new ZRScroller(this.dArea,d)}else this.scroller.resizeScroller(this.dArea);ZDBGridScroll.positionIpadNavComp(c)}else this.setRowCount();this.finalAdjustments()},this.adjustTableControlAreaDimension=function(){this.tcWidth=this.getTcAreaWidth(),this.tcHeight=this.getTcAreaHeight(),this.tcArea.style.width=this.tcWidth+"px",this.gLeftArea.style.width=this.tcWidth+"px",this.tcArea.style.height=this.tcHeight+"px"},this.adjustRowHeadAreaDimension=function(){this.tcHeight===ZDBConst.NOTSET&&this.adjustTableControlAreaDimension(),this.fHeight===ZDBConst.NOTSET&&this.adjustFilterAreaDimension();var a=this.setAndGetGridHeight(),b=this.getScrollThick();b<1&&this.type!="TableDesign"?this.dArea.style.borderBottom="1px solid #CCC":this.dArea.style.borderBottom="0px",this.rhHeight=a-this.tcHeight-this.fHeight-b,this.rhArea.style.height=this.rhHeight+"px",this.rhArea.style.width=this.tcWidth+"px",this.gridSizeBasedOnData===!0&&this.gWidth<this.gDataWidth&&!(this.gHeight<this.gDataHeight)&&this.dArea.style.width!=null&&this.dArea.style.width!=""&&(this.chArea.style.width=parseInt(this.dArea.style.width)+"px"),this.gridSizeBasedOnData===!0&&this.gHeight<this.gDataHeight&&!(this.gWidth<this.gDataWidth)&&this.dArea.style.height!=null&&this.dArea.style.height!=""&&(this.rhArea.style.height=parseInt(this.rhHeight+b)+"px",this.type!="TableDesign"&&(this.gLeftArea.style.borderBottom="1px solid #cccccc",this.dArea.style.borderBottom="1px solid #cccccc")),this.gLeftArea.style.height=a+"px",this.gRightArea.style.height=this.gLeftArea.style.height},this.setAndGetGridHeight=function(){if(this.gridSizeBasedOnData===!1)return this.gDataHeight=this.gHeight,this.gHeight;var a=this.rowData,b=a.length,c;gridHeight=0;for(var d=0;d<b;++d)c=a[d],c.objType!=ZDBConst.FILLER&&(gridHeight+=c.height);return this.gDataHeight=gridHeight,gridHeight+=this.getScrollThick(),gridHeight<this.gHeight?gridHeight:this.gHeight},this.onLostFocus=function(){this.rowHeadFocus=!1,this.colHeadFocus=!1,this.dataFocus=!1,this.gridFocus=!1,this.curCellPos=null,this.removeCellFocus()},this.onFocus=function(b,c){if(b){var d=ZDBUtil.getSourceElement(b);if(d&&d.tagName&&d.tagName.toUpperCase()=="SELECT")return}if(this.isEdit==1)return;this.gridFocus=!0;var e=this.keyHandler;e.gridObj||(e.gridObj=this);var f=ZDBDataGrid.getLastFocusCell(this);f&&!c&&this.setCellFocus(f,!1),ZDBDataGrid.setKeyHandlerFocus(a,10)},this.showTable=function(){this.shown||(this.gridHeaderRows!=null&&this.addPivotHeadRows(this.gridHeaderRows),this.visible=!0,this.adjustDimension(),this.adjustColFill(),this.adjustRowFill(),this.gArea.addEventListener&&this.gArea.addEventListener("DOMMouseScroll",ZDBGridScroll.onMouseWheel,!1),this.shown=!0);var b=ZDBDataGrid.getLastFocusCell(this);if(b)this.setCellFocus(b,!0);else if(this.viewCtx==null||this.viewCtx.canGrabFocus())this.focusFirstCell(),this.type=="TableDesign"&&this.objId=="null"&&setTimeout(function(){a.setCellEditable(ZDBDataGrid.getCurrentCell(a))},100);this.setFreezeIcon(),this.reorderDisabled=this.type=="VUDSheet"?!1:this.reorderDisabled,this.setShowHide(),this.onFocus(null,!1)},this.setShowHide=function(){this.showHideElInEmbed=ZDBUtil.getAttribute(this.showHide,"showInEmbed");if(this.reorderDisabled===!1){var a=this.showHide.style,b=this.setAndGetGridWidth()-this.getScrollThick();b<0&&(b=0);var c=ZDBGlobal.stdColHeight+(BROWSER.IE?0:-5);c<0&&(c=0),a.top="0px",a.right="0px",a.height=c+"px",a.width=this.getScrollThick()+"px",a.display=this.type=="VUDSheet"?this.showHideColsVisible==1?"block":"none":"block"}else this.showHide.style.display="none";this.showHideElInEmbed=="false"&&(this.showHide.className="zdbColHead",this.showHide.style.display="none",this.showHide.style.height=BROWSER.IE?"22px":"20px",this.showHide.style.width="16px",this.showHide.onclick=null,this.showHide.onmousedown=null,this.showHide.onmouseover=null)},this.associateColHead=function(a,b,c){ZDBUtil.removeNonElements(a),b.cellEl=a,a.cellObj=b,b.rowObj=c,b.colObj=b;var d=a.getElementsByTagName("div"),e=d.length;b.checkNode=d[0],b.typeNode=d[1],b.renameIcon=d[2],b.displayNode=d[3],b.iconNode=d[4],b.displayNode.innerHTML=ZDBEscapeUtil.encodeForHtml(b.displayName),a.style.display=b.visible?"block":"none";if(b.parGrid.type=="PivotSheet"||b.parGrid.type=="SummarySheet")b.renameIcon.style.display="block";if(b.objType!=ZDBConst.COLHEAD)for(var f=0;f<e;++f)d[f].style.display="none";ZDBGlobal.IS_MOBILE&&new TouchButton(b.iconNode,ZDBSorting.sortIconTapped,!0,null,null,null,!0,!0,!1,!0),b.setClass()},this.addColToView=function(a,b){var c=ZDBGlobal.colHead.cloneNode(!0);b||(b=this.baseRow),this.associateColHead(c,a,b),a.objType===ZDBConst.ROWHEAD?jQuery(this.tcAreaRowDiv).prepend(c):a.objType===ZDBConst.DUMMY||a.objType===ZDBConst.FILLER?this.chAreaRowDiv.appendChild(c):a.freeze?this.tcAreaRowDiv.appendChild(c):this.chAreaRowDiv.appendChild(c),a.width<0&&(a.width=ZDBDataGrid.calculateColWidth(a,this)),this.placeCellElement(a,[!0,!0,!0,!0],[!1,!1,!0,!0]),ZDBDataGrid.setColHeadDisplayWidth(this,a),this.view&&this.view.chartProp&&this.view.chartProp.zr_wrap_colHead&&ZDBDataGrid.setColHeadDisplayHeight(a,b),c.setAttribute("dontwrap",!0),ZDBGlobal.IS_MOBILE||(c.setAttribute("tiptitle",a.displayName),c.setAttribute("showTipAtCursorPos","true"),a.description&&c.setAttribute("tipdesc1",a.description))},this.showHideColumn=function(a){var b=a.length;if(b==0)return;var c=a[0][0].cellPos,d,e=this.colHeaders,f=e.length,g=[];for(var h=0;h<f;++h)e[h].objType!==ZDBConst.COLHEAD?g.push(!1):g.push(e[h].visible);for(var h=0;h<b;++h)g[a[h][0].cellPos]=a[h][1];var i=!1;for(var h=0;h<f;++h)if(e[h].objType===ZDBConst.COLHEAD&&g[h]){i=!0;break}if(!i){ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.showrhide.js.allColHideErr"));return}for(var h=0;h<b;++h)d=a[h][0],d.visible=a[h][1],d.cellPos<c&&(c=d.cellPos);var j=this.rowData,k=j.length,l,m,n,o,p,q;for(var h=0;h<k;h++){l=j[h],m=l.values,p=m.length;var r=l.objType!=ZDBConst.COLHEAD?l.rowHeaderEl:this.tcAreaRowDiv,s=l.objType!=ZDBConst.COLHEAD?l.rowDataEl:this.chAreaRowDiv,t=parseInt(r.style.width),u=parseInt(s.style.width);for(var v=0;v<p;++v){n=m[v],o=n.colObj;if(o.cellPos<c)continue;q=o.visible?"inline-block":"none",n.cellEl.style.display!=q&&(o.freeze?t=o.visible?t+o.width:t-o.width:u=o.visible?u+o.width:u-o.width,n.cellEl.style.display=q)}r.style.width=t+"px",s.style.width=u+"px"}this.adjustDimension(),this.adjustColFill(!0),this.filterVisible&&this.resetFilterColumnVisible(),this.hideSelection(),this.removeCellFocus(),this.sendClientState(!1,"SHOWHIDECOLUMN")},this.freezeColumn=function(a){var b=this.colHeaders;a instanceof ZDBColHeader||(a=b[parseInt(a,10)+1]);if(a.freeze){ZDBMsgBox.showInfo(ZDBI18NMap.g("zrpt.common.table.showinfo.js.freezingColErr"));return}var c,d=a.cellPos;this.freezePos=d;var e=-1;for(var f=0;f<=d;++f){c=b[f];if(c.freeze)continue;e==-1&&(e=f),c.freeze=!0}var g=this.rowData,h=g.length,c,i,j=this.tcArea,k=this.rhArea,l,m,n;for(var f=0;f<h;++f){var o=g[f];if(o.status==ZDBConst.DELETED)continue;l=o.objType,n=o.values;var p=n.length;for(var q=0;q<p;++q){m=n[q],c=m.colObj;if(c.cellPos<e)continue;if(c.cellPos>d)break;l===ZDBConst.COLHEAD?(this.tcAreaRowDiv.appendChild(m.cellEl),c.visible&&(this.tcAreaRowDiv.style.width=parseInt(this.tcAreaRowDiv.style.width)+c.width+"px",this.chAreaRowDiv.style.width=parseInt(this.chAreaRowDiv.style.width)-c.width+"px")):(o.rowHeaderEl.appendChild(m.cellEl),c.visible&&(o.rowHeaderEl.style.width=parseInt(o.rowHeaderEl.style.width)+c.width+"px",o.rowDataEl.style.width=parseInt(o.rowDataEl.style.width)-c.width+"px"))}l==ZDBConst.COLHEAD?j.appendChild(this.tcAreaRowDiv):k.appendChild(o.rowHeaderEl)}this.freeze=!0,this.adjustDimension(),this.setFreezeIcon(),this.resetFilterOnFreeze(),this.selectColumn()},this.unfreezeColumn=function(a){if(this.type=="TableDesign")return;var b=this.colHeaders,c=b.length,d=this.rowData,e=d.length,f,g,h,i=this.chArea,j=this.dArea;for(var k=0;k<e;++k){var l=d[k],m=l.objType;h=l.values;var n=h.length,o=m==ZDBConst.COLHEAD&&!l.rowDataEl?this.chAreaRowDiv:l.rowDataEl,p=m==ZDBConst.COLHEAD&&!l.rowHeaderEl?this.tcAreaRowDiv:l.rowHeaderEl,q=0,r=0;for(var s=0;s<n;++s){g=h[s],f=g.colObj;if(f.objType==ZDBConst.ROWHEAD){r+=f.width;continue}a&&f.freeze&&(f.unFreezeForScroll=!0),f.freeze=!1,o.appendChild(g.cellEl);var t=m==ZDBConst.COLHEAD&&g.width?g.width:f.width;q=f.visible?q+t:q}(m===ZDBConst.COLHEAD?i:j).appendChild(o),o.style.width=q+"px",p.style.width=r+"px"}this.freeze=!1,this.adjustDimension(),this.setFreezeIcon(),this.resetFilterOnFreeze(),this.selectColumn()},this.setFreezeIcon=function(){if(this.type=="TableDesign"){this.freezeIcon.style.display="none";return}var a=this.colHeaders,b=a.length,c=null;for(var d=1;d<b;++d){if(!a[d].freeze)break;c=d}if(c===null){this.freezeIcon.style.display="none";return}var e=a[c].cellEl.offsetLeft+a[c].width,f=0,g=this.freezeIcon.style,h=8;g.top=f-h+"px",g.left=e-h+"px",(this.parentViewType+"").toLowerCase()=="pivot"?this.freezeIcon.style.display="none":this.freezeIcon.style.display="block",this.unfreezeDisabled&&ZDBDataGrid.setUnfreezeInfo(this.freezeIcon)},this.addRowToView=function(b,c,d,e){this.domCache.associateRow(b),this.columnAlignment(b),e&&b.values!=undefined&&this.appendGrandSummaryCell(b.values[1]);var f=b.values,g=f.length,h,i=b.height,j,k=b.rowDataEl,l=b.rowHeaderEl;for(var m=0;m<g;++m){var n=this.calcPivotHeaderWidth(b,f[m]);j=ZDBDataGrid.calculateRowHeight(f[m],n),j>i&&(i=j,h=f[m])}b.heightObj=h,b.height=i,b.height==ZDBConst.NOTSET&&(b.height=ZDBGlobal.stdCellHeight);var o=this.colHeaders,p=o.length,q=this.rhArea,r=this.dArea,s=this.tcArea,t=this.chArea,u,v,w,x,y=b.objType,z,A,B,C=0,D=0;for(var m=0;m<g;++m)v=f[m],u=v.cellEl,A=f[m].colObj.freeze,B=v.colObj.visible,C=y!=ZDBConst.COLHEAD&&A&&B?C+v.colObj.width:A&&B?C+v.colObj.width:C,D=y!=ZDBConst.COLHEAD&&!A&&B?D+v.colObj.width:!A&&B?D+v.colObj.width:D,(y===ZDBConst.COLHEAD?A?l:k:A?l:k).appendChild(u),this.placeCellElement(v,[!0,!0,!0,!0],[!1,!1,!1,!1]);l.style.height=b.height+"px",l.style.width=C+"px",l.className="zdbDataRowDiv",k.style.height=b.height+"px",k.style.width=D+"px",k.className="zdbDataRowDiv",y==ZDBConst.FILLER&&(this.zdbFillerHRowDiv=l,this.zdbFillerDRowDiv=k),y==ZDBConst.DUMMY&&(this.zdbDummyHRowDiv=l,this.zdbDummyDRowDiv=k);if(this.zdbFillerHRowDiv&&this.zdbFillerDRowDiv&&y!=ZDBConst.FILLER&&y!=ZDBConst.COLHEAD&&this.zdbFillerHRowDiv.parentElement&&this.zdbFillerDRowDiv.parentElement){var E=d?this.zdbDummyHRowDiv:a.scrollUp?jQuery(q).find(":first-child").get(0):this.zdbFillerHRowDiv,F=d?this.zdbDummyDRowDiv:a.scrollUp?jQuery(r).find(":first-child").get(0):this.zdbFillerDRowDiv;q.insertBefore(l,E),r.insertBefore(k,F)}else y==ZDBConst.COLHEAD?(s.insertBefore(l,this.tcAreaRowDiv),t.insertBefore(k,this.chAreaRowDiv)):(q.appendChild(l),y===ZDBConst.COLHEAD?t.appendChild(k):r.appendChild(k));this.selectionType===ZDBConst.COLHEAD&&(this.rightSelect.style.height=ZDBDataGrid.getDataHeight(this,this.rightSelect)-(BROWSER.IE?0:ZDBUtil.getElementOuterHeight(this.rightSelect))+"px",this.leftSelect.style.height=ZDBDataGrid.getDataHeight(this,this.leftSelect)-(BROWSER.IE?0:ZDBUtil.getElementOuterHeight(this.leftSelect))+"px")},this.columnAlignment=function(a){if(a.objType==ZDBConst.COLHEAD)return;var b=this.colHeaders.length,c=a.values,d=c.length,e,f;for(var g=0;g<d;g++)e=c[g].colObj,f=this.colHeaders[g].alignment,f&&(c[g].cellEl.style.textAlign=f)},this.setScrollPosition=function(){}}function getErrorType(a){var b=a.indexOf(" (http");return b=b==-1?a.indexOf("http"):b,b!=-1?a.substring(0,b):""}function globalErrorHandler(a,b,c,d,e,f){if(a.indexOf("Script error.")>-1)return;if(ZDBGlobal.isClientErrorLoggingEnabled){f||(f=0);try{var g=null,h=null,i=null;if(e)g=e.name,h=e.stack,i=getErrorType(h).replace(/([-+.^:,&#?^%<>@*!'\"])/g,"_"),h=h.replace(/([-+.^:,&#?^%<>@*!'\"])/g,"_");else{g="UNSUPPORTED_BROWSER";if(!globalErrorHandler.caller)return;h=globalErrorHandler.caller.toString().substr(0,300),i="",h=h.replace(/([-+.^:,&#?^%<>@*!'\"])/g,"_")}b=b.replace(/([-+.^:,&#?^%<>@*!'\"])/g,"_").replace(/\r?\n|\r/g,"_"),a=a.replace(/([-+.^:,&#?^%<>@*!'\"])/g,"_");var j=ZDBUtil.getValueFromLocal("jserrors");if(j){var k=JSON.parse(ZDBUtil.getValueFromLocal("jserrors")),l=Object.keys(k),m=[];for(var n=0;n<l.length;n++){m=k[l[n]];if(m[0]==ZDBGlobal.zuID&&m[1]==a&&m[5]==c&&(m[6]=d)){m[8]+=1,k[l[n]]=m,ZDBUtil.setValueToLocal("jserrors",JSON.stringify(k));return}}}var o=1,p=new Date;p=p.getTime();var q="jserror_"+Math.random().toString(36).substring(2),r=[ZDBGlobal.zuID,a,b,h,g,c,d,p,o,ZDBGlobal.emailID,BROWSER.browserNdVersion,i];if(j){var k=JSON.parse(ZDBUtil.getValueFromLocal("jserrors"));ZDBUtil.deleteValueFromLocal("jserrors"),k[q]=r,ZDBUtil.setValueToLocal("jserrors",JSON.stringify(k))}else{var k={};k[q]=r,ZDBUtil.setValueToLocal("jserrors",JSON.stringify(k))}}catch(s){f<2&&(saveJSErrorsToServer(),window.onerror(a,b,c,d,e,++f))}}else ZDBUtil.deleteValueFromLocal("jserrors")}function saveJSErrorsToServer(){if(ZDBGlobal.isClientErrorLoggingEnabled&&ZDBUtil.getValueFromLocal("jserrors")){var a="JSONSTRING="+ZDBUtil.getValueFromLocal("jserrors"),b="/ZDBClientErrorLog.ma?ZDBACTION=CLIENTERRORLOG";AjaxAPI.sendRequest({URL:b,PARAMETERS:a,ONSUCCESSFUNC:onSuccessFuncJSErrorHand,ONFAILUREFUNC:function(){ZDBUtil.deleteValueFromLocal("jserrors")}})}else ZDBUtil.deleteValueFromLocal("jserrors")}function onSuccessFuncJSErrorHand(a,b){var c=a.getResponseParams().CLIENTERRORLOGGINGENABLED;c==="true"?ZDBGlobal.isClientErrorLoggingEnabled=!0:ZDBGlobal.isClientErrorLoggingEnabled=!1,ZDBUtil.deleteValueFromLocal("jserrors")}function showCustomMessage(a,b,c){_FRM_CURRENT_ERROR_FIELD=b;var d=document.getElementById("customAlertMessage"),e=document.getElementById("_CUSTOMALERTFRAME");if(e==null){var f=document.createElement("iframe");if(browser_ie)f.id="_CUSTOMALERTFRAME",f.style.position="absolute",f.style.cursor="default",f.style.display="none",f.style.border="0px solid",f.frameBorder="0",f.scrolling="no",window["CONTEXT_PATH"]!=null&&(f.src=ZDBGlobal.REPORTS_CONTEXT_NAME+CONTEXT_PATH+"/framework/html/blank.html");else if(browser_nn4||browser_nn6)f.setAttribute("id","_CUSTOMALERTFRAME"),f.setAttribute("frameBorder","0"),f.setAttribute("style","position: absolute; cursor: default; display:none;");document.body.appendChild(f),e=f}if(d==null){var f=document.createElement("DIV");if(browser_ie)f.id="customAlertMessage",f.style.position="absolute",f.style.cursor="default",f.style.display="none";else if(browser_nn4||browser_nn6)f.setAttribute("id","customAlertMessage"),f.setAttribute("style","position: absolute; cursor: default; display:none;");document.body.appendChild(f),d=f}d.custMsg=a;var g=getCustomAlert(c);g=g.replace("$MESSAGE",a),d.innerHTML=g,d.style.left=ZDBUtil.getObjLeft(b,!0)+"px",d.style.top=ZDBUtil.getElementAbsoluteTop(b)+b.offsetHeight+"px",d.style.width=b.parentNode.offsetWidth+"px",d.style.zIndex=2e5,e.style.left=ZDBUtil.getObjLeft(b,!0)+"px",e.style.top=findPosY(b,!0)+b.offsetHeight+"px",e.style.width=b.parentNode.offsetWidth-5+"px",e.style.zIndex=d.style.zIndex-1,e.style.display="block",d.style.display="block",e.style.height=d.offsetHeight+"px",e.className="alpha0"}function hideCustomMessage(){_FRM_CURRENT_ERROR_FIELD!=null&&(document.getElementById("_CUSTOMALERTFRAME").style.display="none",document.getElementById("customAlertMessage").style.display="none",_FRM_SET_FAILED_FOCUS&&_FRM_CURRENT_ERROR_FIELD.focus&&_FRM_CURRENT_ERROR_FIELD.focus(),_FRM_CURRENT_ERROR_FIELD=null)}function ZDBSuggestionBox(a,b,c,d,e,f){this.showAllOnBlank=c,this.listMode=d,this.expandDefault=e,this.curIndex=-1,this.dropList=null,this.suggestData=b,this.inputEl=typeof a=="string"?document.getElementById(a):a,this.initSB(f)}function setColListVisible(a){$("colListTR").style.display=a?"":"none"}function checkKeyAndSearch(a){return a||(a=window.event),a.keyCode==13?(searchDatabases(),!1):!0}function searchDatabases(){var a=ZDBSearchUtil.getSearchValue($("ZDBDBSEARCHBOX"));updateState("ZDBListDatabases","SCRITERIA",a),resetNavigationState("ZDBListDatabases"),refreshSubView("ZDBListDatabases")}function showDBList(a){var b=a.parentNode.childNodes;for(var c=0,d=b.length;c<d;c++)b[c].getAttribute&&b[c].getAttribute("LISTTYPE")!=null&&(b[c].className=b[c]==a?"buttonSelected":"buttonDeselected");ZDBListDB.refreshTable($("ZDBDBListParEl"),{LISTTYPE:a.getAttribute("LISTTYPE")},a)}function trashDB(a,b){var c=jQuery("#ZDBNAME_"+a).text(),d=$("ZDBLISTDBTD_"+a);d.isDialogOpen=!0,ZDBAlertAPI.showMsg(ZDBI18NMap.f("zrpt.home.errmsg.js.del_db",ZDBEscapeUtil.encodeForHtml(c)),"ZDBYESNO",{ONCLICK:trashDataBase,DBID:a,CALLOUT:!0,SRCEL:b,PAREL:d})}function makeDBDefault(a,b){var c=jQuery("#ZDBListDatabases_Tbl"),d=!0,e=jQuery(b),f=encodeURIComponent(e.parent().siblings("a").html());e.attr("isdefaultDB")=="false"?e.css("width","20px").attr("isdefaultDB","true").attr("tip",ZDBI18NMap.g("zrpt.common.home.js.removedefaultdb")):(e.css("width","").attr("isdefaultDB","false").attr("tip",ZDBI18NMap.g("zrpt.common.home.js.makedefaultdb")),d=!1),ZDBToolTip.hide(),ZDBToolTip.show(b),c.find(".defaultDBIcon").not(b).attr("isdefaultDB","false").css("width","").attr("tip",ZDBI18NMap.g("zrpt.common.home.js.makedefaultdb")),AjaxAPI.sendRequest({URL:"/ZDBDatabaseActionMI.ma?ZDBACTION=ADDRDELDEFAULTDB",PARAMETERS:"&DBID="+a+"&DBNAME="+f+"&ISADDDEFAULTDB="+d,ISADDDEFAULTDB:d})}function trashDataBase(a,b){if(a==="NO"){var c=b.PAREL;c.isDialogOpen=!1,ZDBCreateDB.hideOptions(c);return}var d=b.DBID,e=ZDBGlobal.CTX+"/ZDBDatabaseActionMI.ma";AjaxAPI.sendRequest({URL:e,PARAMETERS:"ZDBACTION=MOVEDBTOTRASH&DBID="+d+"&FORWARDURL="+encodeURIComponent(ZDBGlobal.CTX+"/ZDBListDatabases.cc"),ONSUCCESSFUNC:ZDBListDB.updateList,OPSTATUSID:"DBAccessChange_"+d})}function renameDB(a,b){var c=$("ZDBNAME_"+a),d=ZDBUtil.getText(c),e="",f=$("ZDBDESC_"+a);f!=null&&(e=ZDBUtil.getText(f));if(!ZDBLazyLoadUtil.loadSnippet("RENAMEDB_DLG","/ZDBRenameDB.cc",this,"APPENDTODOC"))return;var g=$("ZDBRenameDBDetails");g.style.display="block";var h=$("ZDBDBNameTxtFld"),i=$("ZDBDBObjDescTxtFld");h.value=d,i.value=e;var j=$("ZDBLISTDBTD_"+a);j.isDialogOpen=!0,g.parEl=j,ZDBDialogUtil.showDialog(g,{TITLE:ZDBI18NMap.g("zrpt.common.home.js.renamedb"),ADDFRAME:!0,MODAL:!0,DONTREMOVE:!0,ONENTER:submitRenameDB,ORIGNAME:d,ORIGDESC:e,NAMEFLD:h,DESCFLD:i,DBID:a,CALLOUT:!0,SRCEL:b,ONCLOSE:ZDBCreateDB.removeHighlight}),$("ZDBDBRENAMEOPTSTATUS").className="mcLoaded",h.select()}function editConnections(a,b){var c=$("ZDBNAME_"+a),d=ZDBUtil.getText(c),e="",f=$("ZDBDESC_"+a);f!=null&&(e=ZDBUtil.getText(f));if(!ZDBLazyLoadUtil.loadSnippet("RENAMEDB_DLG","/ZDBEditConnections.cc",this,"APPENDTODOC"))return;var g=$("ZDBEditConnections");g.style.display="block";var h=$("ZDBDBNameTxtFld"),i=$("ZDBDBObjDescTxtFld");h.value=d,i.value=e;var j=$("ZDBLISTDBTD_"+a);j.isDialogOpen=!0,g.parEl=j,ZDBDialogUtil.showDialog(g,{TITLE:ZDBI18NMap.g("zrpt.common.home.js.renamedb"),ADDFRAME:!0,MODAL:!0,DONTREMOVE:!0,ONENTER:submitRenameDB,ORIGNAME:d,ORIGDESC:e,NAMEFLD:h,DESCFLD:i,DBID:a,CALLOUT:!0,SRCEL:b,ONCLOSE:ZDBCreateDB.removeHighlight}),$("ZDBDBRENAMEOPTSTATUS").className="mcLoaded",h.select()}function submitRenameDB(){var a=ZDBDialogUtil.focusDialog,b=a.params.ORIGNAME,c=a.params.ORIGDESC,d=a.params.NAMEFLD.value,e=a.params.DESCFLD.value,f=DOMUtils.getChildElsWithAttr(a,"elname","*");if(!validateFormElements(f,a))return;if(b==d&&c==e){ZDBDialogUtil.closeDialog();return}var g="EDITDBDETAILS";b==d&&(g="EDITDBDESC");var h=ZDBGlobal.CTX+"/ZDBDatabaseActionMI.ma?",i="&ZDBACTION="+g+"&DBNAME="+encodeURIComponent(d)+"&DESC="+encodeURIComponent(e)+"&DBID="+a.params.DBID;AjaxAPI.sendRequest({URL:h,PARAMETERS:i,ONSUCCESSFUNC:updateDBDetails,ONFAILUREFUNC:updateDBDetFailure,OPSTATUSID:"ZDBDBRENAMEOPTSTATUS",DBID:a.params.DBID})}function copyDB(a,b){if(!ZDBLazyLoadUtil.loadSnippet("COPYDB_DLG","/ZDBCopyDB.cc",this,"APPENDTODOC"))return;var c=ZDBUtil.getText($("ZDBNAME_"+a)),d="",e=$("ZDBDESC_"+a);e!=null&&(d=ZDBUtil.getText(e));var f=$("ZDBCopyDBDetails");f.style.display="block";var g=$("ZDBDBCPNameTxtFld"),h=$("ZDBDBCPObjDescTxtFld"),i=$("ZDBDBCPDataChkBox");i.checked=!0,g.value=c+ZDBI18NMap.g("zrpt.common.js.copy"),h.value=d;var j=$("ZDBLISTDBTD_"+a);j.isDialogOpen=!0,f.parEl=j,ZDBDialogUtil.showDialog(f,{TITLE:ZDBI18NMap.g("zrpt.homepage.db.copydb.js.dlgTtl"),ADDFRAME:!0,MODAL:!0,DONTREMOVE:!0,ONENTER:submitCopyDB,ORIGNAME:c,ORIGDESC:d,NAMEFLD:g,DESCFLD:h,DBID:a,COPYDATA:i,REDIRECTTONEWDB:"false",CALLOUT:!0,SRCEL:b,ONCLOSE:ZDBCreateDB.removeHighlight}),$("ZDBDBCOPYOPTSTATUS").className="mcLoaded",g.select()}function copyDBFromDB(a,b,c){if(!ZDBLazyLoadUtil.loadSnippet("COPYDB_DLG","/ZDBCopyDB.cc",this,"APPENDTODOC"))return;var d=$("ZDBCopyDBDetails");d.style.display="block";var e=$("ZDBDBCPNameTxtFld"),f=$("ZDBDBCPObjDescTxtFld"),g=$("ZDBDBCPDataChkBox");g.checked=!0,e.value=b+ZDBI18NMap.g("zrpt.common.js.copy"),f.value=c,ZDBDialogUtil.showDialog(d,{TITLE:ZDBI18NMap.g("zrpt.homepage.db.copydb.js.dlgTtl"),ADDFRAME:!0,MODAL:!0,DONTREMOVE:!0,ONENTER:submitCopyDB,ORIGNAME:b,ORIGDESC:c,NAMEFLD:e,DESCFLD:f,DBID:a,COPYDATA:g,REDIRECTTONEWDB:"true"}),$("ZDBDBCOPYOPTSTATUS").className="mcLoaded",e.select()}function submitCopyDB(){var a=ZDBDialogUtil.focusDialog,b=a.params.ORIGNAME,c=a.params.ORIGDESC,d=a.params.NAMEFLD.value.trim(),e=a.params.DESCFLD.value.trim(),f=a.params.COPYDATA,g=DOMUtils.getChildElsWithAttr(a,"elname","*");if(!validateFormElements(g,a))return;var h=ZDBGlobal.CTX+"/ZDBDatabaseActionMI.ma",i="ZDBACTION=COPYDATABASE&DBNAME="+encodeURIComponent(d)+"&DESCRIPTION="+encodeURIComponent(e)+"&DBTOCOPY="+a.params.DBID+"&FORWARDURL="+encodeURIComponent(ZDBGlobal.CTX+"/ZDBListDatabases.cc");f.checked==1?i+="&COPYDATA=true":i+="&COPYDATA=false",AjaxAPI.sendRequest({URL:h,PARAMETERS:i,ONSUCCESSFUNC:"hanCopyDBSucess",OPSTATUSID:"ZDBDBCOPYOPTSTATUS",DBID:a.params.DBID,REDIRECTTONEWDB:a.params.REDIRECTTONEWDB})}function hanCopyDBSucess(a,b){var c=b.REDIRECTTONEWDB,d=a.getResponseParams();ZDBDialogUtil.closeDialog();if(c=="true"){var e=ZDBGlobal.CTX+ZDBGlobal.REPORTS_CONTEXT_NAME+"/ZDBDataSheetView.cc?DBID="+d.NEWDBID;window.location.href=e}else ZDBListDB.updateList()}function adminTakeOverFromExp(a){ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.js.admintakeover.msg"),"ZDBYESNO",{ONCLICK:confirmAdminTakeOver,DBID:a},ZDBI18NMap.g("zrpt.common.js.admintakeover.title"))}function confirmAdminTakeOver(a,b){if(a!="YES")return;var c="&DBTOCOPY="+b.DBID;AjaxAPI.sendRequest({URL:"/ZDBAdminActionMI.ma?ZDBACTION=ADMINTAKEOVERFROMEXP"+c,METHOD:"POST",ONSUCCESSFUNC:handleAdminTakeOverSchSuccess,OPSTATUSID:"ZDBMainLoader"})}function handleAdminTakeOverSchSuccess(a,b){ZDBDialogUtil.closeDialog(),ZDBMsgBox.showSuccess(a.responseText)}function updateDBDetails(a,b){var c=b.DBID,d=a.getResponseParams();if(ZDBClientUI.dbId)ZDBNavigation.updateDBDetails(d);else{$("ZDBNAME_"+c).innerHTML=ZDBEscapeUtil.escSplCharAsHTMLWithSpaceEncode(d.DBNAME);var e=$("ZDBDESC_"+c);if(e!=null)e.innerHTML=ZDBEscapeUtil.encodeForHtml(d.DESC);else if(d["DESC"]!=""){var f='<p class="dbDescription" id="ZDBDESC_'+c+'">'+ZDBEscapeUtil.encodeForHtml(d.DESC)+"</p>",g=jQuery("#ZDBNAME_"+c).parent("div");jQuery(f).insertAfter(g)}}ZDBDialogUtil.closeDialog()}function updateDBDetFailure(a,b){var c=a.getResponsePart("ERRORCODE");c=trimAll(c);if(c=="META_DBNAME_DUPLICATE"){var d=ZDBDialogUtil.focusDialog;showCustomMessage(a.getResponsePart("STATUS_MESSAGE"),d.params.NAMEFLD),d.params.NAMEFLD.select()}else ZDBDialogUtil.closeDialog(),AjaxAPI.onFailureFunc(a,b)}function submitCreateDB(a){if(!ZDBLazyLoadUtil.loadJsAlone(["ZDBGridList","import/js/ZDBImport.js"],"APPENDTODOC",submitCreateDB,[a]))return!1;if(!ZDBLazyLoadUtil.loadCssOnly("CSSLIST_GRIDSTYLES","APPENDTODOC",submitCreateDB,[a]))return!1;var b=$("ZDBOPTIONINP").value;if(b=="inhousedb")return ZDBDBConnection.showLocDBsAndTBsList(a),!1;if(b=="cloud")return submitCloudDB(a),!1;if(b=="remote")return RDBPage.getDatabases(),!1;hideCustomMessage();if(b=="import"){a.setAttribute("useiframe","true"),a.action=a.getAttribute("actionurl");var c=$("ZDBFILETYPE").value,d=$("ZDBWEBOPT").checked;d&&showHideUrlParamDiv(!1);if($("ZDBFTPOPT")!=null)var e=$("ZDBFTPOPT").checked;var f=$("ZDBPASTEOPT").checked,g=$("ZDBFILEOPT").checked,h=["CSV","XLS","HTML","JSON","XML"],i=h.indexOf(c)>-1;d&&c!="GSHEET"&&c!="ZDOCS"&&!ZDBImport.isExternalFile(c)&&(a.URL.value=a.URL.value=="Type your URL"?"":a.URL.value);if(g&&i){a.ZDBFILENAME.value=a.FILENAME.value;if(!ZDBImport.isValidFileExtension(a.FILENAME.value))return alert(ZDBI18NMap.g("zrpt.common.browser.alert.js.unsupportedImportFileFormat")),f=!0,locationSelected("PASTEDATA"),!1}else if(f&&i)c=="XLS"&&(c="CSV"),a.ZDBFILENAME.value=" the data you have pasted";else if(d&&i)a.ZDBFILENAME.value=a.URL.value;else if(e&&i){var j="ftp";a.isFTPs&&(j+="s"),a.ZDBFILENAME.value=j+"://"+a.FTPHOST.value+"/"+a.FTPPATH.value}a.reloadCount=0}else{var k={template:"CREATEDBFROMTEMPLATE",scratch:"CREATEDBFROMSCRATCH",remote:"CREATEREMOTECONNECTION",remotedb:"CREATEDBFROMREMOTE",enterdata:"CREATEDBFROMENTERDATA"},l=k[b]?k[b]:"CREATEDB";b=="template"&&(a.COPYDATA.value=a.CDBDATA.checked==1?"true":"false"),a.action="/ZDBDatabaseActionMI.ma?ZDBACTION="+encodeURIComponent(l),a.setAttribute("useiframe","false"),a.removeAttribute("enctype")}return ZDBImport.setEncoding(a,"import"),AjaxAPI.submit(a),!1}function submitCloudDB(a){var b=a.FILETYPE.value;return a.setAttribute("useiframe","true"),a.action=a.getAttribute("actionurl"),a.DOCNAME.value=a.ZDBExtIntInput.value,a.reloadCount=0,a.encoding="application/x-www-form-urlencoded",a.action=a.action+"&LOCATION=WEB",AjaxAPI.submit(a),!1}function hideURLTip(a){a.getAttribute("tipShown")=="true"&&(a.value="",a.setAttribute("tipShown","false"),a.style.color="black",a.style.fontStyle="normal",a.style.fontSize="12px")}function showURLTip(a){if(a.value==""&&a.getAttribute("tipShown")=="false"){var b=a.getAttribute("tipValue");a.value=b!=null?b:ZDBI18NMap.g("zrpt.common.js.search"),a.setAttribute("tipShown","true"),a.style.color="grey",a.style.fontStyle="italic",a.style.fontSize="11px"}}function closeCreateConnectionDialog(){alert("Connection Created successfully. You can use it to create a new remote database."),ZDBFullPageDialog.closeDialog()}function handleErrorDuringImportAdwordsData(a,b){showImpErrorMsg(a,b,"adwordsclientlistform",!1)}function handleErrorDuringExistImport(a,b){showImpErrorMsg(a,b,"ZDBEXCreateFrm",!1)}function showImpErrorMsg(a,b,c,d){var e=a.getResponsePart("ERRORCODE"),f=a.getResponsePart("STATUS_MESSAGE");e=trimAll(e);if(e!=null)if(c=="ZDBEXCreateFrm"&&e=="IMPORT_FK_CONSTRAINT_WARNING"){var g=$("importExTableName").innerHTML,h=ZDBUtil.replaceAll(f,"\n","").split(","),i=ZDBI18NMap.f("zrpt.toolbar.import.js.import_warning",g);if(h[0].trim()=="true"){i+=ZDBI18NMap.f("zrpt.toolbar.import.js.delcascadealert");var j="",k=f.substring(f.indexOf("[")+1,f.indexOf("]")),l=k.split(",");for(var m=0;m<l.length;m++)j+="<li>"+l[m]+"</li>";i+="<ul>"+j+"</ul>"}if(h[1].trim()=="true"){i+=ZDBI18NMap.f("zrpt.toolbar.import.js.setemptyalert");var n="";k=f.substring(f.lastIndexOf("[")+1,f.lastIndexOf("]"));var o=k.split(",");for(var m=0;m<o.length;m++)n+="<li>"+o[m]+"</li>";i+="<ul>"+n+"</ul>"}i+=ZDBI18NMap.f("zrpt.toolbar.import.js.truncateaddconfirm"),ZDBAlertAPI.showMsg(i,"ZDBYESNO",{ONCLICK:this.confirmImport})}else if(e=="GOOGLE_AUTH_REQUIRED"||e=="GSHEETS_NOT_FOUND"||e=="GSHEETS_NOAUTH_HEADER_INFO"){var p;c=="ZDBCreateFrm"?p="createdb":c=="ZDBEXCreateFrm"&&(p="existimport"),ZDBGoogleInteg.authGUser(e,f,p)}else{if(e=="IMPORT_UNAUTHORIZED_ACCESS_ERROR"){if(c=="ZDBEXCreateFrm"){var q=$("ZDBFTPOPT");q==null&&(q=$("ZDBEXFTPOPT"));var r=q!=null?q.checked:!1;r?showCustomMessage(ZDBI18NMap.g("zrpt.common.import.url.js.unauthorized_access_errmsg"),$("ZDBEXCreateFrm").FTPPASSWORD):(showAUTHURLInp(!0,"existImport"),showCustomMessage(ZDBI18NMap.g("zrpt.common.import.url.js.unauthorized_access_errmsg"),$("ZDBEXCreateFrm").PASSWORD))}else{var q=$("ZDBFTPOPT");q==null&&(q=$("ZDBEXFTPOPT"));var r=q!=null?q.checked:!1;r?showCustomMessage(ZDBI18NMap.g("zrpt.common.import.url.js.unauthorized_access_errmsg"),$("ZDBCreateFrm").FTPPASSWORD):(showAUTHURLInp(!0),showCustomMessage(ZDBI18NMap.g("zrpt.common.import.url.js.unauthorized_access_errmsg"),$("ZDBCreateFrm").PASSWORD))}return}if(e=="IMPORT_INVALID_CREDENTIAL_ERROR"){if(c=="ZDBEXCreateFrm"){var q=$("ZDBFTPOPT");q==null&&(q=$("ZDBEXFTPOPT"));var r=q!=null?q.checked:!1;r?showCustomMessage(ZDBI18NMap.g("zrpt.common.import.url.js.invalid_credential_errmsg"),$("ZDBEXCreateFrm").FTPPASSWORD):(showAUTHURLInp(!0,"existImport"),showCustomMessage(ZDBI18NMap.g("zrpt.common.import.url.js.invalid_credential_errmsg"),$("ZDBEXCreateFrm").PASSWORD))}else{var q=$("ZDBFTPOPT");q==null&&(q=$("ZDBEXFTPOPT"));var r=q!=null?q.checked:!1;r?showCustomMessage(ZDBI18NMap.g("zrpt.common.import.url.js.invalid_credential_errmsg"),$("ZDBCreateFrm").FTPPASSWORD):(showAUTHURLInp(!0),showCustomMessage(ZDBI18NMap.g("zrpt.common.import.url.js.invalid_credential_errmsg"),$("ZDBCreateFrm").PASSWORD))}return}if(e=="UNABLE_TO_GET_FILE"){showCustomMessage(f,$(c).FTPPATH);return}if(e=="UNABLE_TO_CONNECT_TO_THE_SPECIFIED_PORT"){showCustomMessage(f,$(c).FTPPORT);return}if(e=="IMPORT_URL_COMMUNICATION_FAILURE"){var q=$("ZDBFTPOPT");q==null&&(q=$("ZDBEXFTPOPT"));var r=q!=null?q.checked:!1;r?c=="ZDBEXCreateFrm"?showCustomMessage(f,$("ZDBEXCreateFrm").FTPHOST):showCustomMessage(f,$("ZDBCreateFrm").FTPHOST):c=="ZDBEXCreateFrm"?showCustomMessage(f,$("ZDBEXCreateFrm").ZDBInputURL):showCustomMessage(f,$("ZDBCreateFrm").ZDBInputURL)}else{var s=DOMUtils.getChildElsWithAttr($(c),"errorcodeprefix","*");for(var m=0,t=s.length;m<t;m++)if(e.indexOf(s[m].getAttribute("errorcodeprefix"))==0){var u=a.getResponsePart("STATUS_MESSAGE");if("IMPORT_FILE_EXCEEDS_SIZE_LOCAL"==e){var v=$("ZDBCSVUPLOADERLINK").innerHTML;u=u.replace("our Upload Tool",v)}showCustomMessage(u,s[m],null);return}if("META_DBOBJECT_NAME_DUPLICATED"==e&&d){showCustomMessage(a.getResponsePart("STATUS_MESSAGE"),$("ZDBCreateFrm").TABLENAME);return}if("EXISTIMPORT_INVALID_FILESELECTION"==e){showCustomMessage(a.getResponsePart("STATUS_MESSAGE"),$("ZDBEXCreateFrm").FILETYPE);return}AjaxAPI.onFailureFunc
(a,b)}}}function showHideReset(){var a=!1,b=jQuery($("URLPARAMS")).children();for(var c=0;c<b.length;c++){var d=jQuery($("URLPARAMS")).find("#ZRURLPARAMNAME")[c].value,e=jQuery($("URLPARAMS")).find("#ZRURLPARAMVALUE")[c].value;if(d!=""||e!=""){a=!0;break}}a==1?($("RESETPARAMS").style.display="table-caption",$("PARAMRESETDIV").style.paddingBottom="0px"):($("RESETPARAMS").style.display="none",$("PARAMRESETDIV").style.paddingBottom="15px")}function showHideUrlParamDiv(a){var b=$("URLINFO"),c=b.style.display,d=c=="block"||a==0||a===null?"none":"block";b.style.display=d,changeParamCount();var e=$("ADDPARAMLINK");d=="block"&&jQuery($("URLPARAMS")).children().size()==0&&addUrlParamDiv();if(d=="block")jQuery(e).find("[elname='moreRLessIcon']").removeClass("ZRSMoreIcon").addClass("ZRSLessIcon"),$("PARAMCOUNT").style.display="none",showHideReset();else{var f=jQuery($("URLPARAMS")).children();for(var g=0,h=0;g<f.length;g++,h++)if(!jQuery($("URLPARAMS")).find("#ZRURLPARAMNAME")[h].value.trim().length||!jQuery($("URLPARAMS")).find("#ZRURLPARAMVALUE")[h].value.trim().length){var i=f[g];jQuery(i).remove(),h-=1}changeParamCount(),jQuery(e).find("[elname='moreRLessIcon']").removeClass("ZRSLessIcon").addClass("ZRSMoreIcon")}}function addUrlParamDiv(){var a=$("PARAMS").cloneNode(!0);if(jQuery($("URLPARAMS")).children().size()>=20){alert(ZDBI18NMap.g("zrpt.common.url.js.alertonparamcount"));return}a.style.display="block",a.querySelectorAll('[id="ZRURLPARAMNAME"]')[0].name="URLPARAMNAME",a.querySelectorAll('[id="ZRURLPARAMVALUE"]')[0].name="URLPARAMVALUE",a.querySelectorAll('[id="ZRURLPARAMTYPE"]')[0].name="URLPARAMTYPE",$("URLPARAMS").appendChild(a),showHideReset()}function removeUrlParamDiv(a){jQuery($("URLPARAMS")).children().size()>1?(jQuery(a).parent().remove(),showHideReset()):(jQuery($("URLPARAMS")).empty(),changeParamCount(),showHideUrlParamDiv())}function changeParamCount(){$("PARAMCOUNT").style.display="table-cell",jQuery($("URLPARAMS")).children().size()==1?$("PARAMCOUNT").innerHTML="("+jQuery($("URLPARAMS")).children().size()+" "+ZDBI18NMap.g("zrpt.common.url.js.singleparamspecified")+")":jQuery($("URLPARAMS")).children().size()>1?$("PARAMCOUNT").innerHTML="("+jQuery($("URLPARAMS")).children().size()+" "+ZDBI18NMap.g("zrpt.common.url.js.moreparamspecified")+")":$("PARAMCOUNT").style.display="none"}function resetUrlParam(){jQuery("#URLPARAMS input").attr("value",""),showHideReset()}function confirmImport(a){if(a!="YES")return;$("URLPARAMALERT").innerHTML="false",ZDBImport.submitExistImportForm($("ZDBEXCreateFrm"),null,!1)}function handleErrorDuringCreateDB(a,b){showImpErrorMsg(a,b,"ZDBCreateFrm",!0)}function handleExistImport(a,b){window.curStep=window.curStep+1,$("zdbExImportTableTitle").innerHTML=ZDBI18NMap.f("zrpt.toolbar.import.js.sametable",window.curStep,window.totStep);var c=a.getResponseParams();c["DBID"]!=null?showDataSheet(a,b):($("ZDBCREATEDBOPTSTATUS").className="mcLoaded",uploadFile(a,b,"existImport")),a.invokeScripts()}function addJoinDiv(a){ZDBCreateDB.count=0;if(jQuery("#EnclosingDiv").find(".disableJoinIconNew").length>0){setTimeout(ZDBCreateDB.blink,80),ZDBCreateDB.count=0;return}var b=jQuery("#JoinTemplateDIV").clone();b.find("#ENCDIV")[0].className="ENCDIV",b.find("#LEFTLABEL")[0].style.display="none",b.find("#RIGHTLABEL")[0].style.display="none",b.find("#JOINDIV")[0].className="disableJoinIconNew marginTop14",b.find("#JOINDIV")[0].setAttribute("blocked","true"),b.find("#LEFTCOLHEAD").css("display","block"),b.find("#RIGHTCOLHEAD").css("display","block"),jQuery("#ZDBImportFileWithRelation").find("#COLUMNLISTDROPDOWN")[0].style.top="42px",jQuery(b).find(".inlinePropComboSel")[0].style.background="white",jQuery(b).find(".inlinePropComboSel")[0].style.border="1px solid #7fbbee",jQuery(b).find(".inlinePropComboSel")[0].style.boxShadow="0 0 5px #a8d3f5",jQuery("#ZDBImportFileWithRelation").find("#FKCOLDROPDOWN")[0].style.top="42px",jQuery(b).find(".inlinePropComboSel")[1].style.background="white",jQuery(b).find("#REMOVEJOIN")[0].style.marginTop="14px",b.attr("id","JOINLIST"),b.css("display","block"),b.insertBefore("#ADDJOINLINK"),hideDropdown("click"),jQuery("#EnclosingDiv").scrollTop(jQuery("#ADDJOINLINK").offset().top)}function showRelations(a){$("ZDBImportFileWithRelation")!=null&&$("ZDBImportFileWithRelation").parentNode.removeChild($("ZDBImportFileWithRelation"));var b="",c=document.createElement("div");c.id="ZDB"+b+"ImportFileWithRelation",c.style.left=jQuery("#ZDBCREATEDIALOG").width()+"px",c.style.top=parseInt(jQuery("#ZDBMAINEL").position().top)+parseInt(jQuery("#ZDBTABTPL").height())+parseInt(1)+"px",c.style.width="947px",c.style.marginRight="25px",c.style.float="left",c.style.tabindex="-1",ev.addEscHandle(ZDBCreateDB.showprevformonEsc),jQuery(c).append($("IM_JOIN_TABLES").innerHTML);var d=document.createElement("div");d.setAttribute("id","EnclosingDiv"),d.style.borderRight="1px inset rgb(204, 204, 204)",d.style.float="left",jQuery(c).append(d);var e=ZDBUtil.getCachedRef(ZDBImport,"ADDJOIN").cloneNode(!0);e.style.display="block",e.setAttribute("id","ADDJOINLINK");var f=$("HELPTEXT").cloneNode(!0);f.setAttribute("id","HELPTEXTV"),jQuery(jQuery(f).find("#ZRSVideoDemoHelp")).css("display","none"),jQuery(jQuery(f).find("#ZRSSnapShotTour")).css("display","none"),f.style.display="block";var g=ZDBUtil.getCachedRef(ZDBImport,"RELATION").cloneNode(!0);g.style.display="block",g.querySelectorAll("#CreateWithLookupLink")[0].setAttribute("id","ZDBImportTableCreateWithLookupLink"),g.querySelectorAll("#LOADINGDIV")[0].setAttribute("id","ZDBIMPORTWITHLOOKUPOPSTATUS"),g.querySelectorAll("#LOADINGDIVLABEL")[0].setAttribute("id","ZDBIMPORTWITHLOOKUPOPSTATUSLABEL"),jQuery(c).append(f),jQuery(c).append(g);var h=jQuery(document.createElement("div")),i=jQuery(c);i.attr("class","relatetabledialog"),h.attr("class","freezeLayer"),h.attr("ID","IMPORTFREEZE"),h.css("top",parseInt(jQuery("#ZDBMAINEL").position().top)+parseInt(1)+"px"),h.css("z-index",jQuery(c).attr("z-index")),jQuery(document.body).append(h),jQuery(document.body).append(c);var j=JSON.parse(a.responseText),k=ZDBUtil.getCachedRef(ZDBImport,"JoinTemplate").cloneNode(!0);k.setAttribute("id","JoinTemplateDIV"),jQuery(c.querySelectorAll("div#COLUMNLISTDROPDOWN1")[0]).attr("id","COLUMNLISTDROPDOWN"),jQuery(c.querySelectorAll("div#COLtemplate")[0]).append(j.NEWCOLSCOMBO[0]),jQuery(c.querySelectorAll("div#FKCOLDROPDOWN1")[0]).attr("id","FKCOLDROPDOWN"),jQuery(c.querySelectorAll("div#FKtemplate")[0]).html(j.FKCOMBO[0]),jQuery(c).append(k);if(j.IDENTIFIEDJOINS)for(var l=0;l<j.IDENTIFIEDJOINS.length;l++){var g=k.cloneNode(!0);g.setAttribute("id","JOINLIST"),g.style.display="block",g.querySelectorAll("#COLUMNLIST")[0].setAttribute("value",j.IDENTIFIEDJOINS[l][0]),selectColumnValue(g.querySelectorAll("#COLUMNLIST")[0],j.IDENTIFIEDJOINS[l][0]),g.querySelectorAll("#FKCol")[0].setAttribute("value",j.IDENTIFIEDJOINS[l][1]),selectColumnValue(g.querySelectorAll("#FKCol")[0],j.IDENTIFIEDJOINS[l][1]),ZDBUtil.getCachedRef(ZDBImport,"EnclosingDiv").appendChild(g),jQuery("#EnclosingDiv").append(g)}jQuery("#EnclosingDiv").append(e),$("EnclosingDiv").style.width="655px",$("EnclosingDiv").style.height="285px",$("EnclosingDiv").style.overflow="auto",$("EnclosingDiv").style.marginBottom="30px",j.IDENTIFIEDJOINS.length==0?(addJoinDiv(),jQuery("#ZDBImportFileWithRelation").find("zdbImportTableDesc")[0]!=undefined&&(jQuery("#ZDBImportFileWithRelation").find("zdbImportTableDesc")[0].innerHTML=ZDBI18NMap.g("zrpt.home.import.js.customJoinTablesDesc"))):jQuery("#ZDBImportFileWithRelation").find("zdbImportTableDesc")[0]!=undefined&&(jQuery("#ZDBImportFileWithRelation").find("zdbImportTableDesc")[0].innerHTML=ZDBI18NMap.g("zrpt.home.import.js.joinTablesDesc"));var m=document.body.offsetWidth-parseInt($("ZDBImportFileWithRelation").offsetWidth);i.animate({left:m+"px"}).show().focus(),j.IDENTIFIEDJOINS.length==0?jQuery("#ZDBImportFileWithRelation").find("#zdbImportTableDesc")[0]!=undefined&&(jQuery("#ZDBImportFileWithRelation").find("#zdbImportTableDesc")[0].innerHTML=ZDBI18NMap.g("zrpt.home.import.js.customJoinTablesDesc")):jQuery("#ZDBImportFileWithRelation").find("#zdbImportTableDesc")[0]!=undefined&&(jQuery("#ZDBImportFileWithRelation").find("#zdbImportTableDesc")[0].innerHTML=ZDBI18NMap.g("zrpt.home.import.js.joinTablesDesc")),window.joinFrm=$("EnclosingDiv").cloneNode(!0)}function selectColumnValue(a,b){if(a.id=="FKCol"){var c=jQuery("#ZDBImportFileWithRelation").find("#FKCOLDROPDOWN")[0].querySelectorAll(".RefFilterList");for(i=0;i<c.length;i++)c[i].getAttribute("FkValue")==b&&(a.setAttribute("subtype",c[i].getAttribute("subtype")),a.setAttribute("colID",c[i].getAttribute("FkValue")),a.setAttribute("value",c[i].getAttribute("FkValue")),c[i].parentNode.querySelectorAll(".RefTblName")[0]!=undefined?a.innerHTML=c[i].parentNode.querySelectorAll(".RefTblName")[0].innerHTML+"."+c[i].innerHTML:a.innerHTML=c[i].innerHTML)}else{var c=jQuery("#ZDBImportFileWithRelation").find("#COLUMNLISTDROPDOWN")[0].querySelectorAll(".RefFilterList");for(i=0;i<c.length;i++)c[i].getAttribute("value")==b&&(a.setAttribute("subtype",c[i].getAttribute("subtype")),a.setAttribute("colID",c[i].getAttribute("value")),a.setAttribute("value",c[i].getAttribute("value")),c[i].parentNode.querySelectorAll(".RefTblName")[0]!=undefined?a.innerHTML=c[i].parentNode.querySelectorAll(".RefTblName")[0].innerHTML+"."+c[i].innerHTML:a.innerHTML=c[i].innerHTML)}}function clearColSearch(a){var b="",c=!1,d=a.parentNode.parentNode.parentNode.querySelectorAll(".RefFilterList");for(i=0;i<d.length;i++)d[i].parentNode.style.display="block";for(i=0;i<d.length;i++)d[i].innerHTML.toUpperCase().indexOf(b.toUpperCase())!=-1?(d[i].style.display="block",d[i].parentNode.style.display="block",c=!0):d[i].style.display="none";if(a.id!="COLUMNLISTCOLSEARCH")for(i=0;i<d.length;i++)jQuery(d[i].parentNode).find("li:visible").length<=1&&(d[i].parentNode.style.display="none");c?jQuery(a.parentNode.parentNode).find(".widgetFieldSearch")[0].style.display="none":jQuery(a.parentNode.parentNode).find(".widgetFieldSearch")[0].style.display="block"}function searchColName(a){var b=a.value=="Search Columns"?"":a.value,c=!1,d=a.parentNode.parentNode.parentNode.querySelectorAll(".RefFilterList"),e=a.parentNode.parentNode.parentNode.querySelectorAll(".refColUi");for(i=0;i<e.length;i++)e[i].style.display="none";for(i=0;i<d.length;i++)d[i].innerHTML.toUpperCase().indexOf(b.toUpperCase())!=-1?(d[i].style.display="block",d[i].parentNode.style.display="block",c=!0):d[i].style.display="none";if(a.id!="COLUMNLISTCOLSEARCH")for(i=0;i<d.length;i++)jQuery(d[i].parentNode).find("li:visible").length<=1&&(d[i].parentNode.style.display="none");c?jQuery(a.parentNode.parentNode).find(".widgetFieldSearch")[0].style.display="none":jQuery(a.parentNode.parentNode).find(".widgetFieldSearch")[0].style.display="block"}function changeColumn(a){var b=jQuery("[elname='CurrentParent']").parents().find("#ENCDIV")[0];jQuery("[elname='CurrentParent']")[0].querySelectorAll("#COLUMNLIST").length>0?(jQuery("[elname='CurrentParent']")[0].querySelectorAll("#COLUMNLIST")[0].innerHTML=a.innerHTML,jQuery("[elname='CurrentParent']")[0].querySelectorAll("#COLUMNLIST")[0].setAttribute("value",a.getAttribute("value")),jQuery("[elname='CurrentParent']")[0].querySelectorAll("#COLUMNLIST")[0].setAttribute("subtype",a.getAttribute("subtype"))):(jQuery("[elname='CurrentParent']")[0].querySelectorAll("#FKCol")[0].innerHTML=a.parentNode.querySelectorAll(".RefTblName")[0].innerHTML+"."+a.innerHTML,jQuery("[elname='CurrentParent']")[0].querySelectorAll("#FKCol")[0].setAttribute("colID",a.getAttribute("FkValue")),jQuery("[elname='CurrentParent']")[0].querySelectorAll("#FKCol")[0].setAttribute("value",a.getAttribute("FkValue")),jQuery("[elname='CurrentParent']")[0].querySelectorAll("#FKCol")[0].setAttribute("subtype",a.getAttribute("subtype"))),jQuery("[elname='CurrentParent']").removeAttr("elname"),$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN")[0].style.display="none",$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN")[0].style.display="none",validateCurrJoin(b)}function showDropDown(a,b){jQuery("[elname='CurrentParent']").removeAttr("elname"),a.style.border="0px solid #d0d0d0",a.style.boxShadow="none";if(a.querySelectorAll("#FKCol").length>0)if($("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN")[0].style.display=="none"){a.setAttribute("elname","CurrentParent"),hideDropdown("click"),$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN")[0].style.display="block";var c=$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLCOLSEARCH")[0];$("FKCOLDROPDOWN").style.top=parseInt(jQuery(a).offsetParent().position().top)+parseInt(jQuery(a).offsetParent().height())+"px",$("FKCOLDROPDOWN").style.left=parseInt(jQuery(a).offsetParent().position().left)+"px",$(c).setAttribute("tipshown","false"),$(c).value="",ZDBSearchUtil.handleBlur($(c)),searchColName(c);var d=!1;hideQuerytable($("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN")[0].querySelectorAll(".divLink")[0]);var e=$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN")[0].querySelectorAll(".RefFilterList"),f=jQuery(a).find("#FKCol").attr("value"),g=jQuery("#FKCOLDROPDOWN").scrollTop();jQuery(jQuery("#FKCOLDROPDOWN").find("#FKtemplate")[0]).scrollTop(0);for(i=0;i<e.length;i++)f==e[i].getAttribute("FkValue")?(g=jQuery(e[i]).position().top,$(e[i]).className=$(e[i]).className.replace("RefFilterList_hover",""),$(e[i]).className=$(e[i]).className+" RefFilterList_hover",e[i].parentNode.parentNode.getAttribute("id").lastIndexOf("QUERYLIST")!=-1&&(d=!0)):$(e[i]).className=$(e[i]).className.replace("RefFilterList_hover","");d&&showQuerytable($("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN")[0].querySelectorAll(".divLink")[0],"click"),jQuery(jQuery("#FKCOLDROPDOWN").find("#FKtemplate")[0]).scrollTop(g-parseInt(100)),jQuery(document.body).click(function(a){var b=jQuery(a.target);b==undefined&&(b=$("EnclosingDiv"));if(b.attr("class")!="RefFilterTbl refListExpand"&&b.attr("class")!="rankingsearchForm_clone"&&b.attr("class")!="fieldsSearchEl"&&b.attr("id")!="ZDBSearchButton"){if($("EnclosingDiv")!=undefined){var c=$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none");var c=$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none")}jQuery(document.body).unbind("click")}jQuery("[elname='CurrentParent']").removeAttr("elname")}),jQuery("#ZDBImportFileWithRelation").keyup(function(a){if(a.keyCode==27){var b=jQuery(a.target);b==undefined&&(b=$("EnclosingDiv"));if(b.attr("class")!="RefFilterTbl refListExpand"&&b.attr("class")!="rankingsearchForm_clone"&&b.attr("class")!="fieldsSearchEl"&&b.attr("id")!="ZDBSearchButton"){if($("EnclosingDiv")!=undefined){var c=$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none");var c=$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none")}jQuery(document.body).unbind("keyup")}ZDBUtil.stopEventBubble(a)}jQuery("[elname='CurrentParent']").removeAttr("elname")}),ZDBUtil.stopEventBubble(b),jQuery("#ZDBImportFileWithRelation").focus(),jQuery("#EnclosingDiv").bind("scroll",function(a){hideDropdown(a),jQuery("#EnclosingDiv").unbind("scroll")}),jQuery(c).focus();var h=$(c).getAttribute("tipValue"),j=h!=null?h:ZDBI18NMap.g("zrpt.common.js.search");$(c).setAttribute("tipShown","true"),$(c).className="tipTextColor",jQuery($(c)).css("color","#888").attr("value",j),$(c).selectionStart=$(c).selectionEnd=0}else $("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN")[0].style.display="none";else if($("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN")[0].style.display=="none"){a.setAttribute("elname","CurrentParent"),hideDropdown("click"),$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN")[0].style.display="block";var c=$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTCOLSEARCH")[0];$("COLUMNLISTDROPDOWN").style.top=parseInt(jQuery(a).offsetParent().position().top)+parseInt(jQuery(a).offsetParent().height())+"px",$("COLUMNLISTDROPDOWN").style.left=parseInt(jQuery(a).offsetParent().position().left)+"px",$(c).setAttribute("tipshown","false"),$(c).value="",ZDBSearchUtil.handleBlur($(c)),searchColName(c);var e=$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN")[0].querySelectorAll(".RefFilterList"),f=jQuery(a).find("#COLUMNLIST").attr("value"),g=jQuery("#COLUMNLISTDROPDOWN").scrollTop();jQuery(jQuery("#COLUMNLISTDROPDOWN").find("#COLtemplate")[0]).scrollTop(0);for(i=0;i<e.length;i++)f==e[i].getAttribute("value")?(g=jQuery(e[i]).position().top,$(e[i]).className=$(e[i]).className.replace("RefFilterList_hover",""),$(e[i]).className=$(e[i]).className+" RefFilterList_hover"):$(e[i]).className=$(e[i]).className.replace("RefFilterList_hover","");jQuery(jQuery("#COLUMNLISTDROPDOWN").find("#COLtemplate")[0]).scrollTop(g-parseInt(100)),jQuery(document.body).click(function(a){var b=jQuery(a.target);b==undefined&&(b=$("EnclosingDiv"));if(b.attr("class")!="RefFilterTbl refListExpand"&&b.attr("class")!="rankingsearchForm_clone"&&b.attr("class")!="fieldsSearchEl"&&b.attr("id")!="ZDBSearchButton"){if($("EnclosingDiv")!=undefined){var c=$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none");var c=$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none")}jQuery(document.body).unbind("click")}jQuery("[elname='CurrentParent']").removeAttr("elname")}),jQuery("#ZDBImportFileWithRelation").keyup(function(a){if(a.keyCode==27){var b=jQuery(a.target);b==undefined&&(b=$("EnclosingDiv"));if(b.attr("class")!="RefFilterTbl refListExpand"&&b.attr("class")!="rankingsearchForm_clone"&&b.attr("class")!="fieldsSearchEl"&&b.attr("id")!="ZDBSearchButton"){if($("EnclosingDiv")!=undefined){var c=$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none");var c=$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none")}jQuery(document.body).unbind("keyup")}ZDBUtil.stopEventBubble(a)}jQuery("[elname='CurrentParent']").removeAttr("elname")}),jQuery("#ZDBImportFileWithRelation").focus(),ZDBUtil.stopEventBubble(b),jQuery("#EnclosingDiv").bind("scroll",function(a){hideDropdown(a),jQuery("#EnclosingDiv").unbind("scroll")}),jQuery(c).focus();var h=$(c).getAttribute("tipValue"),j=h!=null?h:ZDBI18NMap.g("zrpt.common.js.search");$(c).setAttribute("tipShown","true"),$(c).className="tipTextColor",jQuery($(c)).css("color","#888").attr("value",j),$(c).selectionStart=$(c).selectionEnd=0}else $("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN")[0].style.display="none"}function hideDropdown(a){var b=jQuery(a.target);b==undefined&&(b=$("EnclosingDiv"));if(b.attr("class")!="RefFilterTbl refListExpand"&&b.attr("class")!="rankingsearchForm_clone"&&b.attr("class")!="fieldsSearchEl"&&b.attr("id")!="ZDBSearchButton"){var c=$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none");var c=$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN");for(i=0;i<c.length;i++)c[i].style.display!="none"&&(c[i].style.display="none");ZDBUtil.stopEventBubble(a)}ZDBToolTip.hide()}function validateCurrJoin(a,b){jQuery(a).find("#JOINDIV")[0].setAttribute("isError","false"),jQuery(a).find("#JOINDIV")[0].setAttribute("blocked","false"),jQuery(a).find("#JOINDIV")[0].setAttribute("errorMsg","");var c=jQuery(a).find("#COLUMNLIST")[0],d=jQuery(a).find("#FKCol")[0],e=[];c.parentNode.parentNode.style.border="0px solid #d0d0d0",c.parentNode.parentNode.style.boxShadow="none",d.parentNode.parentNode.style.border="0px solid #d0d0d0";var f=jQuery(a).find("#JOINDIV")[0].className.indexOf("left")!=-1?d.getAttribute("subtype"):c.getAttribute("subtype"),g=jQuery(a).find("#JOINDIV")[0].className.indexOf("left")!=-1?c.getAttribute("subtype"):d.getAttribute("subtype"),h=!0,j=canbeJoined(f,g);j?(jQuery(a).find("#JOINDIV")[0].className=="errorOnJoinIcon"&&(jQuery(a).find("#JOINDIV")[0].className="rightJoinIconNew",jQuery(a).find("#RIGHTLABEL")[0].innerHTML.indexOf("Parent")!=-1?jQuery(a).find("#JOINDIV")[0].className="rightJoinIconNew":jQuery(a).find("#JOINDIV")[0].className="leftJoinIconNew"),jQuery(a).find("#LEFTLABEL")[0].style.visibility="visible",jQuery(a).find("#RIGHTLABEL")[0].style.visibility="visible",a.className!="ENCDIV"&&jQuery(a).find("#JOINDIV")[0].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.swaprelationtip"))):(f!=""&&g!=""&&(jQuery(a).find("#JOINDIV")[0].className="errorOnJoinIcon",jQuery(a).find("#LEFTLABEL")[0].style.display="block",jQuery(a).find("#LEFTLABEL")[0].style.visibility="hidden",jQuery(a).find("#RIGHTLABEL")[0].style.display="block",jQuery(a).find("#RIGHTLABEL")[0].style.visibility="hidden",jQuery(a).find("#JOINDIV")[0].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.invalidreference")),f!=null&&g!=null&&f!=""&&g!=""&&(jQuery(a).find("#JOINDIV")[0].setAttribute("isError","true"),ZDBToolTip.show(jQuery(a).find("#JOINDIV")[0],"mouseover"))),h=!1);var k=jQuery("#EnclosingDiv").find("#COLUMNLIST"),l=jQuery("#EnclosingDiv").find("#FKCol"),m=0;for(i=0;i<k.length;i++){var n=jQuery(k[i]).parents().find("#JOINDIV")[0].className,o=n.indexOf("left")!=-1?l[i].getAttribute("value"):k[i].getAttribute("value");if(n.indexOf("disable")!=-1&&a.className!="ENCDIV")continue;e[i]=o;var p=jQuery(a).find("#JOINDIV")[0].className,q=p.indexOf("right")!=-1||p.indexOf("disable")!=-1?c.getAttribute("value"):d.getAttribute("value");q==o&&m++}m>1&&(jQuery(a).find("#JOINDIV")[0].className="errorOnJoinIcon",jQuery(a).find("#LEFTLABEL")[0].style.display="block",jQuery(a).find("#RIGHTLABEL")[0].style.display="block",jQuery(a).find("#LEFTLABEL")[0].style.visibility="hidden",jQuery(a).find("#RIGHTLABEL")[0].style.visibility="hidden",jQuery(a).find("#JOINDIV")[0].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.multiplerelationship")),jQuery(jQuery(a).find("#JOINDIV")[0]).attr("isError","true"),ZDBToolTip.show(jQuery(a).find("#JOINDIV")[0],"mouseover"),h=!1);if(f==null||g==null||f==""||g==""){if(a.className!="ENCDIV"||b)jQuery(a).find("#JOINDIV")[0].className="errorOnJoinIcon",jQuery(a).find("#LEFTLABEL")[0].style.display="block",jQuery(a).find("#LEFTLABEL")[0].style.visibility="hidden",jQuery(a).find("#RIGHTLABEL")[0].style.display="block",jQuery(a).find("#RIGHTLABEL")[0].style.visibility="hidden",jQuery(a).find("#JOINDIV")[0].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.nolookupcolchoosed")),jQuery(jQuery(a).find("#JOINDIV")[0]).attr("isError","true"),ZDBToolTip.show(jQuery(a).find("#JOINDIV")[0],"mouseover");h=!1}if(h){ZDBToolTip.hide();if(a.className=="ENCDIV"||jQuery(a).find("#JOINDIV")[0].className.indexOf("disable")!=-1)addNewJoin(jQuery(a).find("#JOINDIV")[0]),jQuery(a).find("#JOINDIV")[0].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.swaprelationtip"))}else a.className=="ENCDIV"&&jQuery(a).find("#JOINDIV")[0].className.indexOf("disable")!=-1&&jQuery(a).find("#JOINDIV")[0].setAttribute("blocked","true")}function validatejoin(a){var b=jQuery("#EnclosingDiv").find("#COLUMNLIST"),c=jQuery("#EnclosingDiv").find("#FKCol"),d=jQuery("#EnclosingDiv").find("#JOINDIV"),e=!1,f=[],g=[];for(i=0;i<b.length;i++){if(jQuery(d[i].parentNode.parentNode.parentNode).find("#ENCDIV")[0].className=="ENCDIV"&&d[i].className.indexOf("error")==-1)continue;var h=d[i].className.indexOf("right")!=-1?b[i].getAttribute("subtype"):c[i].getAttribute("subtype"),j=d[i].className.indexOf("right")!=-1?c[i].getAttribute("subtype"):b[i].getAttribute("subtype"),k=canbeJoined(h,j);k?(d[i].className=="errorOnJoinIcon"&&(d[i].className="rightJoinIconNew",jQuery(d[i].parentNode.parentNode).find("#RIGHTLABEL")[0].innerHTML.indexOf("Parent")!=-1?d[i].className="rightJoinIconNew":d[i].className="leftJoinIconNew"),jQuery(d[i].parentNode.parentNode).find("#LEFTLABEL")[0].style.visibility="visible",jQuery(d[i].parentNode.parentNode).find("#RIGHTLABEL")[0].style.visibility="visible",d[i].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.swaprelationtip"))):(d[i].className="errorOnJoinIcon",jQuery(d[i].parentNode.parentNode).find("#LEFTLABEL")[0].style.visibility="hidden",jQuery(d[i].parentNode.parentNode).find("#RIGHTLABEL")[0].style.visibility="hidden",d[i].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.invalidreference")),jQuery(d[i]).attr("isError","true"),ZDBToolTip.show(d[i],"mouseover"),e=!0);var l=d[i].className.indexOf("right")!=-1?b[i].getAttribute("value"):c[i].getAttribute("value");if(d[i].className.indexOf("disable")==-1){var m=c[i].getAttribute("value").split(".")[0];jQuery.inArray(m,g)>-1?(d[i].className="errorOnJoinIcon",jQuery(d[i].parentNode.parentNode).find("#LEFTLABEL")[0].style.visibility="hidden",jQuery(d[i].parentNode.parentNode).find("#RIGHTLABEL")[0].style.visibility="hidden",d[i].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.multiplerelationshipbetweenametable")),jQuery(d[i]).attr("isError","true"),ZDBToolTip.show(d[i],"mouseover"),e=!0):g[i]=m,jQuery.inArray(l,f)>-1?(d[i].className="errorOnJoinIcon",jQuery(d[i].parentNode.parentNode).find("#LEFTLABEL")[0].style.visibility="hidden",jQuery(d[i].parentNode.parentNode).find("#RIGHTLABEL")[0].style.visibility="hidden",d[i].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.multiplerelationship")),d[i].setAttribute("isError","true"),ZDBToolTip.show(d[i],"mouseover"),e=!0):f[i]=l}(h==null||j==null||h==""||j=="")&&a&&(d[i].className="errorOnJoinIcon",jQuery(d[i].parentNode.parentNode).find("#LEFTLABEL")[0].style.visibility="hidden",jQuery(d[i].parentNode.parentNode).find("#RIGHTLABEL")[0].style.visibility="hidden",d[i].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.nolookupcolchoosed")),d[i].setAttribute("isError","true"),ZDBToolTip.show(d[i],"mouseover"),e=!0)}return e||ZDBToolTip.hide(),e}function canbeJoined(a,b){return a==b?!0:a!=ZDBConst.DECIMAL_NUMBER&&a!=ZDBConst.CURRENCY&&a!=ZDBConst.PERCENT||b!=ZDBConst.NUMBER&&b!=ZDBConst.POSITIVE_NUMBER?a==ZDBConst.NUMBER&&b==ZDBConst.POSITIVE_NUMBER?!0:b!=ZDBConst.DECIMAL_NUMBER&&b!=ZDBConst.CURRENCY&&b!=ZDBConst.PERCENT||a!=ZDBConst.DECIMAL_NUMBER&&a!=ZDBConst.CURRENCY&&a!=ZDBConst.PERCENT&&a!=ZDBConst.AUTO_NUMBER?!1:!0:!0}function relateTablesOnImport(){var a=validatejoin(!0);if(!!a)return;var b="<JOINS>",c=jQuery("#EnclosingDiv").find("#COLUMNLIST"),d=jQuery("#EnclosingDiv").find("#FKCol"),e=jQuery("#EnclosingDiv").find("#JOINDIV");for(h=0;h<c.length;h++){var f=e[h].className.indexOf("left")!=-1?"left":"right";if(e[h].className.indexOf("left")!=-1||e[h].className.indexOf("right")!=-1)b+="<J"+h+' FieldName="'+encodeURIComponent(ZDBEscapeUtil.encodeForXML(c[h].getAttribute("value")))+'" ReferredColumn="'+d[h].getAttribute("value")+'" JoinType='+'"'+f+'"/>'}b+="</JOINS>",$("JOINSLIST").value=decodeURIComponent(b);var g=jQuery("#EnclosingDiv").find("#ENCDIV:.ENCDIV");for(var h=0;h<g.length;h++)g[h].parentNode.parentNode.removeChild(g[h].parentNode);g=jQuery("#EnclosingDiv").find("#JOINDIV:.selecteddisableJoinIconNew");for(var h=0;h<g.length;h++)g[h].parentNode.parentNode.parentNode.parentNode.removeChild(g[h].parentNode.parentNode.parentNode);var i="JOINSLIST="+b;$("ZDBIMPORTWITHLOOKUPOPSTATUS").className="mcLoading",$("ZDBIMPORTWITHLOOKUPOPSTATUSLABEL").style.display="inline",ZDBIMPORTWITHLOOKUPOPSTATUSLABEL,AjaxAPI.sendRequest({URL:"/ZDBImportData.ve?ZDBACTION=VALIDATEJOINS",ONSUCCESSFUNC:closeJoinDialog,METHOD:"POST",PARAMETERS:i})}function closeJoinDialog(a){$("ZDBIMPORTWITHLOOKUPOPSTATUS").className="mcLoaded",$("ZDBIMPORTWITHLOOKUPOPSTATUSLABEL").style.display="none";var b=JSON.parse(a.getResponsePart("ERROR_MESSAGE"));if(b!=null)for(var c=0;c<b.ERRORS.length;c++){var d=b.ERRORS[c][0],e=b.ERRORS[c][1],f=jQuery("#EnclosingDiv").find("#FKCol"),g=jQuery("#EnclosingDiv").find("#FKCol");for(j=0;j<f.length;j++){var h=f[j];console.log(h.getAttribute("colID"));if(h.getAttribute("colID").indexOf(b.ERRORS[c][0])!=-1){var i=h.parentNode.parentNode.parentNode.parentNode.querySelectorAll("#JOINDIV")[0];i.className.lastIndexOf("right")!=-1&&(h=g[j]),i.className="errorOnJoinIcon",jQuery(i.parentNode.parentNode).find("#LEFTLABEL")[0].style.visibility="hidden",jQuery(i.parentNode.parentNode).find("#RIGHTLABEL")[0].style.visibility="hidden",i.setAttribute("isError","true"),i.setAttribute("blocked","false");var k="<br/><strong>"+ZDBI18NMap.f("zrpt.home.import.js.ColModErr",ZDBEscapeUtil.encodeForHtml(h.innerHTML))+"</strong><br/>";k+=e,i.setAttribute("errorMsg",k);var l=ZDBI18NMap.f("zrpt.home.import.js.ColModErrTip",ZDBEscapeUtil.encodeForHtml(h.innerHTML));i.setAttribute("tip",l),ZDBToolTip.show(i,"mouseover")}}}else{var m=jQuery(document.body).width(),n=jQuery("#EnclosingDiv").find("#JOINLIST").length;n==0&&addJoinDiv(),document.body.removeChild($("IMPORTFREEZE")),n>0?(jQuery("#ZDBImportFileWithRelation").find("zdbImportTableDesc")[0]!=undefined&&(jQuery("#ZDBImportFileWithRelation").find("zdbImportTableDesc")[0].innerHTML=ZDBI18NMap.g("zrpt.home.import.js.joinTablesDesc")),$("ZDBJOINTABLE").style.marginRight="473px",n>1?$("ZDBJOINTABLE").innerHTML=n+" "+ZDBI18NMap.g("zrpt.newtable.import.js.lookupsSaved"):$("ZDBJOINTABLE").innerHTML=n+" "+ZDBI18NMap.g("zrpt.newtable.import.js.lookupSaved")):($("ZDBJOINTABLE").innerHTML=ZDBI18NMap.g("zrpt.newtable.import.js.defineLookup"),jQuery("#ZDBImportFileWithRelation").find("zdbImportTableDesc")[0]!=undefined&&(jQuery("#ZDBImportFileWithRelation").find("zdbImportTableDesc")[0].innerHTML=ZDBI18NMap.g("zrpt.home.import.js.customJoinTablesDesc")),$("ZDBJOINTABLE").style.marginRight="473px",$("JOINSLIST").value=""),jQuery("#ZDBImportFileWithRelation").animate({left:m}).hide(),window.joinFrm=$("EnclosingDiv").cloneNode(!0)}}function showQuerytable(a,b){jQuery(a.parentNode).find("#QUERYLIST")[0].style.display="block";var c=jQuery(a.parentNode).find("#QUERYLIST")[0].querySelectorAll(".refColUi");for(i=0;i<c.length;i++)c[i].style.display="block";a.style.display="none",ZDBUtil.stopEventBubble(b)}function hideQuerytable(a){a!=undefined&&(jQuery(a.parentNode).find("#QUERYLIST")[0].style.display="none",a.style.display="block")}function swapparentchild(a){var b=jQuery(a).parents().find("#ENCDIV")[0];a.className.indexOf("leftJoinIconNew")!=-1?(jQuery(b).find("#LEFTLABEL")[0].style.display="none",jQuery(b).find("#RIGHTLABEL")[0].style.display="none",jQuery(b).find("#JOINDIV")[0].className="selecteddisableJoinIconNew",jQuery(b).find("#JOINDIV")[0].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.addrelation")),ZDBToolTip.show(a,"mouseover")):a.className.indexOf("rightJoinIconNew")!=-1?(jQuery(b).find("#RIGHTLABEL")[0].innerHTML="Child",jQuery(b).find("#LEFTLABEL")[0].innerHTML="Parent",a.className="leftJoinIconNew",jQuery(b).find("#JOINDIV")[0].setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.removerelationtip")),ZDBToolTip.show(a,"mouseover")):a.className.indexOf("disableJoinIconNew")!=-1&&b.className.indexOf("ENCDIV")==-1?validateCurrJoin(b,!0):a.className.indexOf("error")!=-1&&jQuery(b).find("#JOINDIV")[0].getAttribute("errorMsg")!=null&&jQuery(b).find("#JOINDIV")[0].getAttribute("errorMsg")!=""&&(ZDBUtil.showRefErr(jQuery(b).find("#JOINDIV")[0].getAttribute("errorMsg"),"Error on Saving"),ZDBDialogUtil.focusDialog.style.left="500px",ZDBDialogUtil.focusDialog.style.top="202px")}function showremoveicon(a){a.querySelectorAll("#ENCDIV")[0].className==""?a.querySelectorAll("#REMOVEJOIN")[0].style.display="block":(a.querySelectorAll("#REMOVEJOIN")[0].style.display="block",a.querySelectorAll("#REMOVEJOIN")[0].style.marginTop="14px")}function addNewJoin(a){jQuery(a.parentNode.parentNode.parentNode).find("#RIGHTLABEL")[0].innerHTML="Parent",jQuery(a.parentNode.parentNode.parentNode).find("#LEFTLABEL")[0].innerHTML="Child",jQuery(a.parentNode.parentNode.parentNode).find("#RIGHTLABEL")[0].style.display="block",jQuery(a.parentNode.parentNode.parentNode).find("#LEFTLABEL")[0].style.display="block",a.className="rightJoinIconNew",a.setAttribute("tip",ZDBI18NMap.g("zrpt.home.import.js.swaprelationtip")),a.setAttribute("blocked","false"),a.parentNode.parentNode.parentNode.querySelectorAll("#ENCDIV")[0].className="",a.parentNode.parentNode.parentNode.querySelectorAll("#LEFTLABEL")[0].className="LEFTLABEL"
,a.parentNode.parentNode.parentNode.querySelectorAll("#RIGHTLABEL")[0].className="RIGHTLABEL",jQuery(a.parentNode.parentNode.parentNode).find(".inlinePropComboSel")[0].style.background="#f3f3f2",jQuery(a.parentNode.parentNode.parentNode).find(".inlinePropComboSel")[1].style.background="#f3f3f2",jQuery(a.parentNode.parentNode.parentNode).find(".inlinePropComboSel")[0].style.border="0px solid #d0d0d0",jQuery(a.parentNode.parentNode.parentNode).find(".inlinePropComboSel")[0].style.boxShadow="none",jQuery(a.parentNode.parentNode.parentNode).find(".inlinePropComboSel")[1].style.border="0px solid #d0d0d0",jQuery("#ZDBImportFileWithRelation").find("#FKCOLDROPDOWN")[0].style.top="26px",jQuery("#ZDBImportFileWithRelation").find("#COLUMNLISTDROPDOWN")[0].style.top="26px",jQuery(a.parentNode.parentNode.parentNode).find("#REMOVEJOIN")[0].style.marginTop="0px",a.parentNode.parentNode.parentNode.querySelectorAll("#JOINDIV")[0].className="rightJoinIconNew",a.parentNode.parentNode.parentNode.querySelectorAll("#LEFTCOLHEAD")[0].style.display="none",a.parentNode.parentNode.parentNode.querySelectorAll("#RIGHTCOLHEAD")[0].style.display="none"}function removejoin(a){a.parentNode.parentNode.childNodes.length>2?a.parentNode.parentNode.removeChild(a.parentNode):(a.parentNode.parentNode.removeChild(a.parentNode),addJoinDiv()),validatejoin(!1)}function handleCreateDBResp(a,b){var c=a.getResponseParams(),d=c.ENTERDATA;window.curStep=window.curStep+1,d==null&&!c.DBID&&changeTitle(),c["DBID"]!=null?showDataSheet(a,b):($("ZDBCREATEDBOPTSTATUS").className="mcLoaded",uploadFile(a,b)),a.invokeScripts(),ZRUserAnalyticsAttacher.importDialogAttacher(window.importType);if(window.importType=="import"){var e="step"+window.curStep;ZRUserAnalyticsAttacher.importDialogAttacher(window.importType,"homefileimportflow",e,!0)}}function showDataSheet(a,b){var c=a.getResponseParams();if(window.ZDBClientUI==null||window.ZDBClientUI.getExistingTab("NewTable")==null){var d=ZDBGlobal.CTX+ZDBGlobal.REPORTS_CONTEXT_NAME+"/ZDBDataSheetView.cc?DBID="+c.DBID,e=c.OBJID;e!=null&&(d+="&OBJID="+e);var f=c.ENTERDATA;f!=null&&(d+="&VIEWACTION=ENTERDATA"),window.location.href=d}else{ZDBDialogUtil.closeDialog();var g=ZDBClientUI.getExistingTab("NewTable");ZDBClientUI.fetchView(c.OBJID,c.DBID,c.TABLENAME,"Table"),ZDBNavigation.refreshExplorer(),ZDBClientUI.removeTab(g)}}function importReport(a,b){var c=a.getResponseParams();ZDBClientUI.sampleView=c["AUTOGENDLGSTATUS"]=="NOTPRESENT"?!0:!1,ZDBClientUI.hideSheetList=c.IM_HIDESHEETLIST;var d=[",","\t",";"," ","|"],e=["COMMA","TAB","SEMICOLON","SPACE","PIPE"],f=new Object,g=d.length;for(var h=0;h<g;++h)f[d[h]]=e[h];var i=f[c.DELIMITER],j=c.QUOTED,k;switch(j){case 1:k="SINGLE QUOTE";break;case 2:k="DOUBLE QUOTE";break;default:k="NONE"}var l=document.createElement("div"),m=ZDBUtil.getCachedRef(ZDBImport,"im_div");l.setAttribute("id","importReportDIV"),l.setAttribute("isDialog","true"),l.innerHTML=m.innerHTML,m.style.display="block",ZDBCreateDB.isInHomePage()?l.style.padding="0 0 25px":l.style.padding="25px 0",l.className="importReportDIV";var n=document.createElement("div");n.setAttribute("name","TABLEID"),n.setAttribute("id","TABLEID"),n.style.display="none";var o=b.PARAMETERS,p=o.split("&");for(var q=0;q<p.length;q++){var r=p[q].split("=");if(r[0]=="TABLEID"){n.setAttribute("TABLEID",r[1]),n.innerHTML=r[1];break}}l.appendChild(n),ZDBCreateDB.isInHomePage()?(ZDBFullPageDialog.closeDialog(),ZDBFullPageDialog.showDialog(l,{MODAL:!0,DONTREMOVE:!1,ONCLOSE:ZDBCreateDB.gotoSheetView,REQPARAMS:a.getResponseParams()})):(ZDBInlineDialog.closeDialog(),ZDBInlineDialog.showDialog(l,{MODAL:!0,DONTREMOVE:!1,ONCLOSE:ZDBCreateDB.gotoSheetView,REQPARAMS:a.getResponseParams()}),$("ZRImpReport").className=""),ZDBClientUI.modified=!1,fillReport(a),ZRUserAnalyticsAttacher.importDialogAttacher(window.importType);if(window.importType=="import"){var s="step"+window.curStep;ZRUserAnalyticsAttacher.importDialogAttacher(window.importType,"homefileimportflow",s,!0)}return}function fillReport(a){var b=["IM_CREATEUP","IM_TABLENAME","IM_TOTAL","IM_SUCCESS","IM_WARN","IM_FAIL","IM_SKIPDETAIL","IM_TOTALCOL","IM_SUCCESSCOL","IM_DBNAME","IM_OBJID"],c=b.length,d=a.getResponseParams();for(var e=0;e<c;++e)b[e]=="IM_TABLENAME"||b[e]=="IM_DBNAME"?$(b[e]).innerHTML=ZDBEscapeUtil.encodeForHtml(d[b[e]]):$(b[e]).innerHTML=d[b[e]];if(d["IM_ABORTED"]=="true")return jQuery("#IM_TITLE").html(ZDBI18NMap.g("zrpt.common.import.js.importaborted")).addClass("importError"),jQuery("#importErrDetailsHdr").html(ZDBI18NMap.g("zrpt.common.import.js.errdetails")),$("importWarnSuccessTable").style.display="none",$("ZDBImpSchSettingsLnk").style.display="none",!1;$("importWarnSuccessTable").style.display=ZDBUtil.visibleTableStyle;var f=parseInt(d.IM_WARN),g=parseInt(d.IM_FAIL);$("IM_WARNTR").style.display=f==0?"none":ZDBUtil.visibleTrStyle,$("IM_FAILTR").style.display=g==0?"none":ZDBUtil.visibleTrStyle,f+g<1?($("importErrDetailsHdr").style.display="none",$("importErrDetails").style.display="none"):jQuery("#importErrDetailsHdr").html(f>0&&g>0?ZDBI18NMap.g("zrpt.common.import.js.errwarndetails"):f>0?ZDBI18NMap.g("zrpt.common.import.js.warndetails"):ZDBI18NMap.g("zrpt.common.import.js.errdetails"));var h=$("ZDBImpSchSettingsLnk");h.style.display=d["IM_SCHEDULE_ALLOWED"]=="true"?"":"none",h.setAttribute("isGsheet",d.IM_SCHEDULE_ISGSHEET),h.setAttribute("fileType",d.IM_FILETYPE),h.setAttribute("ISFROMGDRIVE",d.IM_ISFROMGDRIVE),h.setAttribute("LOCALFILE",d.IM_LOCAL_FILENAME),h.setAttribute("GDRIVE_FORMAT",d.IM_GDRIVE_FORMAT),h.setAttribute("isZDocs",d.IM_SCHEDULE_ISZDOCS),h.setAttribute("isExtDrive",d.IM_SCHEDULE_ISEXTDRIVE),h.setAttribute("isOnPremiseDB",d.IM_SCHEDULE_ISONPREMISEDB),h.setAttribute("CONNECTIONID",d.CONNECTIONID),h.setAttribute("FILESUBTYPE",d.IM_SCHEDULE_FILESUBTYPE),h.setAttribute("LOCATION",d.LOCATION);var i=$("ZDBImportReportCloseBtn");i!=null&&i.setAttribute("LOCATION",d.LOCATION),d["IM_SCHSHEETLIST"]!=null&&d.IM_SCHSHEETLIST.length>0&&h.setAttribute("ZDBSHEETLIST",d.IM_SCHSHEETLIST),h.setAttribute("ALLOW_SCHEDULE_INTERVAL_IN_MINUTES",d.ALLOW_SCHEDULE_INTERVAL_IN_MINUTES),d["IMPORTPROPERTIES"]!=null&&(h.setAttribute("IMPORTPROPERTIES",d.IMPORTPROPERTIES),h.setAttribute("URLPROPERTIES",d.URLPROPERTIES))}function storeChildDiv(a,b){var c="";b=="existImport"&&a!="GSheetDlg"&&a!="ScheduledGSheets"&&a!="DocsDlg"&&(c="EX");var d=$("ZDB"+c+a);d&&(d.parentNode.removeChild(d),window.divData[c+a]||(window.divData[c+a]=d))}function storeAllReferences(a){var b=["FILEINP","URLINP","PASTEINP","FTPINP","GSHEETINP","ZSHEETINP","EXTFILEINP","import","template","scratch","remote","remotedb","enterdata","GSheetDlg","ScheduledGSheets","DocsDlg","CREATEDIALOG","GOOGLEINTEGCREATEDB","ZDBGADDemo","cloud","CLOUDDIALOG","inhousedb","IMPINTOTHISTBL"],c=!1;window.divData==null&&(window.divData=new Object,window.divData.isExist=!1,window.divData.isNew=!1),a==undefined&&window.divData.isNew==0&&(window.divData.isNew=!0,c=!0),a!=undefined&&a=="existImport"&&window.divData.isExist==0&&(window.divData.isExist=!0,c=!0);if(c){var d=b.length;for(var e=0;e<d;++e)storeChildDiv(b[e],a)}}function setDialogPosition(a,b){var c=$("_DIALOG_LAYER");c.style.position="absolute",c.style.left=a,c.style.top=b}function showTableDialog(a,b){storeAllReferences();var c=window.divData.CREATEDIALOG.cloneNode(!0);window.divData.location=a,ZDBInlineDialog.showDialog(c,{MODAL:!0,VIEW:ZDBClientUI.selectedTab.view});if(a=="inhousedb"){$("remoteDBImportNote").style.display="",ZDBUtil.setFocus("ZDBCONNECTIONNAME");return}$("importNote").style.display="";var d=b==="cloud"?ZDBI18NMap.g("zrpt.newtable.import.js.clouddesc"):ZDBI18NMap.g("zrpt.newtable.import.js.importcsvdesc");$("zdbImportTableDesc").innerHTML=d,b=="cloud"&&$("zdbImportDBHelp")&&($("ZRSHelplink").setAttribute("href",ZDBI18NMap.g("zrpt.links.js.cldimphelp")),$("ZRSVideoDemoHelp").style.display="none",$("ZRSSnapShotTour").style.display="none"),a==undefined?"PASTEDATA":a,a=="PASTEDATA"&&($("ZDBFILETYPE").value="CSV"),locationSelected(a)}function showDatabaseDialog(a){window.importType=a;var b=ZDBClientUI.readOnlyMode;if(b){ZDBMsgBox.showInfo(ZDBI18NMap.g("zrpt.javaerr.common.js.ro_mode"));return}storeAllReferences();var c=window.divData.CREATEDIALOG.cloneNode(!0);ZDBFullPageDialog.showDialog(c,{MODAL:!0}),window.curStep=1,window.totStep=2,a=="import"?($("zdbImportDBTitle").innerHTML=ZDBI18NMap.f("zrpt.home.import.step1.js.createdb",window.curStep,window.totStep),$("zdbImportDBDesc").innerHTML=ZDBI18NMap.g("zrpt.home.import.js.importdescription.new"),$("importNote").style.display="",ZDBUtil.setFocus("IDBNAME1")):a=="enterdata"?($("zdbImportDBTitle").innerHTML=ZDBI18NMap.g("zrpt.home.import.step1.js.createdbenterdata"),$("zdbImportDBDesc").innerHTML=ZDBI18NMap.g("zrpt.home.import.js.enterdatarightdesc.new"),ZDBUtil.setFocus("IDBNAME4")):a=="template"?($("zdbImportDBTitle").innerHTML=ZDBI18NMap.g("zrpt.home.import.step1.js.createdbtemplate"),$("zdbImportDBDesc").innerHTML=ZDBI18NMap.g("zrpt.home.import.js.dbtempdesc.new"),ZDBUtil.setFocus("IDBNAME2"),AjaxAPI.sendRequest({URL:"/ZDBListDBTemplates.cc",ONSUCCESSFUNC:"updateTemplates",OPSTATUSID:"ZDBTemplateLoadIndicator"})):a=="scratch"?($("zdbImportDBTitle").innerHTML=ZDBI18NMap.g("zrpt.home.import.step1.js.createdbblank"),$("zdbImportDBDesc").innerHTML=ZDBI18NMap.g("zrpt.home.import.js.blankdbdesc.new"),ZDBUtil.setFocus("IDBNAME3")):a=="remote"?(window.totStep=2,$("zdbImportDBTitle").innerHTML=ZDBI18NMap.f("zrpt.home.import.step1.js.createdbremote",window.curStep,window.totStep),$("zdbImportDBDesc").innerHTML=ZDBI18NMap.g("zrpt.home.import.js.remotedbdesc"),ZDBUtil.setFocus("IDBNAME6"),$("remoteDBImportNote").style.display=""):a=="google"?$("zdbImportDBTitle").innerHTML=ZDBI18NMap.g("zrpt.home.import.step1.js.googleimport"):a=="cloud"?($("zdbImportDBTitle").innerHTML=ZDBI18NMap.f("zrpt.home.import.step1.js.createdb",window.curStep,window.totStep),$("zdbImportDBDesc").innerHTML=ZDBI18NMap.g("zrpt.home.import.js.dbclouddesc.new"),$("importNote").style.display="",$("zdbImportDBHelp")&&($("ZRSHelplink").setAttribute("href",ZDBI18NMap.g("zrpt.links.js.cldimphelp")),$("ZRSVideoDemoHelp").style.display="none",$("ZRSSnapShotTour").style.display="none"),ZDBUtil.setFocus("IDBNAME1")):a=="inhousedb"&&($("remoteDBImportNote").style.display="",$("zdbImportDBTitle").innerHTML=ZDBI18NMap.g("zrpt.databasedata.import.js.step1.dbconnectionsetting"),$("zdbImportDBDesc").innerHTML=ZDBI18NMap.g("zrpt.databasedata.import.js.step1.description")),$("zdbImportDBHelp")&&($("zdbImportDBHelp").style.display=a=="import"||a=="cloud"||a=="inhousedb"?"block":"none"),showSelectedOption(a),(a=="import"||a=="cloud")&&ZDBImport.setFileType(a),ZRUserAnalyticsAttacher.importDialogAttacher(a);if(a=="import"){var d="step"+window.curStep;ZRUserAnalyticsAttacher.importDialogAttacher(a,"homefileimportflow",d,!0)}ZDBUtil.setIfGAppsUser()}function updateTemplates(a,b){$("ZDBTemplatesHolder").innerHTML=a.getOnlyHtml()}function showSelectedOption(a){var b=$("ZDBCreateDBContainer"),c=a==="import"||a==="cloud"?divData["import"]:divData[a];b.innerHTML=c.innerHTML,a=="import"&&locationSelected("LOCALDRIVE"),$("ZDBOPTIONINP").value=a,$("ZDBSaveNextDBBtn").style.display=a==="remote"?"":"none",$("ZDBNextDBBtn").style.display=a==="import"||a==="inhousedb"?"":"none",$("ZDBCreateDBBtn").style.display=a==="import"||a==="remote"?"none":"",a=="google"&&($("ZDBNextDBBtn").style.display="none",$("ZDBCreateDBBtn").style.display="none",$("ZDBCancelDBBtn").style.display="none"),a=="template"&&($("CDBDATA").checked="true"),a=="cloud"&&locationSelected("GSHEET"),a=="inhousedb"&&(ZDBUtil.setFocus("ZDBCONNECTIONNAME"),$("ZDBCreateDBBtn").style.display="none")}function checkForGADWelcomePage(){AjaxAPI.sendRequest({URL:"/ZDBGoogleAction.ma?ZDBACTION=GADWELCOMEDLG",ONSUCCESSFUNC:checkForGADWelcomePageSuccess})}function checkForGADWelcomePageSuccess(a){a.responseText=="false"?showGADDemoDialog():showGoogleCreateDBDialog()}function showGADDemoDialog(){storeAllReferences(),ZDBGoogleInteg.createAndShowDialog(),$("zdbImportGADDBTitle").innerHTML=ZDBI18NMap.g("zrpt.home.ga.js.gaddemotitle"),$("googlecontent").innerHTML=$("ZDBGADDemo").innerHTML}function setDemoDialog(a){a.checked?$("googlecontent").setAttribute("gadDemoDlg","true"):$("googlecontent").setAttribute("gadDemoDlg","false")}function showGoogleCreateDBDialog(){storeAllReferences();if($("gadwelcomedlg")!=null)var a=$("gadwelcomedlg").checked;ZDBDialogUtil.closeDialog(),ZDBGoogleInteg.downloadGADClientList(a)}function transferInputDet(a,b,c){var d=$(b+a),e=$(c+a);if(d==null||e==null)return;d.type=="radio"?e.checked=d.checked:e.value=d.value}function showCreateDB(a){window.prevDBFrm.style.display="none",$("ZDBCreateDBCntTd").appendChild(window.prevDBFrm);var b=window.divData.importVia,c=window.divData.fileType;if(c=="CSV"||c=="XLS"&&b=="PASTEDATA")$("ZDBPASTEOPT").checked=b=="PASTEDATA",$("ZDBFILEOPT").checked=b=="LOCALDRIVE",$("ZDBWEBOPT").checked=b=="WEB",$("ZDBFTPOPT")!=null&&($("ZDBFTPOPT").checked=b=="FTP"),$("ZDBFILETYPE").value="CSV";sampleTableGrid!=null&&(ZDBDataGrid.removeInstance(sampleTableGrid.ID),sampleTableGrid=null),window.impFrm.parentNode.removeChild(window.impFrm),window.prevDBFrm.style.display="block",window.impFrm=window.prevDBFrm,window.curStep=window.curStep-1,changeTitle()}function showCreateDBFromWeb(a){window.homeFrm.style.display="none",$("ZDBCreateDBCntTd").appendChild(window.homeFrm);var b=window.divData.importVia;sampleTableGrid!=null&&(ZDBDataGrid.removeInstance(sampleTableGrid.ID),sampleTableGrid=null),window.impFrm.parentNode.removeChild(window.impFrm),window.homeFrm.style.display="block",$("ZDBPASTEOPT").checked=b=="PASTEDATA",$("ZDBFILEOPT").checked=b=="LOCALDRIVE",$("ZDBFTPOPT")!=null&&($("ZDBFTPOPT").checked=b=="FTP"),$("ZDBWEBOPT").checked=b=="WEB"||b=="GSHEET"||b=="ZDOCS"||ZDBImport.isExternalFile(b),window.curStep=window.curStep-1,changeTitle()}function uploadFile(a,b,c){var d="";c=="existImport"&&(d="EX"),$("ZDB"+d+"CreateFrm")&&(window.homeFrm=$("ZDB"+d+"ImportFile")),window.prevDBFrm=$("ZDB"+d+"ImportFile");var e=document.createElement("div");e.id="ZDB"+d+"ImportFile",e.style.width="100%",e.style.height="100%",e.innerHTML=a.getOnlyHtml(),e.style.visibility="hidden",$("ZDB"+d+"CreateDBCntTd").appendChild(e),c!="existImport"&&(transferInputDet("DBNAME","I","F"),transferInputDet("TABLENAME","I","F"),transferInputDet("DESCRIPTION","I","F"),transferInputDet("TAGS")),window.impFrm=e,e.style.visibility="visible";if($("ZDB"+d+"CreateFrm")){var f="",g="";$("ZDB"+d+"FILETYPE").value=="GSHEET"&&(f=$("ZDBExtIntInput").value,g=ZDBImport.getFileExtension(f).toUpperCase(),$("ISFROMGDRIVE").value=="false"&&(g=""));if(c=="existImport"&&($("ZDBEXFILETYPE").value=="HTML"||($("ZDBEXFILETYPE").value=="XLS"||$("ZDBEXFILETYPE").value=="GSHEET"||($("ZDBEXFILETYPE").value=="ZDOCS"||ZDBImport.isExternalFile($("ZDBEXFILETYPE").value))&&($("ZDBFILESUBTYPE").value=="XLS"||$("ZDBFILESUBTYPE").value=="XLSX"||$("ZDBFILESUBTYPE").value=="HTML"))&&!$("ZDBEXPASTEOPT").checked&&g!="CSV"&&g!="TSV"&&g!="TXT")){var h=$("ZDBHTMLTableFrm");h.setAttribute("onsuccessfunc","handleExistImport"),h.setAttribute("opstatusid","ZDBCREATEDBOPTSTATUS")}}window.prevDBFrm.parentNode.removeChild(window.prevDBFrm)}function isTopCommentValid(a){var b=a.SKIPTOP.value,c=a.COMMENTCHAR.value;return b!=""&&!ZDBValidator.isPositive(b,!0,!0)?(showCustomMessage(ZDBI18NMap.g("zrpt.common.import.zdbalertmsg.js.skipTopRowsInputErr"),$("SKIPTOP")),!1):c&&!/^.?$/.test(c)?(showCustomMessage(ZDBI18NMap.g("zrpt.common.import.zdbalertmsg.js.commentCharInputErr"),$("COMMENTCHAR")),!1):!0}function isANCTypeUnique(a){var b=a.length,c=0,d,e;for(var f=0;f<b;f++){e=a[f];if(e.objType!=ZDBConst.COLHEAD)continue;d=e.dataType,d.selectedIndex==ZDBDesignGridConst.AUTO_NUMBER&&++c;if(c>1)return!1}return!0}function isDateFieldOK(a,b){var c=a.values,d=c.length,e=!1,f,g,h;for(var i=0;i<d;++i){f=c[i].colObj;if(f.objType!=ZDBConst.COLHEAD)continue;g=f.dataType,h=g[g.selectedIndex].value;if(h=="9"){e=!0;if(b["DATEFORMAT"].value=="")return showCustomMessage(ZDBI18NMap.g("zrpt.common.import.custommsg.js.wrongDtFmtSel"),ZDBUtil.getParentWithTagName(b.DATEFORMAT,"div")),!1}}return!e&&b["DATEFORMAT"].value=="MILLI"?(showCustomMessage(ZDBI18NMap.g("zrpt.common.import.custommsg.js.milliDateFormatErr"),ZDBUtil.getParentWithTagName(b.DATEFORMAT,"div")),!1):!0}function getDataTypeRow(a){var b=sampleTableGrid.rowData,c=ZDBDataGrid.getFirstRowIndex(b,!1);return a?b[c+1]:b[c]}function refreshSampleForm(a){var b=a.form,c=a.name;b.IMPORTUPDATEFIELD.value=c;var d=b.getAttribute("ISEXISTIMPORT")?!0:!1;if(!isTopCommentValid(b))return!1;b["SKIPTOP"].value==""&&(b.SKIPTOP.value=0);if(c=="ZOHO_DECIMAL_SEP"||c=="ZOHO_THOUSAND_SEP"){var e=b.THOUSANDSEP.value,f=b.DECIMALSEP.value;if(e==1&&f==1||e==2&&f==0){var g=ZDBI18NMap.g("zrpt.common.import.zdbalertmsg.js.separatorsAreSame");return showCustomMessage(g,a),!1}}var h="SAMPLEVIEW";return isDateFieldOK(getDataTypeRow(d),b)?(d&&(h+="EX"),$("IMPORTACTION").value=h,$("TABLECONFIG").value="",b.setAttribute("onsuccessfunc","showSampleTable"),b.setAttribute("opstatusid","ZDBSAMPLETABLEOPSTATUS"),AjaxAPI.submit(b),!0):!1}function handleImportError(a,b){var c=a.getResponsePart("STATUS_MESSAGE");if(c=="REUPLOADFILE"){var d=document.forms.UploadFile;if(d.reloadCount<2){d.reloadCount++,AjaxAPI.submit(d);return}c=ZDBI18NMap.g("zrpt.common.import.zdbalertmsg.js.importFailed"),ZDBAlertAPI.showMsg(c)}var e=a.getResponsePart("ERRORNUMCODE");if(e==7286){ZDBImport.defineRelationship(),setTimeout(function(){return!0},200);var f=JSON.parse(a.getResponsePart("ERROR_MESSAGE"));for(var g=0;g<f.ERRORS.length;g++){var h=f.ERRORS[g][0],i=ZDBEscapeUtil.decodeForHtml(f.ERRORS[g][1]),k=jQuery("#EnclosingDiv").find("#FKCol");for(j=0;j<k.length;j++){var l=k[j];console.log(l.getAttribute("colID"));if(l.getAttribute("colID").indexOf(f.ERRORS[g][0])!=-1){var m=l.parentNode.parentNode.parentNode.parentNode.querySelectorAll("#JOINDIV")[0];m.className="errorOnJoinIcon",jQuery(m.parentNode.parentNode).find("#LEFTLABEL")[0].style.visibility="hidden",jQuery(m.parentNode.parentNode).find("#RIGHTLABEL")[0].style.visibility="hidden",m.setAttribute("isError","true"),m.setAttribute("blocked","false"),m.setAttribute("tip",i),ZDBToolTip.show(m,"mouseover")}}}}else e==10001?ZDBAlertAPI.showMsg(c+ZDBI18NMap.g("zrpt.common.import.zdbalertmsg.js.wantToOverride"),"ZDBYESNO",{ONCLICK:handleCanOverRideException}):AjaxAPI.onFailureFunc(a,b)}function handleCanOverRideException(a){if(a!="YES")return;ZDBImport.importTable(!0,!0)}function locationSelected(a,b){hideCustomMessage(),ZDBClientUI.modified=!1;var c="";b=="existImport"&&(c="EX");var d=window.divData[c+"FILEINP"],e=window.divData[c+"PASTEINP"],f=window.divData[c+"URLINP"],g=window.divData[c+"EXTFILEINP"],h=window.divData[c+"FTPINP"],i,j,k,l,m;b=="existImport"&&!ZDBImport.isExternalFile($("ZDB"+c+"FILETYPE").value)&&($("ZDB"+c+"DataLocation").style.display="");if(a=="LOCALDRIVE"){$("ZDB"+c+"OPTIONINP").value="import";if($("ZDB"+c+"FILEOPT").disabled==1)return;$("ZDB"+c+"FILEOPT").checked=!0,i=d,j=e,k=f,l=g,m=h}else if(a=="PASTEDATA"){$("ZDB"+c+"OPTIONINP").value="import",ZDBClientUI.modified=!0;if($("ZDB"+c+"PASTEOPT").disabled==1)return;$("ZDB"+c+"PASTEOPT").checked=!0,i=e,j=d,k=f,l=g,m=h}else if(a=="FTP")if($("ZDB"+c+"FTPOPT")!=null){$("ZDB"+c+"OPTIONINP").value="import";if($("ZDB"+c+"FTPOPT").disabled==1)return;$("ZDB"+c+"FTPOPT").checked=!0,i=h,j=d,k=f,l=g,m=e}else{$("ZDB"+c+"OPTIONINP").value="import";if($("ZDB"+c+"FTPOPT").disabled==1)return;$("ZDB"+c+"PASTEOPT").checked=!0,i=e,j=d,k=f,l=g,m=h}else if(a=="WEB"){if($("ZDB"+c+"WEBOPT").disabled==1)return;$("ZDB"+c+"WEBOPT").checked=!0,ZDBImport.isExternalFile($("ZDB"+c+"FILETYPE").value)?(i=g,l=f):($("ZDB"+c+"OPTIONINP").value="import",i=f,l=g),j=e,k=d,m=h}else ZDBImport.isExternalFile(a)&&(i=g,$("ZDB"+c+"OPTIONINP").value="cloud",j=d,k=e,l=f,m=h,$("ZDB"+c+"DataLocation").style.display="none",b=="existImport"&&($("ZDBEXWEBOPT").checked=!0));a!="GSHEET"&&($("ISFROMGDRIVE").value="false",$("ISGDRIVECSV").value="false"),window.divData.importVia=a,$("ZDB"+c+"IMPORTTBODY").appendChild(i),k.parentNode?k.parentNode.removeChild(k):"Do Nothing",l.parentNode?l.parentNode.removeChild(l):"Do Nothing",j.parentNode?j.parentNode.removeChild(j):"Do Nothing",m.parentNode?m.parentNode.removeChild(m):"Do Nothing";if(ZDBImport.isExternalFile(a)){a==="DROPBOX"?$("ZDBExtDriveName").innerHTML=ZDBI18NMap.g("zrpt.common.external.js.dropbox"):a==="BOX"?$("ZDBExtDriveName").innerHTML=ZDBI18NMap.g("zrpt.common.external.js.box"):a==="ONEDRIVE"?$("ZDBExtDriveName").innerHTML=ZDBI18NMap.g("zrpt.common.external.js.skydrive"):a==="ZDOCS"?$("ZDBExtDriveName").innerHTML=ZDBI18NMap.g("zrpt.common.external.js.zdocs"):a==="GSHEET"&&($("ZDBExtDriveName").innerHTML=ZDBI18NMap.g("zrpt.common.external.js.gdrive"));var n=$("ZDBExtIntInput");n.value=n.getAttribute("tipvalue"),n.setAttribute("tipShown","true"),jQuery("#ZDBEXTERNALOPTSTATUS").hide()}else changeImportNote(b),importStepValUpdate(b),changeTitle(),a=="WEB"&&showHideUrlParamDiv(!1);ZRUserAnalyticsAttacher.attachUAMonitorsToFileTypeDlgInImport(a),window.importType=="import"&&ZRUserAnalyticsAttacher.attachUAMonitorsToFileTypeDlgInImport(a,"homefileimportflow","step1")}function importStepValUpdate(a,b){var c="";a=="existImport"&&(c="EX");var d=$("ZDB"+c+"FILETYPE").value;if(d=="CSV")window.totStep=2;else if(d=="XLS"){var e=$("ZDB"+c+"PASTEOPT").checked;window.totStep=e?2:3}else if(d=="HTML")window.totStep=3;else if(d=="JSON"||d=="XML")window.totStep=2;else if(d=="ZDOCS"||ZDBImport.isExternalFile(d)){var f=$("ZDBFILESUBTYPE").value;f=="XLS"||f=="HTML"||f=="XLSX"||f=="GSHEET"?window.totStep=3:window.totStep=2}else d=="GSHEET"&&(window.totStep=b==="csv"?2:3)}function showSampleTable(a,b){var c=JSON.parse(a.responseText);dg=invokeSampleTableScripts(c),addSampleTableToView(dg,!0),ZDBImport.isCreatePending&&(ZDBImport.isCreatePending=!1,ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.import.zdbalertmsg.js.importConfirm"),"ZDBYESNO",{ONCLICK:processCreateTable}))}function refreshJoinCount(a){var b=JSON.parse(a.responseText);if(b.IDENTIFIEDJOINS){$("ZDBJOINTABLE").style.display="block",$("JOINSLIST").value="",$("ZDBImportFileWithRelation")!=null&&$("ZDBImportFileWithRelation").parentNode.removeChild($("ZDBImportFileWithRelation"));if(b.IDENTIFIEDJOINS.length==1)$("ZDBJOINTABLE").innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.suggestLookup",b.IDENTIFIEDJOINS.length),$("ZDBJOINTABLE").style.marginRight="473px";else if(b.IDENTIFIEDJOINS.length>0)$("ZDBJOINTABLE").innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.suggestLookups",b.IDENTIFIEDJOINS.length),$("ZDBJOINTABLE").style.marginRight="473px";else{$("ZDBJOINTABLE").innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.defineLookup"),$("ZDBJOINTABLE").style.marginRight="473px",$("JOINSLIST").value="";var c=document.createElement("div");c.innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.defineLookup"),c.id="ZDBMaxMinSidebar";var d=jQuery(c);d.attr("class","rec movableAddNewTabGreen"),jQuery(c).bind("click",function(){ZDBCreateDB.showRelDialog()})}}else $("ZDBJOINTABLE")!=undefined&&($("ZDBJOINTABLE").style.display="none")}function invokeSampleTableScripts(a){var b=new ZDBDataGrid;if(a.grid_param)for(key in a.grid_param)b[key]=a.grid_param[key];b.init(),a.JSONNodePath&&b.setJSONNodePath(a.JSONNodePath),a.colHead&&b.setColumnHeaders(a.colHead),a.refreshRows&&b.refreshRows(a.refreshRows),a.csvConfig&&setDefaultCSVConfig.apply(b,a.csvConfig);if(a.IDENTIFIEDJOINS){$("ZDBJOINTABLE").style.display="block",$("ZDBImportFileWithRelation")!=null&&$("ZDBImportFileWithRelation").parentNode.removeChild($("ZDBImportFileWithRelation"));if(a.IDENTIFIEDJOINS.length==1)$("ZDBJOINTABLE").innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.suggestLookup",a.IDENTIFIEDJOINS.length),$("ZDBJOINTABLE").style.marginRight="473px";else if(a.IDENTIFIEDJOINS.length>0)$("ZDBJOINTABLE").innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.suggestLookups",a.IDENTIFIEDJOINS.length),$("ZDBJOINTABLE").style.marginRight="473px";else{$("ZDBJOINTABLE").innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.defineLookup"),$("ZDBJOINTABLE").style.marginRight="473px",$("JOINSLIST").value="";var c=document.createElement("div");c.innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.defineLookup"),c.id="ZDBMaxMinSidebar";var d=jQuery(c);d.attr("class","rec movableAddNewTabGreen"),jQuery(c).bind("click",function(){ZDBCreateDB.showRelDialog()})}}else $("ZDBJOINTABLE")!=undefined&&($("ZDBJOINTABLE").style.display="none");return b}function processCreateTable(a,b){a=="YES"?ZDBImport.importTable(!1):ZDBImport.isCreatePending=!1}function addSampleTableToView(a,b){a.isForImport&&(a.reorderDisabled=!0,a.updateNavigationDisabled=!0);var c=a.colHeaders,d=c.length,e=$("SampleTableHolder");e.style.visibility="hidden";var f=window.sampleTableGrid;f!=null&&f.gArea.parentNode==e?(e.replaceChild(a.gArea,f.gArea),ZDBDataGrid.removeInstance(f.ID)):e.appendChild(a.gArea),a.resizeGrid(e.offsetWidth+2,e.offsetHeight-18);if(ZDBGlobal.IS_MOBILE&&!a.scroller){var g={V_SCROLL_ELS:[a.rhArea],H_SCROLL_ELS:[a.chArea]};a.scroller=new ZRScroller(a.dArea,g)}sampleTableGrid=a,resetDuplicateHeads(a),a.existImport=a.originalColInfo?!0:!1,a.originalColInfo?setDatatypeEditor(a,!1):setDatatypeEditor(a,!0),setIgnoreImportCheckBox(a),a.showTable(),b?e.style.visibility="visible":e.style.visibility="hidden",a.selectable=!1;var h=c.length,i;for(var j=0;j<h;++j)i=c[j],i.objType==ZDBConst.COLHEAD&&resetColIndex(i);$("HEADERHELP")!=undefined&&($("HEADERHELP").style.marginLeft="367px"),d>5?a.resizeGrid(e.offsetWidth-28,134):(a.resizeGrid(646,134),$("HEADERHELP")!=undefined&&($("HEADERHELP").style.marginLeft="89px"))}function getIndex(a,b){var c=a.length,d=b.displayName.toUpperCase();for(var e=0;e<c;++e)if(a[e]!=b&&a[e].displayName.toUpperCase()==d)return e;return-1}function getNewName(a){return a+"_dup"}function resetDuplicateHeads(a){var b=a.colHeaders,c=b.length;for(var d=0;d<c;++d){var e=b[d];if(e.objType!==ZDBConst.COLHEAD)continue;var f=getIndex(b,e),g=e.displayName;g.toUpperCase()=="__ZDBID"&&(f=d);while(f>=0){g=getNewName(g);if(!b[f].setValue(g))continue;f=getIndex(b,e)}}}function onDataTypeChange(a){var b=window.event?window.event.srcElement:a.target,c=b.selectedIndex,d=b.cellObj;if(b[c].getAttribute("zdbDisabled")=="true")return ZDBMsgBox.showHintMsg(ZDBI18NMap.g("zrpt.common.import.hintmsg.js.lookUpColChoosingNotPosErr")),b.selectedIndex=d.colObj.previousIndex,!1;d.originalValue=b[b.selectedIndex].value}function onColListChange(a){var b=a.selectedIndex,c=a.cellObj,d=c.colObj;if(a[b].getAttribute("zdbDisabled")=="true")return alert(ZDBI18NMap.f("zrpt.common.browser.alert.js.existImpColMapErr",a[b].value)),a.selectedIndex=c.colObj.previousIndex,!1;var e=d.parGrid,f=a[b];b!=0&&(setDisableFlag(e,b,!0),f.setAttribute("zdbDisabled","false"),f.removeAttribute("disabled")),setDisableFlag(e,d.previousIndex,!1),d.previousIndex=b;var g=f.value;if(b==0){var h=e.originalColInfo,i=h.length;for(var j=0;j<i;++j)h[j][1]==g&&(g=getNewName(g),j=0)}setUniqueColumnName(d,g),importReset(d),setForExistColumn(d,b==0)}function setUniqueColumnName(a,b){while(!a.setValue(b))b=getNewName(b)}function setForExistColumn(a,b){var c=a.dataType;if(b==1)setEnableListItem(!1,c,"defaultvaltype","REFCOL",optionNotSupported),setEnableListItem(!1,c,"defaultvaltype","RELCOL",optionNotSupported),setEnableListItem(!1,c,"defaultvaltype","AUTO_NUMBER",optionNotSupported),c.removeAttribute("disabled"),c.selectedIndex=getDataIndex(c,"defaultvaltype",a.defaultType),a.isEditable=!0;else{setEnableListItem(!0,c,"defaultvaltype","REFCOL");var d=a.colList[a.previousIndex].getAttribute("dataType");d.toLowerCase()=="boolean"&&(d="YES/NO DECISION");var e=getDataIndex(c,"defaultvaltype",d);c.selectedIndex=e,c.setAttribute("disabled","true"),a.isEditable=!1}}function setDisableFlag(a,b,c){var d=a.colHeaders,e=d.length;for(var f=0;f<e;++f){if(d[f].objType!=ZDBConst.COLHEAD)continue;var g=d[f].colList;g[b].setAttribute("zdbDisabled",c?"true":"false"),c?g[b].setAttribute("disabled","true"):g[b].removeAttribute("disabled")}}function setIgnoreImportCheckBox(a){var b=a.colHeaders,c=b.length,d=document.getElementById("importCheck").cloneNode(!0);d.removeAttribute("id");for(var e=0;e<c;++e){var f=b[e];if(f.objType!=ZDBConst.COLHEAD)continue;f.isEditable=!0,f.importReset=importReset,f.importNode=d.cloneNode(!0),f.importNode.colObj=f,f.importNode.setAttribute("checked","true"),importReset(f,a),f.cellEl.style.textAlign="left"}}function setCheck(a,b){var c=a.colObj;if(a.getAttribute("checked")=="true")a.className="unchecked",a.setAttribute("checked","false"),c.colList&&(setDisableFlag(c.parGrid,c.previousIndex,!1),c.colList.selectedIndex=0,onColListChange(c.colList,b),c.colList.setAttribute("disabled","true")),c.isEditable=!1,c.dataType.setAttribute("disabled","true");else{a.className="colHeadChecked",a.setAttribute("checked","true");if(c.colList){onColListChange(c.colList,b),c.colList.removeAttribute("disabled");var d=getIndex(c.parGrid.colHeaders,c),e=c.displayName;while(d>=0){e=getNewName(e);if(!c.setValue(e))continue;d=getIndex(c.parGrid.colHeaders,c)}importReset(c)}c.isEditable=!0,c.dataType.removeAttribute("disabled")}return ZDBUtil.clearTextSelection(b),!1}function importReset(a,b){var c=b!=null&&b.hiddenColList!=null?b.hiddenColList:[];if(a&&a.displayNode&&a.displayNode.firstChild){a.colList&&(a.colList.options[0].value=a.displayName);var d=a.cellEl,e=a.importNode;for(var f=0;f<c.length;f++)c[f]==a.displayName&&(a.importNode.className="unchecked",a.importNode.setAttribute("checked","false"));a.checkNode.style.display="block",a.checkNode.appendChild(a.importNode)}}function resetColIndex(a){var b=a.colList;if(b){var c=getDataIndex(b,"value",a.displayName,!0);c<0&&(c=0),b.selectedIndex=c,onColListChange(b)}}function setColumnListEditor(a){var b=ZDBDataGrid.getFirstRowObj(a.rowData,!1),c=document.createElement("select");c.style.width="99%",c.style.height="19px",c.className="normalFont12";var d=document.createElement("option"),e=a.originalColInfo,f=e.length,g=a.colHeaders;for(var h=-1;h<f;++h){var i=d.cloneNode(!1),j,k,l;h==-1?(k=ZDBI18NMap.g("zrpt.table.existimport.step2.js.selColNewCol"),j="(New)",l="PLAIN TEXT"):(k=e[h][1],l=e[h][3],j=k),i.setAttribute("value",j),i.setAttribute("dataType",l),i.innerHTML=ZDBEscapeUtil.encodeForHtml(k),c.appendChild(i)}var m=g.length;for(var h=0;h<m;++h){var n=b.values[h],o=n.colObj;if(o.objType!=ZDBConst.COLHEAD)continue;var p=n.cellEl,q=c.cloneNode(!0);o.previousIndex=0,q.onchange=function(a){onColListChange(this,a)},q.cellObj=n,q[0].setAttribute("value",o.displayName),o.colList=q,q.style.display="block",p.innerHTML="",p.appendChild(q)}}function removeListItem(a,b,c){var d=a.options,e=d.length;for(var f=e-1;f>-1;--f){var g=d[f];g.getAttribute(b).toUpperCase()==c.toUpperCase()&&g.parentNode.removeChild(g)}}function optionNotSupported(a){var b=window.event?window.event.srcElement:a.target,c=b.parentNode,d=c.cellObj,e=d.colObj;return c.selectedIndex=d.colObj.previousIndex,!1}function setEnableListItem(a,b,c,d,e){var f=b.options,g=f.length;for(var h=0;h<g;++h){var i=f[h];i.getAttribute(c).toUpperCase()==d.toUpperCase()&&(i.setAttribute("zdbDisabled",a?"false":"true"),a?i.removeAttribute("disabled"):i.setAttribute("disabled","true"))}}function showprevform(){var a=jQuery(document.body).width();jQuery("#ZDBImportFileWithRelation").animate({left:a}).hide(),document.body.removeChild($("IMPORTFREEZE")),ev.escKeyPressStack.pop(),ZDBToolTip.hide()}function setDatatypeEditor(a,b){var c=a.rowData,d=ZDBDataGrid.getFirstRowIndex(c,!1),e;b?e=c[d]:(setColumnListEditor(a),e=a.rowData[d+1]);var f=e.values.length,g=document.getElementById("IMPORT_DATATYPE");g=g.cloneNode(!0),g.removeAttribute("id"),b&&(removeListItem(g,"defaultvaltype","REFCOL"),removeListItem(g,"defaultvaltype","RELCOL"));var h,i;for(var j=0;j<f;++j){h=e.values[j];if(h.colObj.objType!=ZDBConst.COLHEAD)continue;var i;i=h.cellEl;var k=g.cloneNode(!0);k.onchange=ZDBImport.onDataTypeChange,k.style.width="100%",k.style.display="block",i.innerHTML="",i.appendChild(k),h.colObj.dataType=k,h.colObj.colInfo={},k.cellObj=h;if(h.originalValue=="21")var l=h.colInfo;var m=getDataIndex(k,"defaultvaltype",h.displayValue);m<0&&(m=getDataIndex(k,"display",h.displayValue),m<0&&(m=0)),h.geoInfo&&(k[m].setAttribute("georole",h.geoInfo.role),k[m].setAttribute("geostd",h.geoInfo.std)),k[m].selected=!0,h.colObj.defaultType=k[m].getAttribute("defaultvaltype")}}function setDefaultCSVConfig(a,b,c,d,e,f,g,h){if(e.isValidDateFormat=="false"){var i=ZDBI18NMap.g("zrpt.common.import.custommsg.js.dateFmtHlp");showCustomMessage(i,$("DATEFORMAT")),ZDBImport.canProceed=!1;return}ZDBImport.canProceed=!0;var j=",\t; |",
k="'\"",l=",. '",m=".,",n=j.indexOf(a);n=n<0?0:n;var o=b?k.indexOf(b)+1:0,p=d=="true"?0:1,q=f?l.indexOf(f)+1:0,r=m.indexOf(g),s=document.getElementById("DELIMITER");ZDBImport.curForm=s.form;var t=document.getElementById("QUOTED"),u=document.getElementById("COMMENTCHAR"),v=document.getElementById("FIRSTROWISFIELDS"),w=document.getElementById("THOUSANDSEP"),x=document.getElementById("DECIMALSEP"),y=document.getElementById("FILENAME");c=="#"&&(u.value=c,u.previousValue=c),h!=null&&h!=""&&(y.value=h),s.selectedIndex=n,t.selectedIndex=o,v.selectedIndex=p,w.selectedIndex=q,x.selectedIndex=r;var z=$("ImportLocalDatabaseForm");z||setImportDate(e)}function setImportDate(a){var b=document.getElementById("DATEFORMAT");b.value=a.dateFormat?a.dateFormat:"";if(a.isMultiDate=="true"){var c=ZDBI18NMap.g("zrpt.common.import.custommsg.js.dtFmtConfirm");showCustomMessage(c,ZDBUtil.getParentWithTagName(b,"DIV"))}b.value?ZDBImport.setOnDateDiv(ZDBImport.getSampleDate(b.value),a.dateFormat):ZDBImport.setOnDateDiv(ZDBI18NMap.g("zrpt.common.import.step2.js.noDtCol"),"NODATE")}function enableOption(a,b){var c=a.value,d="";b=="existImport"&&(d="EX"),c=="GSHEET"||c=="ZDOCS"||ZDBImport.isExternalFile(c)?locationSelected(c,b):($("ZDB"+d+"PASTEOPT").disabled=!1,$("ZDB"+d+"FILEOPT").disabled=!1,$("ZDB"+d+"WEBOPT").disabled=!1,$("ZDB"+d+"FTPOPT")!=null&&($("ZDB"+d+"FTPOPT").disabled=!1),$("ZDB"+d+"PASTEOPT").checked&&locationSelected("PASTEDATA",b),$("ZDB"+d+"FILEOPT").checked&&locationSelected("LOCALDRIVE",b),$("ZDB"+d+"WEBOPT").checked&&locationSelected("WEB",b),$("ZDB"+d+"FTPOPT")!=null&&$("ZDB"+d+"FTPOPT").checked&&locationSelected("FTP",b),changeImportNote(b)),window.divData.fileType=c,c!="ZDOCS"&&!ZDBImport.isExternalFile(c)&&(importStepValUpdate(b),changeTitle())}function changeImportNote(a){var b="";a=="existImport"&&(b="EX");var c="",d=!1,e="",f=["PASTEOPT","WEBOPT","FILEOPT","FTPOPT"];for(var g=0;g<f.length;g++)if($("ZDB"+b+f[g])!=null&&$("ZDB"+b+f[g]).checked){c=f[g],e=f[g];break}c=="FTPOPT"&&(d=!0);if($("ZDBAUTHURL")!=undefined&&$("ZDBAUTHURL").className=="inputSelected"||c=="WEBOPT")c+="_AUTH_DESC";c+="_"+$("ZDB"+b+"FILETYPE").value,e+="_"+$("ZDB"+b+"FILETYPE").value+"_LINK";var h=ZDBUtil.getParentWithTagName($("ZDB"+b+"InputURL"),"div");h!=null&&($("SAMPLEURLLINK").innerHTML=$(e).innerHTML),$("ZDB"+b+"FILETYPE").value!="ZDOCS"&&!ZDBImport.isExternalFile($("ZDB"+b+"FILETYPE").value)&&$(c)!=null&&($(b+"IMPNOTEDESC").innerHTML=$(c).innerHTML,h!=null&&$("SAMPLEURLLINK").setAttribute("CURPREFIX",b)),d&&changeFTPFilePathHelp($("ZDB"+b+"FILETYPE").value)}function fillURL(a){var b=$("SAMPLEURLLINK").getAttribute("CURPREFIX");$("ZDB"+b+"InputURL").setAttribute("tipShown","false"),$("ZDB"+b+"InputURL").style.color="black",$("ZDB"+b+"InputURL").style.fontStyle="normal",$("ZDB"+b+"InputURL").style.fontSize="12px",$("ZDB"+b+"InputURL").value=a.getAttribute("href"),jQuery("ZDB"+b+"InputURL").focus()}function showAUTHURLInp(a,b){hideCustomMessage(),$("ZDBAUTHURLINP").style.display=a?"block":"none",$("ZDBAUTHURL").className=a?"inputSelected":"inputDeselected",$("ZDBUNAUTHURL").className=a?"inputDeselected":"inputSelected",changeImportNote(b),a||($("ZDBUSERNAME").value="",$("ZDBPASSWORD").value="")}function submitHtmlForm(a,b){var c=$("ZDBIMPFILETYPE").value,d="false",e=c,f;$("ZDBFILESUBTYPE")&&(f=$("ZDBFILESUBTYPE").value),c=="GSHEET"&&(d=$("ISFROMGDRIVE").value,e=$("ZDBGDRIVEFORMAT").value);var g=!1;return c=="HTML"||(c=="ZDOCS"||ZDBImport.isExternalFile(c))&&f=="HTML"||d=="true"&&(e.toUpperCase()=="HTM"||e.toUpperCase()=="HTML")?g=ZDBImport.getSelectTables():c!="XLS"&&(c!="ZDOCS"&&!ZDBImport.isExternalFile(c)||f!="XLS"&&f!="XLSX")&&c!="GSHEET"&&c!="XLSX"?alert(ZDBI18NMap.g("zrpt.common.browser.alert.js.unKnownFile")):(g=ZDBXLSImport.getSelectSheet(),$("IMPORTHIDDENROWS").value=$("ZDBHiddenRows").checked,$("IMPORTHIDDENCOLS").value=$("ZDBHiddenCols").checked),g?(AjaxAPI.submit(a),!1):!1}function changeTitle(){$("zdbImportTableTitle")?$("zdbImportTableTitle").innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.importcsv",window.curStep,window.totStep):$("zdbImportDBTitle")?$("zdbImportDBTitle").innerHTML=ZDBI18NMap.f("zrpt.home.import.step1.js.createdb",window.curStep,window.totStep):$("zdbExImportTableTitle")&&($("zdbExImportTableTitle").innerHTML=ZDBI18NMap.f("zrpt.toolbar.import.js.sametable",window.curStep,window.totStep))}function showHomeFrmExistImp(){window.homeFrm.style.display="none",$("ZDBEXCreateDBCntTd").appendChild(window.homeFrm);var a=window.divData.importVia,b=window.divData.fileType;$("ZDBEXPASTEOPT").checked=a=="PASTEDATA",$("ZDBEXFILEOPT").checked=a=="LOCALDRIVE",$("ZDBEXFTPOPT")!=null&&($("ZDBEXFTPOPT").checked=a=="FTP"),$("ZDBEXWEBOPT").checked=a=="WEB"||a=="GSHEET"||a=="ZDOCS"||ZDBImport.isExternalFile(a),window.impFrm.parentNode.removeChild(window.impFrm),window.homeFrm.style.display="block",$("CHECKFORALERT").value="true",window.impFrm=window.homeFrm,window.curStep=window.curStep-1,changeTitle()}function showPrevFrmExistImp(){window.prevDBFrm.style.display="none",$("ZDBEXCreateDBCntTd").appendChild(window.prevDBFrm);var a=window.divData.importVia,b=window.divData.fileType;if(b=="CSV"||b=="XLS"&&a=="PASTEDATA")$("ZDBEXFILETYPE").value="CSV",$("ZDBEXPASTEOPT").checked=a=="PASTEDATA",$("ZDBEXFILEOPT").checked=a=="LOCALDRIVE",$("ZDBEXWEBOPT").checked=a=="WEB",$("ZDBEXFTPOPT")!=null&&($("ZDBEXFTPOPT").checked=a=="FTP");window.impFrm.parentNode.removeChild(window.impFrm),window.prevDBFrm.style.display="block",$("CHECKFORALERT").value="true",window.impFrm=window.prevDBFrm,window.curStep=window.curStep-1,changeTitle()}function tableSelected(a){$("scraptbl_"+a).checked=!0}function hideMsg(){}function showMoreImportOptions(){jQuery("#ZDBHOMEMOREIMPOPTS").slideToggle("slow",function(){var a=$("ZDBMOREIMPOPTSLINK");a.getAttribute("mode")=="more"?(a.innerHTML=ZDBI18NMap.g("zrpt.common.import.custommsg.js.less_imp_opts"),a.setAttribute("mode","less")):(a.innerHTML=ZDBI18NMap.g("zrpt.common.import.custommsg.js.more_imp_opts"),a.setAttribute("mode","more"))})}function showDatabases(a){var b="ZDBACTION=DBNAMES&CONID="+a;AjaxAPI.sendRequest({URL:"/RDBAction.ma?",PARAMETERS:b,ONSUCCESSFUNC:"ZDBCreateDB.showDatabases"})}function changeFTPFilePathHelp(a){var b=$("FTPPATHHELP");a=a.toLowerCase();var c="zrpt.home.import.step1.filepathhelp."+a,d=document.getElementById(c),e=d!=null&&d!=undefined?d.getAttribute("value"):"";b.setAttribute("tip",e)}function ZRUserAnalytics(a){this.module=null,this.USERANALYTICSID=null,this.action=null,this.subModule=null,this.isSuccess=null,this.additionalParams=null,this.EMAIL=null,this.ZUID=null,this.loggedInfo=["USERID,EMAILID,ACTION,MODULE,ISSUCCESS"],this.logCount,this.timers=null,this.limit,this.pushUsageToServer=function(a,b,c,d,e,f){if(!ZDBGlobal.isUserAnalyticsEnabled)return;c||(c=this.module),d||(d=this.isSuccess);if(!a||!b||!this.USERANALYTICSID||!this.ZUID||!this.EMAIL||!c||!d)return;e&&e instanceof Object&&!(e instanceof Array)&&(this.additionalParams=this.merge(this.additionalParams,e)),this.action=a;var g=new Date;g=g.getTime();var h={LOGGERID:this.USERANALYTICSID,USERID:this.ZUID,EMAIL:encodeURIComponent(this.EMAIL),TIMEOFREQUEST:g,ACTION:encodeURIComponent(a),SUBMODULE:encodeURIComponent(b),MODULE:encodeURIComponent(c),ISSUCCESS:d,ADDITIONALPARAMS:this.additionalParams,TIMERVALUE:f},i=ZDBUtil.getValueFromLocal("ualog");if(i){var j=JSON.parse(ZDBUtil.getValueFromLocal("ualog")),k="ualog_"+Math.random().toString(36).substring(2);ZDBUtil.deleteValueFromLocal("ualog"),j[k]=h,ZDBUtil.setValueToLocal("ualog",JSON.stringify(j)),this.logCount++,this.logCount>=this.limit?(this.pushToServer(),this.logCount=0,ZDBUtil.setValueToLocal("ualogcount",0),ZDBUtil.deleteValueFromLocal("ualog")):ZDBUtil.setValueToLocal("ualogcount",this.logCount)}else{var j={},k="ualog_"+Math.random().toString(36).substring(2);j[k]=h,ZDBUtil.setValueToLocal("ualog",JSON.stringify(j)),this.logCount++,ZDBUtil.setValueToLocal("ualogcount",this.logCount)}},this.pushToServer=function(){var a="PARAMS="+ZDBUtil.getValueFromLocal("ualog")+"&LOGGEDINFO="+this.loggedInfo.toString,b="/ZRUserAnalytics.ma?ZDBACTION=LOGUSAGE";AjaxAPI.sendRequest({URL:b,PARAMETERS:a,METHOD:"GET",ONFAILUREFUNC:function(){void 0}})},this.initializeValues=function(a){if(!a)return;this.module=a.MODULE,this.USERANALYTICSID=a.USERANALYTICSID,this.isSuccess="NA",this.additionalParams=a.ADDITIONALPARAMS,this.EMAIL=a.EMAILID,this.ZUID=a.ZUID,this.timers={},this.limit=a.LIMIT,this.logCount=parseInt(ZDBUtil.getValueFromLocal("ualogcount"))||0;for(var b in this.additionalParams)this.additionalParams.hasOwnProperty(b)&&this.loggedInfo.push(b)},this.merge=function(a,b){var c={};return this.combineValues(c,a),this.combineValues(c,b),c},this.combineValues=function(a,b){for(var c in b)typeof b[c]=="object"?(typeof a[c]!="object"&&(a[c]={}),this.extend(a[c],b[c])):b.hasOwnProperty(c)&&(a[c]=b[c])},this.initialize=function(a){this.initializeValues(a)},this.initialize(a)}function ZRUserAnalyticsTimer(a){this.module=a,this.timerValue=1,this.timerController,this.timerStarted=!1;var b;this.startTimer=function(){this.timerStarted=!0,b=this,this.timerController=setInterval(this.timeOutFunc,1e3)},this.timeOutFunc=function(){b.timerValue<1800?b.timerValue++:b.stopTimer()},this.stopTimer=function(){clearInterval(this.timerController),this.timerValue=0,this.timerStarted=!1},this.getTime=function(){return this.timerValue}}(function(a,b){function c(a){return K.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function d(a){if(!cp[a]){var b=H.body,c=K("<"+a+">").appendTo(b),d=c.css("display");c.remove();if(d==="none"||d===""){cq||(cq=H.createElement("iframe"),cq.frameBorder=cq.width=cq.height=0),b.appendChild(cq);if(!cr||!cq.createElement)cr=(cq.contentWindow||cq.contentDocument).document,cr.write((H.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),cr.close();c=cr.createElement(a),cr.body.appendChild(c),d=K.css(c,"display"),b.removeChild(cq)}cp[a]=d}return cp[a]}function e(a,b){var c={};return K.each(cv.concat.apply([],cv.slice(0,b)),function(){c[this]=a}),c}function f(){cw=b}function g(){return setTimeout(f,0),cw=K.now()}function h(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function i(){try{return new a.XMLHttpRequest}catch(b){}}function j(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},f,g,h=d.length,i,j=d[0],k,l,m,n,o;for(f=1;f<h;f++){if(f===1)for(g in a.converters)typeof g=="string"&&(e[g.toLowerCase()]=a.converters[g]);k=j,j=d[f];if(j==="*")j=k;else if(k!=="*"&&k!==j){l=k+" "+j,m=e[l]||e["* "+j];if(!m){o=b;for(n in e){i=n.split(" ");if(i[0]===k||i[0]==="*"){o=e[i[1]+" "+j];if(o){n=e[n],n===!0?m=o:o===!0&&(m=n);break}}}}!m&&!o&&K.error("No conversion from "+l.replace(" "," to ")),m!==!0&&(c=m?m(c):o(n(c)))}}return c}function k(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j)return j!==f[0]&&f.unshift(j),d[j]}function l(a,b,c,d){if(K.isArray(b))K.each(b,function(b,e){c||bR.test(a)?d(a,e):l(a+"["+(typeof e=="object"||K.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)l(a+"["+e+"]",b[e],c,d);else d(a,b)}function m(a,c){var d,e,f=K.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);e&&K.extend(!0,a,e)}function n(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===ce,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=n(a,c,d,e,l,g)));return(k||!l)&&!g["*"]&&(l=n(a,c,d,e,"*",g)),l}function o(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(K.isFunction(c)){var d=b.toLowerCase().split(ca),e=0,f=d.length,g,h,i;for(;e<f;e++)g=d[e],i=/^\+/.test(g),i&&(g=g.substr(1)||"*"),h=a[g]=a[g]||[],h[i?"unshift":"push"](c)}}}function p(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bL:bM,f=0,g=e.length;if(d>0){if(c!=="border")for(;f<g;f++)c||(d-=parseFloat(K.css(a,"padding"+e[f]))||0),c==="margin"?d+=parseFloat(K.css(a,c+e[f]))||0:d-=parseFloat(K.css(a,"border"+e[f]+"Width"))||0;return d+"px"}d=bN(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0;if(c)for(;f<g;f++)d+=parseFloat(K.css(a,"padding"+e[f]))||0,c!=="padding"&&(d+=parseFloat(K.css(a,"border"+e[f]+"Width"))||0),c==="margin"&&(d+=parseFloat(K.css(a,c+e[f]))||0);return d+"px"}function q(a,b){b.src?K.ajax({url:b.src,async:!1,dataType:"script"}):K.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bB,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function r(a){var b=H.createElement("div");return bD.appendChild(b),b.innerHTML=a.outerHTML,b.firstChild}function s(a){var b=(a.nodeName||"").toLowerCase();b==="input"?t(a):b!=="script"&&typeof a.getElementsByTagName!="undefined"&&K.grep(a.getElementsByTagName("input"),t)}function t(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function u(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function v(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(K.expando)}}function w(a,b){if(b.nodeType===1&&!!K.hasData(a)){var c,d,e,f=K._data(a),g=K._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;d<e;d++)K.event.add(b,c+(h[c][d].namespace?".":"")+h[c][d].namespace,h[c][d],h[c][d].data)}g.data&&(g.data=K.extend({},g.data))}}function x(a,b){return K.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function y(a){var b=bp.split("|"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}function z(a,b,c){b=b||0;if(K.isFunction(b))return K.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return K.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=K.grep(a,function(a){return a.nodeType===1});if(bl.test(b))return K.filter(b,d,!c);b=K.filter(b,d)}return K.grep(a,function(a,d){return K.inArray(a,b)>=0===c})}function A(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function B(){return!0}function C(){return!1}function D(a,b,c){var d=b+"defer",e=b+"queue",f=b+"mark",g=K._data(a,d);g&&(c==="queue"||!K._data(a,e))&&(c==="mark"||!K._data(a,f))&&setTimeout(function(){!K._data(a,e)&&!K._data(a,f)&&(K.removeData(a,d,!0),g.fire())},0)}function E(a){for(var b in a){if(b==="data"&&K.isEmptyObject(a[b]))continue;if(b!=="toJSON")return!1}return!0}function F(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(O,"-$1").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:K.isNumeric(d)?parseFloat(d):N.test(d)?K.parseJSON(d):d}catch(f){}K.data(a,c,d)}else d=b}return d}function G(a){var b=L[a]={},c,d;a=a.split(/\s+/);for(c=0,d=a.length;c<d;c++)b[a[c]]=!0;return b}var H=a.document,I=a.navigator,J=a.location,K=function(){function c(){if(!d.isReady){try{H.documentElement.doScroll("left")}catch(a){setTimeout(c,1);return}d.ready()}}var d=function(a,b){return new d.fn.init(a,b,g)},e=a.jQuery,f=a.$,g,h=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,i=/\S/,j=/^\s+/,k=/\s+$/,l=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,m=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,p=/(?:^|:|,)(?:\s*\[)+/g,q=/(webkit)[ \/]([\w.]+)/,r=/(opera)(?:.*version)?[ \/]([\w.]+)/,s=/(msie) ([\w.]+)/,t=/(mozilla)(?:.*? rv:([\w.]+))?/,u=/-([a-z]|[0-9])/ig,v=/^-ms-/,w=function(a,b){return(b+"").toUpperCase()},x=I.userAgent,y,z,A,B=Object.prototype.toString,C=Object.prototype.hasOwnProperty,D=Array.prototype.push,E=Array.prototype.slice,F=String.prototype.trim,G=Array.prototype.indexOf,J={};return d.fn=d.prototype={constructor:d,init:function(a,c,e){var f,g,i,j;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(a==="body"&&!c&&H.body)return this.context=H,this[0]=H.body,this.selector=a,this.length=1,this;if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?f=h.exec(a):f=[null,a,null];if(f&&(f[1]||!c)){if(f[1])return c=c instanceof d?c[0]:c,j=c?c.ownerDocument||c:H,i=l.exec(a),i?d.isPlainObject(c)?(a=[H.createElement(i[1])],d.fn.attr.call(a,c,!0)):a=[j.createElement(i[1])]:(i=d.buildFragment([f[1]],[j]),a=(i.cacheable?d.clone(i.fragment):i.fragment).childNodes),d.merge(this,a);g=H.getElementById(f[2]);if(g&&g.parentNode){if(g.id!==f[2])return e.find(a);this.length=1,this[0]=g}return this.context=H,this.selector=a,this}return!c||c.jquery?(c||e).find(a):this.constructor(c).find(a)}return d.isFunction(a)?e.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),d.makeArray(a,this))},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return E.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var e=this.constructor();return d.isArray(a)?D.apply(e,a):d.merge(e,a),e.prevObject=this,e.context=this.context,b==="find"?e.selector=this.selector+(this.selector?" ":"")+c:b&&(e.selector=this.selector+"."+b+"("+c+")"),e},each:function(a,b){return d.each(this,a,b)},ready:function(a){return d.bindReady(),z.add(a),this},eq:function(a){return a=+a,a===-1?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(E.apply(this,arguments),"slice",E.call(arguments).join(","))},map:function(a){return this.pushStack(d.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:D,sort:[].sort,splice:[].splice},d.fn.init.prototype=d.fn,d.extend=d.fn.extend=function(){var a,c,e,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!d.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){e=i[c],f=a[c];if(i===f)continue;l&&f&&(d.isPlainObject(f)||(g=d.isArray(f)))?(g?(g=!1,h=e&&d.isArray(e)?e:[]):h=e&&d.isPlainObject(e)?e:{},i[c]=d.extend(l,h,f)):f!==b&&(i[c]=f)}return i},d.extend({noConflict:function(b){return a.$===d&&(a.$=f),b&&a.jQuery===d&&(a.jQuery=e),d},isReady:!1,readyWait:1,holdReady:function(a){a?d.readyWait++:d.ready(!0)},ready:function(a){if(a===!0&&!--d.readyWait||a!==!0&&!d.isReady){if(!H.body)return setTimeout(d.ready,1);d.isReady=!0;if(a!==!0&&--d.readyWait>0)return;z.fireWith(H,[d]),d.fn.trigger&&d(H).trigger("ready").off("ready")}},bindReady:function(){if(!z){z=d.Callbacks("once memory");if(H.readyState==="complete")return setTimeout(d.ready,1);if(H.addEventListener)H.addEventListener("DOMContentLoaded",A,!1),a.addEventListener("load",d.ready,!1);else if(H.attachEvent){H.attachEvent("onreadystatechange",A),a.attachEvent("onload",d.ready);var b=!1;try{b=a.frameElement==null}catch(e){}H.documentElement.doScroll&&b&&c()}}},isFunction:function(a){return d.type(a)==="function"},isArray:Array.isArray||function(a){return d.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return a==null?String(a):J[B.call(a)]||"object"},isPlainObject:function(a){if(!a||d.type(a)!=="object"||a.nodeType||d.isWindow(a))return!1;try{if(a.constructor&&!C.call(a,"constructor")&&!C.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var e;for(e in a);return e===b||C.call(a,e)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=d.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(m.test(b.replace(n,"@").replace(o,"]").replace(p,"")))return(new Function("return "+b))();d.error("Invalid JSON: "+b)},parseXML:function(c){var e,f;try{a.DOMParser?(f=new DOMParser,e=f.parseFromString(c,"text/xml")):(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(c))}catch(g){e=b}return(!e||!e.documentElement||e.getElementsByTagName("parsererror").length)&&d.error("Invalid XML: "+c),e},noop:function(){},globalEval:function(b){b&&i.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(v,"ms-").replace(u,w)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,e){var f,g=0,h=a.length,i=h===b||d.isFunction(a);if(e){if(i){for(f in a)if(c.apply(a[f],e)===!1)break}else for(;g<h;)if(c.apply(a[g++],e)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:F?function(a){return a==null?"":F.call(a)}:function(a){return a==null?"":(a+"").replace(j,"").replace(k,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var e=d.type(a);a.length==null||e==="string"||e==="function"||e==="regexp"||d.isWindow(a)?D.call(c,a):d.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(G)return G.call(b,a,c);d=b.length,c=c?c<0?Math.max(0,d+c):c:0;for(;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];return a.length=d,a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,e){var f,g,h=[],i=0,j=a.length,k=a instanceof d||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||d.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,e),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,e),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var e=a[c];c=a,a=e}if(!d.isFunction(a))return b;var f=E.call(arguments,2),g=function(){return a.apply(c,f.concat(E.call(arguments)))};return g.guid=a.guid=a.guid||g.guid||d.guid++,g},access:function(a,c,e,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)d.access(a,j,c[j],f,g,e);return a}if(e!==b){f=!h&&f&&d.isFunction(e);for(var k=0;k<i;k++)g(a[k],c,f?e.call(a[k],k,g(a[k],c)):e,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=q.exec(a)||r.exec(a)||s.exec(a)||a.indexOf("compatible")<0&&t.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}d.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(c,e){return e&&e instanceof d&&!(e instanceof a)&&(e=a(e)),d.fn.init.call(this,c,e,b)},a.fn.init.prototype=a.fn;var b=a(H);return a},browser:{}}),d.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){J["[object "+b+"]"]=b.toLowerCase()}),y=d.uaMatch(x),y.browser&&(d.browser[y.browser]=!0,d.browser.version=y.version),d.browser.webkit&&(d.browser.safari=!0),i.test("")&&(j=/^[\s\xA0]+/,k=/[\s\xA0]+$/),g=d(H),H.addEventListener?A=function(){H.removeEventListener("DOMContentLoaded",A,!1),d.ready()}:H.attachEvent&&(A=function(){H.readyState==="complete"&&(H.detachEvent("onreadystatechange",A),d.ready())}),d}(),L={};K.Callbacks=function(a){a=a?L[a]||G(a):{};var c=[],d=[],e,f,g,h,i,j=function(b){var d,e,f,g,h;for(d=0,e=b.length;d<e;d++)f=b[d],g=K.type(f),g==="array"?j(f):g==="function"&&(!a.unique||!l.has(f))&&c.push(f)},k=function(b,j){j=j||[],e=!a.memory||[b,j],f=!0,i=g||0,g=0,h=c.length;for(;c&&i<h;i++)if(c[i].apply(b,j)===!1&&a.stopOnFalse){e=!0;break}f=!1,c&&(a.once?e===!0?l.disable():c=[]:d&&d.length&&(e=d.shift(),l.fireWith(e[0],e[1])))},l={add:function(){if(c){var a=c.length;j(arguments),f?h=c.length:e&&e!==!0&&(g=a,k(e[0],e[1]))}return this},remove:function(){if(c){var b=arguments,d=0,e=b.length;for(;d<e;d++)for(var g=0;g<c.length;g++)if(b[d]===c[g]){f&&g<=h&&(h--,g<=i&&i--),c.splice(g--,1);if(a.unique)break}}return this},has:function(a){if(c){var b=0,d=c.length;for(;b<d;b++)if(a===c[b])return!0}return!1},empty:function(){return c=[],this},disable:function(){return c=d=e=b,this},disabled:function(){return!c},lock:function(){return d=b,(!e||e===!0)&&l.disable(),this},locked:function(){return!d},fireWith:function(b,c){return d&&(f?a.once||d.push([b,c]):(!a.once||!e)&&k(b,c)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!e}};return l};var M=[].slice;K.extend({Deferred:function(a){var b=K.Callbacks("once memory"),c=K.Callbacks("once memory"),d=K.Callbacks("memory"),e="pending",f={resolve:b,reject:c,notify:d},g={done:b.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:b.fired,isRejected:c.fired,then:function(a,b,c){return h.done(a).fail(b).progress(c),this},always:function(){return h.done.apply(h,arguments).fail.apply(h,arguments),this},pipe:function(a,b,c){return K.Deferred(function(d){K.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c=b[0],e=b[1],f;K.isFunction(c)?h[a](function(){f=c.apply(this,arguments),f&&K.isFunction(f.promise)?f.promise().then(d.resolve,d.reject,d.notify):d[e+"With"](this===h?d:this,[f])}):h[a](d[e])})}).promise()},promise:function(a){if(a==null)a=g;else for(var b in g)a[b]=g[b];return a}},h=g.promise({}),i;for(i in f)h[i]=f[i].fire,h[i+"With"]=f[i].fireWith;return h.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},b.disable,d.lock),a&&a.call(h,h),h},when:function(a){function b(a){return function(b){g[a]=arguments.length>1?M.call(arguments,0):b,j.notifyWith(k,g)}}function c(a){return function(b){d[a]=arguments.length>1?M.call(arguments,0):b,--h||j.resolveWith(j,d)}}var d=M.call(arguments,0),e=0,f=d.length,g=Array(f),h=f,i=f,j=f<=1&&a&&K.isFunction(a.promise)?a:K.Deferred(),k=j.promise();if(f>1){for(;e<f;e++)d[e]&&d[e].promise&&K.isFunction(d[e].promise)?d[e].promise().then(c(e),j.reject,b(e)):--h;h||j.resolveWith(j,d)}else j!==a&&j.resolveWith(j,f?[a]:[]);return k}}),K.support=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=H.createElement("div"),p=H.documentElement;o.setAttribute("className","t"),o.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",c=o.getElementsByTagName("*"),d=o.getElementsByTagName("a")[0];if(!c||!c.length||!d)return{};e=H.createElement("select"),f=e.appendChild(H.createElement("option")),g=o.getElementsByTagName("input")[0],b={leadingWhitespace:o.firstChild.nodeType===3,tbody:!o.getElementsByTagName("tbody").length,htmlSerialize:!!o.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:d.getAttribute("href")==="/a",opacity:/^0.55/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:g.value==="on",optSelected:f.selected,getSetAttribute:o.className!=="t",enctype:!!H.createElement("form").enctype,html5Clone:H.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},g.checked=!0,b.noCloneChecked=g.cloneNode(!0).checked,e.disabled=!0,b.optDisabled=!f.disabled;try{delete o.test}catch(q){b.deleteExpando=!1}!o.addEventListener&&o.attachEvent&&o.fireEvent&&(o.attachEvent("onclick",function(){b.noCloneEvent=!1}),o.cloneNode(!0).fireEvent("onclick")),g=H.createElement("input"),g.value="t",g.setAttribute("type","radio"),b.radioValue=g.value==="t",g.setAttribute("checked","checked"),o.appendChild(g),i=H.createDocumentFragment(),i.appendChild(o.lastChild),b.checkClone=i.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=g.checked,i.removeChild(g),i.appendChild(o),o.innerHTML="",a.getComputedStyle&&(h=H.createElement("div"),h.style.width="0",h.style.marginRight="0",o.style.width="2px",o.appendChild(h),b.reliableMarginRight=(parseInt((a.getComputedStyle(h,null)||{marginRight:0}).marginRight,10)||0)===0);if(o.attachEvent)for(m in{submit:1,change:1,focusin:1})l="on"+m,n=l in o,n||(o.setAttribute(l,"return;"),n=typeof o[l]=="function"),b[m+"Bubbles"]=n;return i.removeChild(o),i=e=f=h=o=g=null,K(function(){var a,c,d,e,f,g,h,i,k,l,m,p=H.getElementsByTagName("body")[0];!p||(h=1,i="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;",k="visibility:hidden;border:0;",l="style='"+i+"border:5px solid #000;padding:0;'",m="<div "+l+"><div></div></div>"+"<table "+l+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>",a=H.createElement("div"),a.style.cssText=k+"width:0;height:0;position:static;top:0;margin-top:"+h+"px",p.insertBefore(a,p.firstChild),o=H.createElement("div"),a.appendChild(o),o.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",j=o.getElementsByTagName("td"),n=j[0].offsetHeight===0,j[0].style.display="",j[1].style.display="none",b.reliableHiddenOffsets=n&&j[0].offsetHeight===0,o.innerHTML="",o.style.width=o.style.paddingLeft="1px",K.boxModel=b.boxModel=o.offsetWidth===2,typeof o.style.zoom!="undefined"&&(o.style.display="inline",o.style.zoom=1,b.inlineBlockNeedsLayout=o.offsetWidth===2,o.style.display="",o.innerHTML="<div style='width:4px;'></div>",b.shrinkWrapBlocks=o.offsetWidth!==2),o.style.cssText=i+k,o.innerHTML=m,c=o.firstChild,d=c.firstChild,f=c.nextSibling.firstChild.firstChild,g={doesNotAddBorder:d.offsetTop!==5,doesAddBorderForTableAndCells:f.offsetTop===5},d.style.position="fixed",d.style.top="20px",g.fixedPosition=d.offsetTop===20||d.offsetTop===15,d.style.position=d.style.top="",c.style.overflow="hidden",c.style.position="relative",g.subtractsBorderForOverflowNotVisible=d.offsetTop===-5,g.doesNotIncludeMarginInBodyOffset=p.offsetTop!==h,p.removeChild(a),o=a=null,K.extend(b,g))}),b}();var N=/^(?:\{.*\}|\[.*\])$/,O=/([A-Z])/g;K.extend({cache:{},uuid:0,expando:"jQuery"+(K.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?K.cache[a[K.expando]]:a[K.expando],!!a&&!E(a)},data:function(a,c,d,e){if(!!K.acceptData(a)){var f,g,h,i=K.expando,j=typeof c=="string",k=a.nodeType,l=k?K.cache:a,m=k?a[i]:a[i]&&i,n=c==="events";if((!m||!l[m]||!n&&!e&&!l[m].data)&&j&&d===b)return;m||(k?a[i]=m=++K.uuid:m=i),l[m]||(l[m]={},k||(l[m].toJSON=K.noop));if(typeof c=="object"||typeof c=="function")e?l[m]=K.extend(l[m],c):l[m].data=K.extend(l[m].data,c);return f=g=l[m],e||(g.data||(g.data={}),g=g.data),d!==b&&(g[K.camelCase(c)]=d),n&&!g[c]?f.events:(j?(h=g[c],h==null&&(h=g[K.camelCase(c)])):h=g,h)}},removeData:function(a,b,c){if(!!K.acceptData(a)){var d,e,f,g=K.expando,h=a.nodeType,i=h?K.cache:a,j=h?a[g]:g;if(!i[j])return;if(b){d=c?i[j]:i[j].data;if(d){K.isArray(b)||(b in d?b=[b]:(b=K.camelCase(b),b in d?b=[b]:b=b.split(" ")));for(e=0,f=b.length;e<f;e++)delete d[b[e]];if(!(c?E:K.isEmptyObject)(d))return}}if(!c){delete i[j].data;if(!E(i[j]))return}K.support.deleteExpando||!i.setInterval?delete i[j]:i[j]=null,h&&(K.support.deleteExpando?delete a[g]:a.removeAttribute?a.removeAttribute(g):a[g]=null)}},_data:function(a,b,c){return K.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=K.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),K.fn.extend({data:function(a,c){var d,e,f,g=null;if(typeof a=="undefined"){if(this.length){g=K.data(this[0]);if(this[0].nodeType===1&&!K._data(this[0],"parsedAttrs")){e=this[0].attributes;for(var h=0,i=e.length;h<i;h++)f=e[h].name,f.indexOf("data-")===0&&(f=K.camelCase(f.substring(5)),F(this[0],f,g[f]));K._data(this[0],"parsedAttrs",!0)}}return g}return typeof a=="object"?this.each(function(){K.data(this,a)}):(d=a.split("."),d[1]=d[1]?"."+d[1]:"",c===b?(g=this.triggerHandler("getData"+d[1]+"!",[d[0]]),g===b&&this.length&&(g=K.data(this[0],a),g=F(this[0],a,g)),g===b&&d[1]?this.data(d[0]):g):this.each(function(){var b=K(this),e=[d[0],c];b.triggerHandler("setData"+d[1]+"!",e),K.data(this,a,c),b.triggerHandler("changeData"+d[1]+"!",e)}))},removeData:function(a){return this.each(function(){K.removeData(this,a)})}}),K.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",K._data(a,b,(K._data(a,b)||0
)+1))},_unmark:function(a,b,c){a!==!0&&(c=b,b=a,a=!1);if(b){c=c||"fx";var d=c+"mark",e=a?0:(K._data(b,d)||1)-1;e?K._data(b,d,e):(K.removeData(b,d,!0),D(b,c,"mark"))}},queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=K._data(a,b),c&&(!d||K.isArray(c)?d=K._data(a,b,K.makeArray(c)):d.push(c)),d||[]},dequeue:function(a,b){b=b||"fx";var c=K.queue(a,b),d=c.shift(),e={};d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),K._data(a,b+".run",e),d.call(a,function(){K.dequeue(a,b)},e)),c.length||(K.removeData(a,b+"queue "+b+".run",!0),D(a,b,"queue"))}}),K.fn.extend({queue:function(a,c){return typeof a!="string"&&(c=a,a="fx"),c===b?K.queue(this[0],a):this.each(function(){var b=K.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&K.dequeue(this,a)})},dequeue:function(a){return this.each(function(){K.dequeue(this,a)})},delay:function(a,b){return a=K.fx?K.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function d(){--h||e.resolveWith(f,[f])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var e=K.Deferred(),f=this,g=f.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=K.data(f[g],i,b,!0)||(K.data(f[g],j,b,!0)||K.data(f[g],k,b,!0))&&K.data(f[g],i,K.Callbacks("once memory"),!0))h++,l.add(d);return d(),e.promise()}});var P=/[\n\t\r]/g,Q=/\s+/,R=/\r/g,S=/^(?:button|input)$/i,T=/^(?:button|input|object|select|textarea)$/i,U=/^a(?:rea)?$/i,V=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,W=K.support.getSetAttribute,X,Y,Z;K.fn.extend({attr:function(a,b){return K.access(this,a,b,!0,K.attr)},removeAttr:function(a){return this.each(function(){K.removeAttr(this,a)})},prop:function(a,b){return K.access(this,a,b,!0,K.prop)},removeProp:function(a){return a=K.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,h;if(K.isFunction(a))return this.each(function(b){K(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(Q);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{f=" "+e.className+" ";for(g=0,h=b.length;g<h;g++)~f.indexOf(" "+b[g]+" ")||(f+=b[g]+" ");e.className=K.trim(f)}}}return this},removeClass:function(a){var c,d,e,f,g,h,i;if(K.isFunction(a))return this.each(function(b){K(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(Q);for(d=0,e=this.length;d<e;d++){f=this[d];if(f.nodeType===1&&f.className)if(a){g=(" "+f.className+" ").replace(P," ");for(h=0,i=c.length;h<i;h++)g=g.replace(" "+c[h]+" "," ");f.className=K.trim(g)}else f.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";return K.isFunction(a)?this.each(function(c){K(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if(c==="string"){var e,f=0,g=K(this),h=b,i=a.split(Q);while(e=i[f++])h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&K._data(this,"__className__",this.className),this.className=this.className||a===!1?"":K._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ",c=0,d=this.length;for(;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(P," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,f=this[0];if(!!arguments.length)return e=K.isFunction(a),this.each(function(d){var f=K(this),g;if(this.nodeType===1){e?g=a.call(this,d,f.val()):g=a,g==null?g="":typeof g=="number"?g+="":K.isArray(g)&&(g=K.map(g,function(a){return a==null?"":a+""})),c=K.valHooks[this.nodeName.toLowerCase()]||K.valHooks[this.type];if(!c||!("set"in c)||c.set(this,g,"value")===b)this.value=g}});if(f)return c=K.valHooks[f.nodeName.toLowerCase()]||K.valHooks[f.type],c&&"get"in c&&(d=c.get(f,"value"))!==b?d:(d=f.value,typeof d=="string"?d.replace(R,""):d==null?"":d)}}),K.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,f=a.selectedIndex,g=[],h=a.options,i=a.type==="select-one";if(f<0)return null;c=i?f:0,d=i?f+1:h.length;for(;c<d;c++){e=h[c];if(e.selected&&(K.support.optDisabled?!e.disabled:e.getAttribute("disabled")===null)&&(!e.parentNode.disabled||!K.nodeName(e.parentNode,"optgroup"))){b=K(e).val();if(i)return b;g.push(b)}}return i&&!g.length&&h.length?K(h[f]).val():g},set:function(a,b){var c=K.makeArray(b);return K(a).find("option").each(function(){this.selected=K.inArray(K(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var f,g,h,i=a.nodeType;if(!!a&&i!==3&&i!==8&&i!==2){if(e&&c in K.attrFn)return K(a)[c](d);if(typeof a.getAttribute=="undefined")return K.prop(a,c,d);h=i!==1||!K.isXMLDoc(a),h&&(c=c.toLowerCase(),g=K.attrHooks[c]||(V.test(c)?Y:X));if(d!==b){if(d===null){K.removeAttr(a,c);return}return g&&"set"in g&&h&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,""+d),d)}return g&&"get"in g&&h&&(f=g.get(a,c))!==null?f:(f=a.getAttribute(c),f===null?b:f)}},removeAttr:function(a,b){var c,d,e,f,g=0;if(b&&a.nodeType===1){d=b.toLowerCase().split(Q),f=d.length;for(;g<f;g++)e=d[g],e&&(c=K.propFix[e]||e,K.attr(a,e,""),a.removeAttribute(W?e:c),V.test(e)&&c in a&&(a[c]=!1))}},attrHooks:{type:{set:function(a,b){if(S.test(a.nodeName)&&a.parentNode)K.error("type property can't be changed");else if(!K.support.radioValue&&b==="radio"&&K.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}},value:{get:function(a,b){return X&&K.nodeName(a,"button")?X.get(a,b):b in a?a.value:null},set:function(a,b,c){if(X&&K.nodeName(a,"button"))return X.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;if(!!a&&h!==3&&h!==8&&h!==2)return g=h!==1||!K.isXMLDoc(a),g&&(c=K.propFix[c]||c,f=K.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&(e=f.get(a,c))!==null?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):T.test(a.nodeName)||U.test(a.nodeName)&&a.href?0:b}}}}),K.attrHooks.tabindex=K.propHooks.tabIndex,Y={get:function(a,c){var d,e=K.prop(a,c);return e===!0||typeof e!="boolean"&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;return b===!1?K.removeAttr(a,c):(d=K.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}},W||(Z={name:!0,id:!0},X=K.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(Z[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=H.createAttribute(c),a.setAttributeNode(d)),d.nodeValue=b+""}},K.attrHooks.tabindex.set=X.set,K.each(["width","height"],function(a,b){K.attrHooks[b]=K.extend(K.attrHooks[b],{set:function(a,c){if(c==="")return a.setAttribute(b,"auto"),c}})}),K.attrHooks.contenteditable={get:X.get,set:function(a,b,c){b===""&&(b="false"),X.set(a,b,c)}}),K.support.hrefNormalized||K.each(["href","src","width","height"],function(a,c){K.attrHooks[c]=K.extend(K.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),K.support.style||(K.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),K.support.optSelected||(K.propHooks.selected=K.extend(K.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),K.support.enctype||(K.propFix.enctype="encoding"),K.support.checkOn||K.each(["radio","checkbox"],function(){K.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),K.each(["radio","checkbox"],function(){K.valHooks[this]=K.extend(K.valHooks[this],{set:function(a,b){if(K.isArray(b))return a.checked=K.inArray(K(a).val(),b)>=0}})});var $=/^(?:textarea|input|select)$/i,_=/^([^\.]*)?(?:\.(.+))?$/,ba=/\bhover(\.\S+)?\b/,bb=/^key/,bc=/^(?:mouse|contextmenu)|click/,bd=/^(?:focusinfocus|focusoutblur)$/,be=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,bf=function(a){var b=be.exec(a);return b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)")),b},bg=function(a,b){var c=a.attributes||{};return(!b[1]||a.nodeName.toLowerCase()===b[1])&&(!b[2]||(c.id||{}).value===b[2])&&(!b[3]||b[3].test((c["class"]||{}).value))},bh=function(a){return K.event.special.hover?a:a.replace(ba,"mouseenter$1 mouseleave$1")};K.event={add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(g=K._data(a)))){d.handler&&(o=d,d=o.handler),d.guid||(d.guid=K.guid++),i=g.events,i||(g.events=i={}),h=g.handle,h||(g.handle=h=function(a){return typeof K=="undefined"||!!a&&K.event.triggered===a.type?b:K.event.dispatch.apply(h.elem,arguments)},h.elem=a),c=K.trim(bh(c)).split(" ");for(j=0;j<c.length;j++){k=_.exec(c[j])||[],l=k[1],m=(k[2]||"").split(".").sort(),r=K.event.special[l]||{},l=(f?r.delegateType:r.bindType)||l,r=K.event.special[l]||{},n=K.extend({type:l,origType:k[1],data:e,handler:d,guid:d.guid,selector:f,quick:bf(f),namespace:m.join(".")},o),q=i[l];if(!q){q=i[l]=[],q.delegateCount=0;if(!r.setup||r.setup.call(a,e,m,h)===!1)a.addEventListener?a.addEventListener(l,h,!1):a.attachEvent&&a.attachEvent("on"+l,h)}r.add&&(r.add.call(a,n),n.handler.guid||(n.handler.guid=d.guid)),f?q.splice(q.delegateCount++,0,n):q.push(n),K.event.global[l]=!0}a=null}},global:{},remove:function(a,b,c,d,e){var f=K.hasData(a)&&K._data(a),g,h,i,j,k,l,m,n,o,p,q,r;if(!!f&&!!(n=f.events)){b=K.trim(bh(b||"")).split(" ");for(g=0;g<b.length;g++){h=_.exec(b[g])||[],i=j=h[1],k=h[2];if(!i){for(i in n)K.event.remove(a,i+b[g],c,d,!0);continue}o=K.event.special[i]||{},i=(d?o.delegateType:o.bindType)||i,q=n[i]||[],l=q.length,k=k?new RegExp("(^|\\.)"+k.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(m=0;m<q.length;m++)r=q[m],(e||j===r.origType)&&(!c||c.guid===r.guid)&&(!k||k.test(r.namespace))&&(!d||d===r.selector||d==="**"&&r.selector)&&(q.splice(m--,1),r.selector&&q.delegateCount--,o.remove&&o.remove.call(a,r));q.length===0&&l!==q.length&&((!o.teardown||o.teardown.call(a,k)===!1)&&K.removeEvent(a,i,f.handle),delete n[i])}K.isEmptyObject(n)&&(p=f.handle,p&&(p.elem=null),K.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,f){if(!e||e.nodeType!==3&&e.nodeType!==8){var g=c.type||c,h=[],i,j,k,l,m,n,o,p,q,r;if(bd.test(g+K.event.triggered))return;g.indexOf("!")>=0&&(g=g.slice(0,-1),j=!0),g.indexOf(".")>=0&&(h=g.split("."),g=h.shift(),h.sort());if((!e||K.event.customEvent[g])&&!K.event.global[g])return;c=typeof c=="object"?c[K.expando]?c:new K.Event(g,c):new K.Event(g),c.type=g,c.isTrigger=!0,c.exclusive=j,c.namespace=h.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,n=g.indexOf(":")<0?"on"+g:"";if(!e){i=K.cache;for(k in i)i[k].events&&i[k].events[g]&&K.event.trigger(c,d,i[k].handle.elem,!0);return}c.result=b,c.target||(c.target=e),d=d!=null?K.makeArray(d):[],d.unshift(c),o=K.event.special[g]||{};if(o.trigger&&o.trigger.apply(e,d)===!1)return;q=[[e,o.bindType||g]];if(!f&&!o.noBubble&&!K.isWindow(e)){r=o.delegateType||g,l=bd.test(r+g)?e:e.parentNode,m=null;for(;l;l=l.parentNode)q.push([l,r]),m=l;m&&m===e.ownerDocument&&q.push([m.defaultView||m.parentWindow||a,r])}for(k=0;k<q.length&&!c.isPropagationStopped();k++)l=q[k][0],c.type=q[k][1],p=(K._data(l,"events")||{})[c.type]&&K._data(l,"handle"),p&&p.apply(l,d),p=n&&l[n],p&&K.acceptData(l)&&p.apply(l,d)===!1&&c.preventDefault();return c.type=g,!f&&!c.isDefaultPrevented()&&(!o._default||o._default.apply(e.ownerDocument,d)===!1)&&(g!=="click"||!K.nodeName(e,"a"))&&K.acceptData(e)&&n&&e[g]&&(g!=="focus"&&g!=="blur"||c.target.offsetWidth!==0)&&!K.isWindow(e)&&(m=e[n],m&&(e[n]=null),K.event.triggered=g,e[g](),K.event.triggered=b,m&&(e[n]=m)),c.result}},dispatch:function(c){c=K.event.fix(c||a.event);var d=(K._data(this,"events")||{})[c.type]||[],e=d.delegateCount,f=[].slice.call(arguments,0),g=!c.exclusive&&!c.namespace,h=[],i,j,k,l,m,n,o,p,q,r,s;f[0]=c,c.delegateTarget=this;if(e&&!c.target.disabled&&(!c.button||c.type!=="click")){l=K(this),l.context=this.ownerDocument||this;for(k=c.target;k!=this;k=k.parentNode||this){n={},p=[],l[0]=k;for(i=0;i<e;i++)q=d[i],r=q.selector,n[r]===b&&(n[r]=q.quick?bg(k,q.quick):l.is(r)),n[r]&&p.push(q);p.length&&h.push({elem:k,matches:p})}}d.length>e&&h.push({elem:this,matches:d.slice(e)});for(i=0;i<h.length&&!c.isPropagationStopped();i++){o=h[i],c.currentTarget=o.elem;for(j=0;j<o.matches.length&&!c.isImmediatePropagationStopped();j++){q=o.matches[j];if(g||!c.namespace&&!q.namespace||c.namespace_re&&c.namespace_re.test(q.namespace))c.data=q.data,c.handleObj=q,m=((K.event.special[q.origType]||{}).handle||q.handler).apply(o.elem,f),m!==b&&(c.result=m,m===!1&&(c.preventDefault(),c.stopPropagation()))}}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return a.which==null&&(a.which=b.charCode!=null?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,e,f,g=c.button,h=c.fromElement;return a.pageX==null&&c.clientX!=null&&(d=a.target.ownerDocument||H,e=d.documentElement,f=d.body,a.pageX=c.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=c.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),!a.relatedTarget&&h&&(a.relatedTarget=h===a.target?c.toElement:h),!a.which&&g!==b&&(a.which=g&1?1:g&2?3:g&4?2:0),a}},fix:function(a){if(a[K.expando])return a;var c,d,e=a,f=K.event.fixHooks[a.type]||{},g=f.props?this.props.concat(f.props):this.props;a=K.Event(e);for(c=g.length;c;)d=g[--c],a[d]=e[d];return a.target||(a.target=e.srcElement||H),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey),f.filter?f.filter(a,e):a},special:{ready:{setup:K.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){K.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=K.extend(new K.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?K.event.trigger(e,null,b):K.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},K.event.handle=K.event.dispatch,K.removeEvent=H.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},K.Event=function(a,b){if(!(this instanceof K.Event))return new K.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?B:C):this.type=a,b&&K.extend(this,b),this.timeStamp=a&&a.timeStamp||K.now(),this[K.expando]=!0},K.Event.prototype={preventDefault:function(){this.isDefaultPrevented=B;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=B;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=B,this.stopPropagation()},isDefaultPrevented:C,isPropagationStopped:C,isImmediatePropagationStopped:C},K.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){K.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c=this,d=a.relatedTarget,e=a.handleObj,f=e.selector,g;if(!d||d!==c&&!K.contains(c,d))a.type=e.origType,g=e.handler.apply(this,arguments),a.type=b;return g}}}),K.support.submitBubbles||(K.event.special.submit={setup:function(){if(K.nodeName(this,"form"))return!1;K.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=K.nodeName(c,"input")||K.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(K.event.add(d,"submit._submit",function(a){this.parentNode&&!a.isTrigger&&K.event.simulate("submit",this.parentNode,a,!0)}),d._submit_attached=!0)})},teardown:function(){if(K.nodeName(this,"form"))return!1;K.event.remove(this,"._submit")}}),K.support.changeBubbles||(K.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")K.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),K.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,K.event.simulate("change",this,a,!0))});return!1}K.event.add(this,"beforeactivate._change",function(a){var b=a.target;$.test(b.nodeName)&&!b._change_attached&&(K.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&K.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){return K.event.remove(this,"._change"),$.test(this.nodeName)}}),K.support.focusinBubbles||K.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){K.event.simulate(b,a.target,K.event.fix(a),!0)};K.event.special[b]={setup:function(){c++===0&&H.addEventListener(a,d,!0)},teardown:function(){--c===0&&H.removeEventListener(a,d,!0)}}}),K.fn.extend({on:function(a,c,d,e,f){var g,h;if(typeof a=="object"){typeof c!="string"&&(d=c,c=b);for(h in a)this.on(h,c,d,a[h],f);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c=="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=C;else if(!e)return this;return f===1&&(g=e,e=function(a){return K().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=K.guid++)),this.each(function(){K.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;return K(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler),this}if(typeof a=="object"){for(var f in a)this.off(f,c,a[f]);return this}if(c===!1||typeof c=="function")d=c,c=b;return d===!1&&(d=C),this.each(function(){K.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return K(this.context).on(a,this.selector,b,c),this},die:function(a,b){return K(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){K.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return K.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||K.guid++,d=0,e=function(c){var e=(K._data(this,"lastToggle"+a.guid)||0)%d;return K._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),K.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){K.fn[b]=function(a,c){return c==null&&(c=a,a=null),arguments.length>0?this.on(b,null,a,c):this.trigger(b)},K.attrFn&&(K.attrFn[b]=!0),bb.test(b)&&(K.event.fixHooks[b]=K.event.keyHooks),bc.test(b)&&(K.event.fixHooks[b]=K.event.mouseHooks)}),function(){function a(a,b,c,d,f,g){for(var h=0,i=d.length;h<i;h++){var j=d[h];if(j){var k=!1;j=j[a];while(j){if(j[e]===c){k=d[j.sizset];break}if(j.nodeType===1){g||(j[e]=c,j.sizset=h);if(typeof b!="string"){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}}j=j[a]}d[h]=k}}}function c(a,b,c,d,f,g){for(var h=0,i=d.length;h<i;h++){var j=d[h];if(j){var k=!1;j=j[a];while(j){if(j[e]===c){k=d[j.sizset];break}j.nodeType===1&&!g&&(j[e]=c,j.sizset=h);if(j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}d[h]=k}}}var d=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e="sizcache"+(Math.random()+"").replace(".",""),f=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){return i=!1,0});var m=function(a,b,c,e){c=c||[],b=b||H;var f=b;if(b.nodeType!==1&&b.nodeType!==9)return[];if(!a||typeof a!="string")return c;var h,i,j,k,l,n,q,r,t=!0,u=m.isXML(b),v=[],x=a;do{d.exec(""),h=d.exec(x);if(h){x=h[3],v.push(h[1]);if(h[2]){k=h[3];break}}}while(h);if(v.length>1&&p.exec(a))if(v.length===2&&o.relative[v[0]])i=w(v[0]+v[1],b,e);else{i=o.relative[v[0]]?[b]:m(v.shift(),b);while(v.length)a=v.shift(),o.relative[a]&&(a+=v.shift()),i=w(a,i,e)}else{!e&&v.length>1&&b.nodeType===9&&!u&&o.match.ID.test(v[0])&&!o.match.ID.test(v[v.length-1])&&(l=m.find(v.shift(),b,u),b=l.expr?m.filter(l.expr,l.set)[0]:l.set[0]);if(b){l=e?{expr:v.pop(),set:s(e)}:m.find(v.pop(),v.length!==1||v[0]!=="~"&&v[0]!=="+"||!b.parentNode?b:b.parentNode,u),i=l.expr?m.filter(l.expr,l.set):l.set,v.length>0?j=s(i):t=!1;while(v.length)n=v.pop(),q=n,o.relative[n]?q=v.pop():n="",q==null&&(q=b),o.relative[n](j,q,u)}else j=v=[]}j||(j=i),j||m.error(n||a);if(g.call(j)==="[object Array]")if(!t)c.push.apply(c,j);else if(b&&b.nodeType===1)for(r=0;j[r]!=null;r++)j[r]&&(j[r]===!0||j[r].nodeType===1&&m.contains(b,j[r]))&&c.push(i[r]);else for(r=0;j[r]!=null;r++)j[r]&&j[r].nodeType===1&&c.push(i[r]);else s(j,c);return k&&(m(k,f,c,e),m.uniqueSort(c)),c};m.uniqueSort=function(a){if(u){h=i,a.sort(u);if(h)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;e<f;e++){h=o.order[e];if(g=o.leftMatch[h].exec(a)){i=g[1],g.splice(1,1);if(i.substr(i.length-1)!=="\\"){g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c);if(d!=null){a=a.replace(o.match[h],"");break}}}}return d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]),{set:d,expr:a}},m.filter=function(a,c,d,e){var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);while(a&&c.length){for(h in o.filter)if((f=o.leftMatch[h].exec(a))!=null&&f[2]){k=o.filter[h],l=f[1],g=!1,f.splice(1,1);if(l.substr(l.length-1)==="\\")continue;s===r&&(r=[]);if(o.preFilter[h]){f=o.preFilter[h](f,s,d,r,e,t);if(!f)g=i=!0;else if(f===!0)continue}if(f)for(n=0;(j=s[n])!=null;n++)j&&(i=k(j,f,n,s),p=e^i,d&&i!=null?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){d||(s=r),a=a.replace(o.match[h],"");if(!g)return[];break}}if(a===q){if(g!=null)break;m.error(a)}q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!l.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(b,d,e){var g,h=f++,i=a;typeof d=="string"&&!l.test(d)&&(d=d.toLowerCase(),g=d,i=c),i("parentNode",d,h,b,g,e)},"~":function(b,d,e){var g,h=f++,i=a;typeof d=="string"&&!l.test(d)&&(d=d.toLowerCase(),g=d,i=c),i("previousSibling",d,h,b,g,e)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(j,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);return a[0]=f++,a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");return!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),a[2]==="~="&&(a[4]=" "+a[4]+" "),a},PSEUDO:function(a,b,c,e,f){if(a[1]==="not"){if(!((d.exec(a[3])||"").length>1||/^\w/.test(a[3]))){var g=m.filter(a[3],b,c,!0^f);return c||e.push.apply(e,g),!1}a[3]=m(a[3],null,null,b)}else if(o.match.POS.test(a[0])||o.match.CHILD.test(a[0]))return!0;return a},POS:function(a){return a.unshift(!0),a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,d,f,g,h,i,j,k=b[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":c=b[2],d=b[3];if(c===1&&d===0)return!0;f=b[0],g=a.parentNode;if(g&&(g[e]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[e]=f}return j=a.nodeIndex-d,c===0?j===0:j%c===0&&j/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&m.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];if(f)return f(a,c,b,d)}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));var s=function(a,b){return a=Array.prototype.slice.call(a,0),b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(H.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;H.documentElement.compareDocumentPosition?u=function(a,b){return a===b?(h=!0,0):!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(u=function(a,b){if(a===b)return h=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=H.createElement("div"),c="script"+(new Date).getTime(),d=H.documentElement;a.innerHTML="<a name='"+c+"'/>",d.insertBefore(a,d.firstChild),H.getElementById(c)&&(o.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),d.removeChild(a),d=a=null}(),function(){var a=H.createElement("div");a.appendChild(H.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),H.querySelectorAll&&function(){var a=m,b=H.createElement("div"),c="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||
b.querySelectorAll(".TEST").length!==0){m=function(b,d,e,f){d=d||H;if(!f&&!m.isXML(d)){var g=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(g&&(d.nodeType===1||d.nodeType===9)){if(g[1])return s(d.getElementsByTagName(b),e);if(g[2]&&o.find.CLASS&&d.getElementsByClassName)return s(d.getElementsByClassName(g[2]),e)}if(d.nodeType===9){if(b==="body"&&d.body)return s([d.body],e);if(g&&g[3]){var h=d.getElementById(g[3]);if(!h||!h.parentNode)return s([],e);if(h.id===g[3])return s([h],e)}try{return s(d.querySelectorAll(b),e)}catch(i){}}else if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){var j=d,k=d.getAttribute("id"),l=k||c,n=d.parentNode,p=/^\s*[+~]/.test(b);k?l=l.replace(/'/g,"\\$&"):d.setAttribute("id",l),p&&n&&(d=d.parentNode);try{if(!p||n)return s(d.querySelectorAll("[id='"+l+"'] "+b),e)}catch(q){}finally{k||j.removeAttribute("id")}}}return a(b,d,e,f)};for(var d in a)m[d]=a[d];b=null}}(),function(){var a=H.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(H.createElement("div"),"div"),d=!1;try{b.call(H.documentElement,"[test!='']:sizzle")}catch(e){d=!0}m.matchesSelector=function(a,e){e=e.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!m.isXML(a))try{if(d||!o.match.PSEUDO.test(e)&&!/!=/.test(e)){var f=b.call(a,e);if(f||!c||a.document&&a.document.nodeType!==11)return f}}catch(g){}return m(e,null,null,[a]).length>0}}}(),function(){var a=H.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),H.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:H.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var w=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=o.match.PSEUDO.exec(a))f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=K.attr,m.selectors.attrMap={},K.find=m,K.expr=m.selectors,K.expr[":"]=K.expr.filters,K.unique=m.uniqueSort,K.text=m.getText,K.isXMLDoc=m.isXML,K.contains=m.contains}();var bi=/Until$/,bj=/^(?:parents|prevUntil|prevAll)/,bk=/,/,bl=/^.[^:#\[\.,]*$/,bm=Array.prototype.slice,bn=K.expr.match.POS,bo={children:!0,contents:!0,next:!0,prev:!0};K.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return K(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(K.contains(b[c],this))return!0});var e=this.pushStack("","find",a),f,g,h;for(c=0,d=this.length;c<d;c++){f=e.length,K.find(a,this[c],e);if(c>0)for(g=f;g<e.length;g++)for(h=0;h<f;h++)if(e[h]===e[g]){e.splice(g--,1);break}}return e},has:function(a){var b=K(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(K.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(z(this,a,!1),"not",a)},filter:function(a){return this.pushStack(z(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?bn.test(a)?K(a,this.context).index(this[0])>=0:K.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,f=this[0];if(K.isArray(a)){var g=1;while(f&&f.ownerDocument&&f!==b){for(d=0;d<a.length;d++)K(f).is(a[d])&&c.push({selector:a[d],elem:f,level:g});f=f.parentNode,g++}return c}var h=bn.test(a)||typeof a!="string"?K(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){f=this[d];while(f){if(h?h.index(f)>-1:K.find.matchesSelector(f,a)){c.push(f);break}f=f.parentNode;if(!f||!f.ownerDocument||f===b||f.nodeType===11)break}}return c=c.length>1?K.unique(c):c,this.pushStack(c,"closest",a)},index:function(a){return a?typeof a=="string"?K.inArray(this[0],K(a)):K.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c=typeof a=="string"?K(a,b):K.makeArray(a&&a.nodeType?[a]:a),d=K.merge(this.get(),c);return this.pushStack(A(c[0])||A(d[0])?d:K.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),K.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return K.dir(a,"parentNode")},parentsUntil:function(a,b,c){return K.dir(a,"parentNode",c)},next:function(a){return K.nth(a,2,"nextSibling")},prev:function(a){return K.nth(a,2,"previousSibling")},nextAll:function(a){return K.dir(a,"nextSibling")},prevAll:function(a){return K.dir(a,"previousSibling")},nextUntil:function(a,b,c){return K.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return K.dir(a,"previousSibling",c)},siblings:function(a){return K.sibling(a.parentNode.firstChild,a)},children:function(a){return K.sibling(a.firstChild)},contents:function(a){return K.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:K.makeArray(a.childNodes)}},function(a,b){K.fn[a]=function(c,d){var e=K.map(this,b,c);return bi.test(a)||(d=c),d&&typeof d=="string"&&(e=K.filter(d,e)),e=this.length>1&&!bo[a]?K.unique(e):e,(this.length>1||bk.test(d))&&bj.test(a)&&(e=e.reverse()),this.pushStack(e,a,bm.call(arguments).join(","))}}),K.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),b.length===1?K.find.matchesSelector(b[0],a)?[b[0]]:[]:K.find.matches(a,b)},dir:function(a,c,d){var e=[],f=a[c];while(f&&f.nodeType!==9&&(d===b||f.nodeType!==1||!K(f).is(d)))f.nodeType===1&&e.push(f),f=f[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var bp="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",bq=/ jQuery\d+="(?:\d+|null)"/g,br=/^\s+/,bs=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,bt=/<([\w:]+)/,bu=/<tbody/i,bv=/<|&#?\w+;/,bw=/<(?:script|style)/i,bx=/<(?:script|object|embed|option|style)/i,by=new RegExp("<(?:"+bp+")","i"),bz=/checked\s*(?:[^=]|=\s*.checked.)/i,bA=/\/(java|ecma)script/i,bB=/^\s*<!(?:\[CDATA\[|\-\-)/,bC={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bD=y(H);bC.optgroup=bC.option,bC.tbody=bC.tfoot=bC.colgroup=bC.caption=bC.thead,bC.th=bC.td,K.support.htmlSerialize||(bC._default=[1,"div<div>","</div>"]),K.fn.extend({text:function(a){return K.isFunction(a)?this.each(function(b){var c=K(this);c.text(a.call(this,b,c.text()))}):typeof a!="object"&&a!==b?this.empty().append((this[0]&&this[0].ownerDocument||H).createTextNode(a)):K.text(this)},wrapAll:function(a){if(K.isFunction(a))return this.each(function(b){K(this).wrapAll(a.call(this,b))});if(this[0]){var b=K(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return K.isFunction(a)?this.each(function(b){K(this).wrapInner(a.call(this,b))}):this.each(function(){var b=K(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=K.isFunction(a);return this.each(function(c){K(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){K.nodeName(this,"body")||K(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=K.clean(arguments);return a.push.apply(a,this.toArray()),this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);return a.push.apply(a,K.clean(arguments)),a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||K.filter(a,[d]).length)!b&&d.nodeType===1&&(K.cleanData(d.getElementsByTagName("*")),K.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&K.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){return a=a==null?!1:a,b=b==null?a:b,this.map(function(){return K.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(bq,""):null;if(typeof a=="string"&&!bw.test(a)&&(K.support.leadingWhitespace||!br.test(a))&&!bC[(bt.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(bs,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(K.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else K.isFunction(a)?this.each(function(b){var c=K(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){return this[0]&&this[0].parentNode?K.isFunction(a)?this.each(function(b){var c=K(this),d=c.html();c.replaceWith(a.call(this,b,d))}):(typeof a!="string"&&(a=K(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;K(this).remove(),b?K(b).before(a):K(c).append(a)})):this.length?this.pushStack(K(K.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,f,g,h,i=a[0],j=[];if(!K.support.checkClone&&arguments.length===3&&typeof i=="string"&&bz.test(i))return this.each(function(){K(this).domManip(a,c,d,!0)});if(K.isFunction(i))return this.each(function(e){var f=K(this);a[0]=i.call(this,e,c?f.html():b),f.domManip(a,c,d)});if(this[0]){h=i&&i.parentNode,K.support.parentNode&&h&&h.nodeType===11&&h.childNodes.length===this.length?e={fragment:h}:e=K.buildFragment(a,this,j),g=e.fragment,g.childNodes.length===1?f=g=g.firstChild:f=g.firstChild;if(f){c=c&&K.nodeName(f,"tr");for(var k=0,l=this.length,m=l-1;k<l;k++)d.call(c?x(this[k],f):this[k],e.cacheable||l>1&&k<m?K.clone(g,!0,!0):g)}j.length&&K.each(j,q)}return this}}),K.buildFragment=function(a,b,c){var d,e,f,g,h=a[0];return b&&b[0]&&(g=b[0].ownerDocument||b[0]),g.createDocumentFragment||(g=H),a.length===1&&typeof h=="string"&&h.length<512&&g===H&&h.charAt(0)==="<"&&!bx.test(h)&&(K.support.checkClone||!bz.test(h))&&(K.support.html5Clone||!by.test(h))&&(e=!0,f=K.fragments[h],f&&f!==1&&(d=f)),d||(d=g.createDocumentFragment(),K.clean(a,g,d,c)),e&&(K.fragments[h]=f?d:1),{fragment:d,cacheable:e}},K.fragments={},K.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){K.fn[a]=function(c){var d=[],e=K(c),f=this.length===1&&this[0].parentNode;if(f&&f.nodeType===11&&f.childNodes.length===1&&e.length===1)return e[b](this[0]),this;for(var g=0,h=e.length;g<h;g++){var i=(g>0?this.clone(!0):this).get();K(e[g])[b](i),d=d.concat(i)}return this.pushStack(d,a,e.selector)}}),K.extend({clone:function(a,b,c){var d,e,f,g=K.support.html5Clone||!by.test("<"+a.nodeName)?a.cloneNode(!0):r(a);if((!K.support.noCloneEvent||!K.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!K.isXMLDoc(a)){v(a,g),d=u(a),e=u(g);for(f=0;d[f];++f)e[f]&&v(d[f],e[f])}if(b){w(a,g);if(c){d=u(a),e=u(g);for(f=0;d[f];++f)w(d[f],e[f])}}return d=e=null,g},clean:function(a,b,c,d){var e;b=b||H,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||H);var f=[],g;for(var h=0,i;(i=a[h])!=null;h++){typeof i=="number"&&(i+="");if(!i)continue;if(typeof i=="string")if(!bv.test(i))i=b.createTextNode(i);else{i=i.replace(bs,"<$1></$2>");var j=(bt.exec(i)||["",""])[1].toLowerCase(),k=bC[j]||bC._default,l=k[0],m=b.createElement("div");b===H?bD.appendChild(m):y(b).appendChild(m),m.innerHTML=k[1]+i+k[2];while(l--)m=m.lastChild;if(!K.support.tbody){var n=bu.test(i),o=j==="table"&&!n?m.firstChild&&m.firstChild.childNodes:k[1]==="<table>"&&!n?m.childNodes:[];for(g=o.length-1;g>=0;--g)K.nodeName(o[g],"tbody")&&!o[g].childNodes.length&&o[g].parentNode.removeChild(o[g])}!K.support.leadingWhitespace&&br.test(i)&&m.insertBefore(b.createTextNode(br.exec(i)[0]),m.firstChild),i=m.childNodes}var p;if(!K.support.appendChecked)if(i[0]&&typeof (p=i.length)=="number")for(g=0;g<p;g++)s(i[g]);else s(i);i.nodeType?f.push(i):f=K.merge(f,i)}if(c){e=function(a){return!a.type||bA.test(a.type)};for(h=0;f[h];h++)if(d&&K.nodeName(f[h],"script")&&(!f[h].type||f[h].type.toLowerCase()==="text/javascript"))d.push(f[h].parentNode?f[h].parentNode.removeChild(f[h]):f[h]);else{if(f[h].nodeType===1){var q=K.grep(f[h].getElementsByTagName("script"),e);f.splice.apply(f,[h+1,0].concat(q))}c.appendChild(f[h])}}return f},cleanData:function(a){var b,c,d=K.cache,e=K.event.special,f=K.support.deleteExpando;for(var g=0,h;(h=a[g])!=null;g++){if(h.nodeName&&K.noData[h.nodeName.toLowerCase()])continue;c=h[K.expando];if(c){b=d[c];if(b&&b.events){for(var i in b.events)e[i]?K.event.remove(h,i):K.removeEvent(h,i,b.handle);b.handle&&(b.handle.elem=null)}f?delete h[K.expando]:h.removeAttribute&&h.removeAttribute(K.expando),delete d[c]}}}});var bE=/alpha\([^)]*\)/i,bF=/opacity=([^)]*)/,bG=/([A-Z]|^ms)/g,bH=/^-?\d+(?:px)?$/i,bI=/^-?\d/,bJ=/^([\-+])=([\-+.\de]+)/,bK={position:"absolute",visibility:"hidden",display:"block"},bL=["Left","Right"],bM=["Top","Bottom"],bN,bO,bP;K.fn.css=function(a,c){return arguments.length===2&&c===b?this:K.access(this,a,c,!0,function(a,c,d){return d!==b?K.style(a,c,d):K.css(a,c)})},K.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bN(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":K.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var f,g,h=K.camelCase(c),i=a.style,j=K.cssHooks[h];c=K.cssProps[h]||h;if(d===b)return j&&"get"in j&&(f=j.get(a,!1,e))!==b?f:i[c];g=typeof d,g==="string"&&(f=bJ.exec(d))&&(d=+(f[1]+1)*+f[2]+parseFloat(K.css(a,c)),g="number");if(d==null||g==="number"&&isNaN(d))return;g==="number"&&!K.cssNumber[h]&&(d+="px");if(!j||!("set"in j)||(d=j.set(a,d))!==b)try{i[c]=d}catch(k){}}},css:function(a,c,d){var e,f;c=K.camelCase(c),f=K.cssHooks[c],c=K.cssProps[c]||c,c==="cssFloat"&&(c="float");if(f&&"get"in f&&(e=f.get(a,!0,d))!==b)return e;if(bN)return bN(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),K.curCSS=K.css,K.each(["height","width"],function(a,b){K.cssHooks[b]={get:function(a,c,d){var e;if(c)return a.offsetWidth!==0?p(a,b,d):(K.swap(a,bK,function(){e=p(a,b,d)}),e)},set:function(a,b){if(!bH.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),K.support.opacity||(K.cssHooks.opacity={get:function(a,b){return bF.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=K.isNumeric(b)?"alpha(opacity="+b*100+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&K.trim(f.replace(bE,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bE.test(f)?f.replace(bE,e):f+" "+e}}),K(function(){K.support.reliableMarginRight||(K.cssHooks.marginRight={get:function(a,b){var c;return K.swap(a,{display:"inline-block"},function(){b?c=bN(a,"margin-right","marginRight"):c=a.style.marginRight}),c}})}),H.defaultView&&H.defaultView.getComputedStyle&&(bO=function(a,b){var c,d,e;return b=b.replace(bG,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),c===""&&!K.contains(a.ownerDocument.documentElement,a)&&(c=K.style(a,b))),c}),H.documentElement.currentStyle&&(bP=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;return f===null&&g&&(e=g[b])&&(f=e),!bH.test(f)&&bI.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left=b==="fontSize"?"1em":f||0,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d)),f===""?"auto":f}),bN=bO||bP,K.expr&&K.expr.filters&&(K.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!K.support.reliableHiddenOffsets&&(a.style&&a.style.display||K.css(a,"display"))==="none"},K.expr.filters.visible=function(a){return!K.expr.filters.hidden(a)});var bQ=/%20/g,bR=/\[\]$/,bS=/\r?\n/g,bT=/#.*$/,bU=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bV=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bW=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bX=/^(?:GET|HEAD)$/,bY=/^\/\//,bZ=/\?/,b$=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,b_=/^(?:select|textarea)/i,ca=/\s+/,cb=/([?&])_=[^&]*/,cc=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,cd=K.fn.load,ce={},cf={},cg,ch,ci=["*/"]+["*"];try{cg=J.href}catch(cj){cg=H.createElement("a"),cg.href="",cg=cg.href}ch=cc.exec(cg.toLowerCase())||[],K.fn.extend({load:function(a,c,d){if(typeof a!="string"&&cd)return cd.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var f=a.slice(e,a.length);a=a.slice(0,e)}var g="GET";c&&(K.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=K.param(c,K.ajaxSettings.traditional),g="POST"));var h=this;return K.ajax({url:a,type:g,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),h.html(f?K("<div>").append(c.replace(b$,"")).find(f):c)),d&&h.each(d,[c,b,a])}}),this},serialize:function(){return K.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?K.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||b_.test(this.nodeName)||bV.test(this.type))}).map(function(a,b){var c=K(this).val();return c==null?null:K.isArray(c)?K.map(c,function(a,c){return{name:b.name,value:a.replace(bS,"\r\n")}}):{name:b.name,value:c.replace(bS,"\r\n")}}).get()}}),K.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){K.fn[b]=function(a){return this.on(b,a)}}),K.each(["get","post"],function(a,c){K[c]=function(a,d,e,f){return K.isFunction(d)&&(f=f||e,e=d,d=b),K.ajax({type:c,url:a,data:d,success:e,dataType:f})}}),K.extend({getScript:function(a,c){return K.get(a,b,c,"script")},getJSON:function(a,b,c){return K.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?m(a,K.ajaxSettings):(b=a,a=K.ajaxSettings),m(a,b),a},ajaxSettings:{url:cg,isLocal:bW.test(ch[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":ci},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":K.parseJSON,"text xml":K.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:o(ce),ajaxTransport:o(cf),ajax:function(a,c){function d(a,c,d,n){if(v!==2){v=2,t&&clearTimeout(t),s=b,q=n||"",y.readyState=a>0?4:0;var o,p,r,u=c,x=d?k(e,y,d):b,z,A;if(a>=200&&a<300||a===304){if(e.ifModified){if(z=y.getResponseHeader("Last-Modified"))K.lastModified[m]=z;if(A=y.getResponseHeader("Etag"))K.etag[m]=A}if(a===304)u="notmodified",o=!0;else try{p=j(e,x),u="success",o=!0}catch(B){u="parsererror",r=B}}else{r=u;if(!u||a)u="error",a<0&&(a=0)}y.status=a,y.statusText=""+(c||u),o?h.resolveWith(f,[p,u,y]):h.rejectWith(f,[y,u,r]),y.statusCode(l),l=b,w&&g.trigger("ajax"+(o?"Success":"Error"),[y,e,o?p:r]),i.fireWith(f,[y,u]),w&&(g.trigger("ajaxComplete",[y,e]),--K.active||K.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var e=K.ajaxSetup({},c),f=e.context||e,g=f!==e&&(f.nodeType||f instanceof K)?K(f):K.event,h=K.Deferred(),i=K.Callbacks("once memory"),l=e.statusCode||{},m,o={},p={},q,r,s,t,u,v=0,w,x,y={readyState:0,setRequestHeader:function(a,b){if(!v){var c=a.toLowerCase();a=p[c]=p[c]||a,o[a]=b}return this},getAllResponseHeaders:function(){return v===2?q:null},getResponseHeader:function(a){var c;if(v===2){if(!r){r={};while(c=bU.exec(q))r[c[1].toLowerCase()]=c[2]}c=r[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return v||(e.mimeType=a),this},abort:function(a){return a=a||"abort",s&&s.abort(a),d(0,a),this}};h.promise(y),y.success=y.done,y.error=y.fail,y.complete=i.add,y.statusCode=function(a){if(a){var b;if(v<2)for(b in a)l[b]=[l[b],a[b]];else b=a[y.status],y.then(b,b)}return this},e.url=((a||e.url)+"").replace(bT,"").replace(bY,ch[1]+"//"),e.dataTypes=K.trim(e.dataType||"*").toLowerCase().split(ca),e.crossDomain==null&&(u=cc.exec(e.url.toLowerCase()),e.crossDomain=!(!u||u[1]==ch[1]&&u[2]==ch[2]&&(u[3]||(u[1]==="http:"?80:443))==(ch[3]||(ch[1]==="http:"?80:443)))),e.data&&e.processData&&typeof e.data!="string"&&(e.data=K.param(e.data,e.traditional)),n(ce,e,c,y);if(v===2)return!1;w=e.global,e.type=e.type.toUpperCase(),e.hasContent=!bX.test(e.type),w&&K.active++===0&&K.event.trigger("ajaxStart");if(!e.hasContent){e.data&&(e.url+=(bZ.test(e.url)?"&":"?")+e.data,delete e.data),m=e.url;if(e.cache===!1){var z=K.now(),A=e.url.replace(cb,"$1_="+z);e.url=A+(A===e.url?(bZ.test(e.url)?"&":"?")+"_="+z:"")}}(e.data&&e.hasContent&&e.contentType!==!1||c.contentType)&&y.setRequestHeader("Content-Type",e.contentType),e.ifModified&&(m=m||e.url,K.lastModified[m]&&y.setRequestHeader("If-Modified-Since",K.lastModified[m]),K.etag[m]&&y.setRequestHeader("If-None-Match",K.etag[m])),y.setRequestHeader("Accept",e.dataTypes[0]&&e.accepts[e.dataTypes[0]]?e.accepts[e.dataTypes[0]]+(e.dataTypes[0]!=="*"?", "+ci+"; q=0.01":""):e.accepts["*"]);for(x in e.headers)y.setRequestHeader(x,e.headers[x]);if(!e.beforeSend||e.beforeSend.call(f,y,e)!==!1&&v!==2){for(x in{success:1,error:1,complete:1})y[x](e[x]);s=n(cf,e,c,y);if(!s)d(-1,"No Transport");else{y.readyState=1,w&&g.trigger("ajaxSend",[y,e]),e.async&&e.timeout>0&&(t=setTimeout(function(){y.abort("timeout")},e.timeout));try{v=1,s.send(o,d)}catch(B){if(!(v<2))throw B;d(-1,B)}}return y}return y.abort(),!1},param:function(a,c){var d=[],e=function(a,b){b=K.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=K.ajaxSettings.traditional);if(K.isArray(a)||a.jquery&&!K.isPlainObject(a))K.each(a,function(){e(this.name,this.value)});else for(var f in a)l(f,a[f],c,e);return d.join("&").replace(bQ,"+")}}),K.extend({active:0,lastModified:{},etag:{}});var ck=K.now(),cl=/(\=)\?(&|$)|\?\?/i;K.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return K.expando+"_"+ck++}}),K.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(cl.test(b.url)||e&&cl.test(b.data))){var f,g=b.jsonpCallback=K.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h=a[g],i=b.url,j=b.data,k="$1"+g+"$2";return b.jsonp!==!1&&(i=i.replace(cl,k),b.url===i&&(e&&(j=j.replace(cl,k)),b.data===j&&(i+=(/\?/.test(i)?"&":"?")+b.jsonp+"="+g))),b.url=i,b.data=j,a[g]=function(a){f=[a]},d.always(function(){a[g]=h,f&&K.isFunction(h)&&a[g](f[0])}),b.converters["script json"]=function(){return f||K.error(g+" was not called"),f[0]},b.dataTypes[0]="json","script"}}),K.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return K.globalEval(a),a}}}),K.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),K.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=H.head||H.getElementsByTagName("head")[0]||H.documentElement;return{send:function(e,f){c=H.createElement("script"),c.async="async",a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success")},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var cm=a.ActiveXObject?function(){for(var a in co)co[a](0,1)}:!1,cn=0,co;K.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&i()||h()}:i,function(a){K.extend(K.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(K.ajaxSettings.xhr()),K.support.ajax&&K.ajaxTransport(function(c){if(!c.crossDomain||K.support.cors){var d;return{send:function(e,f){var g=c.xhr(),h,i;c.username?g.open(c.type,c.url,c.async,c.username,c.password):g.open(c.type,c.url,c.async);if(c.xhrFields)for(i in c.xhrFields)g[i]=c.xhrFields[i];c.mimeType&&g.overrideMimeType&&g.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(i in e)g.setRequestHeader(i,e[i])}catch(j){}g.send(c.hasContent&&c.data||null),d=function(a,e){var i,j,k,l,m;try{if(d&&(e||g.readyState===4)){d=b,h&&(g.onreadystatechange=K.noop,cm&&delete co[h]);if(e)g.readyState!==4&&g.abort();else{i=g.status,k=g.getAllResponseHeaders(),l={},m=g.responseXML,m&&m.documentElement&&(l.xml=m),l.text=g.responseText;try{j=g.statusText}catch(n){j=""}!i&&c.isLocal&&!c.crossDomain?i=l.text?200:404:i===1223&&(i=204)}}}catch(o){e||f(-1,o)}l&&f(i,j,l,k)},!c.async||g.readyState===4?d():(h=++cn,cm&&(co||(co={},K(a).unload(cm)),co[h]=d),g.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cp={},cq,cr,cs=/^(?:toggle|show|hide)$/,ct=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cu,cv=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cw;K.fn.extend({show:function(a,b,c){var f,g;if(a||a===0)return this.animate(e("show",3),a,b,c);for(var h=0,i=this.length;h<i;h++)f=this[h],f.style&&(g=f.style.display,!K._data(f,"olddisplay")&&g==="none"&&(g=f.style.display=""),g===""&&K.css(f,"display")==="none"&&K._data(f,"olddisplay",d(f.nodeName)));for(h=0;h<i;h++){f=this[h];if(f.style){g=f.style.display;if(g===""||g==="none")f.style.display=K._data(f,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(e("hide",3),a,b,c);var d,f,g=0,h=this.length;for(;g<h;g++)d=this[g],d.style&&(f=K.css(d,"display"),f!=="none"&&!K._data(d,"olddisplay")&&K._data(d,"olddisplay",f));for(g=0;g<h;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:K.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";return K.isFunction(a)&&K.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:K(this).is(":hidden");K(this)[b?"show":"hide"]()}):this.animate(e("toggle",3),a,b,c),this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,e){function f(){g.queue===!1&&K._mark(this);var b=K.extend({},g),c=this.nodeType===1,e=c&&K(this).is(":hidden"),f,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){f=K.camelCase(i),i!==f&&(a[f]=a[i],delete a[i]),h=a[f],K.isArray(h)?(b.animatedProperties[f]=h[1],h=a[f]=h[0]):b.animatedProperties[f]=b.specialEasing&&b.specialEasing[f]||b.easing||"swing";if(h==="hide"&&e||h==="show"&&!e)return b.complete.call(this);c&&(f==="height"||f==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],K.css(this,"display")==="inline"&&K.css(this,"float")==="none"&&(!K.support.inlineBlockNeedsLayout||d(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)j=new K.fx(this,b,i),h=a[i],cs.test(h)?(o=K._data(this,"toggle"+i)||(h==="toggle"?e?"show":"hide":0),o?(K._data(this,"toggle"+i,o==="show"?"hide":"show"),j[o]()):j[h]()):(k=ct.exec(h),l=j.cur(),k?(m=parseFloat(k[2]),n=k[3]||(K.cssNumber[i]?"":"px"),n!=="px"&&(K.style(this,i,(m||1)+n),l=(m||1)/j.cur()*l,K.style(this,i,l+n)),k[1]&&(m=(k[1]==="-="?-1:1)*m+l),j.custom(l,m,n)):j.custom(l,h,""));return!0}var g=K.speed(b,c,e);return K.isEmptyObject(a)?this.each(g.complete,[!1]):(a=K.extend({},a),g.queue===!1?this.each(f):this.queue(g.queue,f))},stop:function(a,c,d){return typeof a!="string"&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){function b(a,b,c){var e=b[c];K.removeData(a,c,!0),e.stop(d)}var c,e=!1,f=K.timers,g=K._data(this);d||K._unmark(!0,this);if(a==null)for(c in g)g[c]&&g[c].stop&&c.indexOf(".run")===c.length-4&&b(this,g,c);else g[c=a+".run"]&&g[c].stop&&b(this,g,c);for(c=f.length;c--;)f[c].elem===this&&(a==null||f[c].queue===a)&&(d?f[c](!0):f[c].saveState(),e=!0,f.splice(c,1));(!d||!e)&&K.dequeue(this,a)})}}),K.each({slideDown:e("show",1),slideUp:e("hide",1),slideToggle:e("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){K.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),K.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?K.extend({},a):{complete:c||!c&&b||K.isFunction(a)&&a,duration:a,easing:c&&b||b&&!K.isFunction(b)&&b};d.duration=K.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in K.fx.speeds?K.fx.speeds[d.duration]:K.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";return d.old=d.complete,d.complete=function(a){K.isFunction(d.old)&&d.old.call(this),d.queue?K.dequeue(this,d.queue):a!==!1&&K._unmark(this)},d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),K.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(K.fx.step[this.prop]||K.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]==null||!!this.elem.style&&this.elem.style[this.prop]!=null){var a,b=K.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a}return this.elem[this.prop]},custom:function(a,c,d){function e(a){return f.step(a)}var f=this,h=K.fx;this.startTime=cw||g(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(K.cssNumber[this.prop]?"":"px"),e.queue=this.options.queue,e.elem=this.elem,e.saveState=function(){f.options.hide&&K._data(f.elem,"fxshow"+f.prop)===b&&K._data(f.elem,"fxshow"+f.prop,f.start)},e()&&K.timers.push(e)&&!cu&&(cu=setInterval(h.tick,h.interval))},show:function(){var a=K._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||K.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),K(this.elem).show()},hide:function(){this.options.orig[this.prop]=K._data(this.elem,"fxshow"+this.prop)||K.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=cw||g(),f=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(f=!1);if(f){i.overflow!=null&&!K.support.shrinkWrapBlocks&&K.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&K(h).hide();if(i.hide||i.show)for(b in i.animatedProperties)K.style(h,b,i.orig[b]),K.removeData(h,"fxshow"+b,!0),K.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}return i.duration==Infinity?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=K.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},K.extend(K.fx,{tick:function(){var a,b=K.timers,c=0;for(;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||K.fx.stop()},interval:13,stop:function(){clearInterval(cu),cu=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){K.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),K.each(["width","height"],function(a,b){K.
fx.step[b]=function(a){K.style(a.elem,b,Math.max(0,a.now)+a.unit)}}),K.expr&&K.expr.filters&&(K.expr.filters.animated=function(a){return K.grep(K.timers,function(b){return a===b.elem}).length});var cx=/^t(?:able|d|h)$/i,cy=/^(?:body|html)$/i;"getBoundingClientRect"in H.documentElement?K.fn.offset=function(a){var b=this[0],d;if(a)return this.each(function(b){K.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return K.offset.bodyOffset(b);try{d=b.getBoundingClientRect()}catch(e){}var f=b.ownerDocument,g=f.documentElement;if(!d||!K.contains(g,b))return d?{top:d.top,left:d.left}:{top:0,left:0};var h=f.body,i=c(f),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||K.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||K.support.boxModel&&g.scrollLeft||h.scrollLeft,n=d.top+l-j,o=d.left+m-k;return{top:n,left:o}}:K.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){K.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return K.offset.bodyOffset(b);var c,d=b.offsetParent,e=b,f=b.ownerDocument,g=f.documentElement,h=f.body,i=f.defaultView,j=i?i.getComputedStyle(b,null):b.currentStyle,k=b.offsetTop,l=b.offsetLeft;while((b=b.parentNode)&&b!==h&&b!==g){if(K.support.fixedPosition&&j.position==="fixed")break;c=i?i.getComputedStyle(b,null):b.currentStyle,k-=b.scrollTop,l-=b.scrollLeft,b===d&&(k+=b.offsetTop,l+=b.offsetLeft,K.support.doesNotAddBorder&&(!K.support.doesAddBorderForTableAndCells||!cx.test(b.nodeName))&&(k+=parseFloat(c.borderTopWidth)||0,l+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),K.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(k+=parseFloat(c.borderTopWidth)||0,l+=parseFloat(c.borderLeftWidth)||0),j=c}if(j.position==="relative"||j.position==="static")k+=h.offsetTop,l+=h.offsetLeft;return K.support.fixedPosition&&j.position==="fixed"&&(k+=Math.max(g.scrollTop,h.scrollTop),l+=Math.max(g.scrollLeft,h.scrollLeft)),{top:k,left:l}},K.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return K.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(K.css(a,"marginTop"))||0,c+=parseFloat(K.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=K.css(a,"position");d==="static"&&(a.style.position="relative");var e=K(a),f=e.offset(),g=K.css(a,"top"),h=K.css(a,"left"),i=(d==="absolute"||d==="fixed")&&K.inArray("auto",[g,h])>-1,j={},k={},l,m;i?(k=e.position(),l=k.top,m=k.left):(l=parseFloat(g)||0,m=parseFloat(h)||0),K.isFunction(b)&&(b=b.call(a,c,f)),b.top!=null&&(j.top=b.top-f.top+l),b.left!=null&&(j.left=b.left-f.left+m),"using"in b?b.using.call(a,j):e.css(j)}},K.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cy.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(K.css(a,"marginTop"))||0,c.left-=parseFloat(K.css(a,"marginLeft"))||0,d.top+=parseFloat(K.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(K.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||H.body;while(a&&!cy.test(a.nodeName)&&K.css(a,"position")==="static")a=a.offsetParent;return a})}}),K.each(["Left","Top"],function(a,d){var e="scroll"+d;K.fn[e]=function(d){var f,g;return d===b?(f=this[0],f?(g=c(f),g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:K.support.boxModel&&g.document.documentElement[e]||g.document.body[e]:f[e]):null):this.each(function(){g=c(this),g?g.scrollTo(a?K(g).scrollLeft():d,a?d:K(g).scrollTop()):this[e]=d})}}),K.each(["Height","Width"],function(a,c){var d=c.toLowerCase();K.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(K.css(a,d,"padding")):this[d]():null},K.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(K.css(b,d,a?"margin":"border")):this[d]():null},K.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(K.isFunction(a))return this.each(function(b){var c=K(this);c[d](a.call(this,b,c[d]()))});if(K.isWindow(e)){var f=e.document.documentElement["client"+c],g=e.document.body;return e.document.compatMode==="CSS1Compat"&&f||g&&g["client"+c]||f}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var h=K.css(e,d),i=parseFloat(h);return K.isNumeric(i)?i:h}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=K,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return K})})(window),function(a,b){var c="ui-effects-";a.effects={effect:{}},function(a,b){function m(a,b,c){var d=h[b.type]||{};return a==null?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:d.max<a?d.max:a)}function n(b){var c=f(),d=c._rgba=[];return b=b.toLowerCase(),l(e,function(a,e){var f,h=e.re.exec(b),i=h&&e.parse(h),j=e.space||"rgba";if(i)return f=c[j](i),c[g[j].cache]=f[g[j].cache],d=c._rgba=f._rgba,!1}),d.length?(d.join()==="0,0,0,0"&&a.extend(d,k.transparent),c):k[b]}function o(a,b,c){return c=(c+1)%1,c*6<1?a+(b-a)*c*6:c*2<1?b:c*3<2?a+(b-a)*(2/3-c)*6:a}var c="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",d=/^([\-+])=\s*(\d+\.?\d*)/,e=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1]*2.55,a[2]*2.55,a[3]*2.55,a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],f=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},g={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},h={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},i=f.support={},j=a("<p>")[0],k,l=a.each;j.style.cssText="background-color:rgba(1,1,1,.5)",i.rgba=j.style.backgroundColor.indexOf("rgba")>-1,l(g,function(a,b){b.cache="_"+a,b.props.alpha={idx:3,type:"percent",def:1}}),f.fn=a.extend(f.prototype,{parse:function(c,d,e,h){if(c===b)return this._rgba=[null,null,null,null],this;if(c.jquery||c.nodeType)c=a(c).css(d),d=b;var i=this,j=a.type(c),o=this._rgba=[];d!==b&&(c=[c,d,e,h],j="array");if(j==="string")return this.parse(n(c)||k._default);if(j==="array")return l(g.rgba.props,function(a,b){o[b.idx]=m(c[b.idx],b)}),this;if(j==="object")return c instanceof f?l(g,function(a,b){c[b.cache]&&(i[b.cache]=c[b.cache].slice())}):l(g,function(b,d){var e=d.cache;l(d.props,function(a,b){if(!i[e]&&d.to){if(a==="alpha"||c[a]==null)return;i[e]=d.to(i._rgba)}i[e][b.idx]=m(c[a],b,!0)}),i[e]&&a.inArray(null,i[e].slice(0,3))<0&&(i[e][3]=1,d.from&&(i._rgba=d.from(i[e])))}),this},is:function(a){var b=f(a),c=!0,d=this;return l(g,function(a,e){var f,g=b[e.cache];return g&&(f=d[e.cache]||e.to&&e.to(d._rgba)||[],l(e.props,function(a,b){if(g[b.idx]!=null)return c=g[b.idx]===f[b.idx],c})),c}),c},_space:function(){var a=[],b=this;return l(g,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var c=f(a),d=c._space(),e=g[d],i=this.alpha()===0?f("transparent"):this,j=i[e.cache]||e.to(i._rgba),k=j.slice();return c=c[e.cache],l(e.props,function(a,d){var e=d.idx,f=j[e],g=c[e],i=h[d.type]||{};if(g===null)return;f===null?k[e]=g:(i.mod&&(g-f>i.mod/2?f+=i.mod:f-g>i.mod/2&&(f-=i.mod)),k[e]=m((g-f)*b+f,d))}),this[d](k)},blend:function(b){if(this._rgba[3]===1)return this;var c=this._rgba.slice(),d=c.pop(),e=f(b)._rgba;return f(a.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return a==null?b>2?1:0:a});return c[3]===1&&(c.pop(),b="rgb("),b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){return a==null&&(a=b>2?1:0),b&&b<3&&(a=Math.round(a*100)+"%"),a});return c[3]===1&&(c.pop(),b="hsl("),b+c.join()+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();return b&&c.push(~~(d*255)),"#"+a.map(c,function(a){return a=(a||0).toString(16),a.length===1?"0"+a:a}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),f.fn.parse.prototype=f.fn,g.hsla.to=function(a){if(a[0]==null||a[1]==null||a[2]==null)return[null,null,null,a[3]];var b=a[0]/255,c=a[1]/255,d=a[2]/255,e=a[3],f=Math.max(b,c,d),g=Math.min(b,c,d),h=f-g,i=f+g,j=i*.5,k,l;return g===f?k=0:b===f?k=60*(c-d)/h+360:c===f?k=60*(d-b)/h+120:k=60*(b-c)/h+240,h===0?l=0:j<=.5?l=h/i:l=h/(2-i),[Math.round(k)%360,l,j,e==null?1:e]},g.hsla.from=function(a){if(a[0]==null||a[1]==null||a[2]==null)return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],e=a[3],f=d<=.5?d*(1+c):d+c-d*c,g=2*d-f;return[Math.round(o(g,f,b+1/3)*255),Math.round(o(g,f,b)*255),Math.round(o(g,f,b-1/3)*255),e]},l(g,function(c,e){var g=e.props,h=e.cache,i=e.to,j=e.from;f.fn[c]=function(c){i&&!this[h]&&(this[h]=i(this._rgba));if(c===b)return this[h].slice();var d,e=a.type(c),k=e==="array"||e==="object"?c:arguments,n=this[h].slice();return l(g,function(a,b){var c=k[e==="object"?a:b.idx];c==null&&(c=n[b.idx]),n[b.idx]=m(c,b)}),j?(d=f(j(n)),d[h]=n,d):f(n)},l(g,function(b,e){if(f.fn[b])return;f.fn[b]=function(f){var g=a.type(f),h=b==="alpha"?this._hsla?"hsla":"rgba":c,i=this[h](),j=i[e.idx],k;return g==="undefined"?j:(g==="function"&&(f=f.call(this,j),g=a.type(f)),f==null&&e.empty?this:(g==="string"&&(k=d.exec(f),k&&(f=j+parseFloat(k[2])*(k[1]==="+"?1:-1))),i[e.idx]=f,this[h](i)))}})}),f.hook=function(b){var c=b.split(" ");l(c,function(b,c){a.cssHooks[c]={set:function(b,d){var e,g,h="";if(d!=="transparent"&&(a.type(d)!=="string"||(e=n(d)))){d=f(e||d);if(!i.rgba&&d._rgba[3]!==1){g=c==="backgroundColor"?b.parentNode:b;while((h===""||h==="transparent")&&g&&g.style)try{h=a.css(g,"backgroundColor"),g=g.parentNode}catch(j){}d=d.blend(h&&h!=="transparent"?h:"_default")}d=d.toRgbaString()}try{b.style[c]=d}catch(j){}}},a.fx.step[c]=function(b){b.colorInit||(b.start=f(b.elem,c),b.end=f(b.end),b.colorInit=!0),a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}})},f.hook(c),a.cssHooks.borderColor={expand:function(a){var b={};return l(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}},k=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function e(b){var c,d,e=b.ownerDocument.defaultView?b.ownerDocument.defaultView.getComputedStyle(b,null):b.currentStyle,f={};if(e&&e.length&&e[0]&&e[e[0]]){d=e.length;while(d--)c=e[d],typeof e[c]=="string"&&(f[a.camelCase(c)]=e[c])}else for(c in e)typeof e[c]=="string"&&(f[c]=e[c]);return f}function f(b,c){var e={},f,g;for(f in c)g=c[f],b[f]!==g&&!d[f]&&(a.fx.step[f]||!isNaN(parseFloat(g)))&&(e[f]=g);return e}var c=["add","remove","toggle"],d={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,c){a.fx.step[c]=function(a){if(a.end!=="none"&&!a.setAttr||a.pos===1&&!a.setAttr)jQuery.style(a.elem,c,a.end),a.setAttr=!0}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(a==null?this.prevObject:this.prevObject.filter(a))}),a.effects.animateClass=function(b,d,g,h){var i=a.speed(d,g,h);return this.queue(function(){var d=a(this),g=d.attr("class")||"",h,j=i.children?d.find("*").addBack():d;j=j.map(function(){var b=a(this);return{el:b,start:e(this)}}),h=function(){a.each(c,function(a,c){b[c]&&d[c+"Class"](b[c])})},h(),j=j.map(function(){return this.end=e(this.el[0]),this.diff=f(this.start,this.end),this}),d.attr("class",g),j=j.map(function(){var b=this,c=a.Deferred(),d=a.extend({},i,{queue:!1,complete:function(){c.resolve(b)}});return this.el.animate(this.diff,d),c.promise()}),a.when.apply(a,j.get()).done(function(){h(),a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})}),i.complete.call(d[0])})})},a.fn.extend({addClass:function(b){return function(c,d,e,f){return d?a.effects.animateClass.call(this,{add:c},d,e,f):b.apply(this,arguments)}}(a.fn.addClass),removeClass:function(b){return function(c,d,e,f){return arguments.length>1?a.effects.animateClass.call(this,{remove:c},d,e,f):b.apply(this,arguments)}}(a.fn.removeClass),toggleClass:function(c){return function(d,e,f,g,h){return typeof e=="boolean"||e===b?f?a.effects.animateClass.call(this,e?{add:d}:{remove:d},f,g,h):c.apply(this,arguments):a.effects.animateClass.call(this,{toggle:d},e,f,g)}}(a.fn.toggleClass),switchClass:function(b,c,d,e,f){return a.effects.animateClass.call(this,{add:c,remove:b},d,e,f)}})}(),function(){function d(b,c,d,e){a.isPlainObject(b)&&(c=b,b=b.effect),b={effect:b},c==null&&(c={}),a.isFunction(c)&&(e=c,d=null,c={});if(typeof c=="number"||a.fx.speeds[c])e=d,d=c,c={};return a.isFunction(d)&&(e=d,d=null),c&&a.extend(b,c),d=d||c.duration,b.duration=a.fx.off?0:typeof d=="number"?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,b.complete=e||c.complete,b}function e(b){return!b||typeof b=="number"||a.fx.speeds[b]?!0:typeof b=="string"&&!a.effects.effect[b]?!0:a.isFunction(b)?!0:typeof b=="object"&&!b.effect?!0:!1}a.extend(a.effects,{version:"1.10.3",save:function(a,b){for(var d=0;d<b.length;d++)b[d]!==null&&a.data(c+b[d],a[0].style[b[d]])},restore:function(a,d){var e,f;for(f=0;f<d.length;f++)d[f]!==null&&(e=a.data(c+d[f]),e===b&&(e=""),a.css(d[f],e))},setMode:function(a,b){return b==="toggle"&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:b.width(),height:b.height()},f=document.activeElement;try{f.id}catch(g){f=document.body}return b.wrap(d),(b[0]===f||a.contains(b[0],f))&&a(f).focus(),d=b.parent(),b.css("position")==="static"?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(e),d.css(c).show()},removeWrapper:function(b){var c=document.activeElement;return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===c||a.contains(b[0],c))&&a(c).focus()),b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(){function g(c){function h(){a.isFunction(e)&&e.call(d[0]),a.isFunction(c)&&c()}var d=a(this),e=b.complete,g=b.mode;(d.is(":hidden")?g==="hide":g==="show")?(d[g](),h()):f.call(d[0],b,h)}var b=d.apply(this,arguments),c=b.mode,e=b.queue,f=a.effects.effect[b.effect];return a.fx.off||!f?c?this[c](b.duration,b.complete):this.each(function(){b.complete&&b.complete.call(this)}):e===!1?this.each(g):this.queue(e||"fx",g)},show:function(a){return function(b){if(e(b))return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="show",this.effect.call(this,c)}}(a.fn.show),hide:function(a){return function(b){if(e(b))return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="hide",this.effect.call(this,c)}}(a.fn.hide),toggle:function(a){return function(b){if(e(b)||typeof b=="boolean")return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="toggle",this.effect.call(this,c)}}(a.fn.toggle),cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}})}(),function(){var b={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,c){b[c]=function(b){return Math.pow(b,a+2)}}),a.extend(b,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return a===0||a===1?a:-Math.pow(2,8*(a-1))*Math.sin(((a-1)*80-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){var b,c=4;while(a<((b=Math.pow(2,--c))-1)/11);return 1/Math.pow(4,3-c)-7.5625*Math.pow((b*3-2)/22-a,2)}}),a.each(b,function(b,c){a.easing["easeIn"+b]=c,a.easing["easeOut"+b]=function(a){return 1-c(1-a)},a.easing["easeInOut"+b]=function(a){return a<.5?c(a*2)/2:1-c(a*-2+2)/2}})}()}(jQuery),$.noConflict();var ParamsParser=function(){};ParamsParser.getAsQueryParam=function(a,b){return encodeURIComponent(a)+"="+encodeURIComponent(b)},Array.prototype.clear=function(){return this.length=0,this},Array.prototype.last=function(){return this.length>0?this[this.length-1]:this},String.prototype.trim=function(){var a=this;return a=a.replace(/^\s*(.*)/,"$1"),a=a.replace(/(.*?)\s*$/,"$1"),a};var BROWSER=new function(){this.NETSCAPE=0,this.FIREFOX=0,this.OPERA=0,this.IE=0,this.SAFARI=0,this.MOZILA=0,this.CHROME=0,this.NONIE=1,this.WEBKIT=0,this.IE11AndAbove=0,this.EDGE=0;var a=navigator.userAgent.toLowerCase();this.IPHONE=a.indexOf("iphone")!=-1,this.IPAD=a.indexOf("ipad")!=-1,this.ANDROID=a.indexOf("android")!=-1,this.IS_MOBILE=this.IPHONE||this.IPAD||this.ANDROID,this.browserNdVersion="",this.detect=function(){var a=navigator.userAgent,b=a.length,c=navigator.vendor,d=window.opera,e="";d?this.OPERA=1:a.indexOf("Edge")>-1?(this.EDGE=1,this.IE=1,this.IE11AndAbove=1,e="Edge/",this.browserNdVersion="IE "):a.indexOf("Chrome")>-1?(this.CHROME=1,e="Chrome/",this.browserNdVersion="Chrome "):a.indexOf("Firefox")>-1?(this.FIREFOX=1,e="Firefox/",this.browserNdVersion="Firefox "):a.indexOf("Trident/")>-1?(this.IE=1,e=a.indexOf("MSIE ")>-1?"MSIE ":"rv:",this.IE11AndAbove=a.indexOf("MSIE ")>-1?0:1,this.browserNdVersion="IE "):c.indexOf("Apple")>-1?(this.SAFARI=1,e="Version/",this.browserNdVersion="Safari "):e="Unknown Browser",this.VERSION=a.substring(a.indexOf(e),b).match(/[0-9\.]+/)[0],this.browserNdVersion+=this.VERSION},this.detectBrowserNdVersion=function(){var a=navigator.userAgent;a.indexOf("Safari")>-1?a.indexOf("Chrome")>-1?this.browserNdVersion=a.substring(a.indexOf("Chrome"),a.indexOf("Chrome")+11).replace("/"," "):this.browserNdVersion=a.substring(a.indexOf("Safari"),a.indexOf("Safari")+10).replace("/"," "):a.indexOf("Firefox")>-1?this.browserNdVersion=a.substring(a.indexOf("Firefox"),a.indexOf("Firefox")+10).replace("/"," "):a.indexOf("Trident")>-1?a.indexOf("rv")>-1?this.browserNdVersion=a.substring(a.indexOf("rv"),a.indexOf("rv")+7).replace("rv:","IE "):a.indexOf("MSIE")>-1&&(this.browserNdVersion=a.substring(a.indexOf("MSIE"),a.indexOf("MSIE")+9).replace("MSIE","IE")):a.indexOf("EDGE")>-1&&(this.browserNdVersion=a.substring(a.indexOf("Edge"),a.indexOf("Edge")+9).replace("/"," "))},this.detect(),this.detectBrowserNdVersion(),this.NONIE=!this.IE,this.WEBKIT=this.SAFARI||this.CHROME},ZDBGlobal=new function(){this.CTX="",this.isGlobalSet=!1,this.dataCell=null,this.row=null,this.cellDIV=null,this.colDIV=null,this.colHead=null,this.rowHead=null,this.integrated=!1,this.curMouseOverCell=null,this.moveDIV=null,this.moveIn=null,this.isMove=!1,this.resizeDIV=null,this.focusDIV=null,this.highlightDIV=null,this.isResize=!1,this.optionDIV=null,this.textFilterDIV=null,this.freezeIcon=null,this.ascIcon=null,this.descIcon=null,this.cellWidth=70,this.dataAreaWidth=500,this.dataAreaHeight=10*this.cellHeight,this.stdCellWidth=150,this.stdCellHeight=BROWSER.IS_MOBILE?26:22,this.stdColHeight=26,this.stdEditGridCellHeight=42,this.getScrollThickness=function(){var a=document.getElementById("ZDBSampleDiv"),b=document.getElementById("ZDBSampleDivForDataSheet");return jQuery(a).is(":visible")!=0?a.offsetHeight-a.clientHeight:jQuery(b).is(":visible")!=0?b.offsetHeight-b.clientHeight:0},this.scrollThick=this.getScrollThickness(),this.isMac=navigator.userAgent.indexOf("Mac OS X")!=-1,BROWSER.IE?this.wait=25:this.wait=5,this.dateCnt=0,this.filterOptions=[],this.filterDisplay=[],this.dervFieldNameCnt=0,this.qryTblDataLimitShown={},this.promoCodeDiscount=0,this._ZVER_="1",this.getDropSpace=function(){return this.dropSpace!=null&&this.dropSpace.parentNode!=null?this.dropSpace:(this.dropSpace=document.createElement("div"),this.dropSpace.className="zdbBlankField",document.body.appendChild(this.dropSpace),this.dropSpace)},this.troubleshooting=!1},ZDBConst=new function(){this.NONE=this.NOTSET=null,this.BROWSER_HANDLE_YES=!0,this.BROWSER_HANDLE_NO=!1,this.ASC=1,this.DESC=2,this.CLEAR=-1,this.CREATED=1,this.MODIFIED=2,this.DELETED=3;var a=["DUMMY","DATA","SUMMARY","SECTION","FILLER","ROWHEAD","COLHEAD","PIVOTHEAD","FILTER","OPTION","CRITERIA"];for(var b=0;b<a.length;++b)this[a[b]]=b;this.BLANK=10,this.TEXT=11,this.UP=12,this.DOWN=13,this.EQUAL=2,this.NOTEQUAL=-2,this.LESS=3,this.LESSEQUAL=4,this.GREATER=5,this.GREATEREQUAL=6,this.START=7,this.NOTSTART=-7,this.END=8,this.NOTEND=-8,this.CONTAIN=9,this.NOTCONTAIN=-9,this.BETWEEN=10,this.NOTBETWEEN=-10,this.SORTASC="Sort Ascending",this.SORTDESC="Sort Descending",this.REMOVESORT="Remove Sort",this.GROUPCOLUMN="Group Column",this.UNGROUPCOLUMN="UnGroup Column",this.GROUPSTART=1,this.GROUPEND=2,this.GROUPBOTH=3,this.GROUPMIDDLE=0,this.GROUPNONE=undefined,this.READONLY={read:1,exportPerm:0,vud:0,add:0,modify:0,deletePerm:0,deleteAll:0,appendImport:0,updateImport:0,truncateImport:0,deleteupdateadd:0,share:0,vudShowSelCol:1,drilldown:0,dbOwner:0,grpMember:0,designModify:0,createTable:0,createChildReports:0},this.ALLPERMS={read:1,exportPerm:1,vud:1,add:1,modify:1,deletePerm:1,deleteAll:1,appendImport:1,updateImport:1,truncateImport:1,deleteupdateadd:1,share:1,vudShowSelCol:1,drilldown:1,dbOwner:1,grpMember:1,designModify:1,createTable:1,createChildReports:1},this.PLAIN=1,this.MULTI_LINE=2,this.EMAIL=3,this.NUMBER=4,this.POSITIVE_NUMBER=5,this.DECIMAL_NUMBER=6,this.CURRENCY=7,this.PERCENT=8,this.DATE=9,this.BOOLEAN=10,this.REFCOL=14,this.AUTO_NUMBER=18,this.URL=19,this.RELCOL=20,this.GEO=21,this.COLNAME_MAX_LENGTH=100,this.DBOBJECT_NAME_MAX_LENGTH=100,this.TITLE_MAX_LENGTH=100,this.DESCRIPTION_MAX_LENGTH=250,this.DEFAULT_CURRENCY_FORMAT="en;US;",this.DEFAULT_DATE_FORMAT="dd MMM, yyyy HH:mm:ss",this.NEEDSAVE="<i>Need to Save</i>",this.DLG_MIN_WIDTH=630,this.DLG_MIN_HEIGHT=250,this.DECISEPSYMBOL=[".",","],this.DEFAULT_DECISEPSYMBOL=".",this.DYNAMIC_COL_NAME="C_DUMMY",this.DEFAULT_1HR_SCH_FAILURE_COUNT="10",this.DEFAULT_SCH_FAILURE_COUNT="5"},ZDBDesignGridConst=new function(){},ZDBImportConst=new function(){this.GDRIVE_FILE_EXTNS=["csv","tsv","txt","xls","xlsx","htm","html","zip"],this.GDRIVE_CSV_EXTNS=["csv","tsv","txt"]};ZDBGlobal.switchCharting=function(a){AjaxAPI.sendRequest({URL:"/ZDBUserAction.ma?ZDBACTION=SWITCHCHARTING",PARAMETERS:"&ENABLED3="+a,ONSUCCESSFUNC:ZDBHeader.reload,ONFAILUREFUNC:ZDBHeader.reload})},ZDBGlobal.showFeedBack=function(a,b){if(!ZDBLazyLoadUtil.loadJsAlone("ZRScreenGrabber","APPENDTODOC",ZDBGlobal.showFeedBack,[a,b]))return;if(!ZDBLazyLoadUtil.loadCssOnly(ZDBGlobal.THEMEDIR+"/styles/ui.zscreengrabber.css","APPENDTODOC",ZDBGlobal.showFeedBack,[a,b]))return;ZDBScreenGrabber.showFeedBack(a,b)},moCnt=0;var KEY=new function(){this.BACKSPACE=8,this.TAB=9,this.ENTER=13,this.SHIFT=16,this.ESC=27,this.SPACE=32,this.END=35,this.HOME=36,this.PAGEUP=33,this.PAGEDOWN=34,this.LEFTARROW=37,this.UPARROW=38,this.RIGHTARROW=39,this.DOWNARROW=40,this.DEL=46,this.F2=113},Click=new function(){this.dcTime=200,this.dcDelay=100,this.dcAt=0,this.savEvent=null,this.zdbEvent=null,this.savEvtTime=0,this.savTO=null,this.method=null,this.hadDoubleClick=function(){return(new Date).getTime()-Click.dcAt<Click.dcDelay?!0:!1},this.setClientPos=function(a){var b=Click.zdbEvent;if(b){var c=BROWSER.IE?window.event:a;b.clientX=c.clientX,b.clientY=c.clientY,b.type=c.type,b.button=c.button,b.position=ZDBUtil.getCursorPos(a)}},this.setZDBEvent=function(a){Click.zdbEvent={},Click.zdbEvent.event=window.event?window.event:a,Click.zdbEvent.src=window.event?window.event.srcElement:a.target,Click.zdbEvent.ctrlKey=window.event?window.event.ctrlKey:a?a.ctrlKey:!1,Click.zdbEvent.shiftKey=window.event?window.event.shiftKey:a?a.shiftKey:!1,Click.setClientPos(a)},this.handle=function(a,b){var c=window.event?window.event.type:a.type;this.method=b,Click.setZDBEvent(a);switch(c){case"click":if(Click.hadDoubleClick())return!1;Click.savEvtTime=(new Date).getTime(),Click.savTO=setTimeout("Click.doClick(Click.zdbEvent)",Click.dcTime);break;case"dblclick":Click.doDoubleClick(Click.zdbEvent)}},this.doClick=function(a){Click.savEvtTime-Click.dcAt>0&&Click.method(a)},this.doDoubleClick=function(a){Click.dcAt=(new Date).getTime(),Click.savTO!=null&&(clearTimeout(Click.savTO),Click.savTO=null),Click.method(a)}},ZDBKeyEvents=new function(){var a=0,b=0;this.moveFocus=function(a,b,c,d,e,f,g){a.setHighlightRowCol(b,!1);var h;h=b.rowObj;var i=h.values,j=ZDBUtil.indexOf(i,b),k=ZDBUtil.indexOf(a.rowData,h);switch(c){case KEY.UPARROW:ZDBGridScroll.navigate(e?0:4,a,j,k);break;case KEY.DOWNARROW:ZDBGridScroll.navigate(e?3:5,a,j,k);break;case KEY.LEFTARROW:a.setCurrentCell(a.getCellLeft(i,j,e));break;case KEY.RIGHTARROW:a.setCurrentCell(a.getCellRight(i,j,e));break;case KEY.ENTER:ZDBGridScroll.navigate(d?4:5,a,j,k);break;case KEY.TAB:ZDBGridScroll.navigate(d?6:7,a,j,k);break;case KEY.HOME:e?ZDBGridScroll.navigate(0,a):a.focusRowFirstCell(k);break;case KEY.END:e?ZDBGridScroll.navigate(3,a,null):a.focusRowLastCell(k);break;case KEY.ESC:a.setCurrentCell(b);break;case KEY.PAGEUP:return ZDBGridScroll.navigate(1,a,j,k),!1;case KEY.PAGEDOWN:return ZDBGridScroll.navigate(2,a,j,k),!1}},this.handleModifiers=function(a,b){var c=ZDBDataGrid.getCurrentCell(b);if(!b)return!1;var d=ZDBUtil.getGridKeyPressEvent(a);if(d.ctrlPressed||d.cmdPressed){var e=String.fromCharCode(d.charCode).toUpperCase();switch(e){case"S":if(b.isEdit){b.isEdit=!1;var f=ZDBUtil.getSourceElement(a);f.blur()}return b.save(),b.onFocus(null,!1),ZDBUtil.stopEventBubble(a),!0;case"C":return c=c!=null?c:ZDBDataGrid.getLastFocusCell(b),b.isEdit?!1:b.selectionType==ZDBConst.DATA?(ZDBEvents.copyCell(a,!1),!1):b.selectionType==ZDBConst.ROWHEAD?(ZDBEvents.copyRow(a,!1),!1):!0;case"V":return c=c!=null?c:ZDBDataGrid.getLastFocusCell(b),b.isEdit?!1:b.selectionType==ZDBConst.DATA?(ZDBEvents.pasteCell(a,!1),!1):b.selectionType==ZDBConst.ROWHEAD?(ZDBEvents.pasteRow(a,!1),!1):!0}}return!1},this.onKeyDown=function(a){var b=ZDBUtil.getSourceElement(a),c=ZDBUtil.getPropertyFromEl(b,"gridObj","object");if(!c)return;var d=ZDBDataGrid.getCurrentCell(c)||ZDBDataGrid.getLastFocusCell(c);if(d)var e=d.colObj,f=d.rowObj;var g=ZDBUtil.getGridKeyUpEvent(a),h=ZDBUtil.getKeyCode(a),i=ZDBUtil.getGridKeyPressEvent(a);if(i.ctrlPressed||i.altPressed||i.cmdPressed)if(ZDBKeyEvents.handleModifiers(a,c))return ZDBConst.BROWSER_HANDLE_NO;if(c.rowHeadFocus){if(c.isForImport)return ZDBConst.BROWSER_HANDLE_YES;if(h==KEY.DEL)c.deleteSelectedRows(),h=0;else switch(h){case KEY.UPARROW:case KEY.DOWNARROW:case KEY.LEFTARROW:case KEY.RIGHTARROW:case KEY.ENTER:case KEY.TAB:case KEY.HOME:case KEY.PAGEUP:case KEY.PAGEDOWN:case KEY.END:return ZDBKeyEvents.moveFocus(c,ZDBDataGrid.getFirstVisibleCell(c.selectedRows[0]),h,g.shiftPressed,g.ctrlPressed,g.cmdPressed),c.rowHeadFocus=!1,ZDBConst.BROWSER_HANDLE_NO}}else if(c.dataFocus){switch(h){case KEY.UPARROW:case KEY.DOWNARROW:case KEY.LEFTARROW:case KEY.RIGHTARROW:case KEY.ENTER:case KEY.TAB:case KEY.HOME:case KEY.PAGEUP:case KEY.PAGEDOWN:case KEY.END:return ZDBKeyEvents.moveFocus(c,d,h,g.shiftPressed,g.ctrlPressed,g.cmdPressed),ZDBConst.BROWSER_HANDLE_NO}if(c.readOnly||c.editDisabled)return ZDBConst.BROWSER_HANDLE_YES;if(!c.isEdit){var j=e;if(!c.checkEditWithMsg(e))return ZDBConst.BROWSER_HANDLE_NO;if(h==KEY.F2)c.setCellEditable(d);else{if(h==KEY.DEL)return ZDBEvents.setValue(d,"",!0),c.adjustRowHeightBasedOnCell(d),ZDBConst.BROWSER_HANDLE_NO;if(h==KEY.BACKSPACE)return ZDBEvents.setValue(d,"",!1),c.adjustRowHeightBasedOnCell(d),c.setCellEditable(d),ZDBConst.BROWSER_HANDLE_NO}}h=0}return ZDBConst.BROWSER_HANDLE_YES},this.onKeyPress=function(a){if(ZDBEvents.isDefault(a))return!0;var b=ZDBUtil.getSourceElement(a),c=ZDBUtil.getPropertyFromEl(b,"gridObj","object");if(!c)return ZDBConst.BROWSER_HANDLE_YES;var d=ZDBUtil.getGridKeyPressEvent(a);if(d.ctrlPressed||d.altPressed||d.cmdPressed)return ZDBKeyEvents.handleModifiers(a,c)?ZDBConst.BROWSER_HANDLE_NO:ZDBConst.BROWSER_HANDLE_YES;if(!c.gridFocus)return ZDBConst.BROWSER_HANDLE_YES;if(c.isEdit==0){if(c.readOnly)return ZDBConst.BROWSER_HANDLE_NO;var e=ZDBDataGrid.getCurrentCell(c);if(!e)return ZDBConst.BROWSER_HANDLE_YES;var f=e.colObj;f||console.log("WWW");if(!f.isColCellsEditable)return ZDBConst.BROWSER_HANDLE_NO;var g=ZDBUtil.getGridKeyPressEvent(a).charCode;if(ZDBUtil.isPrintable(g)){var h=String.fromCharCode(g);BROWSER.IE||BROWSER.OPERA?ZDBEvents.setValue(e,"",!1):ZDBEvents.setValue(e,h,!1),c.setCellEditable(e)}return ZDBConst.BROWSER_HANDLE_YES}return ZDBConst.BROWSER_HANDLE_YES},this.onBlur=function(a){var b=ZDBUtil.getSourceElement(a),c=ZDBUtil.getPropertyFromEl(b,"gridObj","object");return c?c.focusClick?ZDBConst.BROWSER_HANDLE_NO:(c.removeCellFocus(),ZDBConst.BROWSER_HANDLE_YES):ZDBConst.BROWSER_HANDLE_YES}},ZDBEvents=new function(){this.mouseDownPos=null,this.mouseUpPos=null,this.copyType=ZDBConst.DATA};ZDBEvents.isResizeArea=function(a,b){var c=b,d=b.rowObj;b instanceof ZDBCell&&(b.endIndex>-1?c=b.colObj.parGrid.colHeaders[b.endIndex]:c=b.colObj);if(c.objType===ZDBConst.FILLER||d.objType===ZDBConst.FILLER)return!1;var e=c.parGrid;if(!e||!e.resizeable)return!1;var f=ZDBUtil.getCursorPos(a),g=ZDBUtil.getObjLeft(c.cellEl)+c.width;return g-f.x<10},ZDBEvents.setMove=function(a){var b=a.parGrid;ZDBGlobal.moveIndicator.gridObj=b,ZDBGlobal.moveIndicator.cellObj=a,document.body.style.cursor="move"},ZDBEvents.setResize=function(a){var b=a.colObj,c=b.parGrid,d=a.cellEl,e=ZDBGlobal.resizeDIV;e.gridObj=c,e.cellObj=a,e||(e=document.getElementById("resizeDIV"),e.parentNode!=document.body&&document.body.appendChild(ZDBGlobal.resizeDIV),ZDBGlobal.resizeDIV=e);var f=e.style;f.height=c.gHeight-ZDBGlobal.scrollThick+"px",f.top=c.position.y+"px",f.left=0},ZDBEvents.onCHeadMouseMove=function(a,b){var c=ZDBUtil.getSourceElement(b),d=a.parGrid,e=a.cellEl;return e.getAttribute("tiptitle")!=a.displayName&&!ZDBGlobal.IS_MOBILE&&e.setAttribute("tiptitle",a.displayName),ZDBEvents.hideLinkIcon(),ZDBGlobal.isMove?document.body.style.cursor!="move"&&(document.body.style.cursor="move"):(d.showSortIcon?ZDBEvents.setSortIconClass(a,!0,b):a.iconNode.style.cursor="default",d.showRenameIcon&&d.type=="PivotSheet"?ZDBEvents.setRenameIconClassforPivot(a,!0,b):d.showRenameIcon&&d.type=="SummarySheet"?ZDBEvents.setRenameIconClassforSummary(a,!0,b):a.renameIcon.style.cursor="default"),ZDBToolTip.showTip(b),ZDBConst.BROWSER_HANDLE_YES},ZDBEvents.getAttrFromEventSrc=function(a,b){var c=window.event?window.event.srcElement:a.target;return!c||!c.getAttribute?"":c.getAttribute(b)},ZDBEvents.clearResizeMove=function(a){document.body.style.cursor="default",a=="move"?(ZDBGlobal.moveIndicator.style.display="none",ZDBGlobal.isMove=!1,ZDBGlobal.moveMsg.gridObj=null):(ZDBGlobal.resizeDIV.style.display="none",ZDBGlobal.resizeDIV.gridObj=null,ZDBGlobal.isResize=!1)},ZDBEvents.showMoveIndicator=function(a){var b=ZDBGlobal.moveIndicator,c=b.cellObj,d=c.parGrid;if(a.objType!=ZDBConst.COLHEAD||c==a||ZDBUtil.indexOf(d.selectedCols,a)>-1){b.style.display="none";return}b.style.display="block";var e=d.getCellHeadPos(a),f=d.position.x+e.x-10-d.dArea.scrollLeft,g=a.cellPos<c.cellPos;g||(f+=a.width-1);var h=d.position.y-6;if(f>=document.body.clientWidth){var i=f-document.body.clientWidth;f>0&&(d.gArea.scrollLeft=i)}ZDBUtil.positionEl("moveIndicator","absolute",h,f,null,null,"block"
)},ZDBEvents.onFocusElClick=function(a,b){var c=ZDBUtil.getPropertyFromEl(a,"gridObj","object");if(!c)return console.log("This log is generated from onFocusDivClick - need to track this ;-)"),!0;c.focusClick=!0;var d=ZDBDataGrid.getCurrentCell(c);if(!d)return;var e=d.rowObj.objType,f=ZDBEvents.colBaseType(d.colObj);d.refErrorMsg&&(ZDBDesignGrid.showRefErrorMsg(d),ZDBUtil.stopEventBubble(b)),c.setCellFocus(d)},ZDBEvents.onColHeadDblClick=function(a){if(!a.isEditable)return;var b=a.cellEl,c=null,d=a.rowObj,e=a.parGrid,f=ZDBEditors.getEditField("colHeadEdit");a.freeze?e.tcArea.appendChild(f):e.chArea.appendChild(f);var g=f.style;e.removeCellFocus();var h=e.getCellElPosInGrid(a);g.left=h.cellLeft+"px",g.top=h.cellTop+"px",g.width=jQuery(b).width()+"px",g.height=jQuery(b).height()-4+"px",g.display="block",f.colObj=a,f.value=a.displayName,f.originalValue=f.value,ZDBUtil.setFocus(f,!0),e.isColHeadEdit=!0},ZDBEvents.onDataCellClick=function(a,b){var c=a.colObj,d=a.rowObj;if(ZDBConst.FILLER===d.objType)return ZDBConst.BROWSER_HANDLE_YES;var e=c.parGrid;if(e.isEdit)return!1;ZDBMsgBox.showErrorIfNeeded(a),a.refErrorMsg&&ZDBDesignGrid.showRefErrorMsg(a);var f=a.colObj.type,g=a.rowObj.objType;return f!="FORMULACOL"||g!=ZDBConst.DATA&&a.originalValue!=ZDBI18NMap.g("zrpt.toolbar.table.editdesign.js.addformula")?(e.setCellFocus(a),!0):ZDBDesignGrid.showDerivedFieldUI(a)},ZDBEvents.setValue=function(a,b,c){var d=a.colObj,e=d.typeObj;if(e&&e.editorType=="list"&&b!=="")return;(d.isNullable||b!=="")&&d.type!="FKCOL"&&(a.editBackup=a.getValue("edit"),a.setValue(b,null,!0,c))},ZDBEvents.isDefault=function(a){var b=ZDBUtil.getSourceElement(a),c=DOMUtils.getElOrParentWithAttr(b,"keyDefault");return c&&b.getAttribute("keyDefault")=="1"?!0:!1},ZDBEvents.onCellClick=function(a,b){var c=a.rowObj.objType;switch(c){case ZDBConst.COLHEAD:return ZDBEvents.onColHeadClick(a,b);default:var d=a.colObj;switch(d.objType){case ZDBConst.ROWHEAD:case ZDBConst.DUMMY:case ZDBConst.FILLER:return ZDBConst.BROWSER_HANDLE_YES;default:return ZDBEvents.onDataCellClick(a,b)}}},ZDBEvents.getCellObj=function(a){var b=ZDBUtil.getSourceElement(a);if(!b){b=a.srcEl;if(b==null)return null}var c=b.cellObj;if(!c){var d=b.parentNode;d&&(c=d.cellObj)}return c},ZDBEvents.onDataCellMouseOver=function(a,b){var c=a.colObj,d;d=a.cellEl;if(!d)return;var e=ZDBEvents.colBaseType(c);a.rowObj.objType!=ZDBConst.DATA||e!="EMAIL"&&e!="URL"||!a.displayValue?ZDBEvents.hideLinkIcon():(ZDBUtil.setNamedChildEls(d,d),ZDBEvents.showLinkIcon(a)),ZDBEvents.getViewTypeForPivotSummary(a.colObj.parGrid)&&a.originalValue=="-NA-"&&a.colObj.parGrid.viewObj.editMode==1&&(d.childNodes[0].className+="renamecolumnheadericon"),ZDBDataGrid.mouseoverHighlight(a,!0)},ZDBEvents.getViewTypeForPivotSummary=function(a){return a.type=="PivotSheet"?!0:a.type=="SummarySheet"?!0:!1},ZDBEvents.getGridObj=function(a){var b=ZDBEvents.getCellObj(a);if(b)return b.rowObj.parGrid;var c=ZDBUtil.getSourceElement(a);while(c){if(c.gridObj)return c.gridObj;c=c.parentNode}return null},ZDBEvents.getColObj=function(a){var b=a.objType;return b&&b===ZDBConst.COLHEAD?a:(a=a.colObj,b&&b===ZDBConst.COLHEAD?a:null)},ZDBEvents.getZDBEvent=function(a){var b={},c=BROWSER.IE?window.event:a;return b.srcEl=ZDBUtil.getSourceElement(a),b.target=b.srcEl,b.clientX=c.clientX,b.clientY=c.clientY,b.type=c.type,b.button=c.button,b.position=ZDBUtil.getCursorPos(a),b},ZDBEvents.onGridMouseDown=function(a){if(!ZDBUtil.isMouseLeftButtonPressed(a))return ZDBUtil.stopEventBubble(a),ZDBEvents.onGridContextMenu(ZDBEvents.getZDBEvent(a)),ZDBConst.BROWSER_HANDLE_NO;ZDBEvents.mouseDownPos=ZDBUtil.getCursorPos(a);var b=ZDBEvents.getCellObj(a);if(!b)return;var c=b.colObj.parGrid;c.keyFocusRequired=!0;if(b.colObj.parGrid.isEdit)return ZDBConst.BROWSER_HANDLE_YES;var d=b.colObj.objType,e=b.rowObj.objType;if(ZDBEvents.onGridCellMouseDown(a,b)==ZDBConst.BROWSER_HANDLE_NO)return ZDBConst.BROWSER_HANDLE_NO;switch(e){case ZDBConst.COLHEAD:switch(d){case ZDBConst.COLHEAD:ZDBEvents.onColHeadMouseDown(b,a);break;case ZDBConst.ROWHEAD:ZDBEvents.onTableHeadMouseDown(b,a)}break;case ZDBConst.DATA:switch(d){case ZDBConst.COLHEAD:ZDBEvents.onDataMouseDown(b,a);break;case ZDBConst.ROWHEAD:ZDBEvents.onRowHeadMouseDown(b,a)}}},ZDBEvents.onGridMouseOver=function(a){var b=ZDBEvents.getCellObj(a),c=ZDBUtil.getSourceElement(a);if(!b)return;b.colObj.objType===ZDBConst.COLHEAD&&b.displayNode==c&&ZDBEvents.onDataSpanMouseOver(c,a,b);var d=b.objType;d||ZDBEvents.onDataCellMouseOver(b,a);return},ZDBEvents.onGridMouseOut=function(a){var b=ZDBUtil.getSourceElement(a),c=ZDBEvents.getCellObj(a);ZDBDataGrid.mouseoverHighlight(c,!1,!0),ZDBEvents.highlightLink(b,a,!1);if(!c)return;c.colObj.objType===ZDBConst.COLHEAD&&c.displayNode==b&&ZDBEvents.onDataSpanMouseOut(b,a,c);if(!ZDBGlobal.isResize&&!ZDBGlobal.isMove){var d=document.body.style.cursor;d!="default"&&(document.body.style.cursor="default")}ZDBEvents.getViewTypeForPivotSummary(c.colObj.parGrid)&&c.originalValue=="-NA-"&&c.colObj.parGrid.viewObj.editMode==1&&(c.cellEl.childNodes[0].className="zdbColHeadArea zdbColHeadRenameIcon ");var e=c.rowObj,f=c.colObj,g=e.objType;g===ZDBConst.COLHEAD&&f.objType===ZDBConst.COLHEAD&&!ZDBGlobal.isResize&&!ZDBGlobal.isMove&&(f.parGrid.showSortIcon&&ZDBEvents.setSortIconClass(c,!1,a),f.parGrid.showRenameIcon&&f.parGrid.type=="PivotSheet"?ZDBEvents.setRenameIconClassforPivot(c,!1,a):f.parGrid.showRenameIcon&&f.parGrid.type=="SummarySheet"&&ZDBEvents.setRenameIconClassforSummary(c,!1,a))},ZDBEvents.onGridMouseMove=function(a){var b=ZDBUtil.getSourceElement(a),c=ZDBEvents.getCellObj(a);if(ZDBGlobal.isMove){var d=ZDBGlobal.moveIndicator.gridObj,c=ZDBGlobal.moveIndicator.cellObj,e=ZDBUtil.getCursorPos(a);d.position.x+d.setAndGetGridWidth()<e.x+20&&(d.dArea.scrollLeft+=20);if(e.x<d.position.x){var f=d.dArea.scrollLeft-20;d.dArea.scrollLeft=f>0?f:0}var g=d.findCellBasedOnLeft(ZDBUtil.getCursorPos(a).x);if(!g)return;return ZDBEvents.showMoveIndicator(g),ZDBUtil.clearTextSelection(),ZDBUtil.stopEventBubble(a),!1}if(ZDBGlobal.isResize){var h=ZDBGlobal.resizeDIV.style,e=ZDBUtil.getCursorPos(a);return h.display!="block"&&(h.display="block"),h.left=e.x+"px",ZDBUtil.clearTextSelection(),ZDBUtil.stopEventBubble(a),!1}ZDBEvents.clearResizeMove("resize"),ZDBEvents.clearResizeMove("move"),ZDBUtil.detachEvent(document,"mousemove",ZDBEvents.onGridMouseMove,!1),ZDBUtil.detachEvent(document,"mouseup",ZDBEvents.onGridMouseUp,!1);if(!c)return;if(ZDBEvents.onGridCellMouseMove(a,c)==ZDBConst.BROWSER_HANDLE_NO)return ZDBConst.BROWSER_HANDLE_NO;var i=c.objType;if(!i)return;switch(i){case ZDBConst.COLHEAD:case ZDBConst.ROWHEAD:ZDBEvents.onCHeadMouseMove(c,a);return}},ZDBEvents.onGridMouseClickCapture=function(a){Click.handle(a,ZDBEvents.onGridMouseClick)},ZDBEvents.onGridMouseDblClickCapture=function(a){Click.handle(a,ZDBEvents.onGridDblClick)},ZDBEvents.onGridContextMenu=function(a){var b=ZDBEvents.getCellObj(a);return b?ZDBPopUpMenu.gridContextMenu(b,a):ZDBConst.BROSWER_HANDLE_YES},ZDBEvents.onGridMouseClick=function(a){if(BROWSER.NONIE&&!ZDBUtil.isMouseLeftButtonPressed(a.event))return ZDBConst.BROSWER_HANDLE_NO;var b=a.src,c=b.getAttribute("zdbname");if(c=="selectOut")var d=b.gridObj;else if(c=="selectIn")var d=b.parentNode.gridObj;if(d)return d.onSelectClick(a),ZDBConst.BROWSER_HANDLE_NO;var e=ZDBEvents.getCellObj(a);if(!e)return ZDBConst.BROWSER_HANDLE_YES;if(ZDBEvents.onGridCellClick(a,e)==ZDBConst.BROWSER_HANDLE_NO)return ZDBConst.BROWSER_HANDLE_NO;d=e.colObj.parGrid;if(d.isEdit)return ZDBConst.BROWSER_HANDLE_YES;if(d.rightFocus==b||d.leftFocus==b)return ZDBEvents.onFocusElClick(b,a);if(d.type=="TableDesign"){var f=e.colObj,g=e.rowObj;if(f.objType==ZDBConst.ROWHEAD&&g.objType==ZDBConst.DATA)return ZDBPopUpMenu.showPopup(a,"ROW",e,f,g)}return ZDBEvents.onCellClick(e,a)},ZDBEvents.onGridDblClick=function(a){var b=ZDBUtil.getSourceElement(a),c=ZDBUtil.getPropertyFromEl(b,"cellObj","object");if(!c){var d=ZDBUtil.getPropertyFromEl(b,"gridObj","object");c=d.getCellAtPos(a.clientX,a.clientY);if(!c)return ZDBConst.BROWSER_HANDLE_YES}var e=c.colObj,f=c.rowObj;if(f.objType===ZDBConst.COLHEAD)c.objType===ZDBConst.COLHEAD&&ZDBEvents.onColHeadDblClick(c);else if(e.objType==ZDBConst.COLHEAD)switch(f.objType){case ZDBConst.DATA:case ZDBConst.DUMMY:e.parGrid.setCellEditable(c)}return ZDBConst.BROWSER_HANDLE_NO},ZDBEvents.onGridMouseUp=function(a){ZDBEvents.mouseUpPos=ZDBUtil.getCursorPos(a);var b,c;if(ZDBEvents.onGridCellMouseUp(a,b)==ZDBConst.BROWSER_HANDLE_NO)return ZDBConst.BROWSER_HANDLE_NO;if(ZDBGlobal.isMove){c=ZDBGlobal.moveIndicator.gridObj,b=ZDBGlobal.moveIndicator.cellObj;var d=c.findCellBasedOnLeft(ZDBUtil.getCursorPos(a).x);if(!d||d==b||ZDBUtil.indexOf(c.selectedCols,d)>-1){ZDBEvents.clearResizeMove("move");return}d instanceof ZDBCell&&(d=d.colObj),ZDBDataGrid.reorderDragAndDrop(ZDBGlobal.moveIndicator.cellObj,d),ZDBEvents.clearResizeMove("move")}ZDBUtil.detachEvent(document,"mousemove",ZDBEvents.onGridMouseMove,!1),ZDBUtil.detachEvent(document,"mousemove",ZDBEvents.onGridMouseUp,!1)},ZDBEvents.onColHeadMouseDown=function(a,b){var c=a.colObj,d=c.parGrid,e=d.colHeaders;if(d.reorderDisabled)return ZDBConst.BROWSER_HANDLE_YES;var f=ZDBUtil.getGridKeyPressEvent(b);return f.shiftPressed==0&&ZDBUtil.indexOf(d.selectedCols,a)<0&&(d.selectedCols=[],d.hideSelection()),ZDBGlobal.isMove=!0,ZDBEvents.setMove(a),ZDBUtil.attachEvent(document,"mousemove",ZDBEvents.onGridMouseMove,!1),ZDBUtil.attachEvent(document,"mouseup",ZDBEvents.onGridMouseUp,!1),ZDBConst.BROWSER_HANDLE_NO},ZDBEvents.onColHeadClick=function(a,b,c){var d=a.colObj;if(d.objType==ZDBConst.ROWHEAD)return ZDBEvents.onTableHeadClick(d,b);var e=d.parGrid;if(d.objType==ZDBConst.COLHEAD&&e.type=="TableDesign")return;var f=e.colHeaders,g=ZDBUtil.getGridKeyPressEvent(b);if(c||g.shiftPressed){var h=e.selectedCols[0];e.selectedCols=[],e.selectedCols.push(h);if(h){var i=h.cellPos,j=d.cellPos,k=i>=j?j:i,l=i<=j?j:i;for(var m=k;m<=l;++m)e.addSelectedCol(f[m])}else e.addSelectedCol(d)}else e.selectedCols=[],e.addSelectedCol(d);e.selectColumn(),ZDBGlobal.IS_MOBILE&&ZDBEvents.setSortIconClass(d,!0,b)},ZDBEvents.onRowHeadMouseDown=function(a,b){var c=a.rowObj,d=a.colObj,e=c.parGrid,f=e.rowData,g=ZDBUtil.getGridKeyPressEvent(b);if(g.shiftPressed&&e.selectedRows.length>0){var h=e.selectedRows[0];e.selectedRows=[],e.selectedRows.push(h);if(h){var i=ZDBUtil.indexOf(f,h),j=ZDBUtil.indexOf(f,c),k=i>=j?j:i,l=i<=j?j:i;for(var m=k;m<=l;++m)e.addSelectedRow(f[m])}else e.addSelectedRow(c)}else e.selectedRows=[],e.addSelectedRow(c);e.selectRow()},ZDBEvents.onDataMouseDown=function(a,b){var c=a.colObj.parGrid;c.rowHeadFocus=!1,c.type==="TableDesign"&&a.colObj.type==="DRILLDOWN"&&ZDBDesignGrid.updateDrillDetNshowOptns(a)},ZDBEvents.onTableHeadMouseDown=function(a,b){a.colObj.parGrid.selectedCols.push(a),ZDBEvents.isResizeArea(b,a)&&(ZDBGlobal.isResize=!0,ZDBEvents.setResize(a),ZDBUtil.attachEvent(document,"mouseup",ZDBEvents.onGridMouseUp,!1))},ZDBEvents.onTableHeadClick=function(a,b){var c=a.parGrid;return a.filter?c.hideFilter("block"):a.filter===!1&&c.hideFilter("none"),!1},ZDBEvents.onFilterAreaButtonClick=function(a,b,c){var d=ZDBUtil.getPropertyFromEl(a,"gridObj","object");switch(b){case"apply":if(!ZDBClientUI.checkAskSave(d,ZDBI18NMap.g("zrpt.common.toolbar.filter.loadingdiv.js.applyingFilter"),this))return!1;d.doFilter();break;case"clear":d.resetFilterData();break;case"close":if(!ZDBClientUI.checkAskSaveView(d,ZDBI18NMap.g("zrpt.common.toolbar.filter.loadingdiv.js.closing"),d))return;d.closeFilter();break;case"save":ZDBFilterAux.doFilterAction("save",d);break;case"hide":d.hideFilter("none");break;case"submenu":ZDBFilterAux.showFilterSubMenu(c,a,d);break;case"delete":if(!ZDBClientUI.checkAskSave(d,ZDBI18NMap.g("zrpt.common.toolbar.filter.loadingdiv.js.deleteFilter"),this))return!1;var e={FILTERDELETE:!0};d.validateFilterData()?d.deleteAllRows(null,e):ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.toolbar.filter.zdbalertmsg.js.multiCriteriaInvalidErr"))}},ZDBEvents.disableContextMenu=function(a){a.onmousedown=a.onmouseup=a.onmouseclick=a.oncontextmenu=function(a){return ZDBUtil.stopEventBubble(a),ZDBConst.BROWSER_HANDLE_NO}},ZDBEvents.onTabHeaderClickCapture=function(a){Click.handle(a,ZDBEvents.onTabHeaderClick)},ZDBEvents.onTabHeaderDblClickCapture=function(a){Click.handle(a,ZDBEvents.onTabHeaderDblClick)},ZDBEvents.onTabHeaderClick=function(a){return ZDBConst.BROWSER_HANDLE_YES},ZDBEvents.onTabHeaderDblClick=function(a){return ZDBTabHandler.editTab(a.src,a.event)},ZDBEvents.handleFilterEnter=function(a,b){var c=ZDBUtil.getKeyCode(b);return c==KEY.ENTER?(a.tagName=="INPUT"&&ZDBFilterAux.setInputBlur(a),a.colObj.parGrid.doFilter(),!1):!0},ZDBEvents.inputKeyDown=function(a,b){keyCode=ZDBUtil.getKeyCode(b);switch(keyCode){case KEY.ENTER:a.blur();break;case KEY.ESC:a.value=a.originalValue,a.blur(),ZDBUtil.stopEventBubble(b)}},ZDBEvents.inputSave=function(a,b){var c=a.colObj,d=c.displayName,e=a.value.trim();if(!c.setValue(e)){var f="zrpt.common.table.zdbalertmsg.js.";return f+=e==""?"emptyColName":"duplicateColName",e==""&&(a.value=a.originalValue),ZDBAlertAPI.showMsg(ZDBI18NMap.f(f,e)),ZDBEditors.hideElements([a]),ZDBUtil.stopEventBubble(b),!1}return c.displayName!=d&&(c.isModified=!0,c.importReset&&ZDBImport.findpossibleJoinsCount()),ZDBEditors.hideElements([a]),c.importReset&&(c.importReset(c),c.colList&&resetColIndex(c)),c.parGrid.isColHeadEdit=!1,!0},ZDBEvents.showLinkIcon=function(a){ZDBGlobal.linkIcon||(ZDBGlobal.linkIcon=document.getElementById("linkIcon"),ZDBGlobal.linkIcon.parentNode!=document.body&&document.body.appendChild(ZDBGlobal.linkIcon));var b=ZDBGlobal.linkIcon;b.style.display="block";var c=a.colObj,d=ZDBEvents.colBaseType(c),e=c.type!="REFCOL"?a.originalValue:a.displayValue;c.type=="REFCOL"&&a.isCellFocused?b.style.display="none":d=="EMAIL"?b.className="zdbLinkStyle zdbEmailIcon":d=="URL"?b.className="zdbLinkStyle zdbUrlIcon":b.locationURL=e,a.cellEl.linkEl&&(b.title=a.cellEl.linkEl.getAttribute("title")),b.locationURL=e,b.type=d,b.cellObj=a;var f=c.parGrid,g=ZDBUtil.getObjLeft(a.cellEl)+c.width-b.offsetWidth,h=ZDBUtil.getObjTop(a.cellEl);ZDBUtil.positionEl("linkIcon","absolute",h,g)},ZDBEvents.hideLinkIcon=function(){ZDBGlobal.linkIcon&&(ZDBGlobal.linkIcon.style.display="none")},ZDBEvents.gotoLink=function(a){ZDBUtil.openWindow(a.locationURL,a.type)},ZDBEvents.setSortIconClass=function(a,b,c){if(a&&a.objType==ZDBConst.ROWHEAD)return;var d=ZDBUtil.getSourceElement(c),e=a.parGrid;if(a.sortOrder<=0||a.sortOrder==3){var f=a.iconNode;f.className="zdbColHeadArea zdbColHeadIcon "+(b||ZDBGlobal.IS_MOBILE?"headerSortAsc":""),ZDBGlobal.IS_MOBILE?(f.style.opacity="0.4",jQuery(f).fadeIn({duration:1e3,queue:!1}),ZDBEvents.setSortIconDisplayTimeout(a)):f.style.display=b?"block":"none"}if(a.sortTip&&b&&d==a.iconNode&&!ZDBGlobal.IS_MOBILE){var g={};g.title=ZDBI18NMap.g("zrpt.common.tooltip.js.pivotSortTip"),g.tipHTML=ZDBEscapeUtil.encodeForHtml(a.sortTip),ZDBToolTip.showTip(c,g)}else ZDBToolTip.hideTip()},ZDBEvents.setSortIconDisplayTimeout=function(a){var b=a.parGrid;b.sortIconTimeout&&(clearTimeout(b.sortIconTimeout),b.timedOutSortElCol!==a&&(b.timedOutSortElCol.iconNode.className="zdbColHeadArea zdbColHeadIcon")),b.sortIconTimeout=setTimeout(function(){a.iconNode.className="zdbColHeadArea zdbColHeadIcon"},1e4),b.timedOutSortElCol=a},ZDBEvents.onGridCellMouseMove=function(a,b){ZDBGlobal.isResize||ZDBEvents.isResizeArea(a,b)?document.body.style.cursor!="e-resize"&&(document.body.style.cursor="e-resize"):document.body.style.cursor!="default"&&(document.body.style.cursor="default")},ZDBEvents.onGridCellClick=function(a,b){var c=b instanceof ZDBCell?b.colObj:b,d=c.parGrid;return d.isCellClickAllowed()?b.displayNode==a.src?(d.pivotCellOnClick(b),ZDBConst.BROWSER_HANDLE_NO):ZDBConst.BROWSER_HANDLE_YES:ZDBConst.BROWSER_HANDLE_YES},ZDBEvents.onGridCellMouseMove=function(a,b){return ZDBEvents.isResizeArea(a,b)&&document.body.style.cursor!="e-resize"?(document.body.style.cursor="e-resize",ZDBConst.BROWSER_HANDLE_NO):ZDBConst.BROWSER_HANDLE_YES},ZDBEvents.onGridCellMouseDown=function(a,b){var c=b instanceof ZDBCell?b.colObj:b,d=c.parGrid;return ZDBEvents.isResizeArea(a,b)&&!d.resizeDisabled?(ZDBGlobal.isResize=!0,ZDBEvents.setResize(b),ZDBUtil.attachEvent(document,"mousemove",ZDBEvents.onGridMouseMove,!1),ZDBUtil.attachEvent(document,"mouseup",ZDBEvents.onGridMouseUp,!1),ZDBConst.BROWSER_HANDLE_NO):ZDBConst.BROWSER_HANDLE_YES},ZDBEvents.onGridCellMouseUp=function(a,b){if(ZDBGlobal.isResize){gridObj=ZDBGlobal.resizeDIV.gridObj;var c=ZDBGlobal.resizeDIV.cellObj;ZDBEvents.clearResizeMove("resize");if(c instanceof ZDBCell)if(c.endIndex>-1)var d=!0;else c=c.colObj;if(d){var e=parseInt(ZDBEvents.mouseUpPos.x-ZDBEvents.mouseDownPos.x);e=Math.ceil(e/(c.endIndex-c.startIndex+1));for(var f=c.startIndex;f<=c.endIndex;f++)gridObj.resizeColumn(a,c.colObj.parGrid.colHeaders[f],e)}else gridObj.resizeColumn(a,c);return ZDBUtil.detachEvent(document,"mousemove",ZDBEvents.onGridMouseMove,!1),ZDBUtil.detachEvent(document,"mousemove",ZDBEvents.onGridMouseUp,!1),ZDBConst.BROWSER_HANDLE_NO}return ZDBConst.BROWSER_HANDLE_YES},ZDBEvents.onDataSpanMouseOver=function(a,b,c){var d=c.colObj,e=d.parGrid;if(!e.isCellClickAllowed())return;var f=ZDBUtil.getAttribute(a,"class","className");f?a.orgClass=f:a.orgClass="",d.vudPerm&&ZDBUtil.setAttribute(a,a.orgClass+" ZDBPivotLink","class","className")},ZDBEvents.onDataSpanMouseOut=function(a,b,c){var d=c.colObj,e=d.parGrid;if(!e.isCellClickAllowed())return;ZDBUtil.setAttribute(a,a.orgClass,"class","className")},ZDBEvents.highlightLink=function(a,b,c){var d=ZDBUtil.getPropertyFromEl(a,"cellObj","object");if(!d)return;var e=d.cellEl;ZDBUtil.setNamedChildEls(e,e);if(!e)return;var f=e.className;e.className=c?f+" zdbLinkStyle":f.replace(" zdbLinkStyle",""),e.linkEl&&(e.linkEl.className=c?"zdbLinkStyle":"linkFormat")},ZDBEvents.colBaseType=function(a){var b=a.type=="REFCOL"?a.refColType:a.type;return b},ZDBEvents.setRenameIconClassforPivot=function(a,b,c){var d=a.renameIcon,e=a.displayNode;if(!b&&d==undefined)return;var f=a.dataColRefIdx,g=a.colId,h=a.parGrid.viewObj.currentList,i=a.parGrid.viewObj.editMode,j=ZDBUtil.getElementsWithAttribute(h,"viewType","TEXTAXIS"),k=ZDBUtil.getElementsWithAttribute(h,"viewType","YAXIS");i&&(f!=-1?a.isSummary!=null&&j.length==1||a.colSummary!=0||j.length>1?d.className="zdbColHeadArea zdbColHeadRenameIcon "+(b?"renamecolumnheadericon":""):(e.style.marginLeft="15px",d.style.display="none"):g<k.length&&(d.className="zdbColHeadArea zdbColHeadRenameIcon "+(b?"renamecolumnheadericon":"")))},ZDBEvents.setRenameIconClassforSummary=function(a,b,c){var d=a.renameIcon;if(!b&&d==undefined)return;var e=a.parGrid.viewObj.currentList,f=a.parGrid.viewObj.editMode,g=ZDBUtil.getElementsWithAttribute(e,"viewType","GROUP"),h=ZDBUtil.getElementsWithAttribute(e,"viewType","YAXIS"),i=a.colId,j=i-h.length;f==1&&(i<h.length?d.className="zdbColHeadArea zdbColHeadRenameIcon "+(b?"renamecolumnheadericon":""):j<g.length&&(d.className="zdbColHeadArea zdbColHeadRenameIcon "+(b?"renamecolumnheadericon":"")))},ZDBEvents.paste=function(a,b){var c=ZDBClientUI.pasteArea.value;ZDBEvents.setValue(a,c,!1),b.setCellFocus(a)},ZDBEvents.copyCell=function(a,b){var c=ZDBUtil.getSourceElement(a),d=ZDBUtil.getPropertyFromEl(c,"gridObj","object");ZDBClientUI.pasteArea.value="";var e=ZDBDataGrid.getCurrentCell(d)||ZDBDataGrid.getLastFocusCell(d);if(e==null)return;ZDBEvents.copyType=ZDBConst.DATA;var f=e.originalValue||e.displayValue?e.modifiedValue==null?e.colObj.type!="REFCOL"&&e.colObj.type!="BOOLEAN"&&e.colObj.type!="DATE"?e.originalValue:e.displayValue:e.displayValue:"";ZDBClientUI.pasteArea.value=f,ZDBClientUI.pasteArea.select(),setTimeout(function(){d.setCellFocus(e)},100)},ZDBEvents.pasteCell=function(a,b){var c=ZDBUtil.getSourceElement(a),d=ZDBUtil.getPropertyFromEl(c,"gridObj","object"),e=d.permissions;if(ZDBEvents.copyType==ZDBConst.DATA&&(e.add||e.modify)){var f=ZDBDataGrid.getCurrentCell(d)||ZDBDataGrid.getLastFocusCell(d);if(f==null||f.colObj.type=="AUTO_NUMBER"||f.colObj.formula!=null||f.colObj.type=="REFCOL")return;ZDBClientUI.pasteArea.select(),ZDBEvents.paste(f,d)}},ZDBEvents.copyRow=function(a,b){var c=ZDBUtil.getSourceElement(a),d=ZDBUtil.getPropertyFromEl(c,"gridObj","object");ZDBClientUI.pasteArea.value="";var e=d.permissions,f=d.selectedRows,g=f[0].values,h=g.length-2;for(var i=2;i<h;i++){var j=g[i].originalValue||g[i].displayValue?g[i].modifiedValue==null?g[i].colObj.type!="REFCOL"&&g[i].colObj.type!="BOOLEAN"&&g[i].colObj.type!="DATE"?g[i].originalValue:g[i].displayValue:g[i].displayValue:"";ZDBClientUI.pasteArea.value+=i==h-1?j:j+"\t"}ZDBClientUI.pasteArea.select(),ZDBEvents.copyType=ZDBConst.ROWHEAD},ZDBEvents.pasteRow=function(a,b){var c=ZDBUtil.getSourceElement(a),d=ZDBUtil.getPropertyFromEl(c,"gridObj","object"),e=d.permissions;if(e.add||e.modify){var f=ZDBClientUI.pasteArea.value.split("\t"),g=d.selectedRows,h=g[0].values,i=h.length-2;for(var j=2;j<i;j++)h[j].colObj.type!="AUTO_NUMBER"&&h[j].colObj.formula==null&&h[j].colObj.type!="REFCOL"&&ZDBEvents.setValue(h[j],f[j-2],!1);d.setRowHighLight(!0)}},ZDBEvents.showDropDownIcon=function(a,b){var c=b.colObj,d=b.rowObj,e=a.rightDropDownIcon,f=a.getCellElPosInGrid(b);c.freeze&&(e=a.leftDropDownIcon),e.cellObj=b;var g=e.style;g.left=f.cellLeft+c.width-20+"px",g.top=f.cellTop+"px",g.display=""},ZDBEvents.hideDropDownIcon=function(a){a.rightDropDownIcon.style.display="none",a.leftDropDownIcon.style.display="none"},ZDBEvents.showDropDownList=function(a,b){ZDBEvents.onGridDblClick(b),a.style.display="none"},ZDBEvents.generateLinkEl=function(a,b){var c,d,e=ZDBEscapeUtil.encodeForHtml(a.originalValue),f=a.rowObj.parGrid;c=a.displayValue,a.fontCol&&(d="color:"+a.fontCol),e||(e=c),a.colObj.type=="REFCOL"&&(e=ZDBEscapeUtil.encodeForHtml(a.displayValue));if(b=="URL"){var g=ZDBUtil.addHttp(e);return'<a href="'+g+'" title="'+e+'" class="linkFormat" style='+d+" target='_blank' elname='linkEl'>"+(c||"")+"</a>"}if(b=="EMAIL")return'<a href="mailto:'+e+'" title="'+e+'" class="linkFormat" style='+d+" target='_blank' elname='linkEl'>"+(c||"")+"</a>"};var ev=new function(){this.escKeyPressStack=new Array,this.enterKeyPressStack=new Array};jQuery(document).keydown(function(a){ev.keyDown(a)}),ev.keyDown=function(a){var b=a.keyCode;switch(b){case KEY.ESC:if(ev.escKeyPressStack.length<=0)return;var c=ev.escKeyPressStack.pop();c.apply(this,[a]),ZDBUtil.stopEventBubble(a);break;case KEY.ENTER:if(ev.enterKeyPressStack.length<=0)return;var c=ev.enterKeyPressStack.pop();c.apply(this,[a]),ZDBUtil.stopEventBubble(a);break;default:}},ev.addEscHandle=function(a){ev.escKeyPressStack.push(a)},ev.addEnterHandle=function(a){ev.enterKeyPressStack.push(a)};var AjaxAPI=new function(){};AjaxAPI.navigFrameName=null,AjaxAPI.navigFrameEl=null,AjaxAPI.getXMLHttpRequest=function(){try{var a=null;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){a=new ActiveXObject("Microsoft.XMLHTTP")}}catch(b){throw StatusMsgAPI.showErrorMsg("Unable to create XML Http Object for Ajax Request. <br>Reason :"+LangUtils.getErrorMsg(b)),b}return a},AjaxAPI.sendRequest=function(a){var b=AjaxAPI.getXMLHttpRequest();try{a=AjaxOptions.getAsAjaxOptions(a);var c=a.URL,d=a.PARAMETERS,e=a.v("URL");e.indexOf("/reports")!=0&&(e=ZDBGlobal.REPORTS_CONTEXT_NAME+e);var f=a.TARGET;d&&a.vu("METHOD")=="GET"&&(e=appendParamsToUrl(e,d)),a.NOSUBREQPARAM||(e=appendParamsToUrl(e,"SUBREQUEST=XMLHTTP&_ZVER_="+ZDBGlobal._ZVER_)),b.open(a.vu("METHOD"),e,a.isTrue("ASYNCHRONOUS"));var g=new Object;g["X-Requested-With"]="XMLHttpRequest",a.vu("METHOD")=="POST"&&(g["Content-type"]="application/x-www-form-urlencoded;charset=UTF-8"),b.overrideMimeType&&(g.Connection="close"),AjaxUtils.updateObject(g,a.REQUESTHEADERS),d!=null&&a.vu("METHOD")=="POST"&&(d+="&ZDB_CSRF_TOKEN="+getCSRFCookie("CSRF_TOKEN"));var h=a.POSTBODY?a.POSTBODY:d;h=a.vu("METHOD")=="POST"?h:null,h!=null?g["Content-length",h.length]:a.vu("METHOD")=="POST"&&(h="___DUMMYDATA=aa&ZDB_CSRF_TOKEN="+getCSRFCookie("CSRF_TOKEN"),g["Content-length",h.length]);for(var i in g)b.setRequestHeader(i,g[i]);var j=new AjaxResponse(b);b.onreadystatechange=function(){AjaxUtils.handleAjaxResponse(j,a)},a.STATUSFUNC&&a.fn("STATUSFUNC")(j,a);if(a.PROGRESSIND==="true"){var k=b.upload;k.downloadStartTime=(new Date).getTime(),k.currentStart=k.downloadStartTime,k.currentProgress=0,k.startData=0,k.addEventListener("progress",function(b){AjaxAPI.updateProgress(b,a)}),k.addEventListener("load",function(b){AjaxAPI.completeProgress(b,a)})}b.send(h),DOMUtils.enableElements(a.DISABLEELS,!1)}catch(l){throw StatusMsgAPI.showErrorMsg("Unable to send request.<br>Reason : "+LangUtils.getErrorMsg(l)),l}},AjaxAPI.sendNavigableRequest=function(a){a=AjaxOptions.getAsAjaxOptions(a);if(a["METHOD"]!="GET")throw new Error("Currently only Get is supported.");var b=AjaxAPI.getAsNavigableAjaxURL(a);if(AjaxAPI.navigFrameName==null)throw new Error("AjaxAPI.navigFrameName has not been set");AjaxAPI.navigFrameEl.reqOptions=null,window.frames[AjaxAPI.navigFrameName].location.href=b},AjaxAPI.getMCFrame=function(a){if(a["CONTENTAREANAME"]!=null)return MCFrame.getMCFrame(a.CONTENTAREANAME);if(a["NAME"]!=null&&a["TARGET"].indexOf("_mcframe_this")!=-1){var b=DOMUtils.getForm(a.NAME),c=MCFrame.getMCFrame(b);return a.CONTENTAREANAME=c.contentareaname,c}var d=a.TARGET,e=d.substring("_mcframe_".length);return e.indexOf("_")!=-1&&(e=e.substring(0,e.indexOf("_"))),MCFrame.getMCFrame(e)},AjaxAPI.getAsNavigableAjaxURL=function(a){a=AjaxOptions.getAsAjaxOptions(a);var b=a.encode(),c=a.URL;return c.indexOf("SUBREQUEST")==-1&&(c=appendSubRequestArgs(c)),c.lastIndexOf("#")>-1&&(c=c.substring(0,c.lastIndexOf("#"))),c+="#"+encodeURIComponent(b),c},AjaxAPI.checkIfBlankPage=function(a){return a.location.href=="about:blank"||a.location.href.indexOf("blank.html")>0||a.location.href.indexOf("empty.html")>0?!0:!1},AjaxAPI.handleIframeResponse=function(a){AjaxAPI.navigFrameName==null&&(AjaxAPI.navigFrameEl=a,AjaxAPI.navigFrameName=a.getAttribute("name"));var b=window.frames[a.getAttribute("name")];if(AjaxAPI.checkIfBlankPage(b))return;var c=a.reqOptions;b.reqOptions=null;if(c==null){var d=b.location.hash;if(d==null||d.length<2)return;d=d.substring(1),browser_ie&&(d=decodeURIComponent(d)),c=new AjaxOptions(d),c.setV("URL",b.location.href)}var e=new Object;e.iframe=b,e.readyState=4,e.status=200,e.responseText="";var f=!1,g=b.document.getElementsByTagName("*"),h=!1,i="                    ";for(var j=0;j<g.length;j++){var k=g[j];if(k.nodeName=="PRE"){var l=k.childNodes;for(var m=0;m<l.length;m++){if(!h){if(l[m].nodeValue.indexOf(i)!=0)continue;h=!0}e.responseText+=l[m].nodeValue}}}e.responseText.indexOf(i)==0&&(f=!0),f||(e.responseText=g[0].innerHTML);var n=new AjaxResponse(e);AjaxUtils.handleAjaxResponse(n,c)},AjaxAPI.invokeNavigableAction=function(a){var b=a.encode();a.fn("NAVIGFUNCTION_N")(a),AjaxUtils.ignoreNavigFrameLoad=!0,window.frames.AJAXNAVIG.location.href=ZDBGlobal.REPORTS_CONTEXT_NAME+CONTEXT_PATH+"/framework/html/blank.html?"+b},AjaxAPI.submit=function(a,b){var c=AjaxAPI.getFormAttrsAsOptions(a);try{b&&c.update(b);if(c.VALIDATEFUNC&&!c.fn("VALIDATEFUNC")(a))return!1;var d=a.getAttribute("action");d.indexOf(location.protocol)!=0&&d.indexOf("/reports")!=0&&(d=ZDBGlobal.REPORTS_CONTEXT_NAME+d);if(!c.isTrue("USEIFRAME",!1)){var e=ZRSerialize(a);c.update({URL:d,parameters:e});var f=c.SRCVIEW;f==null&&(f=DOMUtils.getParentWithAttr(a,"unique_id"),f!=null&&c.update({SRCVIEW:f.getAttribute("unique_id")})),AjaxAPI.sendRequest(c)}else{a.target=AjaxAPI.navigFrameName;var g=new AjaxOptions(c);d.indexOf("SUBREQUEST")==-1&&!c.NOSUBREQPARAM&&(d=appendParamsToUrl(d,"SUBREQUEST=true&_ZVER_="+ZDBGlobal._ZVER_)),g.update({URL:d,ONSUCCESSFUNC:"AjaxAPI.iframeSubmitResponse",ONFAILUREFUNC:"AjaxAPI.iframeSubmitFailure",FORMNAME:a.name}),a.action=d,c.PROGRESSIND==="true"?AjaxAPI.fileUploadHandler(a,g):(StatusMsgAPI.showOperationStatus(StatusMsgAPI.OPSTATUS.STARTED,g.OPSTATUSID,g.LOADINGTYPE,g.PARENT),AjaxAPI.navigFrameEl.reqOptions=g,a.submit()),DOMUtils.enableElements(c.DISABLEELS,!1)}}catch(h){StatusMsgAPI.showMsg("Script Error Occurred : "+LangUtils.getErrorMsg(h),!1,!0,c.STATUSMSGID)}return!1},AjaxAPI.fileUploadHandler=function(a,b){var c=new XMLHttpRequest;c.open("post",a.action,!0);var d=new AjaxResponse(c);c.onreadystatechange=function(){AjaxUtils.handleAjaxResponse(d,b)},b.STATUSFUNC&&b.fn("STATUSFUNC")(d,b);var e=c.upload;e.downloadStartTime=(new Date).getTime(),e.currentStart=e.downloadStartTime,e.currentProgress=0,e.startData=0,e.addEventListener("progress",function(a){AjaxAPI.updateProgress(a,b)}),e.addEventListener("load",function(a){AjaxAPI.completeProgress(a,b)}),c.send(new FormData(a))},AjaxAPI.completeProgress=function(a,b){b.PROGPERCDIV&&jQuery("#"+b.PROGPERCDIV).html("").hide(),jQuery("#"+b.PROGRESSDIV).css("width","100%")},AjaxAPI.updateProgress=function(a,b){if(a.lengthComputable){var c=Math.ceil(a.loaded/a.total)*100;b.PROGPERCDIV&&jQuery("#"+b.PROGPERCDIV).html(c+"%"),jQuery("#"+b.PROGRESSDIV).css("width",c+"%")}},AjaxAPI.getFormAttrsAsOptions=function(a){var b=a.attributes,c=new AjaxOptions({submittedFrm:a.name});for(var d=0;d<b.length;d++)c.setV(b.item(d).nodeName,b.item(d).nodeValue);return c},AjaxAPI.iframeSubmitResponse=function(a,b){var c=DOMUtils.getForm(b.FORMNAME),d=AjaxAPI.getFormAttrsAsOptions(c);StatusMsgAPI.showOperationStatus(a.opStatus,b.OPSTATUSID,b.LOADINGTYPE,b.PARENT),d["ONSUCCESSFUNC"]!=null&&d.fn("ONSUCCESSFUNC")(a,d)},AjaxAPI.iframeSubmitFailure=function(a,b){var c=DOMUtils.getForm(b.FORMNAME),d=AjaxAPI.getFormAttrsAsOptions(c);AjaxAPI.showRespMsg(a,d)},AjaxAPI.dummyFunction=function(a,b){return StatusMsgAPI.OPSTATUS.FINISHED},AjaxAPI.refreshView=function(a,b){return b.update({VIEWTOREFRESH_RN:b.v("SRCVIEW"),NAVIGABLE_RN:!1}),ViewAPI.refreshView(b),StatusMsgAPI.OPSTATUS.INPROGRESS},AjaxAPI.setAjaxAttributes=function(a){a=new AjaxOptions(a);var b=a.form("FORMNAME");for(var c in a){if(typeof a[c]!="string")continue;existValue=a[c],b.setAttribute(c.toLowerCase(),existValue)}b.onsubmit||(b.onsubmit=function(){return AjaxAPI.submit(this)}),b.requestOptions=a},AjaxAPI.showRespMsg=function(a,b){var c=a.opStatus;StatusMsgAPI.showOperationStatus(c,b.OPSTATUSID,b.LOADINGTYPE,b.PARENT);if(c==StatusMsgAPI.OPSTATUS.STARTED){StatusMsgAPI.closeMsgImmediately(b.STATUSMSGID);return}if(c==StatusMsgAPI.OPSTATUS.FAILED_SCRIPT)throw a.EXCEP;if(c==StatusMsgAPI.OPSTATUS.FAILED){AjaxAPI.storeLastFailedResp&&(AjaxAPI.lastFailedContent=a.responseText);var d=b.ONFAILUREFUNC;if(b["ONFAILUREFUNC"]!=null){var e=b.fn("ONFAILUREFUNC")(a,b);if(AjaxAPI.ONFAILUREFUNCHANDLED||e)return}var f=a.getResponsePart("STATUS_MESSAGE");f==null?StatusMsgAPI.showErrorMsg(a.getOnlyHtml()):StatusMsgAPI.showMsg(f,c==StatusMsgAPI.OPSTATUS.FINISHED,!0,b.STATUSMSGID)}else if(c==StatusMsgAPI.OPSTATUS.FINISHED){var f=a.getResponsePart("STATUS_MESSAGE");if(f==null){var g=b.PREVRESPONSE_RN;g!=null&&(f=g.getResponsePart("STATUS_MESSAGE"))}f!=null&&StatusMsgAPI.showMsg(f,c==StatusMsgAPI.OPSTATUS.FINISHED,!0,b.STATUSMSGID)}else c==StatusMsgAPI.OPSTATUS.INPROGRESS&&(b.PREVRESPONSE_RN=a);(!AjaxAPI.checkAttrForInvokeScript||b.INVOKESCRIPTS)&&a.invokeScripts()},AjaxOptions.getAsAjaxOptions=function(a){return a instanceof AjaxOptions||(a=new AjaxOptions(a)),a};var AjaxUtils=new function(){};AjaxUtils.ignoreNavigFrameLoad=!1,AjaxUtils.handleNavigFrameLoad=function(){var a=window.frames.AJAXNAVIG.location.search;window.status="handle NavigFrameLoad called. "+a+" "+AjaxUtils.ignoreNavigFrameLoad;if(AjaxUtils.ignoreNavigFrameLoad){AjaxUtils.ignoreNavigFrameLoad=!1;return}if(a==null||a=="")return;var b=new AjaxOptions(a);b.fn("NAVIGFUN_N")(b)},AjaxUtils.scriptFragment="(?:<script.*?>)((\n|.)*?)(?:</script>)",AjaxUtils.invokeScriptsInHtml=function(a){var b=new RegExp(AjaxUtils.scriptFragment,"img"),c=a.match(b);AjaxUtils.invokeScripts(c)},AjaxUtils.separateScriptAndHtml=function(a){var b=new Object,c=new RegExp(AjaxUtils.scriptFragment,"img");return b.html=a.replace(c,""),c=new RegExp(AjaxUtils.scriptFragment,"img"),b.scripts=a.match(c),b},AjaxUtils.invokeScripts=function(a){if(a==null)return;var b=document.createElement("div"),c="";for(var d=0;d<a.length;d++)c+="\n"+a[d];var e=new RegExp("<script>","img");c=c.replace(e,"<SCRIPT>"),e=new RegExp("</script>","img"),c=c.replace(e,"</SCRIPT>"),b.innerHTML="<html><body>"+c+"</body></html>",a=b.getElementsByTagName("SCRIPT");for(var d=0;d<a.length;d++)AjaxUtils.scheduleScript(a[d].text,a[d].src)},AjaxUtils.scheduleScript=function(a,b){var c=document.createElement("SCRIPT");b!=null&&b!=""&&(c.src=b),c.text=a,document.getElementsByTagName("HEAD")[0]?document.getElementsByTagName("HEAD")[0].appendChild(c)
:document.createElement("HEAD").appendChild(c)},AjaxUtils.handleAjaxResponse=function(a,b){if(a.transport.readyState!=4){if(b.ONABORTFUNC){var c=b.fn("ONABORTFUNC")(a,b);if(c){StatusMsgAPI.showOperationStatus(StatusMsgAPI.OPSTATUS.FINISHED,b.OPSTATUSID,reqOptions.LOADINGTYPE,reqOptions.PARENT),a.transport.abort();return}}return}a.responseText=a.transport.responseText,a.opStatus=StatusMsgAPI.OPSTATUS.INPROGRESS,b.ORIGOPTIONS&&(b=b.ORIGOPTIONS,closeDialog()),DOMUtils.enableElements(b.DISABLEELS,!0),a.opStatus=AjaxUtils.internalHandleAjaxResponse(a,b),b.STATUSFUNC&&b.fn("STATUSFUNC")(a,b)},AjaxUtils.internalHandleAjaxResponse=function(a,b){var c=0;AjaxAPI.statusSearchIndex&&(c=a.responseText.length-AjaxAPI.statusSearchIndex),c<0&&(c=0);if(a.responseText.indexOf("__ERROR__LOGIN",c)>-1)return AjaxUtils.handleReLogin(a,b),StatusMsgAPI.OPSTATUS.INPROGRESS_LOGIN;if(a.responseText.indexOf("__ERROR__",c)>-1||!a.isHttpReqSuccess())return StatusMsgAPI.OPSTATUS.FAILED;var d=StatusMsgAPI.OPSTATUS.FINISHED;if(b.ONSUCCESSFUNC)try{d=b.fn("ONSUCCESSFUNC")(a,b),d||(d=StatusMsgAPI.OPSTATUS.FINISHED)}catch(e){return a.EXCEP=e,StatusMsgAPI.OPSTATUS.FAILED_SCRIPT}return d},AjaxUtils.handleReLogin=function(a,b){showDialog(a.responseText,"title=ReLogin(Session Timed Out),modal=yes");var c=DOMUtils.getFirstMatchingElement(oDialog.getElementsByTagName("form"),null,"name","login");if(c==null)throw new Error('Login Page should contain a form with name as "login"');c.REQUESTOPTIONS=b,c.onsubmit=function(){return AjaxUtils.submitReLoginFrm(c),!1};return},AjaxUtils.updateObject=function(a,b){if(b==null)return;for(property in b)a[property]=b[property];return a},AjaxUtils.extractFromResponse=function(a,b){var c=document.createElement("div");c.innerHTML=a;var d=DOMUtils.getFirstMatchingElement(c.getElementsByTagName("div"),null,"part",b);return d!=null?d.innerHTML:null};var StatusMsgAPI=new function(){};StatusMsgAPI.showOperationStatus=function(a,b,c,d){if(c=="FILLINGLOAD"){var e=jQuery(".ZRSFillLoading");a==StatusMsgAPI.OPSTATUS.STARTED||a==StatusMsgAPI.OPSTATUS.INPROGRESS||a==StatusMsgAPI.OPSTATUS.INPROGRESS_LOGIN?(jQuery(d).append(e),e.width("0%"),e.show().animate({width:"80%"},3e3)):e.show().stop(!0,!0).animate({width:"100%"},100)}else{b==null&&(b="mc_loading");var f=typeof b=="string"?document.getElementById(b):b;if(f!=null){var g=f.getAttribute("classPrefix");g==null&&(g="mc"),a==StatusMsgAPI.OPSTATUS.STARTED||a==StatusMsgAPI.OPSTATUS.INPROGRESS||a==StatusMsgAPI.OPSTATUS.INPROGRESS_LOGIN?DOMUtils.replaceCSSClass(f,g+"Loading",g+"Loaded"):DOMUtils.replaceCSSClass(f,g+"Loaded",g+"Loading")}}},StatusMsgAPI.showMsgOnNextPageLoad=function(a,b){a=a.replace(/\n/g,"\\n");var c=new RegExp("'","g");a=a.replace(c,"\\'"),AjaxAPI.setOnNextPageLoadScript("StatusMsgAPI.showMsg('"+a+"',"+b+")")},StatusMsgAPI.showMsg=function(a,b,c,d){d=StatusMsgAPI.getDivId(d,"MSGDIV","mc_msg");var e=document.getElementById(d);if(e!=null){e.className=b?"successMsg":"failureMsg";var f=document.getElementById(d+"_txt");f==null&&(f=e),f.innerHTML=a,c==null&&(c=!0),b&&c==1?StatusMsgAPI.closeMsg(d):b||(e.style.visibility="visible",window.clearInterval(e.f_intvl))}else b||StatusMsgAPI.showErrorMsg(a)},StatusMsgAPI.closeMsg=function(a){a=StatusMsgAPI.getDivId(a,"MSGDIV","mc_msg"),MCEffect.FadeOut("mc_msg",{ONCLOSE:"StatusMsgAPI.removeMsg",MSGDIV:a})},StatusMsgAPI.closeMsgImmediately=function(a){a=StatusMsgAPI.getDivId(a,"MSGDIV","mc_msg");var b=document.getElementById(a);b!=null&&(b.visibility="hidden")},StatusMsgAPI.removeMsg=function(a){a=StatusMsgAPI.getDivId(a,"MSGDIV","mc_msg");var b=document.getElementById(a);b!=null&&(b.className="hide")},StatusMsgAPI.getDivId=function(a,b,c){return a instanceof Object&&(a=a[b]),a==null&&(a=c),a},StatusMsgAPI.showErrorMsg=function(a){showDialog(a,"title=Error Occured")},StatusMsgAPI.OPSTATUS=new function(){this.STARTED=1,this.INPROGRESS=2,this.INPROGRESS_LOGIN=3,this.FINISHED=4,this.FAILED=5,this.FAILED_SCRIPT=6};var DOMUtils=new function(){this.addCSSClass=function(a,b){for(var c=0;c<a.length;c++){var d=a[c].className;if(d==null)d=b;else{var e=d.indexOf(b);e==-1&&(d=d.trim(),d+=" "+b)}a[c].className=d}},this.replaceCSSClass=function(a,b,c){var d=a.className;if(d==null||d==c)d=b;else{var e=d.indexOf(c);e==-1?d.indexOf(b)==-1&&(d+=" "+b):d=d.substring(0,e)+b+d.substring(e+c.length)}a.className=d},this.removeCSSClass=function(a,b){for(var c=0,d=a.length;c<d;c++){var e=a[c].className;if(e==null)continue;var f=e.indexOf(b);f>-1&&(e==b?e=null:e=e.substring(0,f)+e.substring(f+b.length+1)),a[c].className=e}},this.filterElements=function(a,b,c,d){var e=new Array,f=0;for(var g=0,h=a.length;g<h;g++){var i=a[g];if(!i.getAttribute)continue;if(b==null||i.nodeName==b)if(c==null||i.getAttribute(c)==d||d=="*"&&i.getAttribute(c)!=null)e[f++]=i}return e},this.getFirstMatchingElement=function(a,b,c,d){for(var e=0,f=a.length;e<f;e++){var g=a[e];if(!g.getAttribute)continue;if(b==null||g.nodeName==b)if(c==null||g.getAttribute(c)==d||d=="*"&&g.getAttribute(c)!=null)return g}return null},this.getFirstMatchingChild=function(a,b,c,d){b==null&&(b="*");var e=a.getElementsByTagName(b);return this.getFirstMatchingElement(e,null,c,d)},this.getChildElsWithAttr=function(a,b,c){var d=DOMUtils.getNodes(a,b);return this.filterElements(d,null,b,c)},this.getChildElsWithTagAttr=function(a,b,c,d){var e=b.getElementsByTagName(a);return this.filterElements(e,null,c,d)},this.getFirstChild=function(a,b,c,d,e){var f,g=DOMUtils.getChildElsWithAttr(a,b,c);for(i=0;i<g.length;i++){f=g[i].parentNode;while(f!=a){if(f.getAttribute(d)==e)break;f=f.parentNode}if(f==a)return g[i]}},this.getParentWithAttr=function(a,b,c){var d=0,e=a.parentNode;while(e!=null&&e.getAttribute!=null&&(c==null||d<c)){if(e.getAttribute(b)!=null)return e;e=e.parentNode}return null},this.getSelfOrParentWithAttr=function(a,b){return a.getAttribute(b)!=null?a:this.getParentWithAttr(a,b)},this.getParentWithAttrValue=function(a,b,c){var d=a.parentNode;while(d!=null&&d.getAttribute!=null){if(d.getAttribute(b)==c)return d;d=d.parentNode}return null},this.getSelfOrParentWithAttrValue=function(a,b,c){return a.getAttribute(b)==c?a:this.getParentWithAttrValue(a,b,c)},this.getParentWithTagName=function(a,b){var c=a.parentNode;return c?c.tagName.toLowerCase()==b?c:this.getParentWithTagName(c,b):!1},this.getForm=function(a){var b=document.forms[a];if(b!=null)return b;for(var c=0;c<document.forms.length;c++)if(document.forms[c].name==a)return document.forms[c];return null},this.getForm=function(a){var b=document.forms[a];if(b!=null)return b;for(var c=0;c<document.forms.length;c++)if(document.forms[c].name==a)return document.forms[c];return null},this.setAttribute=function(a,b,c){for(var d=0;d<a.length;d++)a[d].setAttribute(b,c)},this.setProperty=function(a,b,c){for(var d=0;d<a.length;d++)a[d][b]=c},this.fillData=function(a,b){for(var c=0;c<a.length;c++)this.setValueOnEl(a[c],b[a[c].getAttribute("name")])},this.setValueOnEl=function(a,b){var c=a.type,d=a.nodeName;if(b==null)return;if(c=="radio"||c=="checkbox")a.checked=b=="true";else if(c=="select-one"){for(var e=0;e<a.options.length;e++)if(a.options[e].value&&a.options[e].value==b||a.options[e].innerHTML==b)a.options[e].selected=!0}else d=="DIV"||d=="SPAN"?a.innerHTML=b:a.value=b},this.enableElement=function(a,b){var c=$(a);c&&(b?c.removeAttribute("disabled"):c.setAttribute("disabled","true"))},this.enableElements=function(a,b){if(a==null||a=="")return;var c=a.split(",");for(var d=0;d<c.length;d++)this.enableElement(c[d],b)},this.removeFromView=function(a){if(a==null||a.parentNode==null)return;a.parentNode.removeChild(a)},this.getNodes=function(a,b){var c=null;return a.querySelectorAll?c=a.querySelectorAll("["+b+"]"):c=jQuery(a).find("["+b+"]")},this.getValueFromEl=function(a){var b=a.type;return b==="radio"||b==="checkbox"?a.checked:b==="select-one"?a.options[a.selectedIndex].value:b==="text"||b==="textarea"?a.value:a.innerHTML}};LangUtils=new function(){},LangUtils.cloneArray=function(a){var b=new Array;for(var c=0;c<a.length;c++)b[c]=a[c];return b},LangUtils.cloneObject=function(a){var b={};for(var c in a)b[c]=a[c];return b},LangUtils.getErrorMsg=function(a){return a.message!=null?a.message:a.toString()},LangUtils.indexOf=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return c;return-1};var browser_opera=!1,browser_ie=!1,browser_nn6=!1,browser_nn4=!1;document.all?window.navigator.appName.toUpperCase=="OPERA"?browser_opera=!0:browser_ie=!0:document.layers||!document.all&&document.getElementById?browser_nn6=!0:document.layers&&(browser_nn4=!0);var _FRM_CURRENT_ERROR_FIELD=null,_FRM_SET_FAILED_FOCUS=!0,MCEffect=new function(){};MCEffect.CONFIG={INTERVAL:10,SCROLL_INTERVAL:3,FADE_INTERVAL:5},MCEffect.getValue=function(a,b,c){return b!=null&&b[a]!=null?b[a]:c!=null&&c[a]!=null?c[a]:null},MCEffect.getDimensions=function(a){if(a.style.display!="none")return{width:a.offsetWidth,height:a.offsetHeight};var b=a.style,c=b.visibility,d=b.position;b.display="block",b.visibility="hidden",b.position="absolute";var e=a.offsetWidth,f=a.offsetHeight;return b.display="none",b.position=d,b.visibility=c,{width:e,height:f}},MCEffect.SlideDown=function(elementID,reqOptions){var content=document.getElementById(elementID);if(content==null)return;if(MCEffect.getValue("INTERVAL",reqOptions,MCEffect.CONFIG)==-1){content.style.display="block";if(reqOptions!=null){var obj=reqOptions.ONOPEN;obj!=null&&eval(obj)(reqOptions)}return}window.clearInterval(content._intvl),window.clearInterval(content.s_intvl),content._reqOptions=reqOptions,appendParent(content);var contentHeight=MCEffect.getDimensions(content).height,margin=-1*contentHeight;content.style.marginTop=margin+"px",content.setAttribute("__margin",margin);var openIntvl=window.setInterval("MCEffect.openContent('"+elementID+"')",1);content._intvl=openIntvl},MCEffect.openContent=function(elementID){var content=document.getElementById(elementID),margin=parseInt(content.getAttribute("__margin")),reqOptions=content._reqOptions;if(margin<=0){content.style.marginTop=margin+"px",margin+=MCEffect.getValue("INTERVAL",reqOptions,MCEffect.CONFIG),content.setAttribute("__margin",margin),content.style.display="block";var top=parseInt(findPosY(content)),contentHeight=content.offsetHeight,docHeight=document.body.clientHeight,scrollTop=document.body.scrollTop;top+contentHeight-scrollTop>docHeight&&(replaceParent(content),content.style.marginTop="0px",window.clearInterval(content._intvl),MCEffect.ScrollToView(elementID,reqOptions))}else{replaceParent(content),content.style.marginTop="0px",window.clearInterval(content._intvl);if(reqOptions!=null){var obj=reqOptions.ONOPEN;obj!=null&&eval(obj)(reqOptions)}}},MCEffect.ScrollToView=function(a,b){var c=document.getElementById(a);if(!c)return;window.clearInterval(c.s_intvl);var d=parseInt(findPosY(c)),e=c.offsetHeight,f=document.body.clientHeight,g=document.body.scrollTop,h=null;if(d-g<0)b!=null?b._scroll=d:b={_scroll:d},c._reqOptions=b,h=window.setInterval("MCEffect.scrollUp('"+a+"')",1);else if(d+e-g>f){var i=d+e-f;b!=null?b._scroll=i:b={_scroll:i},c._reqOptions=b,h=window.setInterval("MCEffect.scrollDown('"+a+"')",1)}c.s_intvl=h},MCEffect.scrollUp=function(elementID){var scrollTop=document.body.scrollTop,element=document.getElementById(elementID),reqOptions=element._reqOptions;if(!reqOptions){window.clearInterval(element.s_intvl);return}var scrollUpCnt=reqOptions._scroll;if(scrollTop>scrollUpCnt)document.body.scrollTop-=3;else{scrollUpCnt=0,window.clearInterval(scrollUpIntvl);if(reqOptions!=null){var obj=reqOptions.ONOPEN;obj!=null&&eval(obj)(reqOptions)}}},MCEffect.scrollDown=function(elementID){var scrollTop=document.body.scrollTop,element=document.getElementById(elementID),reqOptions=element._reqOptions;if(!reqOptions){window.clearInterval(element.s_intvl);return}var scrollDownCnt=reqOptions._scroll;if(scrollTop<scrollDownCnt)document.body.scrollTop+=3;else{scrollDownCnt=0,window.clearInterval(element.s_intvl);if(reqOptions!=null){var obj=reqOptions.ONOPEN;obj!=null&&eval(obj)(reqOptions)}}},MCEffect.SlideUp=function(elementID,reqOptions){var content=document.getElementById(elementID);if(content==null)return;if(MCEffect.getValue("INTERVAL",reqOptions,MCEffect.CONFIG)==-1){content.style.display="none";if(reqOptions!=null){var obj=reqOptions.ONCLOSE;obj!=null&&eval(obj)(reqOptions)}return}window.clearInterval(content._intvl),content._reqOptions=reqOptions,appendParent(content),content.style.display="block";var contentHeight=content.offsetHeight,margin=0;content.setAttribute("__margin",margin),content.setAttribute("_conHeight",contentHeight);var closeIntvl=window.setInterval("MCEffect.closeContent('"+elementID+"')",1);content._intvl=closeIntvl},MCEffect.closeContent=function(elementID){var content=document.getElementById(elementID),contentHeight=content.getAttribute("_conHeight"),margin=parseInt(content.getAttribute("__margin"));if(margin>=contentHeight*-1)content.style.marginTop=margin+"px",margin-=MCEffect.getValue("INTERVAL",reqOptions,MCEffect.CONFIG),content.setAttribute("__margin",margin);else{content.style.display="none",replaceParent(content),window.clearInterval(content._intvl);var reqOptions=content._reqOptions;if(reqOptions!=null){var obj=reqOptions.ONCLOSE;obj!=null&&eval(obj)(reqOptions)}}},MCEffect.FadeOut=function(a,b){var c=document.getElementById(a);if(c==null)return;window.clearInterval(c.f_intvl),c.style.visibility="visible";if(browser_ie){c.style.filter="progid:DXImageTransform.Microsoft.Fade(duration=6)",c.filters[0].Apply(),c.style.visibility="hidden",c.filters[0].Play();if(b!=null){var d=b.ONCLOSE;d!=null&&(c.___REQOPT=b,setTimeout("closeOnFade('"+a+"')",6e3))}return}var e=window.setInterval("MCEffect.fadeOut('"+a+"')",1);c.f_intvl=e,c._cnt=3,c.style.opacity=c._cnt,c._reqOptions=b},MCEffect.fadeOut=function(elementID){var element=document.getElementById(elementID);if(element==null)return;var cnt=parseFloat(element._cnt);if(cnt>0){var def=""+MCEffect.getValue("FADE_INTERVAL",MCEffect.CONFIG);if(def.length>2)cnt-=.09,cnt<1&&(element.style.opacity=cnt);else{var temp="0.0";def.length==1&&(temp="0.00"),cnt-=parseFloat(temp+def),cnt<1&&(element.style.opacity=cnt)}element._cnt=cnt}else{element.style.opacity="",element.style.visibility="hidden",window.clearInterval(element.f_intvl);var reqOptions=element._reqOptions;if(reqOptions!=null){var obj=reqOptions.ONCLOSE;obj!=null&&eval(obj)(reqOptions)}}};var ZDBI18NMap=new function(){this.g=function(a,b){var c=a.indexOf(".js.");if(c<0)return a;var d=a.substring(0,c),e=a;return I18NProps.keySet[d]&&(e=I18NProps.keySet[d][a],e==null&&(e=a)),e},this.f=function(a){var b=this.g(a);if(arguments.length==1)return b;for(var c=1;c<arguments.length;c++)b=b.replace("{"+(c-1)+"}",arguments[c]);return b}};LazyLoad=function(a){function h(b,c){var d=a.createElement(b),e;for(e in c)c.hasOwnProperty(e)&&d.setAttribute(e,c[e]);return d}function i(a){var b=d[a],c,g;b&&(c=b.callback,g=b.urls,g.shift(),e=0,g.length||(c&&c.call(b.context,b.obj),d[a]=null,f[a].length&&k(a)))}function j(){var c=navigator.userAgent;b={async:a.createElement("script").async===!0},(b.webkit=/AppleWebKit\//.test(c))||(b.ie=/MSIE|Trident/.test(c))||(b.opera=/Opera/.test(c))||(b.gecko=/Gecko\//.test(c))||(b.unknown=!0)}function k(e,g,k,n,o){var p=function(){i(e)},q=e==="css",r=[],s,t,u,v,w,x;b||j();if(g){g=typeof g=="string"?[g]:g.concat();if(q||b.async||b.gecko||b.opera)f[e].push({urls:g,callback:k,obj:n,context:o});else for(s=0,t=g.length;s<t;++s)f[e].push({urls:[g[s]],callback:s===t-1?k:null,obj:n,context:o})}if(d[e]||!(v=d[e]=f[e].shift()))return;c||(c=a.head||a.getElementsByTagName("head")[0]),w=v.urls.concat();for(s=0,t=w.length;s<t;++s)x=w[s],q?u=b.gecko?h("style"):h("link",{href:x,rel:"stylesheet"}):(u=h("script",{src:x,crossorigin:"anonymous"}),u.async=!1),u.className="lazyload",u.setAttribute("charset","utf-8"),b.ie&&!q&&"onreadystatechange"in u&&!("draggable"in u)?u.onreadystatechange=function(){/loaded|complete/.test(u.readyState)&&(u.onreadystatechange=null,p())}:q&&(b.gecko||b.webkit)?b.webkit?(v.urls[s]=u.href,m()):(u.innerHTML='@import "'+x+'";',l(u)):u.onload=u.onerror=p,r.push(u);for(s=0,t=r.length;s<t;++s)c.appendChild(r[s])}function l(a){var b;try{b=!!a.sheet.cssRules}catch(c){e+=1,e<200?setTimeout(function(){l(a)},50):b&&i("css");return}i("css")}function m(){var a=d.css,b;if(a){b=g.length;while(--b>=0)if(g[b].href===a.urls[0]){i("css");break}e+=1,a&&(e<200?setTimeout(m,50):i("css"))}}var b,c,d={},e=0,f={css:[],js:[]},g=a.styleSheets;return{css:function(a,b,c,d){k("css",a,b,c,d)},js:function(a,b,c,d){k("js",a,b,c,d)}}}(this.document);var ZDBClientUI=new function(){this.curDummyViewId=-10,this.loadDivs={},this.typeDefns={},this.resizeMain=function(){var a=document.getElementById("ZDBRIGHTDIV");a.style.display="none";var b=ZDBUtil.getOffsetSize($("ZDBHEADER"),!1)+ZDBUtil.getOffsetSize($("ZDBMAINDIV"),!1);b=jQuery(window).height()-b-4,a.style.height=b+"px",a.style.display=""},this.resizeDomainHmePage=function(){var a=jQuery("#ZDBDomainHomePageDiv"),b=jQuery("#ZDBHEADER").height(),c=jQuery(window).height()-b;a.css("height",c-5);var d=c-45;jQuery("#ZDBDomainDBList").css("height",d)},this.focusMain=function(a){var b=ZDBUtil.getSourceElement(a);if(b&&b.parentNode)return!0;if(!ZDBClientUI.selectedTab)return!0;var c=ZDBClientUI.selectedTab.view},this.initReferences=function(){this.placeHolder=document.getElementById("ZDBPLACEHOLDER"),this.poweredByEl=document.getElementById("ZDBPoweredByEl"),this.mainPanel=document.getElementById("ZDBMAINEL"),this.headerArea=document.getElementById("ZDBHEADER"),this.dummyGrid=document.getElementById("ZDBDUMMYGRID"),this.blankView=document.getElementById("ZDBBLANKVIEW"),this.dummyGraph=document.getElementById("ZDBDUMMYGRAPH"),this.mainLoader=document.getElementById("ZDBMainLoader"),this.iPhoneBlankView=document.getElementById("ZDBIPHONEBLANKVIEW"),this.dummyGraph.parentNode.removeChild(this.dummyGraph),this.tabTpl=document.getElementById("ZDBTABTPL"),this.swipeArea=document.getElementById("ZDBSWIPE"),this.swipeAreaTD=document.getElementById("ZDBSWIPETD"),this.responseHolder=document.getElementById("ZDBRESPONSEHOLDER"),this.viewOption=document.getElementById("ZDBViewOption"),this.viewList=document.getElementById("ZDBVIEWLISTDIV"),this.layoutMode="normal",this.navigatable=$("ZDBNAVIGTABLE"),this.swipeBar=$("ZDBSwipeBar"),this.pasteArea=$("ZDBPasteArea"),this.leftArrowWidth=jQuery("#ZR_LeftTabNavArrow").width(),this.minMaxIconWidth=jQuery("#ZR_MinMaxIcon").width(),this.rightArrowWidth=jQuery("#ZR_RightTabNavArrow").width(),this.addTabIconWidth=jQuery("#ZRNewTab").width(),this.listTabNavArrowWidth=jQuery("#ZR_ListTabNavArrow").width()},this.resizeAllDInst=function(){var a=document.body,b=this.standAlone?0:2,c=2,d=jQuery(window).width()-c,e=jQuery(window).height()-b,f=$("ZDBMainBox");f.style.margin="auto",jQuery(f).height(e),jQuery(f).width(d);var g=jQuery("#ZDBHead").height();if(e==a.prevClientHeight&&d==a.prevClientWidth)return;a.prevClientHeight=e,a.prevClientWidth=d;var h=ZDBClientUI.selectedTab;if(h&&h.view.dialogStatus>0){ZDBClientUI.resizeHolders(!1),ZDBInlineDialog.resized=!0,ZDBInlineDialog.resizeDialog(),h.focusedDialog&&h.focusedDialog.gridObj&&h.focusedDialog.gridObj.type=="TableDesign"&&ZDBClientUI.resizeEditGridHolder();return}ZDBClientUI.resizeHolders(!0),h&&(h.view instanceof ZDBDashboard&&h.view.OldDashDivSize&&(h.view.OldDashDivSize.width=h.view.dashDiv.clientWidth),h.view.resize(),ZDBMenu.resizeTitleNDesc(h.view.toolbar),ZDBTabHandler.moveToVisibleArea())},this.resizeHolders=function(a){a&&ZDBClientUI.resizePlaceHolder(),ZDBClientUI.resizeSwipe(),ZDBClientUI.resizeTabHolder(),ZDBClientUI.resizeCustomDashboardHeader()},this.resizeCustomDashboardHeader=function(){window.CustomHomePage&&CustomHomePage.resizeCustomDashboardHeader()},this.resizeSwipe=function(){var a=ZDBClientUI.swipeArea;a.style.display="none";var b=ZDBClientUtil.offsetHeight(ZDBClientUI.headerArea)+ZDBClientUtil.offsetHeight($("ZDBNAVIGTABLE"))+ZDBClientUtil.offsetHeight($("ZDBLeftPanelBtm"));b=document.body.prevClientHeight-b,b+=BROWSER.IE?0:-2,a.style.display="",a.style.height=b-1+"px",ZDBClientUI.resizeRightExplorerView()},this.resizeRightExplorerView=function(){var a=$("ZDBEXPTITLE"),b=$("ZDBEXPHEADERROW"),c=ZDBUtil.getOffsetSize($("ZDBPLACEHOLDER"),!1)-(ZDBUtil.getOffsetSize(a,!1)+ZDBUtil.getOffsetSize(b,!1));c+=BROWSER.IE?0:-2;var d=ZDBClientUI.viewList,e=9;d.style.height=c-e+"px"},this.positionWorkArea=function(){var a=0;if(ZDBClientUI.layoutMode=="max"||ZDBNavigation.hiddenState)a=jQuery("#attachedSwipeArea").width();jQuery("[elname='graphFieldHolder']").css("left",a+"px"),jQuery("[elname='workArea']").css("left",a+"px")},this.resizeTabHolder=function(){if(this.standAlone!=1){var a=ZDBClientUI.layoutMode=="max"||ZDBNavigation.hiddenState?0:250,b=jQuery(document).width()-a,c=document.getElementById("ZDBTabHolder"),d=b;if(d>5){var e=ZDBClientUI.leftArrowWidth,f=ZDBClientUI.minMaxIconWidth,g=4,h=e+f+g,i=ZDBClientUI.rightArrowWidth,j=ZDBClientUI.listTabNavArrowWidth,k=ZDBClientUI.addTabIconWidth,l=20,m=i+k+j+l;c.style.width=d-(h+m)+"px"}c.style.display=""}},this.resizePlaceHolder=function(){var a=document.body;document.body.style.overflow="hidden";var b=ZDBClientUI.placeHolder;b.style.display="none";var c=ZDBClientUtil.offsetHeight(ZDBClientUI.headerArea)+ZDBClientUtil.offsetHeight(ZDBClientUI.mainPanel);c=a.prevClientHeight-c-3,this.poweredByEl&&(c-=ZDBClientUtil.offsetHeight(this.poweredByEl.parentNode)),b.style.height=c+"px",b.style.display="block";var d=ZDBGlobal.integrated?0:ZDBClientUtil.offsetWidth($("ZDBShowHideNavigIconContainer")),e=$("ZDBNavigationBarTD"),f="";ZDBClientUI.standAlone||ZDBGlobal.integrated||ZDBClientUI.layoutMode=="max"?f="none":ZDBNavigation.hiddenState&&!ZDBNavigation.popOut&&jQuery(e).css({position:"absolute","z-index":"10000","box-shadow":"0px 4px 10px #666666",left:"-256px"}),e.style.display=f,ZDBClientUI.mainPanel.style.display="";var g=2;g+=ZDBClientUI.layoutMode=="max"||ZDBNavigation.hiddenState||ZDBClientUI.standAlone||ZDBGlobal.integrated?0:250;var h=ZDBClientUI.standAlone?2:17;b.style.width=document.body.prevClientWidth-g-h+"px",ZDBClientUI.placeHolderWidth=b.clientWidth,ZDBClientUI.placeHolderHeight=b.clientHeight;var i=ZDBClientUI.getViewObj(b,"view");if(i&&i.type=="QueryTable"&&i.editMode&&i.editor){var j=$("ZDBSQLQueryTxtFldTD"),k=j.getElementsByTagName("div")[0],l=i.editor;l.setSize($("ZDBPLACEHOLDER").offsetWidth,k.offsetHeight),ZDBSQLTable.positionResizeEl()}},this.resizeEditGridHolder=function(){var a=document.body;a.style.overflow="hidden";var b=ZDBClientUI.selectedTab,c=b.focusedDialog,d=ZDBClientUI.editGridHolder,e=ZDBClientUtil.offsetHeight(ZDBClientUI.headerArea)+ZDBClientUtil.offsetHeight($("TABSHOLDERPARENT"))+ZDBClientUtil.offsetHeight(c.designDIV.dlgTitleBar)+ZDBClientUtil.offsetHeight($("ZREditDesignToolBar"));e=a.prevClientHeight-e;var f=$("ZDBNavigationBarTD"),g="";g=ZDBClientUI.standAlone||ZDBGlobal.integrated||(ZDBClientUI.layoutMode=="max"||ZDBNavigation.hiddenState)&&!ZDBNavigation.popOut?"none":"",f.style.display=g;var h=2;h+=ZDBClientUI.layoutMode=="max"||ZDBNavigation.hiddenState||ZDBClientUI.standAlone||ZDBGlobal.integrated?h:250,h=a.prevClientWidth-h-15+2,ZDBClientUI.editGridHolderHeight=e-ZDBGlobal.scrollThick,ZDBClientUI.editGridHolderWidth=h-ZDBGlobal.scrollThick,d.style.height=ZDBClientUI.editGridHolderHeight+"px",d.style.width=ZDBClientUI.editGridHolderWidth+"px",c.gridObj.resizeGrid(ZDBClientUI.editGridHolderWidth,ZDBClientUI.editGridHolderHeight)},this.replaceInSwipeArea=function(a){var b=ZDBClientUI.swipeArea.curComp;b!=a&&(b==null?ZDBClientUI.swipeArea.appendChild(a):ZDBClientUI.swipeArea.replaceChild(a,b),ZDBClientUI.swipeArea.curComp=a)},this.checkIfRespValid=function(a){return a.removed?!1:ZDBClientUI.integrated&&ZDBClientUI.selectedTab.view!=null&&ZDBClientUI.selectedTab.view.objId!=a.view.objId?!1:!0},this.$$=function(a){var b=this.$(a);return ZDBUtil.removeNonElements(b),b},this.$=function(a){var b=this[a];return b==null&&(this[a]=b=document.getElementById(a)),b},this.createDummyTab=function(a,b,c,d){var e=new DummyView(a,b,d,c),f=this.createTab(e,c);return this.selectTab(f),f},this.createEmptyTab=function(){var a=this.tabTpl.cloneNode(!0);return ZDBUtil.setNamedChildEls(a,a),this.$$("ZDBTABCONT").appendChild(a),ZDBClientUI.standAlone&&(a.tabIcon=$("ZDBMainLoader"),setTimeout(function(){ZDBClientUI.appendTabIconToBody(a.tabIcon)},1e3)),a.viewCtx=new ZDBUIViewCtx(a),a},this.createUpdateDummyTab=function(a,b,c,d){var e=ZDBClientUI[ZDBClientUI.typeDefns[c].dummyView];if(d==null)d=this.createDummyTab(a,b,e,c);else{var f=new DummyView(a,b,c,e);d.viewCtx.handle(f)}return d},this.appendTabIconToBody=function(a){a.parentNode!=document.body&&document.body.appendChild(a)},this.isObjectInView=function(a){var b=ZDBContentCache.appendAndGet("Tab_List","GridMenu",document.body);b.parentNode!=document.body&&document.body.appendChild(b),ZDBUtil.setNamedChildEls(b,b,"item"),ZDBUtil.removeAllChildren(b.tbody);var c=this.$$("ZDBTABCONT").childNodes;for(var d=0;d<c.length;d++)if(c[d].view.objId==a)return!0;return!1},this.selectTabFromList=function(a){ZDBMenuUtil.closeMenu();var b=DOMUtils.getParentWithTagName(a,"li"),c=b.tabRef;ZDBClientUI.selectTab(c)},this.createTab=function(a,b){jQuery("#ZDBTABCONT").children().length==1&&jQuery("#ZR_MovableAddNewTab").removeClass("movableAddNewTabGreen").addClass("movabaleAddNewTabGrey");var c=ZDBClientUI.createEmptyTab();return this.initializeTab(c,a,b),c},this.selectTabEl=function(a,b){var c=DOMUtils.getParentWithAttr(a,"parTab");this.selectTab(c);var d=setTimeout(function(){ZDBTabSwitchHandler.executeMatchedFuncsInQ(c.view)},1e3);ZDBUtil.stopEventBubble(b),ZDBNavigation.popOut&&ZDBNavigation.popInNavigation(!0)},this.fetchViewEl=function(a,b){ZDBMenuUtil.closeMenu(),ZDBUtil.stopEventBubble(b);if(ZDBDashboardAPI.modeHelper.isInNavigDragMode())return;var c=DOMUtils.getParentWithAttr(a,"objId");ZDBNavigation.deHighlightListItem(c);var d=c.getAttribute("objId"),e=c.getAttribute("dispname"),f=DOMUtils.getParentWithAttr(c,"dbid").getAttribute("dbid"),g=ZDBClientUI.getExistingTab(d);if(g!=null){this.selectTab(g);return}var h=c.getAttribute("objType");this.fetchView(d,f,e,h,null)},this.fetchView=function(a,b,c,d,e){var e=this.createUpdateDummyTab(a,c,d,e);ZDBClientUI.typeDefns[d].fetchView(a,e.viewCtx)},this.createView=function(a,b,c,d,e){ZDBMenuUtil.closeMenu();if(d=="AnalysisView"||d=="Pivot"||d=="SummaryView"){if(ZDBGlobal.ZCTYPE>0){if(!ZDBLazyLoadUtil.loadJsAlone(["ZDBAnalysisViewList_NEW","ZDBAnalysisEditList_NEW","ZRJSChartsList","ZAVMFilterList","zdbjs/analysisedit/ZDBFieldsView.js"],"APPENDTODOC",ZDBClientUI.createView,[a,b,c,d,e]))return}else if(!ZDBLazyLoadUtil.loadJsAlone(["ZDBAnalysisViewList","ZDBAnalysisEditList","ZAVMFilterList","zdbjs/analysisedit/ZDBFieldsView.js"],"APPENDTODOC",ZDBClientUI.createView,[a,b,c,d,e]))return;urls=["CSSLIST_GRIDSTYLES","CSSLIST_ANALYSISVIEWSTYLES","CSSLIST_VMFILTERSTYLES"];if(!ZDBLazyLoadUtil.loadCssOnly(urls,"APPENDTODOC",ZDBClientUI.createView,[a,b,c,d,e]))return}else if(d=="Report"||d=="QueryTable"){if(!ZDBLazyLoadUtil.loadJsAlone(["ZDBGridList","ZRQueryEditor"],"APPENDTODOC",ZDBClientUI.createView,[a,b,c,d,e]))return;if(!ZDBLazyLoadUtil.loadCssOnly(["CSSLIST_QUERYEDITOR","CSSLIST_GRIDSTYLES","CSSLIST_VMFILTERSTYLES"],"APPENDTODOC",ZDBClientUI.createView,[a,b,c,d,e]))return}var f=ZDBI18NMap.g(ZDBClientUI.typeDefns[d].newName);e=ZDBClientUI.createUpdateDummyTab(ZDBClientUI.curDummyViewId--,f,d,e),e.view.parentViewId=b,ZDBClientUI.typeDefns[d].createView(e.viewCtx,d,a,b,c,e.view.objId)},this.updateViewInTab=function(a,b){ZDBClientUI.initializeTab(b,a,a.viewComp),ZDBClientUI.selectTab(b)},this.getExistingTab=function(a){a==null&&(a="");if(!this.$$("ZDBTABCONT"))return null;var b=this.$$("ZDBTABCONT").childNodes;for(var c=0,d=b.length;c<d;c++){var e=b[c];if(e.getElementsByTagName&&e.view.objId==a)return e}},this.updateLayout=function(a){var b=a.view;ZDBUtil.removeNonElements(this.placeHolder),this.placeHolder.className="alpha0";var c=a.comp;if(!c)return;ZDBMenu.updateToolbar(b);var d=this.placeHolder.oldComp;d&&d.parentNode!=this.placeHolder&&(d=null),d!=c&&(d!=null?this.placeHolder.replaceChild(c,d):this.placeHolder.appendChild(c),this.placeHolder.oldComp=c,this.resizePlaceHolder(),b.setScrollPosition(!1)),this.placeHolder.className="showView100",ZDBClientUI.isRemoteDB&&b.type=="Explorer"&&ZDBClientUI.dbConfig.rdbView&&ZDBClientUI.dbConfig.rdbView.mismatchCount&&RDBPage.showMismatchInExp(ZDBClientUI.dbConfig.rdbView.mismatchCount)},this.updateDisplayName=function(a,b,c){var d=a.tabHeader;jQuery(d).attr("tip",b).bind("mouseover",function(a){ZDBToolTip.checkLengthAndShow(this,a)}).bind("mouseout",function(){ZDBToolTip.hide(this)}),d.innerHTML=ZDBEscapeUtil.encodeForHtml(b),d.style.maxWidth="150px";var e=a.view;if(!e.dialogStatus||e.dialogStatus==0)e.displayName=b,c&&(e.description=c),e.toolbar&&ZDBMenu.updateViewTitleNDesc(e)},this.selectTab=function(a){ZRSMenu.closeAllMenu(),a!=this.selectedTab&&this.unselectTab();var b=null;b=this.$$("ZDBTABCONT").childNodes;for(var c=0;c<b.length;c++)b[c].className=b[c].view.type+"Obj "+(b[c]==a?"tabSelected":"tabNotSelected");if(!ZDBGlobal.integrated){var d=ZDBGlobal.EXPBROWSERTXT+" - ";d+=a.tabHeader.getAttribute("tip"),document.title=d}this.updateLayout(a),ZDBClientUI.selectedTab=a,ZDBClientUI.navigatable.view=a.view,a.view.setVisible(),a==ZDBNavigation.explorerTab&&ZDBClientUI.resizeRightExplorerView(),this.modeHelper.selectTab();var e=a.view,f=e.type;window.ZDBDataGrid&&e instanceof ZDBDataGrid&&e.onFocus(null,!1),e.dialogStatus>0&&(ZDBInlineDialog.showOrHideInlineDlgDiv(a,!0),hideCustomMessage());var g=a.layoutMode!=ZDBClientUI.layoutMode;ZDBNavigation.showOrHideNavIcon(e,g),a.layoutMode=ZDBClientUI.layoutMode,e.editMode&&(f=="AnalysisView"||f=="Pivot"||f=="SummaryView")&&e.checkNSendTblColInfoReq()},this.unselectTab=function(){var a=ZDBClientUI.selectedTab;ToolTip.hide(),ZDBMenuUtil.closeMenu(),a&&a.view.dialogStatus>0&&(hideCustomMessage(),ZDBInlineDialog.showOrHideInlineDlgDiv(a,!1));var b=null;a!=null&&(b=a.view,b.setScrollPosition(!0),b.setHidden()),ZDBClientUI.selectedTab=null},this.newViewAdded=function(a){var b=a.viewCtx.tab;ZDBClientUI.updateDisplayName(b,a.displayName);if(b.isDialog)return;ZDBClientUI.selectTab(b),ZDBNavigation.refreshExplorer()},this.removeTabEl=function(a){var b=DOMUtils.getParentWithAttr(a,"parTab");b==null&&(b=a);if(!this.checkAskSaveView(b.view,ZDBI18NMap.g("zrpt.common.analysis.js.closing"),this))return;this.removeTab(b)},this.removeTab=function(a){a.removed=!0;if(!ZDBGlobal.integrated){if(ZDBClientUI.selectedTab!=ZDBNavigation.explorerTab){var b=a.previousSibling!=null?a.previousSibling:a.nextSibling;b!=null?this.selectTab(b):ZDBCreateViewAPI.showCreateNewTblDlg(!1)}}else ZDBClientUI.unselectTab();ZDBTabSwitchHandler.deleteViewInQ(a.view),a.parentNode.removeChild(a),a.view.removeView(),a.view=null,ZDBTabHandler.moveToVisibleArea(),jQuery("#ZDBTABCONT").children().length==1&&jQuery("#ZR_MovableAddNewTab").removeClass("movabaleAddNewTabGrey").addClass("movableAddNewTabGreen")},this.trashView=function(a,b){var c=b.ELEMENT,d=c.getAttribute("objId"),e=c.getAttribute("viewname"),f=c.getAttribute("objtype");if(a=="NO")return;AjaxAPI.sendRequest({URL:ZDBGlobal.CTX+"/ZDBDatabaseActionMI.ma?ZDBACTION=MOVEOBJECTTOTRASH",PARAMETERS:"OBJID="+d+"&CHECKVIEWDEP=true",ONSUCCESSFUNC:ZDBClientUI.resourceRemoved,OBJID:d,OBJNAME:e,OBJTYPE:f,OPSTATUSID:"ZDBMainLoader"})},this.trashObject=function(a){var b=a.getAttribute("viewname");ZDBAlertAPI.showMsg(ZDBI18NMap.f("zrpt.common.analysis.js.delObjConfirm",ZDBEscapeUtil.encodeForHtml(b)),"ZDBYESNO",{ONCLICK:this.trashView,ELEMENT:a})},this.trashObj=function(a,b){if(a=="NO")return;var c=b.OBJIDS,d=b.OBJID,e=b.OBJTYPE;AjaxAPI.sendRequest({URL:ZDBGlobal.CTX+"/ZDBDatabaseActionMI.ma?ZDBACTION=MOVEOBJECTTOTRASH",PARAMETERS:"OBJID="+d+"&CHECKVIEWDEP=false&OBJIDS="+c,ONSUCCESSFUNC:ZDBClientUI.resourceRemoved,OBJID:d,OBJTYPE:e})},this.resourceRemoved=function(a,b){var c=a.getResponseParams(),d=c.REFTABLES,e=b.OBJTYPE,f=b.OBJID,g=d.length>0?d.split(","):[];if(g.length>0){var h=ZDBI18NMap.g("zrpt.common.analysis.errmsg.js.refErrDlgTtl"),i="<br><b>"+ZDBI18NMap.f("zrpt.common.analysis.errmsg.js.delTblWithRefObjErr",ZDBEscapeUtil.encodeForHtml(b.OBJNAME))+"</b><br>";for(var j=0;j<g.length;j++)i=j==0?i+ZDBEscapeUtil.encodeForHtml(g[j]):i+", "+ZDBEscapeUtil.encodeForHtml(g[j]);ZDBUtil.showRefErr(i,h);return}var k=c.DEPVIEWS;g=k.length>0?k.split(","):[];var l=b.OBJTYPE;if(g.length>0){ZDBAlertAPI.showMsg(ZDBI18NMap.f("zrpt.common.analysis.js.delTblWithDepViewConfirm",l,ZDBEscapeUtil.encodeForHtml(b.OBJNAME),l),"ZDBYESNO",{ONCLICK:ZDBClientUI.trashObj,OBJIDS:g,OBJID:b.OBJID,OBJTYPE:l})
;return}ZDBNavigation.refreshExplorer();var m=c.OBJIDS,n=m.length>0?m.split(","):[];ZDBClientUI.removeObjects(n),(e=="Table"||e=="QueryTable")&&ZDBClientUtil.deleteJsonForObjId(f)},this.removeObjects=function(a){ZDBClientUI.TBLLIST=a.length>0?null:ZDBClientUI.TBLLIST;var b=ZDBClientUI.$$("ZDBTABCONT").childNodes;for(var c=0;c<b.length;c++){var d=b[c];for(var e=0;e<a.length;e++){var f=a[e];if(d.view.objId==f){ZDBClientUI.removeTab(d),c--;break}}}},this.getDisplayNameForId=function(a){var b=ZDBClientUI.ObjectsList,c=b.getElementsByTagName("tr");for(var d=0,e=c.length;d<e;d++){var f=c[d];if(f.getAttribute("objid")==a)return f.getAttribute("dispname")}},this.updateDisplayNameForId=function(a,b){var c=ZDBClientUI.ObjectsList,d=c.getElementsByTagName("tr");for(var e=0,f=d.length;e<f;e++){var g=d[e];g.getAttribute("objid")==a&&g.setAttribute("dispname",b)}},this.onBeforeWindowUnLoad=function(){if(ZDBClientUI.dontCheckForModified==1)return;var a=ZDBClientUI.$$("ZDBTABCONT").childNodes,b=!1;ZDBClientUI.modified&&(b=!0);for(var c=0;c<a.length;c++)if(a[c].view.modified!=0){b=!0;break}if(b)return"\n "+ZDBI18NMap.g("zrpt.common.browser.js.unsavedInformationErr")+" \n"},this.checkAskImgSave=function(a,b,c,d,e){e==null&&(e=arguments.callee.caller);var f=e.arguments;return f||(f=[]),e.OPTION!=null?e.OPTION:a.modified!=0&&!ZDBGlobal.integrated?(f=LangUtils.cloneArray(f),ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.analysis.js.save2ExportConfirmMsg"),"ZDBYESNO",{ONCLICK:this.handleImgExportSaveOption,OWNEROBJECT:c,FUNC:e,ARGS:f,LABEL:d,VIEW:a},a.displayName+" "+ZDBI18NMap.g("zrpt.common.analysis.js.isModified")),!1):!0},this.handleImgExportSaveOption=function(a,b){a=="YES"&&(b.HANDLESAVE=ZDBClientUI.invokeAfterOption,b.VIEW.save(b))},this.checkAskSaveView=function(a,b,c,d){return a==null?!0:this.checkAskSave(a,b,c,d,arguments.callee.caller)},this.checkAskSave=function(a,b,c,d,e){e==null&&(e=arguments.callee.caller);var f=e.arguments;return f||(f=[]),e.OPTION!=null?e.OPTION:ZDBUtil.isViewModified(a)?(f=LangUtils.cloneArray(f),ZDBAlertAPI.showMsg(ZDBI18NMap.f("zrpt.common.analysis.js.operationOnModifiedViewConfirm",b)+" ?","ZDBSAVE",{ONCLICK:this.handleSaveOption,OWNEROBJECT:c,FUNC:e,ARGS:f,LABEL:d,VIEW:a},a.displayName+" "+ZDBI18NMap.g("zrpt.common.analysis.js.isModified")),!1):!0},this.handleSaveOption=function(a,b){a=="NO"?(b.VIEW.clearModified&&b.VIEW.clearModified(),b.VIEW.refError&&(b.VIEW.refError=!1),ZDBClientUI.invokeAfterOption(b)):a=="YES"&&(b.HANDLESAVE=ZDBClientUI.invokeAfterOption,b.VIEW.save(b))},this.invokeAfterOption=function(a){var b=a.FUNC;try{b.LABEL=a.LABEL,b.OPTION=!0,b.apply(a.OWNEROBJECT,a.ARGS)}finally{delete b.LABEL,delete b.OPTION}},this.getParentViewId=function(a){var b=ZDBClientUI.selectedTab.view;if(b.objId!=null&&b.parentViewId==null||a!=null){var c=a!=null?a:b.objId,d=$("OBJ_"+c);if(d)var e=DOMUtils.getParentWithAttr(d,"parentviewid"),f=e.getAttribute("parentviewid")}if(b.parentViewId!=null)var f=b.parentViewId;return f},this.getSelectedViewIndex=function(){return this.viewOption.selectedIndex},this.initializeTab=function(a,b,c){a.view!=null&&a.view!=b&&a.view.removeView(),b.viewCtx=a.viewCtx,a.view=b,b.tab=a,a.comp=c,b.displayName&&this.updateDisplayName(a,b.displayName),a.viewCtx.updateModified()},this.attachedSwipeArea=function(){ZDBClientUI.swipeArea.style.display="";var a=$("attachedSwipeArea");a.appendChild(ZDBClientUI.swipeArea),a.style.display="";var b=ZDBClientUI.selectedTab.view;b.eModeHelper.setFieldsDimension(b)},this.navPanelSwipeArea=function(){ZDBClientUI.swipeArea.style.display="";var a=$("attachedSwipeArea"),b=ZDBClientUI.swipeAreaTD,c=ZDBClientUI.selectedTab.view.type;if(ZDBClientUI.selectedNav==null||ZDBClientUI.selectedNav=="Fields"&&(c!="AnalysisView"&&c!="Pivot"&&c!="SummaryView"||!ZDBClientUI.selectedTab.view.editMode))var d="All";else var d=ZDBClientUI.selectedNav;ZDBClientUI.selectNavTab(d),b.appendChild(ZDBClientUI.swipeArea),a!=null&&(a.style.display="none")},this.setUpDBView=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){this.dbId=b,this.isDBOwner=f,this.isDBOwnerAndNotDBAdmin=g,this.isGroupMember=h,this.notLoggedIn=i,this.standAlone=j,this.modeHelper=j?ZDBStandAloneMode:ZDBMainMode,this.zoho_criteria=r,this.directFilterString=z,this.folderPerm=q,this.sampleViewStatus=k,this.hideOnStandAlone=j||i,this.hideOnNotDBOwnerAndNotGroupUser=!f&&!h,this.isBetaCustomer=s,this.isRemoteDB=y,ZDBGlobal.integrated=t,this.fs=u,this.rsConfig=v,this.dbConfig=new DBConfig(b),this.initReferences(),ZDBGlobal.integrated&&(this.layoutMode="max"),this.resizeAllDInst(),this.privateKey=l,this.zrauthkey=m,this.authtoken=n,this.sessionKey=x,this.containerObjId=o,ZDBToolTip.init(),this.updateScrollSize(),a=="ENTERDATA"?(ZDBNavigation.initializeExplorerView(!1),setTimeout(function(){ZDBCreateViewAPI.fetchEnterDataView(null,null,b,!1,ZDBI18NMap.g("zrpt.table.existimport.step1.js.untitled1"))},100)):a=="CREATEANALYSIS"?this.createView(b,c,"Sheet",p,null):a=="VUD"?ZDBVUDataAPI.sendVUDRequestInWindow(c):c!=null?(!j&&!ZDBGlobal.integrated&&ZDBNavigation.initializeExplorerView(!1),this.fetchView(c,b,d,e,null)):ZDBNavigation.initializeExplorerView(!0),ZDBGlobal.integrated||(jQuery(window).resize(function(){ZDBClientUI.handleWindowResize()}),window.onbeforeunload=this.onBeforeWindowUnLoad,window.onfocus=ZDBClientUI.focusMain),setTimeout(function(){ZDBContentCache.contentCache(w)},1e3),ZDBVersionCheck.checkVersionChange()},this.checkAndRedirectForApps=function(){if(document.readyState=="complete"&&getCookie("APPCHECKSHOWN")!="true"&&!ZDBClientUI.standAlone)if(BROWSER.IPAD||BROWSER.ANDROID&&navigator.userAgent.toLowerCase().indexOf("mobile")==-1){var a=jQuery("#ZDBAppCheck"),b=window.innerHeight,c=a.find("#linkContainer"),d=a.find("#AppDesc");ZDBClientUI.handleAppCheckLinkPositioning(b,c,d),a.find("#Container").height(b),BROWSER.IPAD?a.find("#ZRPlayLink").hide():a.find("#ZRItuneLink").hide(),document.body.style.margin="0px",a.show(),ZDBClientUI.appCheckShown=!0,window.addEventListener("resize",ZDBClientUI.handleAppCheckResize),setCookie("APPCHECKSHOWN",!0)}},this.handleAppCheckLinkPositioning=function(a,b,c){a<=600?(b.css("bottom","28px"),c.css("top","13px")):a<=700?(b.css("bottom","65px"),c.css("top","41px")):a<=800?(b.css("bottom","114px"),c.css("top","75px")):a<=900?(b.css("bottom","156px"),c.css("top","108px")):a<=1e3?(b.css("bottom","186px"),c.css("top","129px")):a<=1100?(b.css("bottom","186px"),c.css("top","129px")):a>1100&&(b.css("bottom","229px"),c.css("top","183px"))},this.handleAppCheckResize=function(){if(ZDBClientUI.appCheckShown){var a=window.innerHeight,b=jQuery("#ZDBAppCheck"),c=b.find("#linkContainer"),d=b.find("#AppDesc");ZDBClientUI.handleAppCheckLinkPositioning(a,c,d),jQuery("#Container").height(a);return}},this.closeCheckApps=function(){jQuery("#ZDBAppCheck").hide(),ZDBClientUI.appCheckShown=!1},document.onreadystatechange=this.checkAndRedirectForApps,this.handleWindowResize=function(){return ZDBClientUI.windowResizeTimeout!=null&&clearTimeout(ZDBClientUI.windowResizeTimeout),ZDBClientUI.windowResizeTimeout=setTimeout("ZDBClientUI.resizeAllDInst(true)",500),!0},this.openView=function(a,b){ZDBToolTip.hide(),ZDBDialogUtil.closeDialog();var c=jQuery(a).attr("objId"),d=jQuery(a).attr("dbId"),e=jQuery(a).attr("dispName"),f=jQuery(a).attr("type"),g=ZDBClientUI.getExistingTab(c);if(g!=null){this.selectTab(g);return}this.fetchView(c,d,e,f,null)},this.updateScrollSize=function(){var a=$("ZDBTPLGRIDAREA");a.offsetHeight==0&&document.body.appendChild(a.parentNode),ZDBGlobal.scrollThick=ZDBGlobal.scrollWidth=ZDBGlobal.getScrollThickness(),a.parentNode.parentNode.removeChild(a.parentNode)},this.saveAll=function(){var a=ZDBClientUI.$$("ZDBTABCONT").childNodes;for(var b=0;b<a.length;b++){var c=a[b];c.view.checkSave()&&c.view.save()}return!0},this.changeTheme=function(a,b){AjaxAPI.sendRequest({URL:"/ZDBDatabaseActionMI.ma?ZDBACTION=CHANGETHEME",PARAMETERS:"THEMENAME="+encodeURIComponent(a),ONSUCCESSFUNC:ZDBClientUI.themeChanged,OPSTATUSID:"ZDBMainLoader"})},this.themeChanged=function(){window.location.href=window.location.href},this.handleProjectsMenu=function(a){var b=$("ZDBEXPLORERPROJECTS_TITEM");a!=1&&b&&(DOMUtils.addCSSClass([b],"disabledonnotsaved"),DOMUtils.addCSSClass([b],"notpermitted"),b.onclick=null)},this.setImportOptions=function(a,b,c,d){this.isCustomDomain=d,this.showDocs=a,this.showExt=b,this.showGDrive=c}};ZDBClientUI.getViewObj=function(a,b){var c=a;while(c&&c[b]==null)c=c.parentNode;return c==null?null:c[b]};var ZDBStandAloneMode=new function(){this.dummyFunc=function(){},this.removeObjects=this.dummyFunc,this.selectTab=this.dummyFunc},ZDBMainMode=new function(){this.removeObjects=function(a){ZDBClientUI.TBLLIST=null,ZDBNavigation.removeObjects(a)},this.selectTab=function(){ZDBTabHandler.moveToVisibleArea(),ZDBNavigation.highlightSelectedInNavList()}};ZDBClientUI.clearCache=function(){ZDBClientUI.TBLLIST=null,AllowedValPopup.cache=new Object,ZDBAnalysisCaching.cachedFields=new Object},ZDBClientUI.positionComboHdr=function(a,b){var c=a.comboHdr,d=a.originalValue;if(d){var e=JSON.parse(d),f=e[ZDBDesignGrid.getColumnDataTypeForField(a)];f.length>1&&(jQuery(c.compElContainer).attr({DRILLCOLID:f[0],DRILLTBLID:f[1],DRILLCOLADDONTYPE:f[2],DRILLCOLOPERATION:f[3],DISPCOLNAME:f[4]}),c.displaySelected.innerHTML=ZDBEscapeUtil.encodeForHtml(f[4]),c.displaySelected.setAttribute("value",ZDBEscapeUtil.encodeForHtml(f[4])))}var g=ZDBUtil.getObjLeft(a.cellEl,!1,b),h=ZDBUtil.getObjTop(a.cellEl,!1,b);c.style.position="absolute",c.style.top=h-1+"px",c.style.left=g-1+"px",c.displaySelected.style.width=a.cellEl.offsetWidth-28+"px"},ZDBClientUI.showCombo=function(a,b){var c;c=b.CELLOBJ;var d=document.createElement("div");d.innerHTML=a.getOnlyHtml(),ZDBClientUI.TBLLIST=d.childNodes[0],ZDBClientUI.showList(c,b.OBJID)},ZDBClientUI.showList=function(a,b){var c=ZDBClientUI.TBLLIST,d=c.cloneNode(!0);typeof ZDBQa=="object"&&(d.id&&(d.id=""),d.id=a.id);var e=d.getElementsByTagName("optgroup"),f=e.length,g;for(var h=0;h<f;h++){var i=e.item(h),j=i.getAttribute("objId");j==b&&(g=i)}g!=null&&g!=undefined&&d.removeChild(g),ZDBEditors.configureListEditor(a,d),d.onchange=ZDBDesignGrid.customFunc,d.onblur=function(a){return ZDBEditors.onListBlur(this,a)},ZDBEditors.showListEditor(a,d)},ZDBClientUI.openGettingStartedDlg=function(a){if(!ZDBLazyLoadUtil.loadSnippet("ZDBGettingStarted","/ZDBGettingStartedDialog.cc?",this,"APPENDTODOC"))return;if(!ZDBLazyLoadUtil.loadCssOnly(ZDBGlobal.THEMEDIR+"/styles/gettingstarted_NEW.css","APPENDTODOC",ZDBClientUI.openGettingStartedDlg,[a]))return;var b=$("ZDBGettingStartedDlg"),c=b.getAttribute("isgappuser");if(c=="true"){var d=jQuery("#gettingStartedTabsDiv").show();d.children('[purpose="reports"]').show(),d.children('[purpose="gau"]').hide(),jQuery(b).find("[gsTabParent]").removeClass().addClass("gsTab2Selected")}else $("gettingStartedTabsDiv").style.display="none";ZDBFullPageDialog.showDialog(b,{DONTREMOVE:!0},{"margin-left":"-440px",width:"850px"}),a||AjaxAPI.sendRequest({URL:"/ZDBUserAction.ma?ZDBACTION=DELGETSTARTDLGPROP"})},ZDBClientUI.hoverLinkInGS=function(a,b){var c=jQuery(a).parents("[elname='gsoption']"),d=c.find("div"),e=d.attr("elname"),f=c.find("[elname='txt']");b?(d.removeClass().addClass(e+"Hover"),f.removeClass().addClass("gsLinkTxtHover")):(d.removeClass().addClass(e),f.removeClass().addClass("gsLinkTxt"))},ZDBClientUI.gsTabSelected=function(a){jQuery("[gsTabParent]").removeClass().addClass(a.getAttribute("selectionClass")),jQuery(a).hide().siblings().show()},ZDBClientUI.closeVideoDialog=function(a){var b=$("gsvideoHolder");b.style.display="none",b.freezeLayer.style.display="none",jQuery(".gsiframe").removeAttr("src"),a||ev.escKeyPressStack.pop()},ZDBClientUI.showVideo=function(a){var b=$("gsvideoHolder");if(!b){b=document.createElement("div"),b.setAttribute("id","gsvideoHolder"),b.appendChild(jQuery(".gsiframeholder").show()[0]),document.body.appendChild(b);var c=document.createElement("DIV");c.className="freezeLayer",c.style.zIndex=1100,b.freezeLayer=c,document.body.appendChild(b.freezeLayer)}else b.style.display="",b.freezeLayer.style.display="";jQuery(".gsiframe").attr("src",a+"&autoplay=1"),ev.addEscHandle(ZDBClientUI.closeVideoDialog)},ZDBClientUI.getDispName=function(a){var b=ZDBUtil.getElWithTagNAttrWithVal(ZDBClientUI.swipeArea,"objid",a,"tr");return b?b.getAttribute("dispname"):null},ZDBClientUI.hideSubscriptionLink=function(a){a||jQuery("#ZRSubscriptionLink").hide()};var ZDBUtil=new function(){this.timeoutCnt=1,this.visibleTdStyle="",this.visibleTrStyle="",this.visibleTableStyle="",this.dataTypeNumVsSubtypeDisp={1:"PLAIN",2:"MULTI_LINE",3:"EMAIL",4:"NUMBER",5:"POSITIVE_NUMBER",6:"DECIMAL_NUMBER",7:"CURRENCY",8:"PERCENT",9:"DATE",10:"BOOLEAN",14:"REFCOL",18:"AUTO_NUMBER",19:"URL",20:"RELCOL",21:"GEO"},this.dataTypeVsdataTypeNum={PLAIN:"1",MULTI_LINE:"2",EMAIL:"3",NUMBER:"4",POSITIVE_NUMBER:"5",DECIMAL_NUMBER:"6",CURRENCY:"7",PERCENT:"8",DATE:"9",BOOLEAN:"10",REFCOL:"14",AUTO_NUMBER:"18",URL:"19",RELCOL:"20"},this.datatypeVsFormatType={PLAIN:"Text",MULTI_LINE:"Text",EMAIL:"Text",URL:"Text",BOOLEAN:"Text",NUMBER:"Numeric",POSITIVE_NUMBER:"Numeric",AUTO_NUMBER:"Numeric",DECIMAL_NUMBER:"Float",CURRENCY:"Cur",PERCENT:"Percent",DATE:"Date",GEO:"Geo"},this.dataTypeNumVsSubtypeDisp.length=12,this.dataTypeVsDisplayType={PLAIN:"Plain Text",MULTI_LINE:"Multi Line Text",EMAIL:"E-mail",URL:"URL",NUMBER:"Number",POSITIVE_NUMBER:"Positive Number",AUTO_NUMBER:"Auto Number",DECIMAL_NUMBER:"Decimal Number",CURRENCY:"Currency",PERCENT:"Percent",DATE:"Date",BOOLEAN:"Decision Box",REFCOL:"Lookup Column",RELCOL:"Lookup Column",GEO:"Geo Location"},this.allowedTypes_for_Drill=["PLAIN","DATE","EMAIL","URL","GEO"],this.getParGridColHeaderForColId=function(a){var b=ZDBDialogUtil.focusDialog?ZDBDialogUtil.focusDialog.gridObj:ZDBClientUI.selectedTab.focusedDialog.gridObj;b||(b=ZDBClientUI.ZDBViewEl.view);var c=b.colHeaders,d;for(var e=0;e<c.length;e++){var f=c[e];if(f.colId&&f.colId.toString()===a.toString()){d=f;break}}return d},this.getOrigColTypeForEl=function(a){var b=ZDBDesignGrid.getColumnDataTypeForField(a);if(b!="RELCOL"&&b!="REFCOL")return b;var c=a.rowObj.parGrid.getColumnIndex("FIELDID"),d=a.rowObj.values[c];if(d){var e=d.getValue(),f=ZDBUtil.getParGridColHeaderForColId(e);if(!f)return;var b=f.type;b=b=="RELCOL"||b=="REFCOL"?f.relColType:b}return b},this.isColTypeAllowedForDrill=function(a){var b=ZDBUtil.getOrigColTypeForEl(a);return jQuery.inArray(b,ZDBUtil.allowedTypes_for_Drill)>=0},this.getMonthName=function(a,b,c){if(isNaN(a))return"Invalid";var d=["January","February","March","April","May","June","July","August","September","October","November","December"];return b&&a--,c?d[a].substring(0,3):d[a]},this.isNumber=function(a){return a!=null&&typeof a!="undefined"&&!isNaN(a)&&(parseInt(a,10)+"").length==a.length?!0:!1},this.replaceStr=function(a,b,c){try{var d=a,e="",f=d.indexOf(b);while(f>=0)e+=d.substring(0,f)+c,d=d.substring(f+b.length,d.length),f=d.indexOf(b);return e+d}catch(g){return a}},this.removeChar=function(a,b){if(!a||!b)return a;var c="";a+="";var d=a.length;for(i=0;i<d;++i){var e=a.charAt(i);if(e==b)continue;c+=e}return c},this.getCaretPos=function(a){var b=0;if(a.selectionStart)b=a.selectionStart;else if(!document.selection)b=0;else{var c="",d=document.selection.createRange(),e=d.duplicate();e.moveToElementText(a);if(d.text.length==0)d.text=c,b=e.text.indexOf(c),d.moveStart("character",-1),d.text="",a.zdbselrange&&(a.zdbselrange=null);else{e.setEndPoint("EndToEnd",d);var f=e.text.length-d.text.length;a.zdbselrange=[f,f+d.text.length]}}return b<0?a.value.length:b},this.insertText=function(a,b,c,d){var e=this.getSelection(a,!0),f=this.getSelection(a,!1);BROWSER.IE&&(e=f=c,d!=-1&&(f=d,a.zdbselrange=null));var g=a.value.substring(0,e),h=a.value.substring(f,a.value.length);a.value=g+b+h,this.setCaretToPos(a,c+b.length)},this.positionCenter=function(a){if(a!=null){var b=document.body.clientWidth/2-a.offsetWidth*.5,c=document.body.clientHeight/2-a.offsetHeight*.5;a.style.position="absolute",a.style.left=b+"px",a.style.top=c+"px"}},this.getCaretCurPos=function(a){return a.focus(),this.getSelection(a,!0)},this.getSelection=function(a,b){if(BROWSER.NONIE||BROWSER.IE11AndAbove)return b?a.selectionStart:a.selectionEnd;var c=document.selection.createRange(),d=c.compareEndPoints("StartToEnd",c)==0;d||(b?c.collapse(!0):c.collapse(!1));var e=c.getBookmark();return e.charCodeAt(2)-2},this.addToNode=function(a,b){var c=document.getElementById(a);return b?b.appendChild(c):document.body.appendChild(c),c},this.getCloned=function(a){var b=typeof a=="string"?document.getElementById(a):a;return b!=null&&(b=b.cloneNode(!0),b.removeAttribute("id")),b},this.getCloneNode=function(a){var b=typeof a=="string"?document.getElementById(a):a;return b!=null&&(b=b.cloneNode(!0),b.removeAttribute("id"),b.elnameSet=!1),b},this.getSelectedRadioEltWithAttrVal=function(a,b,c){var d=DOMUtils.getChildElsWithAttr(a,b,c),e=d.length;for(var f=0;f<e;f++){var g=d[f];if(g.checked)return g}},this.getSelectedRadioElement=function(a,b){var c=a[b],d=c.length;for(var e=0;e<d;e++){var f=c[e];if(f.checked)return f}},this.getRadioSelectedValue=function(a,b){var c=a[b],d=c.length;for(var e=0;e<d;e++){var f=c[e];if(f.checked)return f.value}},this.setRadioSelectedValue=function(a,b,c,d){if(c==null)return;var e=a[b],f=e.length,d=d!=null?d:"value";for(var g=0;g<f;g++){var h=e[g];if(h.getAttribute(d)==c){h.checked=!0,h.onchange&&h.onchange();break}}},this.stopEventBubble=function(a){a&&a.stopPropagation&&(a.preventDefault(),a.stopPropagation()),window.event&&(window.event.cancelBubble=!0,window.event.returnValue=!1)},this.doNothing=function(a){return ZDBUtil.stopEventBubble(a),!1},this.isPrintable=function(a){return a>0},this.getSourceElement=function(a){return window.event&&window.event.srcElement?window.event.srcElement:a&&a.target?a.target:a&&a.src?a.src:null},this.attachEvent=function(a,b,c,d){BROWSER.IE&&!BROWSER.IE11AndAbove?c?a.attachEvent("on"+b,c):a.attachEvent("on"+b,ZDBUtil.doNothing):c?a.addEventListener(b,c,d):a.addEventListener(b,ZDBUtil.doNothing,!1)},this.detachEvent=function(a,b,c,d){BROWSER.IE&&!BROWSER.IE11AndAbove?c?a.detachEvent("on"+b,c):a.detachEvent("on"+b,ZDBUtil.doNothing):c?a.removeEventListener(b,c,d):a.removeEventListener(b,ZDBUtil.doNothing,!1)},this.isCapsLockOn=function(a,b){return a>=65&&a<=90&&!b||a>=95&&a<=123&&b},this.getGridKeyUpEvent=function(a){var b=0;window.event&&(b=window.event.keyCode);var c=a||window.event;return c?{obj:c,keyCode:b,shiftPressed:c.shiftKey,ctrlPressed:c.ctrlKey,cmdPressed:c.metaKey,altPressed:c.altKey,modifierPressed:c.shiftKey||c.ctrlKey||c.altKey||c.metaKey}:a},this.getGridKeyPressEvent=function(a){var b=0;window.event?b=window.event.keyCode:a&&a.charCode&&(b=a.charCode);var c=a||window.event;return{obj:c,charCode:b,shiftPressed:c.shiftKey,ctrlPressed:c.ctrlKey,cmdPressed:c.metaKey,altPressed:c.altKey,modifierPressed:c.shiftKey||c.ctrlKey||c.altKey||c.metaKey}},this.getObject=function(a,b){while(a){if(a[b])return a[b];a=a.parentNode}throw new Error("Could not find "+b)},this.getCursorPos=function(a){return BROWSER.NONIE?{x:a.pageX,y:a.pageY}:BROWSER.IE?{x:window.event.clientX+document.body.scrollLeft,y:window.event.clientY+document.body.scrollTop}:{x:0,y:0}},this.isMouseLeftButtonPressed=function(a){if(BROWSER.NONIE)return a&&a.button==0?!0:!1;if(BROWSER.IE11AndAbove)return window.event&&window.event.button==0?!0:!1;if(BROWSER.IE)return window.event&&window.event.button==1?!0:!1;throw new Exception("Can not determine!")},this.getElementAbsolutePos=function(a){var b=new Object;b.x=0,b.y=0;if(a!==null&&a.getBoundingClientRect){var c=document.documentElement,d=a.getBoundingClientRect(),e=c.scrollLeft,f=c.scrollTop;b.x=d.left+e,b.y=d.top+f}return b},this.getElementAbsoluteLeft=function(a){return this.getElementAbsolutePos(a).x},this.getElementAbsoluteTop=function(a){return this.getElementAbsolutePos(a).y},this.getObjTop=function(a,b,c){if(!a)throw new Error("NULL Object. findObjTop returns null");var d=0;if(document.getElementById||document.all)while(a&&a.parentNode&&a.offsetParent&&a!=c)d+=b?a.offsetTop:a.offsetTop-a.scrollTop,a=a.offsetParent;else document.layers&&(d+=b?a.y:a.y-a.scrollTop);return d},this.getObjTopWithScrollUpToPar=function(a,b){var c=b.scrollTop;b.scrollTop=0;var d=ZDBUtil.getObjTop(b),e=ZDBUtil.getObjTop(a),f=e-d;return b.scrollTop=c,f},this.isElVisibleWithinPar=function(a,b){var c=b.scrollTop,d=ZDBUtil.getObjTopWithScrollUpToPar(a,b),e=d,f=d+a.offsetHeight+100,g=c<=e&&f<c+b.clientHeight;return g},this.scrollElToVisibleAreaWithinPar=function(a,b){if(!ZDBUtil.isElVisibleWithinPar(a,b)){var c=ZDBUtil.getObjTopWithScrollUpToPar(a,b);b.scrollTop-c>0?b.scrollTop=c:b.scrollTop-c<0&&(b.scrollTop+=c+a.offsetHeight+100-(b.scrollTop+b.clientHeight))}},this.getObjTopUpTo=function(a,b){var c=ZDBNavigation.getAutoGenTr(a),d=0;if(c==null)return d;if(document.getElementById||document.all)while(c.id!=a.id&&c.parentNode)d+=b?c.offsetTop:c.offsetTop-c.scrollTop,c=c.parentNode;else document.layers&&(d+=b?c.y:c.y-c.scrollTop);return d},this.getObjLeft=function(a,b,c){if(!a)throw new Error("NULL Object. getObjLeft returns null");var d=0;if(document.getElementById||document.all)while(a&&a.parentNode&&a.offsetParent&&a!=c)d+=b?a.offsetLeft:a.offsetLeft-a.scrollLeft,a=a.offsetParent;else document.layers&&(d+=b?a.x:a.x-a.scrollLeft);return d},this.setCaretToEnd=function(a){if(a.createTextRange){var b=a.createTextRange();b.collapse(!1),b.select()}else if(a.setSelectionRange){var c=a.value.length;a.setSelectionRange(c,c)}},this.setCaretToPos=function(a,b){if(a.createTextRange){var c=a.createTextRange();c.move("character",b),c.collapse(!1),c.select()}else a.setSelectionRange&&(a.focus(),a.setSelectionRange(b,b))},this.setCaretToStart=function(a){if(a.createTextRange){var b=a.createTextRange();b.collapse(!0),b.select()}else a.setSelectionRange&&a.setSelectionRange(0,0)},this.getKeyCode=function(a){if(BROWSER.NONIE)return a.keyCode;if(BROWSER.IE)return window.event.keyCode},this.getCharCode=function(a){if(BROWSER.NONIE)return a.charCode;if(BROWSER.IE)return window.event.keyCode},this.findParentWithTagName=function(a,b){if(!a||!b)throw new Error("Either element or name is missing!");b=b.toUpperCase();var c=a;do{if(c.nodeName.toUpperCase()==b)return c;c=c.parentNode}while(c)},this.findObjectWithProperty=function(a,b,c,d){if(document.body[a])return document.body;var e=document.body.childNodes,f=e.length;for(var g=0;g<f;++g)if(e[g][a])return e[g];return null;var h},this.getObj=function(a,b){var c,d,e;b||(b=document),(c=a.indexOf("?"))>0&&parent.frames.length&&(b=parent.frames[a.substring(c+1)].document,a=a.substring(0,c)),!(e=b[a])&&b.all&&(e=b.all[a]);for(d=0;!e&&d<b.forms.length;d++)e=b.forms[d][a];var f=b.layers;for(d=0;!e&&f&&d<f.length;d++)e=this.getObj(a,b.lay[d].document);return!e&&b.getElementById&&(e=b.getElementById(a)),e},this.createInput=function(a,b,c){if(BROWSER.IE){var d="<"+a+" "+"type="+c+" />",e=document.createElement(d);return b&&b.appendChild(e),e}if(BROWSER.NONIE){var e=document.createElement(a);return b&&b.appendChild(e),c&&(e.type=c),e}},this.clearTextSelection=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},this.getActualDimension=function(domElement){var obj=new Object;obj.width=domElement.style.width?parseInt(domElement.style.width):0,obj.height=domElement.style.height?parseInt(domElement.style.height):0;if(BROWSER.IE)return obj;var marginL=marginR=marginT=marginB=0,paddingL=paddingR=paddingT=paddingB=0,borderL=borderR=borderT=borderB=0;with(domElement.style)border?borderL=borderR=borderT=borderB=parseInt(border):(borderL=borderLeft?parseInt(borderLeft):0,borderR=borderRight?parseInt(borderRight):0,borderT=borderTop?parseInt(borderTop):0,borderB=borderBottom?parseInt(borderBottom):0),margin?marginL=marginR=marginT=marginB=parseInt(margin):(marginL=marginLeft?parseInt(marginLeft):0,marginR=marginRight?parseInt(marginRight):0,marginT=marginTop?parseInt(marginTop):0,marginB=marginBottom?parseInt(marginBottom):0),padding?paddingL=paddingR=paddingT=paddingB=parseInt(padding):(paddingL=paddingLeft?parseInt(paddingLeft):0,paddingR=paddingRight?parseInt(paddingRight):0,paddingT=paddingTop?parseInt(paddingTop):0,paddingB=paddingBottom?parseInt(paddingBottom):0);return obj.width+=borderL+borderR+marginL+marginR+paddingL+paddingR,obj.height+=borderT+borderB+marginT+marginB+paddingT+paddingB,obj},this.getBoxModelDimension=function(a,b,c,d){return b=typeof b!="undefined"?b:1,c=typeof c!="undefined"?c:0,d=typeof d!="undefined"?d:0,BROWSER.IE?a+2*b+2*c+2*d:a},this.getAdjustedSize=function(a,b,c,d){b=typeof b!="undefined"?b:0,c=typeof c!="undefined"?c:0,d=typeof d!="undefined"?d:0;if(BROWSER.IE)return a;if(BROWSER.NONIE)return a-2*b-2*c-2*d},this.setDimensionForPopup=function(a,b){if(!a)throw new Error("Couln't find elementID");var c=0,d=0,e=0,f=0,g=a.offsetHeight,h=a.offsetWidth;BROWSER.IE?(c=document.body.clientWidth-window.event.clientX,d=document.body.clientHeight-window.event.clientY,c<h?e=window.event.clientX+document.body.scrollLeft-h:e=window.event.clientX+document.body.scrollLeft,d<g?f=window.event.clientY+document.body.scrollTop-g:f=window.event.clientY+document.body.scrollTop):BROWSER.NONIE&&(c=window.innerWidth-b.clientX,d=window.innerHeight-b.clientY,c<h?e=b.clientX+window.pageXOffset-h:e=b.clientX+window.pageXOffset,d<g?f=b.clientY+window.pageYOffset-g:f=b.clientY+window.pageYOffset),a.style.overflow="auto",a.style.position="absolute",a.style.top=f+"px",a.style.left=e+"px",a.zIndex="9999"},this.deepRemoveNonElements=function(a,b){this.removeNonElements(a),b=b?b:"*";var c=a.getElementsByTagName(b);for(var d=0;d<c.length;d++)c[d].getAttribute("keeptext")!="true"&&this.removeNonElements(c[d])},this.removeAllUnwanted=function(a,b){if(a==null)return;b=b?b:"*";var c=a.getElementsByTagName(b);for(var d=c.length-1;d>-1;d--)c[d].getAttribute("keeptext")!="true"&&c[d].parentNode.removeChild(c[d])},this.removeAllChildren=function(a){if(a==null)return;var b=a.childNodes;for(var c=b.length-1;c>-1;c--)a.removeChild(b[c])},this.removeNonElements=function(a){if(a&&!a.elTrimmed){var b=a.childNodes;for(var c=b.length-1;c>-1;c--)b[c].getElementsByTagName||a.removeChild(b[c]);a.elTrimmed=!0}},this.removeElementsByClassName=function(a,b){if(!b)return;var c=a.getElementsByClassName(b);for(var d=c.length-1;d>=0;d--)c[d].getAttribute("keeptext")!="true"&&c[d].parentElement.removeChild(c[d])},this.setNamedChildEls=function(a,b,c,d){c==null&&(c="elname");if(b[c+"Set"]==1)return;if(d){var e=a.getAttribute(c);e!=null&&(b[e]=a)}var f=a.getElementsByTagName("*");for(var g=0,h=f.length;g<h;g++){var e=f[g].getAttribute(c);e!=null&&(b[e]=f[g])}b[c+"Set"]=!0},this.setIdBasedNamedChildEls=function(a,b,c){if(a[c+"Set"]==1)return;var d=[];for(var e=0,f=b.length;e<f;e++){var g=c+b[e],h=document.getElementById(g);h!=null&&(h.id="",h.getAttribute("REMOVEFROMPARENT")=="true"&&d.push(h)),a[b[e]]=h}for(var e=0,f=d.length;e<f;e++)d[e].parentNode.removeChild(d[e]);a[c+"Set"]=!0},this.updateIdBasedNamedChildEls=function(a,b,c){a[c+"Set"]=!1,this.setIdBasedNamedChildEls(a,b,c)},this.getCachedRef=function(a,b){var c=a[b];return c==null&&(c=document.getElementById(b),a[b]=c),c},this.positionEl=function(a,b,c,d,e,f,g){var h=ZDBGlobal[a];if(h==null){h=document.getElementById(a);if(!h)throw new Error(a+" not present");h.parentNode!=document.body&&document.body.appendChild(h),ZDBGlobal[a]=h}var i=h.style;b&&(i.position=b),c!==undefined&&c!==null&&(i.top=c+"px"),d!==undefined&&d!==null&&(i.left=d+"px"),e!==undefined&&e!==null&&e>=0&&(i.width=e+"px"),f!==undefined&&f!==null&&f>=0&&(i.height=f+"px"),g!==undefined&&g!==null&&(i.display=g)},this.indexOf=function(a,b,c,d){var e=a.length,f=typeof b=="string";f&&d&&(b=b.toLowerCase());for(var g=0;g<e;g++){var h=a[g];if(f&&typeof h=="string"){d&&(h=h.toLowerCase());if(h==b)return g;if(c&&h.substring(0,c)==b)return g}else if(h==b)return g}return-1},this.addToSet=function(a,b){return this.indexOf(a,b)==-1?(a.push(b),!0):!1},this.removeFromSet=function(a,b){var c=ZDBUtil.indexOf(a,b);return c>-1&&a.splice(c,1),c},this.roundDecimals=function(a,b){var c=a*Math.pow(10,b);return c=Math.round(c),c/=Math.pow(10,b),c},this.dummyFunc=function(){},this.getAssocArraySize=function(a){var b=0;for(var c in a)b++;return b},this.scrollToView=function(a,b,c){var d=b.offsetWidth,e=b.offsetHeight,f=a.offsetLeft-b.scrollLeft,g=a.offsetTop-b.scrollTop,h=a.offsetWidth,i=a.offsetHeight;f+h>d-c?b.scrollLeft+=f+h-(d-c):f<0&&(b.scrollLeft+=f),g+i>e-c?b.scrollTop+=g+i-(e-c):g<0&&(b.scrollTop+=g)},this.showRefErr=function(a,b){var c=ZDBContentCache.appendAndGet("Ref_Details_Dlg","GridMenu",document.body);c.style.display="block";var d=$("ZDBSHEETREFERR_CONTENT");d.style.height="",d.innerHTML=a,ZDBDialogUtil.showDialog(c,{TITLE:b,ADDFRAME:!0,MODAL:!0,DONTREMOVE:!0}),d.offsetHeight>200&&(d.style.height="200px"),ZDBMenu.resizeIframe(ZDBDialogUtil.focusDialog)},this.getTrimmedString=function(a,b,c){return a==null?"":a.length>b?a.substring(0,b)+c:a},this.trace=function(){var a="",b=arguments.callee;while(b!=null)a+=b,b=b.caller},this.createIframes=function(){for(i=0;i<2;i++){var a=null;BROWSER.NETSCAPE||BROWSER.NONIE?(a=document.createElement("div"),a.style.overflow="auto"):(a=document.createElement("iframe"),window.location.protocol=="https:"?a.src=ZDBGlobal.REPORTS_CONTEXT_NAME+"/framework/html/blank.html":a.src="about:blank",a.scrolling="no",a.frameBorder=0),a.style.background="none",a.style.border="none",a.style.position="absolute",ZDBUtil.iframeList.push(a)}},this.getCachedIframe=function(){return ZDBUtil.iframeList==null&&(this.iframeList=new Array),ZDBUtil.iframeList.length<1&&ZDBUtil.createIframes(),ZDBUtil.iframeList.pop()},this.returnIframeToCache=function(a){ZDBUtil.iframeList.push(a),a.parentNode.removeChild(a)},this.setIfGAppsUser=function(){AjaxAPI.sendRequest({URL:"/ZDBSecurityAction.ma?ZDBACTION=ZDBCHECKIFGAPPUSER",METHOD:"GET",ONSUCCESSFUNC:ZDBUtil.gAppUserCheckResp,ONFAILUREFUNC:ZDBUtil.gAppUserCheckRespFailure})},this.gAppUserCheckResp=function(a,b){var c=a.responseText;c=="true"?ZDBClientUI.isGAppUser=!0:ZDBClientUI.isGAppUser=!1},this.gAppUserCheckRespFailure=function(a,b){ZDBClientUI.isGAppUser=!1},this.gAppAdminCheckResp=function(a,b){var c=a.responseText;c=="true"?ZDBClientUI.isGAppAdmin=!0:ZDBClientUI.isGAppAdmin=!1},this.gAppAdminCheckRespFailure=function(a,b){ZDBClientUI.isGAppAdmin=!1},this.showTouchEffect=function(a,b,c){a&&(a.className+=c?c:" touched")},this.removeTouchEffect=function(a,b,c){a&&(a.className=ZDBUtil.replaceStr(a.className,c?c:" touched",""))}};DOMUtils.getElOrParentWithAttr=function(a,b){return a.getAttribute&&a.getAttribute(b)!=null?a:DOMUtils.getParentWithAttr(a,b)},ZDBUtil.getParentWithAttributeValue=function(a,b,c){b=b.toUpperCase(),c=c.toUpperCase();var d=a;while(d){if(d.getAttribute&&(""+d.getAttribute(b)).toUpperCase()==c)return d;d=d.parentNode}return null},ZDBUtil.getElsWithAttrName=function(a,b){if(a==null)return;var c=new Array,d=a.getElementsByTagName("*");for(var e=0,f=d.length;e<f;e++){var g=d[e].getAttribute(b);g!=null&&c.push(d[e])}return c},ZDBUtil.getElsWithTagNAttr=function(a,b,c){if(a==null)return;var d=new Array,e=a.getElementsByTagName(c);for(var f=0,g=e.length;f<g;f++){var h=e[f].getAttribute(b);h!=null&&d.push(e[f])}return d},ZDBUtil.getElWithTagNAttrWithVal=function(a,b,c,d){if(a==null)return;var e=a.getElementsByTagName(d);for(var f=0,g=e.length;f<g;f++){var h=e[f],i=h.getAttribute(b);if(i!=null&&(""+h.getAttribute(b)).toUpperCase()==c.toUpperCase())return h}return},ZDBUtil.getElsWithTagNAttrWithVal=function(a,b,c,d){if(a==null)return;var e=a.getElementsByTagName(d),f=new Array;for(var g=0,h=e.length;g<h;g++){var i=e[g],j=i.getAttribute(b);j!=null&&(""+i.getAttribute(b)).toUpperCase()==c.toUpperCase()&&f.push(i)}return f},ZDBUtil.getParentWithTagName=function(a,b){b=b.toUpperCase();var c=a;while(c&&c.tagName.toUpperCase()!=b)c=c.parentNode;return c},ZDBUtil.getParentWithProperty=function(a,b){var c=a;while(c&&c[b]==null)c=c.parentNode;return c},window.console==null&&(console=new Object,console.log=function(){},console.error=console.log,console.trace=console.log,console.logit=function(a){var b=document.createElement("div");b.innerHTML=a;if(console.msgDiv==null){console.msgDiv=document.getElementById("ZDBCONSOLEMSG");if(console.msgDiv==null)return;console.msgDiv.style.display="block",ZDBDialogUtil.showDialog(console.msgDiv,{ADDFRAME:!0,TITLE:"Console"})}console.msgDiv.appendChild(b),console.msgDiv.style.visibility!="visible"&&(console.msgDiv.style.visibility="visible"),console
.msgDiv.onclick=console.clearConsole},console.clearConsole=function(){console.msgDiv.innerHTML=""},console.enableConsole=function(){console.log=console.logit,console.error=console.logit}),console.trace||(console.trace=ZDBUtil.dummyFunc),ZDBUtil.findDataInList=function(a,b,c,d){var e=-1;c||(c="value");var f=a.options,g=f.length;for(var h=0;h<g;++h){var i=ZDBUtil.getAttribute(f[h],c)?ZDBUtil.getAttribute(f[h],c):"";if(i.toLowerCase()==(""+b).toLowerCase())return h;e==-1&&ZDBUtil.getAttribute(f[h],d)=="true"&&(e=h)}return e},ZDBUtil.getSubStringInHTML=function(a,b,c){var d=a.outerHTML,e=d.indexOf(b),f=d.substring(e+b.length,d.length);return f=f.substring(0,f.indexOf(c)),f},ZDBUtil.getAttribute=function(a,b,c){return BROWSER.NONIE||BROWSER.IE&&9<=parseInt(BROWSER.VERSION)?a.getAttribute(b):BROWSER.IE?c?a[c]:a[b]:a.getAttribute(b)},ZDBUtil.setAttribute=function(a,b,c,d,e){d&&(a[d]=b),a.setAttribute(c,b),e&&(a[c]=b==="true"||b===!0?!0:!1)},ZDBUtil.removeAttribute=function(a,b,c,d){c&&(a[c]=!1),d&&BROWSER.IE?a.setAttribute(b,!1):a.removeAttribute(b)},ZDBUtil.setAllAttributes=function(a,b){if(a==null||b==null)return null;var c=a.attributes;for(i in c)c[i].nodeName&&b.setAttribute(c[i].nodeName,a.getAttribute(c[i].nodeName))},ZDBUtil.getParentWithAttr=function(a,b,c){var d=a.parentNode,e=0;while(d!=null&&d.getAttribute!=null&&(c==null||e<c)){if(d.getAttribute(b)!=null)return d;e++,d=d.parentNode}return null},ZDBUtil.getElementsWithAttribute=function(a,b,c){var d=[],e=null,f,g;a instanceof Array?e=a:e=a.childNodes;if(e){var h=e.length||0;for(var i=0;i<h;++i){f=e[i],f.getAttribute?g=f.getAttribute(b):g=null;if(g===null)continue;if(c!=="undefined"&&c!=g)continue;d.push(f)}}return d},ZDBUtil.getStyle=function(a,b){var c="";if(document.defaultView&&document.defaultView.getComputedStyle&&a!=null){var d=document.defaultView.getComputedStyle(a,"");c=d.getPropertyValue(b)}else a!=null&&a.currentStyle&&(b=b.replace(/\-(\w)/g,firstCharUpper),c=a.currentStyle[b]);return c},ZDBUtil.getStyleNumeric=function(a,b){var c=ZDBUtil.getStyle(a,b);return c&&(c=parseInt(c,10)),c?c:0},ZDBUtil.getElementOuterWidth=function(a){var b=ZDBUtil.getStyleNumeric(a,"padding-left");return b+=ZDBUtil.getStyleNumeric(a,"padding-right"),b+=ZDBUtil.getStyleNumeric(a,"border-left-width"),b+=ZDBUtil.getStyleNumeric(a,"border-right-width"),b+=ZDBUtil.getStyleNumeric(a,"margin-left"),b+=ZDBUtil.getStyleNumeric(a,"margin-right"),b},ZDBUtil.getElementOuterHeight=function(a){var b=ZDBUtil.getStyleNumeric(a,"padding-bottom");return b+=ZDBUtil.getStyleNumeric(a,"padding-top"),b+=ZDBUtil.getStyleNumeric(a,"border-bottom-width"),b+=ZDBUtil.getStyleNumeric(a,"border-top-width"),b+=ZDBUtil.getStyleNumeric(a,"margin-bottom"),b+=ZDBUtil.getStyleNumeric(a,"margin-top"),b},ZDBUtil.getElementOuterSize=function(a,b){return b?ZDBUtil.getElementOuterWidth(a):ZDBUtil.getElementOuterHeight(a)},ZDBUtil.getObjCoordinates=function(a,b){if(!a)return 0;var c=0,d=0;if(document.getElementById||document.all)while(a&&a.parentNode&&a.offsetParent)c+=b?a.offsetTop:a.offsetTop-a.scrollTop,d+=b?a.offsetLeft:a.offsetLeft-a.scrollLeft,a=a.offsetParent;else document.layers&&(c+=b?a.y:a.y-a.scrollTop,d+=b?a.x:a.x-a.scrollLeft);return{x:d,y:c}},ZDBUtil.disableTextSelection=function(a){a.onselectstart=function(){return!1},a.unselectable="on",a.style.MozUserSelect="none",a.style.cursor="default"},ZDBUtil.getOffsetSize=function(a,b){return a==null?null:BROWSER.IE?b?a.offsetWidth:a.offsetHeight:ZDBUtil.getStyleNumeric(a,b?"width":"height")+ZDBUtil.getElementOuterSize(a,b)},ZDBUtil.getOneElementById=function(a){var b,c;b=document.getElementById(a);if(b==null)return null;while(b!=null)c=document.getElementById(a),c.id="",b=document.getElementById(a);return c.id=a,c},ZDBUtil.timeoutAction=function(a){var b=ZDBUtil[a],c=b[0],d=b[1],e=b[2];try{c.apply(d,e)}catch(f){throw new Error("Either function to call is null or argument is not an Array"+f)}finally{delete ZDBUtil[a]}},ZDBUtil.setTimeout=function(a,b,c,d){if(b===null&&c===null)return setTimeout(a,d);var e="zdb"+ZDBUtil.timeoutCnt++;return ZDBUtil[e]=[a,b,c],setTimeout("ZDBUtil.timeoutAction('"+e+"')",d)},ZDBUtil.setFocus=function(a,b){typeof a=="string"&&(a=$(a));if(!a||!a.focus)return;try{a.focus(),b&&a.select&&a.select()}catch(c){}return!0},ZDBUtil.cloneObject=function(a){if(a===null||"object"!=typeof a)return a;if(a.cloneNode)return a.cloneNode(!0);var b={};for(prop in a)b[prop]=ZDBUtil.cloneObject(a[prop]);return b},ZDBUtil.getPropertyFromEl=function(a,b,c){var d=null,e=null;while(a){if(a[b]!==undefined){d=a[b],e=a;break}a=a.parentNode}if(c=="object")return d;if(c=="element")return e;if(c=="both")return[d,e]},ZDBUtil.getText=function(a){return a.textContent!==undefined?a.textContent:a.innerText!==undefined?a.innerText:a.innerHTML},ZDBUtil.tabselected=function(a){var b=DOMUtils.getParentWithAttr(a,"mainTable"),c=a.getAttribute("selectionclass");b.className=c},ZDBUtil.timedLoop=function(a,b,c,d,e){if(e){if(!e.isAlive){clearTimeout(e.currentId),delete e;return}b.shift(),e.curStartIndex=parseInt(b.shift())+1,e.curEndIndex=e.curStartIndex+e.increment,b.unshift(e.curStartIndex,e.curEndIndex),a.apply(this,b);if(!(e.curEndIndex<e.endIndex)){delete e;return}e.currentId=ZDBUtil.setTimeout(ZDBUtil.timedLoop,this,[a,b,null,null,e],e.interval)}var e={};return e.isAlive=!0,e.interVal=c?c:5,e.increment=d?d:10,e.startIndex=parseInt(b.shift()),e.endIndex=parseInt(b.shift()),e.curStartIndex=e.startIndex,e.curEndIndex=e.startIndex+e.increment,e.loopMethod=a,b.unshift(e.curStartIndex,e.curEndIndex),a.apply(this,b),e.currentId=ZDBUtil.setTimeout(ZDBUtil.timedLoop,this,[e.loopMethod,b,null,null,e],e.interval),e},ZDBUtil.getParam=function(a,b,c){return c?" "+a+"='"+ZDBEscapeUtil.encodeForXML(b)+"'":"&"+a+"="+encodeURIComponent(b)},ZDBUtil.isNewView=function(a){var b=a.objId;if(a.isDummyView)return!1;if(b!==undefined){b=parseInt(b,10);if(isNaN(b)==0&&b>=0)return!1}return!0},ZDBUtil.isViewModified=function(a){return a.isDummyView?!1:ZDBUtil.isNewView(a)?!0:a.isModified&&a.isModified instanceof Function?a.isModified():a.modified!==undefined&&a.modified!=0},ZDBUtil.addHttp=function(a){return a.indexOf("://")==-1&&(a="http://"+a),a},ZDBUtil.openWindow=function(a,b){if(a!==undefined&&a!==null&&a!==""){a=a.trim();if(b=="EMAIL")window.open("mailto:"+a,"_self");else if(b=="URL"){a=ZDBUtil.addHttp(a);var c=window.open(a,"_blank")}}},ZDBUtil.getParamMapFromUrl=function(a){var b=a.indexOf("?");if(b<0)return{};a=a.substring(b+1,a.length);var c=a.split("&"),d={};for(var e=0;e<c.length;e++){var f=c[e],g=f.indexOf("="),h=f.substring(0,g),i=decodeURIComponent(f.substring(g+1,f.length)),j=d[h];j===undefined?d[h]=i:j instanceof Array?j[j.length]=i:d[h]=[j,i]}return d},ZDBUtil.setElPos=function(a,b){var c=["height","width","top","left"];for(var d=0;d<b.length;d++)b[d]!=null&&(a.style[c[d]]=parseInt(b[d])+"px")},ZDBUtil.getUsersAsCommaSeparated=function(a){if(a!=""){var b=a.split(/(\r\n|\n|\r)/gm);a=ZDBUtil.remvomeBlankSpacesAndReturnAsString(b)}return a},ZDBUtil.getValidatedEmailsAsCommaSeparated=function(a){if(a!=""){var b=a.split(/(\r\n|\n|\r)/gm);a=ZDBUtil.validateEmailsAndReturnAsString(b)}return a},ZDBUtil.validateEmailsAndReturnAsString=function(a){var b="";for(var c=0;c<a.length;c++){var d=a[c].trim();if(d!=""){if(!ZDBValidator.isEmail(d,!1))throw{name:"INVALID_EMAILID",message:ZDBI18NMap.g("zrpt.common.pricing.manageusr.js.invalid_email_ids")};b!=""&&(b+=","),b+=d}}return b},ZDBUtil.remvomeBlankSpacesAndReturnAsString=function(a){var b="";for(var c=0;c<a.length;c++){var d=a[c].trim();d!=""&&(b!=""&&(b+=","),b+=d)}return b},ZDBUtil.setValueInSelectBox=function(a,b,c,d){var e=getDataIndex(a,b,c,d);a[e].selected=!0},ZDBUtil.getSubString=function(a,b){var c=a.toString().length;return c<=b?a:a.substr(0,b)+"..."},ZDBUtil.containsAllValues=function(a,b){a=a.toUpperCase();for(var c=0,d=b.length;c<d;c++){var e=a.indexOf(b[c].toUpperCase());if(e==-1)return!1}return!0},ZDBUtil.containsAnyValue=function(a,b){a=a.toUpperCase();for(var c=0,d=b.length;c<d;c++){var e=a.indexOf(b[c].toUpperCase());if(e!=-1)return!0}return!1},ZDBUtil.replaceValues=function(a,b,c){for(var d=0,e=b.length;d<e;d++)a=a.replace(b[d],c[d]);return a},ZDBUtil.replaceAllValues=function(a,b,c){for(var d=0,e=b.length;d<e;d++)a=ZDBUtil.replaceStr(a,b[d],c[d]);return a},ZDBUtil.removeSpace=function(a){return a.split(" ").join("")},ZDBUtil.calendarDateFormat=function(a){var b=["dd","MMMM","MMM","MM","yyyy","yy","mm","HH","hh","ss","a","EEEE","EEE","SSS"],c=["%d","%B","%b","%m","%Y","%y","%M","%H","%I","%S","%p","%A","%a","%f"],d=ZDBUtil.replaceValues(a,b,c);return d},ZDBUtil.replaceAll=function(a,b,c){var d=a,e=d.indexOf(b);while(e!=-1)d=d.replace(b,c),e=d.indexOf(b);return d},ZDBUtil.getValueFromLocal=function(a){try{return window.localStorage!=null?window.localStorage.getItem(a):getCookie(a)}catch(b){return null}},ZDBUtil.setValueToLocal=function(a,b){try{if(window.localStorage!=null){window.localStorage.setItem(a,b);return}setCookie(a,b)}catch(c){return}},ZDBUtil.deleteValueFromLocal=function(a){try{if(window.localStorage!=null){window.localStorage.removeItem(a);return}deleteCookie(a)}catch(b){return}},ZDBUtil.getPreviousSiblingWithAttr=function(a,b){var c=b,d=a;while(d){if(d.getAttribute&&d.getAttribute(c)!=null)return d;d=d.previousSibling}return null},ZDBUtil.getDataTypeNo=function(a){var b=ZDBUtil.dataTypeNumVsSubtypeDisp.length;for(var c=0;c<b;c++)if(ZDBUtil.dataTypeNumVsSubtypeDisp[c]==a)return c},ZDBUtil.removeAllElsAttrWithVal=function(a,b,c,d){if(a==null)return;var e=a.getElementsByTagName(d);for(var f=0,g=e.length;f<g;f++){var h=e[f],i=h!=null?h.getAttribute(b):null;i!=null&&(""+h.getAttribute(b)).toUpperCase()==c.toUpperCase()&&(a.removeChild(h),f--,g--)}},ZDBUtil.hasScrollBar=function(a){var b=jQuery(a);return b.get(0).scrollHeight>b.height()},ZDBUtil.isCursorBusyOnInputField=function(){var a=document.activeElement;if(!a)return;var b=a.tagName.toLowerCase(),c=b=="input"||b=="textarea";return c},ZDBUtil.setTooltipForMenuItems=function(a,b){var c=0,d=a.children();d.hover(function(a){var b=jQuery(this),d=b.find("a")[0];d.scrollWidth>d.clientWidth&&(c=setTimeout(function(){ZDBToolTip.show(b,a)},1e3,b,a))},function(a){clearTimeout(c),ZDBToolTip.hide(this,a)})},ZDBUtil.highlightSave=function(a,b){if(b){var c=jQuery(a).find("span[elname='ZRDesignSave']");c.hasClass("saveIcon")&&c.removeClass("saveIcon").addClass("highlightSave")}else jQuery(a.toolbar.ZRSave).removeClass("saveIcon").addClass("highlightSave")},ZDBUtil.removeHighlight=function(a,b){if(b){var c=jQuery(a).find("span[elname='ZRDesignSave']");c.hasClass("highlightSave")&&c.removeClass("highlightSave").addClass("saveIcon")}else{var c=jQuery(a.toolbar.ZRSave);c.hasClass("highlightSave")&&c.removeClass("highlightSave").addClass("saveIcon")}};var ZDBClientUtil=new function(){this.getInnerHeight=function(a){return jQuery(a).height()},this.getInnerHeightAnyway=function(a){if(a.parentNode===null)return 0;var b=ZDBClientUtil.getInnerHeight(a);if(b>0)return b;a.parNode=a.parentNode,a.visibilityStatus=a.style.visibility,a.visibilityStatus=a.visibilityStatus===null?"":a.visibilityStatus,a.displayStatus=a.style.display,a.displayStatus=a.displayStatus===null?"":a.displayStatus,a.style.visibility="hidden",a.style.display="";var c=document.createElement("div");c.className="ZROutOfScreen",document.body.appendChild(c),c.appendChild(a);var d=ZDBClientUtil.getInnerHeight(a);return a.parNode.appendChild(a),c.parentNode.removeChild(c),a.style.visibility=a.visibilityStatus,a.style.display=a.displayStatus,d=d<0?0:d,d},this.getInnerWidth=function(a){return jQuery(a).width()},this.getHeightGap=function(a){var b=jQuery(a).height(),c=a.scrollHeight,d=c-b;return d},this.getWidthGap=function(a){var b=jQuery(a).width(),c=a.scrollWidth,d=c-b;return d},this.isWithin=function(a,b,c,d){var e=d?c.scrollLeft:0,f=d?c.scrollTop:0,g=a[0]+f,h=a[1]+f,i=a[2]+e,j=a[3]+e,k=b[0],l=b[1],m=b[2],n=b[3];return(k>=g&&k<=h||l>=g&&l<=h)&&(m>=i&&m<=j||n>=i&&n<=j)},this.getDimInfo=function(a){var b=ZDBUtil.getObjTop(a),c=b+a.offsetHeight,d=ZDBUtil.getObjLeft(a),e=d+a.offsetWidth;return[b,c,d,e]},this.offsetWidth=function(a){return jQuery(a).is(":visible")!=0?a.offsetWidth:0},this.offsetHeight=function(a){return jQuery(a).is(":visible")!=0?a.offsetHeight:0},this.clientHeight=function(a){return jQuery(a).is(":visible")!=0?a.clientHeight:0},this.clientWidth=function(a){return jQuery(a).is(":visible")!=0?a.clientWidth:0},this.getClientX=function(a){return ZDBGlobal.IS_MOBILE?getTouchX(a):a.clientX},this.getClientY=function(a){return ZDBGlobal.IS_MOBILE?getTouchY(a):a.clientY},this.scrollElToVisible=function(a,b,c){if(a==null||b==null)return;if(ZDBClientUtil.isElFullyVisible(a,b))return;var d=c.DIRECTION,e=c.ADJUSTTOP,f=c.ADJUSTLEFT,g=c.DURATION,h=jQuery(b),i={};i.top=jQuery(a).offset().top-h.offset().top,i.left=jQuery(a).offset().left-h.offset().left;var j="top,left,both";d=d!=null&&j.indexOf(d.toLowerCase())>-1?d:"top",c.DIRECTION=d;var k=h.scrollTop()+a.scrollDiffY,l=h.scrollLeft()+a.scrollDiffX;c.TOP=k,c.LEFT=l,ZDBClientUtil.scrollToPosition(h,c)},this.scrollToPosition=function(a,b){var c=b.DIRECTION,d=b.TOP,e=b.LEFT,f=b.ADJUSTTOP,g=b.ADJUSTLEFT,h=b.DURATION,i=b.ONCOMPLETE;f=f==null?0:f,g=g==null?0:g,h=h==null?"fast":h,d+=f,e+=g;var j={};j.scrollTop=c=="top"||c=="both"?d:null,j.scrollLeft=c=="left"||c=="both"?e:null,a.animate(j,{duration:h,complete:i})},this.isElFullyVisible=function(a,b){var c=jQuery(b),d=c.offset().left,e=c.offset().top,f=d+c.width(),g=e+c.height(),h=jQuery(a),i=h.offset().left,j=h.offset().top,k=i+h.width(),l=j+h.height(),m=i>=d&&k<=f&&j>=e&&l<=g;if(m!=1){var n=a.nextSibling;a.scrollDiffX=k>f?n!=null?jQuery(n).offset().left-f:b.scrollWidth-b.clientWidth-b.scrollLeft:-(d-i),a.scrollDiffY=l>g?n!=null?jQuery(n).offset().top-g:b.scrollHeight-b.clientHeight-b.scrollTop:-(e-j)}return m},this.searchAndDisplay=function(a,b,c,d,e,f){var g=ZDBSearchUtil.getSearchValue(d),h=jQuery($(a)).find(b);h.parent().show();if(g===null){e.style.display="none",f!=null&&($(f).removeAttribute("disabled"),$(f).setAttribute("class","buttonCompBoxBg"));return}var i="'["+c+'*="'+g.toLowerCase()+"\"]'";h.not(i).parent().hide(),h.parent().find(":visible").length===0?(e.style.display="",f!=null&&($(f).setAttribute("disabled","disabled"),$(f).setAttribute("class","buttonCompBoxBg alpha"))):(e.style.display="none",f!=null&&jQuery(f).show())},this.getJsonRelModelIdForObjId=function(a){for(var b in ZDBAnalysisCaching.tblColInfo.relModelInfo)if(ZDBAnalysisCaching.tblColInfo.data[b].tableDet[a])return b;return null},this.deleteJsonForObjId=function(a){var b=ZDBAnalysisCaching.tblColInfo.data;for(var c in ZDBAnalysisCaching.tblColInfo.relModelInfo)if(b[c].tableDet[a]){delete b[c],delete ZDBAnalysisCaching.tblColInfo.relModelInfo[c];break}return}};ZDBStrBuf.prototype.a=function(a){return this.buf.push(a),this},ZDBStrBuf.prototype.attr=function(a,b){return this.buf.push(" "),this.buf.push(a),this.buf.push("='"),this.buf.push(ZDBEscapeUtil.encodeForXML(b)),this.buf.push("' "),this},ZDBStrBuf.prototype.sTag=function(a){return this.buf.push("<"),this.buf.push(a),this.buf.push(" "),this},ZDBStrBuf.prototype.eTag=function(){return this.buf.push("/>\n"),this},ZDBStrBuf.prototype.eNTag=function(a){return this.buf.push("\n</"),this.buf.push(a),this.buf.push(">\n "),this},ZDBStrBuf.prototype.toString=function(){return this.buf.join("")};var ZRSHomeUtil=new function(){};jQuery(window).mousemove(function(a){ZRSHomeUtil.curMouseEvent=a}),jQuery.fn.hasVerticalScrollBar=function(){return this.get(0).scrollHeight>this.height()},ZRSHomeUtil.handleFooter=function(){var a="ZRSFooter";$("ZRSFooter").className=a;var b=jQuery("#ZDBHomeContainer");b.length>0&&(a=b.hasVerticalScrollBar()?a:"ZRSFooterFixed"),$("ZRSFooter").className=a},jQuery("ul.DBCreateOpts li").hover(function(a){ZRSHomeUtil.showDBOptsTip(this,a)},function(a){jQuery(this).find("div.ZDBDBOptsTip").stop(!0,!0).fadeOut(300)}),jQuery(".ZDBDBOptsTip a").click(function(a){a.stopPropagation()}),ZRSHomeUtil.handleShowDBOptsTip=function(a,b){ZRSHomeUtil.showDBOptsTip(a,b)},ZRSHomeUtil.showDBOptsTip=function(a,b){jQuery(a).find("div.ZDBDBOptsTip").stop(!0,!0).fadeIn(300)},ZRSHomeUtil.currentPage=1,ZRSHomeUtil.initDBOptsVariables=function(){ZRSHomeUtil.wrapper=jQuery("#ZDBDBOptsDiv"),ZRSHomeUtil.opts=jQuery("ul.DBCreateOpts li:visible"),ZRSHomeUtil.single=ZRSHomeUtil.opts.filter(":first"),ZRSHomeUtil.singleWidth=ZRSHomeUtil.single.outerWidth(!0)},ZRSHomeUtil.initializeSlideShowVar=function(){ZRSHomeUtil.visible=Math.ceil(ZRSHomeUtil.wrapper.innerWidth()/ZRSHomeUtil.singleWidth),ZRSHomeUtil.pages=Math.ceil(ZRSHomeUtil.opts.length/ZRSHomeUtil.visible),ZRSHomeUtil.handleSlideNavigButtons()},ZRSHomeUtil.handleSlideNavigButtons=function(){ZRSHomeUtil.slideHolderOffset=jQuery("ul.DBCreateOpts").offset(),ZRSHomeUtil.pages<=1?(jQuery("a.back").hide(),jQuery("a.forward").hide()):(jQuery("a.back").show(),jQuery("a.forward").show()),ZRSHomeUtil.pages>1&&ZRSHomeUtil.currentPage===1&&(jQuery("a.back").fadeTo("fast",0),jQuery("a.back").unbind("click")),jQuery("a.forward").unbind("click").click(function(){return ZRSHomeUtil.gotoPage(ZRSHomeUtil.currentPage+1)})},ZRSHomeUtil.gotoPage=function(a){a>ZRSHomeUtil.pages&&(a=1);var b=a<ZRSHomeUtil.currentPage?-1:1,c=Math.abs(ZRSHomeUtil.currentPage-a),d=ZRSHomeUtil.singleWidth*b*ZRSHomeUtil.visible*c;return ZRSHomeUtil.wrapper.filter(":not(:animated)").animate({scrollLeft:"+="+d},500,function(){ZRSHomeUtil.currentPage=a,ZRSHomeUtil.currentPage===1?(jQuery("a.back").fadeTo("fast",0),jQuery("a.back").unbind("click")):ZRSHomeUtil.currentPage>1&&ZRSHomeUtil.currentPage<=ZRSHomeUtil.pages&&(jQuery("a.back").fadeTo("fast",1),jQuery("a.forward").fadeTo("fast",1),jQuery("a.back").unbind("click"),jQuery("a.forward").unbind("click"),jQuery("a.back").click(function(){return ZRSHomeUtil.gotoPage(ZRSHomeUtil.currentPage-1)}),jQuery("a.forward").click(function(){return ZRSHomeUtil.gotoPage(ZRSHomeUtil.currentPage+1)}))}),!1},ZRSHomeUtil.setDBOptsWidth=function(){var a=jQuery("#ZDBHomeContainer").innerWidth(),b=100,c=a-b*2;c-=c%ZRSHomeUtil.singleWidth;var d=ZRSHomeUtil.opts.length*ZRSHomeUtil.singleWidth;c=d<c?d:c;var e=jQuery(".arrow").outerWidth(!0);jQuery("#ZDBDBOptsDiv").css({opacity:0,visibility:"visible"}).width(c).animate({opacity:1},500);var f=10;jQuery("#ZDBDBOptsDiv").parent().width(c+(e+f)*2),ZRSHomeUtil.visible=Math.floor(ZRSHomeUtil.wrapper.innerWidth()/ZRSHomeUtil.singleWidth),ZRSHomeUtil.pages=Math.ceil(ZRSHomeUtil.opts.length/ZRSHomeUtil.visible),ZRSHomeUtil.handleSlideNavigButtons()},ZRSHomeUtil.initialSetUp=function(a){ZRSHomeUtil.showRHideDBCreateOpts(a),ZRSHomeUtil.initDBOptsVariables();var b=jQuery("#ZDBHomeContainer");b.css("margin-left",jQuery("#ZDBMinMaxSidebar").outerWidth(!0)),jQuery("#ZDBMainContainer").css("top",jQuery("#ZDBHeader").outerHeight(!0)),ZRSHomeUtil.handleFooter(),ZRSHomeUtil.setDBOptsWidth();var c=jQuery("#ZDBHomeTabs li.buttonSelected"),d=jQuery(".ZRSFillLoading");c.append(d),d.width("0%"),d.show().animate({width:"100%"},100),jQuery("#ZRSRecentListHolder").attr("recentItemsLen")>0&&(jQuery("#ZDBMaxMinSidebar").show(),jQuery("#ZDBMaxMinSidebar").bind("mouseover",function(){ZRSHomeUtil.showSideBar()}))},ZRSHomeUtil.resizeHolders=function(){ZRSHomeUtil.initDBOptsVariables();var a=jQuery("#ZDBHomeContainer");a.css("margin-left",jQuery("#ZDBMinMaxSidebar").outerWidth(!0)),jQuery("#ZDBMainContainer").css("top",jQuery("#ZDBHeader").outerHeight(!0)),ZRSHomeUtil.handleFooter(),ZRSHomeUtil.wrapper.filter(":not(:animated)").css("visibility","hidden").scrollLeft(0),ZRSHomeUtil.currentPage=1,ZRSHomeUtil.setDBOptsWidth()},ZRSHomeUtil.handleWindowResize=function(){return ZRSHomeUtil.windowResizeTimeout!=null&&clearTimeout(ZRSHomeUtil.windowResizeTimeout),ZRSHomeUtil.windowResizeTimeout=setTimeout("ZRSHomeUtil.resizeHolders()",500),!0},ZRSHomeUtil.hideSideBar=function(){var a=jQuery("#ZDBSidebar");a.animate({left:"-281px"})},ZRSHomeUtil.showSideBar=function(){var a=jQuery("#ZDBSidebar");a.stop(!0,!0).animate({left:"31px"}).focus(),jQuery(document.body).mouseover(function(a){var b=jQuery(a.target),c=b.attr("id")=="ZDBMaxMinSidebar"||b.attr("id")=="ZDBSidebar"||b.parents("#ZDBSidebar").length;c||(ZRSHomeUtil.hideSideBar(),jQuery(document.body).unbind("mouseover"))})},ZRSHomeUtil.showImportDlgInfo=function(a){var b=ZDBUtil.getParentWithAttr(a,"connectorId"),c=b.getAttribute("connectorId");if(ZRSHomeUtil.impInfoDlg&&ZRSHomeUtil.impInfoDlg[c]){var d=ZDBI18NMap.f("zrpt.connector.js.demo.title",ZRSHomeUtil.getConnectorName(c));ZDBDialogUtil.showDialog(ZRSHomeUtil.impInfoDlg[c],{TITLE:d,ADDFRAME:!0,MODAL:!0})}else AjaxAPI.sendRequest({URL:"/ZDBImportInfoDlg.cc?CONNECTORID="+c,ONSUCCESSFUNC:ZRSHomeUtil.showConnectorInfoDlg,CONNECTORID:c,OPSTATUSID:"ZDBMainLoader"})},ZRSHomeUtil.showConnectorInfoDlg=function(a,b){var c=b.CONNECTORID,d=document.createElement("div");d.innerHTML=a.responseText,ZRSHomeUtil.impInfoDlg==null&&(ZRSHomeUtil.impInfoDlg=new Object,ZRSHomeUtil.impInfoDlg[c]=d);var e=ZDBI18NMap.f("zrpt.connector.js.demo.title",ZRSHomeUtil.getConnectorName(c));ZDBDialogUtil.showDialog(d,{TITLE:e,ADDFRAME:!0,MODAL:!0})},ZRSHomeUtil.getConnectorName=function(a){var b="";return a==="0"?b=ZDBI18NMap.g("zrpt.connector.js.sf"):a==="1"?b=ZDBI18NMap.g("zrpt.connector.js.zp"):a==="2"?b=ZDBI18NMap.g("zrpt.connector.js.gad"):a==="3"?b=ZDBI18NMap.g("zrpt.connector.js.ga"):a==="4"?b=ZDBI18NMap.g("zrpt.connector.js.zbt"):a==="5"?b=ZDBI18NMap.g("zrpt.connector.js.zendesk"):a==="6"&&(b=ZDBI18NMap.g("zrpt.connector.js.creator")),b},ZRSHomeUtil.toggleDBCreateOpts=function(a,b){jQuery("#ZRSDBCreateOptsHldr").stop().slideToggle("slow",function(){ZRSHomeUtil.handleFooter()});var c=a+"_SHOW_DB_CREATE_OPTS",d=window.localStorage.getItem(c);d==null||d=="false"?(window.localStorage.setItem(c,"true"),jQuery(b).find("[elname='moreRLessIcon']").attr("class","ZRSLessIcon"),ZRSHomeUtil.initDBOptsVariables(),ZRSHomeUtil.setDBOptsWidth()):(window.localStorage.setItem(c,"false"),jQuery(b).find("[elname='moreRLessIcon']").attr("class","ZRSMoreIcon"))},ZRSHomeUtil.showRHideDBCreateOpts=function(a){var b=a+"_SHOW_DB_CREATE_OPTS",c=window.localStorage.getItem(b),d=parseInt(jQuery("#ZRSCreateDBBtn").attr("createdDBCount"));if(d<1)jQuery("#ZRSCreateDBBtn").hide(),jQuery("#ZRSCreateOptsHeader").children("h1").show(),jQuery("#ZRSDBCreationOptions").removeClass("toggleCreateOpts"),jQuery("#ZRSDBCreateOptsHldr").show();else{var e=jQuery("#ZRSCreateDBBtn").show();jQuery("#ZRSDBCreationOptions").addClass("toggleCreateOpts"),c=="true"?(jQuery("#ZRSDBCreateOptsHldr").show(),e.find("[elname='moreRLessIcon']").attr("class","ZRSLessIcon")):(jQuery("#ZRSDBCreateOptsHldr").hide(),e.find("[elname='moreRLessIcon']").attr("class","ZRSMoreIcon"))}},ZRSHomeUtil.validateDBName=function(a){var b=jQuery(a).val();AjaxAPI.sendRequest({URL:"/ZDBDatabaseActionMI.ma?ZDBACTION=VALIDATEDBNAME&ZOHO_DBNAME="+b,ONFAILUREFUNC:ZRSHomeUtil.validateDBFailure,ELEMENT:a})},ZRSHomeUtil.validateDBFailure=function(a,b){var c=b.ELEMENT;jQuery(c).addClass("inputError");var d=a.getResponsePart("ERRORCODE"),e=a.getResponsePart("STATUS_MESSAGE");d=trimAll(d);if(d==="META_DBNAME_DUPLICATE"){showCustomMessage(e,c);return}AjaxAPI.onFailureFunc(a,b)};var ZDBLazyLoadUtil=new function(){this.moduleJSURLs={},this.moduleCSSURLs={},this.loadedSnippets={},this.loadedScripts={},this.loadedCss={},this.loadingUrls={},this.sendSnippetRequest=!0,this.loadSnippet=function(a,b,c,d,e,f,g,h){if(a)var i=a.split(","),j=ZDBLazyLoadUtil.checkSnippetsList(i)==0;else var j=ZDBLazyLoadUtil.loadedSnippets[a];var k=e==null;if(e!=null){e=e instanceof Array?e:e.split(",");var l=ZDBLazyLoadUtil.checkFileslist(e);k=l==0;if(j&&k)return!0}if(j&&k)return!0;f!=null,f=arguments.callee.caller,g=f.arguments,g||(g=[]),g=LangUtils.cloneArray(g);var m={func:f,ownerObj:c,args:g,snippetName:a,snippetUrl:b,loadOption:d,isJs:!0,jsFileNames:e,jsLoaded:k,opStatusId:h||"ZDBMainLoader",snippetLoaded:j};if(!m.jsLoaded){var n=ZDBLazyLoadUtil.getFileURLs(e,!1,ZDBGlobal.JSPATH);LazyLoad.js(n,ZDBLazyLoadUtil.handleResponse,m,!1)}return m.snippetLoaded||ZDBLazyLoadUtil.fetchSnippet(m),!1},this.checkFileslist=function(a){var b=a;for(var c=0;c<b.length;c++){var d=ZDBLazyLoadUtil.loadedScripts[b[c]]!=null;d&&(b.splice(c,1),c--)}return b.length},this.checkCssFileslist=function(a){var b=a;for(var c=0;c<b.length;c++){var d=ZDBLazyLoadUtil.loadedCss[b[c]]!=null;d&&(b.splice(c,1),c--)}return b.length},this.checkSnippetsList=function(a){var b=a;for(var c=0;c<a.length;c++){var d=ZDBLazyLoadUtil.loadedSnippets[b[c]];d&&(b.splice(c,1),c--)}return b.length},this.loadJsAlone=function(a,b,c,d,e,f){a=a instanceof Array?a:a.split(",");var g=ZDBLazyLoadUtil.checkFileslist(a);if(g==0)return!0;d||(d=[]);var h={func:c,ownerObj:b,args:d,jsFileNames:a,isJs:!0,jsLoaded:!1,snippetLoaded:!0,opStatusId:e},i=ZDBLazyLoadUtil.getFileURLs(a,f,ZDBGlobal.JSPATH,!1,h);if(i.length<=0){setTimeout(function(){ZDBLazyLoadUtil.invokeFunc(h)},500);return}LazyLoad.js(i,ZDBLazyLoadUtil.handleResponse,h,!1),StatusMsgAPI.showOperationStatus(StatusMsgAPI.OPSTATUS.STARTED,h.opStatusId)},this.getFileURLs=function(a,b,c,d,e){if(b)return a;var f=a instanceof Array?a:a.split(",");f.forEach(function(a,b,c){ZDBLazyLoadUtil.loadingUrls.hasOwnProperty(a)?c.splice(b,1):ZDBLazyLoadUtil.loadingUrls[a]=!0});var g=[];for(var h=0;h<f.length;h++){var i=f[h],j=d?ZDBLazyLoadUtil.moduleCSSURLs[i]:ZDBLazyLoadUtil.moduleJSURLs[i];if(j==null)g=g.concat([c+i]);else if(typeof j=="string")g=g.concat([c+j]);else{if(typeof j!="object")throw new Error("Unexpected Url type "+j);g=g.concat(j)}}return ZDBLazyLoadUtil.addVersion(g),g},this.handleJsAndCssFilePathResp=function(a,b){var c=document.createElement("script");c.innerHTML=a.responseText,document.getElementsByTagName("body")[0].appendChild(c),ZDBLazyLoadUtil.snippetsLoaded=!0,ZDBLazyLoadUtil.sendSnippetRequest=!0},this.fetchSnippet=function(a){AjaxAPI.sendRequest({URL:a.snippetUrl,METHOD:"GET",REQOBJ:a,OPSTATUSID:a.opStatusId,ONSUCCESSFUNC:ZDBLazyLoadUtil.handleSnippetResp})},this.handleSnippetResp=function(a,b){var c=b.REQOBJ,d=c.loadOption,e=c.snippetName;if(d!="APPENDTODOC")throw new Error("Unknown loadOption "+d);var f=document.createElement("div");f.innerHTML=a.responseText,f.style.display="none",document.body.appendChild(f);if(e){var g=e.split(",");for(var h=0;h<g.length;h++)ZDBLazyLoadUtil.loadedSnippets[g[h]]=!0}else ZDBLazyLoadUtil.loadedSnippets[e]=!0;return c.snippetLoaded=!0,c.jsLoaded?(ZDBLazyLoadUtil.invokeFunc(c),StatusMsgAPI.OPSTATUS.FINISHED):StatusMsgAPI.OPSTATUS.INPROGRESS},this.handleResponse=function(a){if(a.isJs){var b=a.jsFileNames instanceof Array?a.jsFileNames:a.jsFileNames.split(",");a.jsLoaded=!0;for(var c=0;c<b.length;c++)ZDBLazyLoadUtil.loadedScripts[b[c]]=!0}else if(a.isCss){var b=a.cssFileNames instanceof Array?a.cssFileNames:a.cssFileNames.split(",");a.cssLoaded=!0;for(var c=0;c<b.length;c++)ZDBLazyLoadUtil.loadedCss[b[c]]=!0}a.snippetLoaded&&ZDBLazyLoadUtil.invokeFunc(a)},this.invokeFunc=function(a){if(a.finished){console.trace();return}a.finished=!0;var b=a.func,c=StatusMsgAPI.OPSTATUS.FINISHED;try{b&&(c=b.apply(a.ownerObj,a.args))}finally{(c===StatusMsgAPI.OPSTATUS.FINISHED||c==null)&&StatusMsgAPI.showOperationStatus(StatusMsgAPI.OPSTATUS.FINISHED,a.opStatusId)}},this.addVersion=function(a){if(ZDBGlobal.isDevelopmentMode){var b=(new Date).getTime();for(var c=0,d=a.length;c<d;c++)a[c]+="?VER="+b}},this.loadCssOnly=function(a,b,c,d,e,f){a=a instanceof Array?a:a.split(",");var g=ZDBLazyLoadUtil.checkCssFileslist(a);if(g==0)return!0;d||(d=[]);var h={func:c,ownerObj:b,args:d,isCss:!0,cssFileNames:a,cssLoaded:!1,snippetLoaded:!0,opStatusId:e},i=ZDBLazyLoadUtil.getFileURLs(a,f,"",!0,h);if(i.length<=0){setTimeout(function(){ZDBLazyLoadUtil.invokeFunc(h)},500);return}LazyLoad.css(i,ZDBLazyLoadUtil.handleResponse,h,!1),StatusMsgAPI.showOperationStatus(StatusMsgAPI.OPSTATUS.STARTED,h.opStatusId)}},ZDBLazyLoadFuncMap=new function(){this.lazyLoadFuncMap={"ZDBClientUI.openGettingStartedDlg":ZDBClientUI.openGettingStartedDlg,"ZDBEvents.onFilterAreaButtonClick":ZDBEvents.onFilterAreaButtonClick}},ZDBClientViewAPI=new function(){this.TYPE_TABLE=0,this.TYPE_REPORT=1,this.TYPE_ANALYSISVIEW=2,this.TYPE_PIVOT=3,this.TYPE_SUMMARY=4,this.TYPE_TABLEVIEW=5,this.TYPE_QUERYTABLE=6,this.TYPE_DASHBOARD=7,this.TYPE_WIDGET=8,this.TYPES_VALUE_MAP={Table:this.TYPE_TABLE,Report:this.TYPE_REPORT,AnalysisView:this.TYPE_ANALYSISVIEW,Pivot:this.TYPE_PIVOT,SummaryView:this.TYPE_SUMMARY,TableView:this.TYPE_TABLEVIEW,QueryTable:this.TYPE_QUERYTABLE,Dashboard:this.TYPE_DASHBOARD,WIDGET:this.TYPE_WIDGET},this.init=function(a,b,c,d,e,f,g,h,i){a.objId=b,a.dbId=c,a.parentViewId=d,a.displayName=e,a.type=f,a.designModTime=g,a.description=h,a.title=i,this.initFns(a)},this.interfaceFns={save:ZDBUtil.dummyFunc,resize:ZDBUtil.dummyFunc,setVisible:ZDBUtil.dummyFunc,setHidden:ZDBUtil.dummyFunc,checkSave:DummyView.checkSave,removeView:ZDBUtil.dummyFunc,layoutModeChanged:ZDBUtil.dummyFunc,setScrollPosition:ZDBUtil.dummyFunc,setModified:function(){this.modified++,this.viewCtx.updateModified()},clearModified:function(){this.modified=0,this.viewCtx.updateModified()}},this.initFns=function(a){var b=this.interfaceFns;for(var c in b)a[c]||(a[c]=b[c])},this.setSecurityDetails=function(a,b,c,d,e){a.permissions=ZDBClientViewAPI.constructPermissions(b),a.permLevel=b,a.grpShared=c,a.isPublic=d,a.exportPerm=a.permissions.exportPerm,(a.permissions.add!==1&&a.permissions.modify!==1&&a.permissions.deletePerm!==1&&a.setAsReadOnly||ZDBGlobal.IS_MOBILE)&&a.setAsReadOnly(),a.isSystemTable=e},this.initFromDiv=function(a,b){a.objId=b.getAttribute("objId"),a.parentViewId=b.getAttribute("parentViewId"),a.displayName=b.getAttribute("displayName"),a.displayName==""&&(a.displayName=null),a.dbId=b.getAttribute("dbId"),a.permLevel=b.getAttribute("permLevel"),a.grpShared=b.getAttribute("grpShared")=="true",a.isPublic=b.getAttribute("isPublic")=="true",a.permissions=ZDBClientViewAPI.constructPermissions(a.permLevel),a.canPreLoad=b.getAttribute("canPreLoad")=="true",a.title=b.getAttribute("title")||"",a.description=b.getAttribute("description")||"";var c=b.getAttribute("viewType");c&&!a.type&&(a.type=c),a.type=="Pivot"?a.typeValue=ZDBClientViewAPI.TYPE_PIVOT:a.type=="SummaryView"?a.typeValue=ZDBClientViewAPI.TYPE_SUMMARY:a.type=="AnalysisView"?a.typeValue=ZDBClientViewAPI.TYPE_ANALYSISVIEW:a.type=="Dashboard"&&(a.typeValue=ZDBClientViewAPI.TYPE_DASHBOARD);if(ZDBUtil.isNewView(a)&&a.displayName==null){var c=ZDBClientUI.typeDefns[a.type];c!=null&&(a.displayName=ZDBI18NMap.g(c.newName))}b.getAttribute("isExportCSV")!=null?a.isExportCSV=b.getAttribute("isExportCSV")=="true":a.isExportCSV=!0,this.initFns(a)},this.constructPermissions=function(a){var b=new Object;if(!a)return b;var c=a.split("$"),d=["read","exportPerm","vud","add","modify","deletePerm","deleteAll","appendImport","updateImport","truncateImport","deleteupdateadd","share","vudShowSelCol","drilldown","dbOwner","grpMember","designModify","createTable","createChildReports"];for(var e=0;e<c.length;e++)d[e]&&(b[d[e]]=parseInt(c[e]));return b}};DummyView.checkSave=function(){return!0},ZDBDefViewCtx.prototype.checkIfRespValid=function(a,b){return this.isValid},ZDBDefViewCtx.prototype.getConfig=function(a,b){var c=this.configMap;return c==null||c[a]==null?b:c[a]},ZDBDefViewCtx.prototype.setConfig=function(a,b){this.configMap||(this.configMap={key:b}),this.configMap[a]=b},ZDBDefViewCtx.prototype.canGrabFocus=function(a,b){return!0},ZDBDefViewCtx.prototype.handle=function(a){this.view=a,a.viewCtx=this,this.parView=a.parView,this.singleChild&&this.parComp.firstChild!=a.viewComp&&ZDBUtil.removeAllChildren(this.parComp),this.parComp.appendChild(a.viewComp),this.parComp.view=a,a.setVisible(),this.updateModified(),this.isReadOnly&&(a.permissions.designModify=0,a.setAsReadOnly&&(a.permissions=ZDBConst.READONLY,a.setAsReadOnly()))},ZDBDefViewCtx.prototype.getLoadIndicator=function(a){var b=this.loadIndicator;return b&&b.textEl&&(b.textEl.innerHTML="<nobr>"+(a||ZDBI18NMap.g("zrpt.common.loadingdiv.js.loading"))+" . . .</nobr>"),b},ZDBDefViewCtx.prototype.isStandAlone=function(){return this.standAlone},ZDBDefViewCtx.prototype.showModalDiv=function(a,b){var c=b==null?"alpha0":b;if(a.typeValue!=ZDBClientViewAPI.TYPE_DASHBOARD)return;var d=ZDBEditModeSelect.resizeModalDiv;d.className=c,d.style.cursor="",d.parentNode!=document.body&&document.body.appendChild(d),d.style.display="",this.resizeModalDiv=d},ZDBDefViewCtx.prototype.hideModalDiv=function(a,b){if(a.typeValue!=ZDBClientViewAPI.TYPE_DASHBOARD||a.typeValue==ZDBClientViewAPI.TYPE_WIDGET)return;if(b)return;var c=ZDBEditModeSelect.resizeModalDiv;c.style.display="none"},ZDBDefViewCtx.prototype.hasMenuItems=function(
){return this.menuItems},ZDBDefViewCtx.prototype.getSize=function(){return{width:this.parComp.clientWidth,height:this.parComp.clientHeight}},ZDBDefViewCtx.prototype.updateModified=ZDBUtil.dummyFunc,ZDBDefViewCtx.prototype.getParComp=function(){return this.parComp},ZDBDefViewCtx.prototype.getNavigPlHolder=function(a){return{isNavig:!1,el:null}},ZDBDefViewCtx.prototype.getAdditionalParams=function(){var a="";return ZDBClientUI.zoho_criteria&&(a+="&ZOHO_CRITERIA="+encodeURIComponent(ZDBClientUI.zoho_criteria)),ZDBClientUI.privateKey!=null&&(a+="&privatelink="+encodeURIComponent(ZDBClientUI.privateKey)),ZDBClientUI.zrauthkey!=null&&(a+="&zrauthkey="+encodeURIComponent(ZDBClientUI.zrauthkey)),ZDBClientUI.authtoken!=null&&(a+="&authtoken="+encodeURIComponent(ZDBClientUI.authtoken)),ZDBClientUI.sessionKey!=null&&(a+="&SFSESSIONKEY="+encodeURIComponent(ZDBClientUI.sessionKey)),ZDBClientUI.fs!=null&&(a+="&FS="+encodeURIComponent(ZDBClientUI.fs)),ZDBClientUI.rsConfig!=null&&(a+="&RSCONFIG="+encodeURIComponent(ZDBClientUI.rsConfig)),ZDBClientUI.containerObjId!=null&&(a+="&CONOBJID="+encodeURIComponent(ZDBClientUI.containerObjId)),this.configMap&&this.configMap.FROMDASHBOARD&&(a+="&FROMDASHBOARD="+this.configMap.FROMDASHBOARD),ZDBClientUI.isPrivateSlide!=null&&(a+="&SLIDEID="+ZDBClientUI.slideId+"&SLIDEKEY="+ZDBClientUI.slideKey),a},ZDBUIViewCtx.prototype=new ZDBDefViewCtx,ZDBUIViewCtx.prototype.initConfig=function(){if(this.configMap)return;ZDBUIViewCtx.configMap||(ZDBUIViewCtx.configMap=ZDBUtil.getParamMapFromUrl(window.location.href)),this.configMap=LangUtils.cloneObject(ZDBUIViewCtx.configMap)},ZDBUIViewCtx.prototype.checkIfRespValid=function(a,b){return ZDBClientUI.checkIfRespValid(this.tab)},ZDBUIViewCtx.prototype.handle=function(a){ZDBClientUI.updateViewInTab(a,this.tab)},ZDBUIViewCtx.prototype.getSize=function(){var a=ZDBClientUtil.getInnerWidth(this.parComp),b=ZDBClientUtil.getInnerHeight(this.parComp);return{width:a,height:b}},ZDBUIViewCtx.prototype.updateModified=function(){var a=this.tab,b=ZDBUtil.isViewModified(a.view);a.tabModified.style.visibility=b?"visible":"hidden",!(a.view instanceof DummyView)&&a.view.toolbar&&(b?ZDBUtil.highlightSave(a.view):ZDBUtil.removeHighlight(a.view))},ZDBUIViewCtx.getViewLoadingDiv=function(a){return loadDiv=ZDBUtil.getCloned(ZDBClientUI.mainLoader),loadDiv.className="zdbLoaded",ZDBUtil.setNamedChildEls(loadDiv,loadDiv),a&&a.appendChild(loadDiv),loadDiv};var ZDBMenu=new function(){this.setForRelEl=function(a,b){var c=a.getAttribute("relid");if(c!=null){var d="iconitem".length,e=document.getElementById(c),f=this.getBaseClass(e.className);b=="hover"||b=="over"?this.setMouseOver(e,d,f):(b==""||b=="out")&&this.setMouseOut(e,f)}},this.getBaseClass=function(a){var b=a.split(" ");for(var c=1;c<b.length;c++)if(b[c].trim().length>0)return b[c]},this.setMouseOver=function(a,b,c){var d=a.className.substring(b);a.setAttribute("oldClass",d),a.className="iconitem "+c+" hover"},this.setMouseOut=function(a,b){var c=a.getAttribute("oldClass");a.className="iconitem "+(c?c:b),a.removeAttribute("oldClass")},this.zdbHighLighter=function(a,b,c){if(a.getAttribute("enabled")=="false"||!b)return;a.className="iconitem "+b+" "+c,this.setForRelEl(a,c)},this.save=function(a,b,c){if(c=="TableDesign"){var d=ZDBUtil.getPropertyFromEl(a,"gridObj","object");d.save()}else if(ZDBClientUI.selectedTab){var e=ZDBClientUI.getViewObj(a,"view");ZDBClientUI.selectedTab.view.save()}},this.showMenu=function(a,b,c,d,e){var f=$(c);return ZDBMenu.showMenuEl(a,b,f,d,e)},this.showModuleMenu=function(a,b,c,d,e,f){var g=ZDBContentCache.appendAndGet(c,d,document.body);if(g==null)return;return ZDBMenu.showMenuEl(a,b,g,e,f)},this.showDashOptsMenu=function(a,b,c,d,e){var f=ZDBContentCache.appendAndGet(c,d,document.body);if(f==null)return;ZDBUtil.setNamedChildEls(f,f);var g=a.view;return f.view=g,ZDBExport.enableDisableExpMailSubMenuItems($("ExportImage"),g.type,g),ZRSMenu.showMenu(b,a,f,null,e),f},this.showModuleMenuRight=function(a,b,c,d,e,f){var g=ZDBContentCache.appendAndGet(c,d,document.body);if(g==null)return;ZDBMenu.showMenuEl(a,b,g,e,f,2)},this.showDropDownMenu=function(a,b,c,d,e,f){var g=ZDBContentCache.appendAndGet(c,d,document.body);if(g==null)return;if(c=="Sort_Chart"){var h=ZAChartSortMenu.SHOW_LEGEND_MENU;f===null&&(h=ZAChartSortMenu.SHOW_AXIS_MENU),ZAChartSortMenu.showSubMenu(h)}if(e=="left")var i=ZDBMenu.checkAndGetPositionVal(a,g,c,d,b),j=i[0],k=i[1];else{var l=ZDBContentCache.getContent(c,d);ZRSMenu.showMenu(b,null,g,1),j=ZDBUtil.getObjLeft(a)+a.offsetWidth-l.offsetWidth,k=ZDBUtil.getElementAbsolutePos(a).y-l.offsetHeight,k=parseInt(k),j=parseInt(j),ZDBUtil.stopEventBubble(b)}g.style.top=k+"px",g.style.left=j+"px",ZRSMenu.showMenu(b,null,g,1),ZDBUtil.stopEventBubble(b)},this.checkAndGetPositionVal=function(a,b,c,d,e){var f=document.body.offsetWidth,g=ZDBUtil.getObjLeft(a),h=ZDBUtil.getObjTop(a)+a.offsetHeight,i=ZDBContentCache.getContent(c,d);return ZRSMenu.showMenu(e,null,b,1),i.offsetWidth+g+5>f&&(g=parseInt(ZDBUtil.getObjLeft(a)+a.offsetWidth-i.offsetWidth),h=parseInt(ZDBUtil.getElementAbsolutePos(a).y-i.offsetHeight)),[g,h]},this.showHideMenuItems=function(a,b,c){var d=$("ZDBTbldrill");c&&c.id=="ZDBColPropMenuQT"&&(d=$("ZDBTbldrillQT")),jQuery(d).show();if(d){if(!b)return;var e=b.getSelectedColHead(),f=e?e.colObj:a.colObj;if(!f){d.setAttribute("enabled",!1),d.style.display="none";return}var g=f.type;g=g=="RELCOL"||g=="REFCOL"?f.relColType:g,d.style.display!=="none"&&(d.style.display=jQuery.inArray(g,ZDBUtil.allowedTypes_for_Drill)>=0?ZDBUtil.visibleTrStyle:"none");var h=d.style.display==="none"?!1:!0;if(h)jQuery(d).prev("tr").children("td").removeClass("iconitem3");else{var c=jQuery(d).prev("tr").children("td").addClass("iconitem3");c.length>0&&c[0].setAttribute("menuitemclass",c[0].className)}d.setAttribute("enabled",h)}},this.showMenuEl=function(a,b,c,d,e,f){var g=ZDBUtil.getPropertyFromEl(a,"gridObj","object");if(g&&g instanceof ZDBDataGrid){c.gridObj=g;var h=ZDBDataGrid.getLastFocusCell(g);h&&(c.cellObj=h,c.colObj=h.colObj,c.rowObj=h.rowObj,g.setCellFocus(h,!1))}if(c.getAttribute("isEnableDisable")=="true"){var i=jQuery(c).find("li a");this.enableDisableMenuItems(ZDBClientUI.selectedTab.view,i,!1),this.showHideMenuItems(c,g,a)}e&&(c.view=e),ZRSMenu.showMenu(b,a,c,f);return},this.showNewObjectsPopup=function(a,b,c){if(!ZDBLazyLoadUtil.loadJsAlone("zdbjs/autogen/ZDBSampleViews.js",this,ZDBMenu.showNewObjectsPopup,[a,b,c]))return;if(this.warnIfNotLoggedIn())return;this.showModuleMenu(a,b,"New_Objects_Menu","GridMenu",!0);var d=jQuery("#ZDBNewObjectsMenu"),e=d.position(),f=e.top,g=e.left;d.css({top:f+10,left:g-9}),ZDBPopUpMenu.hideSeparator(d);var h=jQuery("#ZRSAutoAnalysis");h&&ZDBClientUI.isDBOwner&&(c?h.hide():h.show())},this.showViewRelationsPopup=function(a,b){var c=ZDBClientUI.getViewObj(a,"view");if(this.warnIfNotLoggedIn())return;this.showModuleMenu(a,b,"ERD_View_Chart_Relationship","GridMenu",!0,c);var d=jQuery("#ZDBERDGChartMenu"),e=d.position(),f=e.top,g=e.left;d.css({top:f+10,left:g-9}),ZDBPopUpMenu.hideSeparator(d)},this.showExploreNewPopup=function(a,b){var c=ZDBContentCache.appendAndGet("Exp_New_Menu","GridMenu",document.body);if(!c)return;var d=$("ZDBEXPNEWTABLEROW");ZDBClientUI.isDBOwner||(d.style.display="none"),this.showMenuEl(a,b,c,!0);var e=jQuery(c);if(a.id=="ZDBEXPLORERNEW_TITEM"){e.children("span").show();var f=e.position(),g=f.top,h=f.left;e.css({top:g+10,left:h-9})}else e.children("span").hide();ZDBPopUpMenu.hideSeparator(c)},this.showExplorerLocalDBConnListPopup=function(a,b){var c=ZDBContentCache.appendAndGet("Exp_LocalDBConnList_Menu","GridMenu",document.body);this.showMenuEl(a,b,c,!0)},this.showConnSettingsMenu=function(a,b){var c=ZDBUtil.getParentWithAttributeValue(a,"isparent","true"),d=ZDBContentCache.appendAndGet("Exp_DataSources_Menu","GridMenu",document.body);this.showMenuEl(a,b,d,!0,null,5),$("ConnEditMenuItem").setAttribute("parId",c.id),$("ConnReAuthMenuItem").setAttribute("parId",c.id),$("DelConnMenuItem").setAttribute("parId",c.id),c.getAttribute("isauthreq")!="true"?$("ConnReAuthMenuItem").style.display="none":$("ConnReAuthMenuItem").style.display="",$("DelConnMenuItem").style.display=c.getAttribute("delconn")=="true"?"":"none"},this.showExploreSharePopup=function(a,b){if(ZDBClientUI.isDBOwner){var c=ZDBContentCache.appendAndGet("Exp_Share_Menu","GridMenu",document.body);c.setAttribute("dbId",ZDBClientUI.dbId),this.showMenuEl(a,b,c,!0);var d=$("ZDBExpShareToSupportMenuItem"),e=$("ZDBExpRemoveShareToSupportMenuItem");d&&e&&(ZDBClientUI.isDBSharedToSupport==1?(d.style.display="none",e.style.display=""):(d.style.display="",e.style.display="none"))}else{var f=ZDBContentCache.appendAndGet("Explorer_Grp_User_Shr_Menu","GridMenu",document.body);f.setAttribute("dbId",ZDBClientUI.dbId),this.showMenuEl(a,b,f,!0)}}};ZDBMenu.setToolbarStatus=function(a){if(a.isForImport||a.subtype&&a.subtype=="EnterData")return;var b=a.type,c=a.selectedCols,d=c.length;if(b=="Table"){var e=ZDBClientUI.sheetDataTypeEl;if(e){e.setAttribute("disabled",!0);var f="",g;c.length==1?(g=c[0],f=g.type):a.lastCellFocus&&(g=a.lastCellFocus.colObj,f=g.type);var h=getDataIndex(e,"defaultvaltype",f);h>-1&&(c.length==1&&ZDBClientUI.isDBOwner&&(e.removeAttribute("disabled"),e.origVal=e[h].value,e.colName=g.displayName,e.tableName=a.displayName,e.header=g),e[h].selected=!0)}}if(d==0){var i=ZDBDataGrid.getCurColHead(a);if(!i){ZDBMenu.setDefaultToolbarStatus();return}}},ZDBMenu.setDefaultToolbarStatus=function(){},ZDBMenu.saveViewAs=function(a,b){var c=ZDBClientUI.selectedTab,d=c.view,e=d.type;if(c==null||ZDBUtil.isNewView(d)||ZDBUtil.isViewModified(d)){if(e=="Report"||e=="Table"){ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.zdbalertmsg.js.saveAsErr"));return}if(ZDBUtil.isNewView(d)){ZDBMenu.save(a,b);return}}var f=e=="Report"||e=="Table"||e=="Dashboard"?!0:ZDBAnalysisEditViewMode.validateView(d);if(f==0)return;e=="AnalysisView"||e=="Pivot"||e=="SummaryView"||e=="Dashboard"||e=="Table"?ZDBCreateViewAPI.saveAsNewView(d):d.saveAsNewView()},ZDBMenu.addShadow=function(a){var a=a.iframe!=null&&a.iframe.tagName.toLowerCase()=="iframe"?a.iframe:a;if(a.shadowAdded)return;var b=a.className;a.className=b?b+" ZRSShadow":"ZRSShadow",a.shadowAdded=!0;return},ZDBMenu.updateToolbar=function(a){var b=a.type,c=ZDBClientUI.$$("ZDBViewEl"),d=ZDBClientUI.$$("ZDBSheetActions");d.style.display="",jQuery(d).find("li a").bind("mousemove",function(a){ZDBToolTip.showTip(a)}),window.ZDBDataGrid&&a instanceof ZDBDataGrid&&(d.gridObj=a),d.view=a,c.view=a;var e=d.childNodes,f=null;for(var g=0,h=e.length;g<h;g++){if(e[g].getAttribute(b+"Obj")!="true"||(ZDBClientUI.standAlone||ZDBClientUI.notLoggedIn||ZDBGlobal.integrated)&&e[g].getAttribute("notLoggedInOrStandAlone")=="false"){e[g].style.display="none";continue}e[g].style.display=ZDBUtil.visibleTrStyle,f=e[g]}a instanceof DummyView?a instanceof DummyView&&f&&(f.style.display="none"):f&&(f.style.display="",a.toolbar=f,ZDBUtil.setNamedChildEls(f,a.toolbar),this.enableDisableMenuItems(a,jQuery(f).find("li a"),!0),ZDBMenu.updateViewTitleNDesc(a),this.groupToolbarItems(f)),!(a instanceof DummyView)&&f&&(a.modified?ZDBUtil.highlightSave(a):ZDBUtil.removeHighlight(a))},ZDBMenu.showHideToolbarOptions=function(a,b){var c=b?"":"none";jQuery(a).find("li a:not([default])").css("display",c)},ZDBMenu.updateViewTitleNDesc=function(a){if(a.toolbar.viewTitleEl){a.chartTitleEl=a.toolbar.viewTitleEl,a.chartDescEl=a.toolbar.viewDescEl,a.vertLineEl=a.toolbar.vertLineEl;var b=ZDBEscapeUtil.encodeForHtml(a.description==null||a.description==""||a.description=="null"?"":a.description);a.chartDescEl.innerHTML=b,a.vertLineEl&&(a.toolbar.vertLineEl.style.height=b==""?"25px":"36px"),a.chartTitleEl.innerHTML=ZDBEscapeUtil.encodeForHtml(a.title==null||a.title==""?a.displayName:a.title),ZDBMenu.resizeTitleNDesc(a.toolbar)}},ZDBMenu.resizeTitleNDesc=function(a){if(a){var b=jQuery(a.titleBar),c=jQuery(a.viewTitleEl),d=jQuery(a.viewDescEl);c.css("width",""),d.css("width",""),b.css("width","");var e=b.prev(),f=b.next(),g=e.is(":visible")?e.width():0,h=f.is(":visible")?f.width():0,i=ZDBClientUI.layoutMode=="max"||ZDBNavigation.hiddenState||ZDBClientUI.standAlone||ZDBGlobal.integrated?0:250,j=jQuery(document).width()-i,k=j-(g+h+35);k=k<100?100:k;var l=c.next().width()+40;c.width()+l>k&&c.css("width",k-l),b.css("width",k),d.css("max-width",k)}},ZDBMenu.groupToolbarItems=function(a){var b=jQuery(a).find('div[grpdiv="true"]');b.find("li a.newGrpTextBtn:visible:first").addClass("first"),b.find("li a.newGrpTextBtn:visible:last").addClass("last")},ZDBMenu.enableDisableMenuItems=function(a,b,c){var d=ZDBClientUI.readOnlyMode;if(d){jQuery(b).hide();return}var e=ZDBClientUI.isDBOwner,f=ZDBClientUI.isDBOwnerAndNotDBAdmin,g=ZDBClientUI.isGroupMember,h=a.permissions;if(!h)return;var i=h.read,j=h.exportPerm,k=h.vud,l=h.add,m=h.modify,n=h.deletePerm,o=h.deleteAll,p=h.appendImport,q=h.updateImport,r=h.truncateImport,s=h.deleteupdateadd,t=h.share==1||(h.grpMember==1||h.dbOwner==1)&&h.designModify==1,u=h.designModify,v=h.createChildReports,w=c?a.enableToolItems:null,x=a.permissions.grpMember,y=a.enterData,z=a.isExportCSV!=null?a.isExportCSV:!0,A=a.isERDGEnable,B=a.editMode?"edit":"view",C=$("ZDBExportButton");C.setAttribute("dontwrap","true");var D=a.isSystemTable?a.isSystemTable:!1,E=a.objId!=null&&a.objId>-1,F=a.haveAllInvolvedTablesReadPermission&&a.haveAllInvolvedTablesReadPermission=="false";for(var G=0,H=b.length;G<H;G++){var I=b[G];I.getAttribute&&I.getAttribute("divider")&&(I.style.display="",I.setAttribute("hided",""),I.setAttribute("donthide",""))}var J=!1;for(var G=0,H=b.length;G<H;G++){var I=b[G];if(!I.getAttribute||I.getAttribute("visualtd"))continue;I.getAttribute&&I.getAttribute("divider")&&J==0&&(firstDivider=I,J=!0);if(I.getAttribute&&I.getAttribute("divider")&&I.getAttribute("hided")=="true")continue;var K="SearchBoxEl";if(I.getAttribute("elname")==K){var L=I.getElementsByTagName("INPUT")[0];a.directFilterStr?(L.setAttribute("tipShown","false"),L.value=a.directFilterStr,jQuery(L).css("color","black"),jQuery(L).attr("searchempty","true").siblings("#ZDBSearchButton").removeClass("ZRSSearchIcon").addClass("ZRSSearchClearIcon")):(L.setAttribute("tipShown","true"),L.value=ZDBI18NMap.g("zrpt.common.js.search"),jQuery(L).css("color","grey"),jQuery(L).siblings("#ZDBSearchButton").removeClass("ZRSSearchClearIcon").addClass("ZRSSearchIcon"))}var M=I.getAttribute("isDBOwnerReq"),N=I.getAttribute("isDBOwnerAndNotDBAdminReq"),O=I.getAttribute("isGroupMemberReq"),P=I.getAttribute("isLoginReq"),Q=I.getAttribute("zdbModPermReq")=="true",R=!ZDBClientUI.notLoggedIn,S=I.getAttribute("disableOnNew")=="true",T=I.getAttribute("DELETEORDELETEALLNEEDED")=="true",U=I.getAttribute("isReadPermReq"),V=I.getAttribute("isExportPermReq"),W=I.getAttribute("isVUDPermReq"),X=I.getAttribute("isWritePermReq"),Y=I.getAttribute("isAddPermReq"),Z=I.getAttribute("isDeletePermReq"),_=I.getAttribute("isDeleteAllPermReq"),ba=I.getAttribute("isImportPermReq"),bb=I.getAttribute("isSaveAllowed"),bc=I.getAttribute("isGroupPermNeeded"),bd=I.getAttribute("isCreateReportPermReq"),be=I.getAttribute("isSharePermReq"),bf=I.getAttribute("isExportCSVPermReq"),bg=I.getAttribute("isSystemTable")?I.getAttribute("isSystemTable"):!1,bh=I.getAttribute("isAddModifyPermReq"),bi=I.getAttribute("enableForIOS"),bj=I.getAttribute("isERDGEnable"),bk=I.getAttribute("modeType"),bl=I.getAttribute("isSFDB")=="true",bm=(M==null||e)&&(O==null||g||e)&&(N==null||f)&&(!Q||u==1)&&(P==null||R)&&(E||!S)&&(!bd||v)&&(!U||i==1)&&(!V||j==1)&&(!W||k==1)&&(!X||m==1)&&(!Y||l==1)&&(!Z||n==1)&&(!_||o==1)&&(!T||n==1||o==1)&&(!ba||p==1||r==1||q==1||s==1)&&(!be||t==1)&&(!bb||m==1||l==1||n==1||o==1||y)&&(!bh||m==1||l==1)&&(!bc||x||e)&&(!w||I.getAttribute("tname")==null||ZDBUtil.indexOf(w,I.getAttribute("tname"))!=-1)&&(!bk||bk==B)&&(!bl||bl==ZDBGlobal.ISSFDB)&&(!bf||z)&&(!bg||!D)&&(!bj||A);bm=ZDBGlobal.IS_MOBILE?bi:bm;var bn=!u&&v&&!F,bo=I.getAttribute("CUSATTR");bo!=null&&(bo=="SAVEAS"?I.style.display=bn?ZDBUtil.visibleTdStyle:"none":bo=="SAVE"?I.style.display=bn?"none":ZDBUtil.visibleTdStyle:bo=="OWNERSHIP"&&(I.style.display=u&&e?"none":ZDBUtil.visibleTdStyle)),I.setAttribute("enabled",bm?"true":"false");var bp=I.getAttribute("hideOnDisable");if(bp!=null)I.style.display=bm?"":"none";else{!E&&S?(ZDBMenu.editCSSClass(I,"notpermitted",!0),ZDBMenu.editCSSClass(I,"disabledonnotsaved",bm)):(ZDBMenu.editCSSClass(I,"disabledonnotsaved",bm),ZDBMenu.editCSSClass(I,"notpermitted",bm));if(I.getAttribute("disableChild")!=null){var L=I.getElementsByTagName("INPUT")[0];L.disabled=!bm}}}},ZDBMenu.warnIfNotLoggedIn=function(){return ZDBClientUI.notLoggedIn&&ZDBAlertAPI.showErrorMsg(ZDBI18NMap.f("zrpt.common.zdbalertmsg.js.notLoggedInErr",ZDBGlobal.PRODUCTNAME)),ZDBClientUI.notLoggedIn},ZDBMenu.selectTab=function(a){var b=DOMUtils.getParentWithAttrValue(a,"elname","feedBackDemoRequestFormHolder"),c=DOMUtils.getFirstMatchingChild(b,"*","selected","true"),d=$("ZDBInsFeed_Success"),e=$("ZDBInsFeed_Failure"),f=a.getAttribute("focusEl"),g=$(f);if(a==c){ZDBUtil.setFocus(g,!0);return}d.style.display="none",e.style.display="none",jQuery(c).removeClass("greenBtn"),jQuery(a).addClass("greenBtn"),c.removeAttribute("selected"),a.setAttribute("selected","true");var h=c.getAttribute("frmName"),i=a.getAttribute("frmName"),j=DOMUtils.getFirstMatchingChild(b,"*","name",i),k=DOMUtils.getFirstMatchingChild(b,"*","name",h);j.style.display="block",k.style.display="none",ZDBUtil.setFocus(g,!0)},ZDBMenu.addIframe=function(a,b){if(a.iframe!=null)return;var c=ZDBUtil.getCachedIframe();c.className="",c.shadowAdded=null,a.style.zIndex!=null&&(c.style.zIndex=a.style.zIndex?a.style.zIndex-1:0),a.iframe=c,ZDBMenu.resizeIframe(a);var d=jQuery(a).position().left;d=d?parseInt(d):ZDBUtil.getObjLeft(a,!0,b);var e=jQuery(a).position().top;e=e?parseInt(e):ZDBUtil.getObjTop(a,!0,b),c.style.left=jQuery.isNumeric(d)?d+"px":"auto",c.style.top=jQuery.isNumeric(e)?e+"px":"auto";var f=b==null?document.body:b;f.appendChild(c)},ZDBMenu.resizeIframe=function(a){if(a.iframe!=null){var b=a.iframe.style.display!=null?a.iframe.style.display:"";a.iframe.style.width="",a.iframe.style.height="",a.iframe.style.visibility="hidden",a.iframe.style.display="";var c=a.offsetHeight,d=a.offsetWidth;a.iframe.style.visibility="visible",a.iframe.style.display=b,d>=4&&c>=4&&(a.iframe.style.width=d+"px",a.iframe.style.height=c+"px")}},ZDBMenu.resizeIframeNSetPosition=function(a){ZDBMenu.resizeIframe(a),a.iframe.style.left=ZDBUtil.getObjLeft(a,!0),a.iframe.style.top=ZDBUtil.getObjTop(a,!0)},ZDBMenu.removeIframe=function(a){a.iframe!=null&&(ZDBUtil.returnIframeToCache(a.iframe),a.iframe=null)},ZDBMenu.editCSSClass=function(a,b,c){if(!a)return;c?(DOMUtils.removeCSSClass([a],b),a.onclick==null&&a.onclickorig!=null&&(a.onclick=a.onclickorig)):(DOMUtils.addCSSClass([a],b),a.onclick!=null&&(a.onclickorig=a.onclick),a.onclick=null)},ZDBMenu.editTitleInline=function(a,b){ZDBTabHandler.editTitleNDesc(a,b,"titleEdit")},ZDBMenu.editDescInline=function(a,b){ZDBTabHandler.editTitleNDesc(a,b,"descEdit")},ZDBMenu.editTitleForChart=function(a,b){ZDBTabHandler.editTitleNDesc(a,b,"titleEditChart")},ZDBMenu.editDescForChart=function(a,b){ZDBTabHandler.editTitleNDesc(a,b,"descEditChart")};var ZRSMenu=new function(){this.zIndex=21e3,this.visibleMenu=new Array,jQuery(document).bind("keydown",function(a){ZRSMenu.keyHandling(a)}),jQuery(document).bind("click",function(a){ZRSMenu.closeAllMenu()}),this.showMenu=function(a,b,c,d,e){a.button!=2&&a.stopPropagation&&a.stopPropagation();var f=jQuery(c);f[0].srcEl=b;var g=jQuery(b);if(f.is(":visible")&&b&&c.srcEl==b){d!=3&&ZRSMenu.closeAllMenu(b);return}g.attr("submenu")?ZRSMenu.closeAllSubMenuOfCurEl(b):ZRSMenu.closeAllMenu(b),f.show(),ZRSMenu.zIndex++,c.closeFunc=e,this.visibleMenu.push(f),f[0].srcEl=b;var g=jQuery(b);!g.attr("submenu")&&d!=5&&!g.attr("menuparent")&&g.addClass("ZRSDropDown"),f[0].positioned||ZRSMenu.position(f,g,d,a);var h=f.find("li:not('.nonMenuItem')").has("a:visible:not('.ZRSMenuSeparator')").has("a[OPERATION!='DUMMY']");f[0].menuItemList=h,h.mouseover(function(a){var b=jQuery(this);if(b.hasClass("ZRSMenuHover"))return;var c=b.parents("ul").find("li.ZRSMenuHover"),d=c.find("a").attr("submenu");c&&d&&ZRSMenu.closeAllSubMenuOfCurEl(c[0]),c.removeClass("ZRSMenuHover");var e=b.addClass("ZRSMenuHover").find("a"),f=e.attr("submenu"),g=e.attr("specialCase");if(f&&!g)e.click();else if(f&&g)if(e.attr("isRange")){var h=window.ZDBAnalysisFuncMenu.showRangeSubMenuIfNeeded;h.apply(null,[a])}else{var h=window.ZDBAnalysisFuncMenu.showSubMenuIfNeeded,i=e.attr("isDate");i=i==="true"?i=!0:i=!1;var j=e.attr("isSubMenu");j=j==="true"?j=!0:j=!1;var k=[a,i,j];h.apply(null,k)}else ZRSMenu.closeMenu(b)}),h.mouseout(function(){var a=jQuery(this);if(a.find("a").attr("submenu"))return;a.removeClass("ZRSMenuHover")})},this.closeAllSubMenuOfCurEl=function(a){var b=ZRSMenu.visibleMenu.slice();for(var c=b.length-1;c>-1;c--){var d=b[c];if(d.find(a).length>0)break;ZRSMenu.closeLastMenu(d)}},this.keyHandling=function(a){var b=a,c=ZRSMenu.visibleMenu.last();if(!c.length)return;var d=a.keyCode?a.keyCode:a.which,e=c[0].menuItemList,f=e.length,g=jQuery(".ZRSMenuHover");if(d===27)ZRSMenu.closeMenu();else if(d===13)g.find("a").click();else if(d===38){var h=g.removeClass("ZRSMenuHover"),i=e.index(h),j=i<=0?e[f-1]:e[i-1];jQuery(j).addClass("ZRSMenuHover")}else if(d===40){var h=g.removeClass("ZRSMenuHover"),i=e.index(h),k=i<0||i==f-1?e[0]:e[i+1];jQuery(k).addClass("ZRSMenuHover")}else if(d===37){var l=ZRSMenu.visibleMenu;l.length>1&&ZRSMenu.closeMenu(null,!0)}else{if(d!==39)return;var m=g.find("a"),n=m.attr("submenu"),o=m.attr("specialCase");if(n&&!o)m.click();else if(n&&o)if(m.attr("isRange")){var p=window.ZDBAnalysisFuncMenu.showRangeSubMenuIfNeeded;p.apply(null,[b])}else{var p=window.ZDBAnalysisFuncMenu.showSubMenuIfNeeded,q=m.attr("isDate");q=q==="true"?q=!0:q=!1;var r=m.attr("isSubMenu");r=r==="true"?r=!0:r=!1;var s=[b,q,r];p.apply(null,s)}}},this.closeMenu=function(a,b){var c=ZRSMenu.visibleMenu.last();if(c.length>0){if(c.find(a).length>0)return;ZRSMenu.closeLastMenu(c,b)}},this.closeAllMenu=function(a){var b=ZRSMenu.visibleMenu.slice();for(var c=0;c<b.length;c++){var d=b[c];if(d.find(a).length>0)continue;ZRSMenu.closeLastMenu(d)}},this.closeLastMenu=function(a,b){if(a.length<=0)return;a[0].closeFunc&&a[0].closeFunc();var c=jQuery(a[0].srcEl);c.attr("submenu")&&!b?c.parent().removeClass("ZRSMenuHover"):c.removeClass("ZRSDropDown"),a.hide(),ZRSMenu.visibleMenu.pop(),ZRSMenu.zIndex--},this.popupPosition=function(a,b){var c=b.clientX,d=b.clientY,e={left:"auto",right:"auto",top:"auto",bottom:"auto"},f=window.innerWidth,g=window.innerHeight,h=f-c,i=g-d,j=a.width(),k=a.height();return j>h?e.left=f-j-20:e.left=c-3,k>i?e.top=g-k-20:e.top=d-3,e},this.position=function(a,b,c,d){var e,f,g="auto",h="auto";if(c===1)e=ZRSMenu.popupPosition(a,d),a.css({left:e.left,right:e.right,top:e.top,bottom:e.bottom});else if(c===2)e=b.offset(),f=e.top+b.outerHeight()-1,h=jQuery(window).width()-e.left-b.outerWidth()+1,a.css({left:g,right:parseInt(h),top:f});else if(c===3){e=b.parent().offset(),f=e.top;var i=jQuery(window).width(),j=b.parent().outerWidth();h=i-e.left-j-a.outerWidth();var k=jQuery(window).height(),l=a.outerHeight();h<0&&(h=i-e.left),f+l>=k?a.css({left:g,right:h,top:"auto",bottom:8,"z-index":ZRSMenu.zIndex}):a.css({left:g,right:h,top:f,bottom:"auto","z-index":ZRSMenu.zIndex})}else if(c==4){var m=b.attr("relid"),n=jQuery("#"+m);e=n.offset(),f=e.top+b.outerHeight()-2,a.css({left:e.left,right:h,top:f})}else if(c==5)e=b.offset(),f=e.top+b.outerHeight(),g=e.left,a.css({left:g,right:h,top:f});else{e=b.offset(),f=e.top+b.outerHeight()-1;var o=a.outerWidth(),i=jQuery(window).width();g=e.left,i<g+o&&(h=i-g-b.outerWidth(),g="auto"),a.css({left:g,right:h,top:f})}},this.showHideToolBarEls=function(a){a=jQuery(a),a.closest("li").siblings().toggle();var b=a.find("span:first-child");b.toggleClass("ZR_LeftNavArrow").toggleClass("ZR_RightNavArrow");var c=b.hasClass("ZR_LeftNavArrow")?"zrpt.toolbar.embed.js.showtoolbar.tip.title":"zrpt.toolbar.embed.js.hidetoolbar.tip.title";a.attr("tip",ZDBI18NMap.g(c));var d=ZDBClientUI.getViewObj(a[0],"view");d&&d.toolbar&&ZDBMenu.resizeTitleNDesc(d.toolbar)},this.showHeaderMenu=function(a,b,c){var d=jQuery("#"+c);if(d.is(":visible")){ZRSMenu.closeAllMenu(a);return}ZDBMenu.showMenu(a,b,d[0]);var e=jQuery("#ZDBMainHeader").position().top,f=parseInt(d.css("right"));f=f<10?f:f-10,d.css({top:e+40,right:f})}},ZDBTableGrid=new function(){this.createGrid=function(a,b,c,d,e,f,g,h,i,j){var k=new ZDBDataGrid;return ZDBClientViewAPI.init(k,a,b,null,d,e,f,g,null),k.tableName=c,k.showDatatype=!0,k.showSortIcon=!0,k.qryTblMaxRows=i,e=="QueryTable"&&(k.setAsReadOnly(),!ZDBGlobal.qryTblDataLimitShown[a]&&h&&(ZDBGlobal.qryTblDataLimitShown[a]=!1),j||ZDBMsgBox.showInfo("This query table is deactivated.")),k},this.getTableInstance=function(a){for(var b in ZDBDataGrid.INSTANCES)if(ZDBDataGrid.INSTANCES[b]!=null&&ZDBDataGrid.INSTANCES[b].objId==a)return ZDBDataGrid.INSTANCES[b]}};ZDBTableGrid.refreshDataForView=function(a,b){var c="/ZDBTableDataAction.ma?ZDBACTION=DATAVIEW&CONFIGASXML=true&&REFRESHDATAONLY=true&CLEARCACHEANDROWS=true&GRIDID="+a.ID+"&"+a.getGridDetailsAsParams();c+=a.getDrillDet();var d=a.getConfigAsXML();AjaxAPI.sendRequest({URL:c,POSTBODY:d,REQUESTHEADERS:{"Content-type":"text/xml"},VIEWCTX:a.viewCtx,GRIDOBJREF:a,VIEW:a,ONSUCCESSFUNC:ZDBTableGrid.placeDataSheet,OPSTATUSID:a.viewCtx.getLoadIndicator(b)})},ZDBTableGrid.sendRequestForDataView=function(a,b,c,d){if(!ZDBLazyLoadUtil.loadJsAlone("ZDBGridList","APPENDTODOC",ZDBTableGrid.sendRequestForDataView,[a,b,c,d]))return;if(c.dashView){var e="<DBSVRequest csrftoken='"+ZDBEscapeUtil.encodeForXML(getCookie("CSRF_TOKEN"))+"'>\n",f=c.dashView.permissions.designModify==1&&ZDBUtil.isViewModified(c.dashView),g=ZDBDashboardUF.getDashDynFltrConfig(c.dashView),h=new ZDBStrBuf;h.a("<dcdet").attr("cinfo",f).a(">\n"),h.a(g),h.a("</dcdet>"),e+=h.toString(),e+="</DBSVRequest>",b+="&CONFIGASXML=true",b+="&OBJTYPE="+(this.isAnalysis?"AnalysisGrid":this.type),a+=b,AjaxAPI.sendRequest({URL:a,POSTBODY:e,REQUESTHEADERS:{"Content-type":"text/xml"},ONSUCCESSFUNC:ZDBTableGrid.placeDataSheet,VIEWCTX:c,OPSTATUSID:c.getLoadIndicator(d)})}else AjaxAPI.sendRequest({URL:a,PARAMETERS:b,ONSUCCESSFUNC:ZDBTableGrid.placeDataSheet,VIEWCTX:c,OPSTATUSID:c.getLoadIndicator(d)})},ZDBTableGrid.placeDataSheet=function(a,b){var c=b.VIEWCTX;if(c.dashView){var d=c.dashView,e=function(){ZDBTableGrid.placeDataSheet(a,b)};if(!ZDBTabSwitchHandler.isRelevendTab2Exec(d,e))return;d.updateRespStatus(),ZDBDashboard.viewLoaded=!0}if(!c.checkIfRespValid(a,b)){var f=b.OPSTATUSID;f&&(f.style.display="none");return}var g=b.ISMODIFIED,h=b.GRIDOBJREF;h=ZDBDataGrid.parseGridResponse(h,a.responseText),c.handle(h),h.fromVW&&ZDBMsgBox.showInfo(ZDBI18NMap.g("zrpt.common.showinfo.js.FromVW")),h.errmsg!="null"&&ZDBMsgBox.showInfo(h.errmsg),ZDBUtil.isNewView(h)&&h.setModified(),h.objId>0&&h.type=="QueryTable"&&ZDBGlobal.qryTblDataLimitShown[h.objId]==0&&(ZDBMsgBox.showInfo(ZDBI18NMap.f("zrpt.common.querytable.showinfo.js.maxRowsExceededInfo",h.qryTblMaxRows)),ZDBGlobal.qryTblDataLimitShown[h.objId]=!0),g==1&&h.setModified()},ZDBTableGrid.fetchView=function(a,b){if(!ZDBLazyLoadUtil.loadJsAlone(["ZDBGridList"],"APPENDTODOC",ZDBTableGrid.fetchView,[a,b]))return;if(!ZDBLazyLoadUtil.loadCssOnly(["CSSLIST_GRIDSTYLES",ZDBGlobal.THEMEDIR+"/styles/ZDBAnalysis_NEW.css"],"APPENDTODOC",ZDBTableGrid.fetchView,[a,b]))return;if(ZDBClientUI.sampleViewStatus||ZDBClientUI.sampleView)if(!ZDBLazyLoadUtil.loadJsAlone("zdbjs/autogen/ZDBSampleViews.js",this,ZDBTableGrid.fetchView,[a,b]))return;var c="&OBJID="+a+"&ZDBACTION=DATAVIEW"+b.getAdditionalParams();ZDBClientUI.directFilterString&&(c+="&"+directFilterString),ZDBTableGrid.sendRequestForDataView("/ZDBTableDataAction.ma?",c,b),(ZDBClientUI.sampleViewStatus||ZDBClientUI.sampleView)&&setTimeout(function(){ZDBAlertAPI.showMsg(ZDBI18NMap.f("zrpt.common.zdbalertmsg.js.autoGenDlgContent",ZDBGlobal.PRODUCTNAME),"ZDBYESNO",{ONCLICK:ZDBSampleViews.createSampleViews,OBJID:a},ZDBI18NMap.g("zrpt.common.zdbalertmsg.js.autoGenDlgTtl"),null,"ZDBAutoReports")},1e3)},ZDBTableGrid.updateTableViewEls=function(a,b,c){var d=b.type;d==null&&(d=a.type);var e=DOMUtils.getParentWithAttr(a.viewComp,"isdashboarddiv");if(e!==null&&(!a.showNavVisibility||d==="Table"||d==="Report"||d==="QueryTable")){var f=e.dlgTitle,g=e.dlgDesc;f.innerHTML=ZDBEscapeUtil.encodeForHtml(a.title!=null&&a.title!=""?a.title:a.displayName);var h=a.description==null?"":a.description;g.innerHTML=ZDBEscapeUtil.encodeForHtml(h);if(h==null||h=="")g.style.display="none";c.dashView&&c.dashView.editMode&&e.modalDiv&&(e.modalDiv.style.height=e.offsetHeight+"px",e.det=null,e.oldDet=null,ZDBEditModeSelect.editOptsEl!=null&&ZDBEditModeSelect.reposMenu(e,ZDBDashEdit.getCurEditState()))}},ZDBTableGrid.updateNavigComp=function(a,b,c){var d=b.type;d==null&&(d=a.type);var e=c.getNavigPlHolder(b),f=e.el;if(f==null)return;ZDBUtil.removeNonElements(f),a.navigComp&&!ZDBGlobal.IS_MOBILE&&(f.childNodes.length>0?f.replaceChild(a.navigComp,f.childNodes[0]):f.appendChild(a.navigComp),a.navigComp.style.display=""),f.style.display="";if(a.showNavVisibility){var g=a.gDataWidth,h=a.gWidth,i=a.gHeight,j=a.totalRecords+a.overAllSumCount,k=j*22+a.tcHeight;k<i&&j>0?a.showHideNavToolBar=ZDBGlobal.IS_MOBILE?!1:ZDBAnalysisGrid.showNavComp(e,a,!1):a.showHideNavToolBar=ZDBGlobal.IS_MOBILE?!0:ZDBAnalysisGrid.showNavComp(e,a,!0),b.resize();var l=DOMUtils.getParentWithAttr(a.viewComp,"isdashboarddiv");l!=null&&!ZDBGlobal.IS_MOBILE&&(f.style.right=h>g?h-g-ZDBGlobal.scrollThick+"px":"0px",l.showNavVisibility=a.showNavVisibility),c.standAlone&&l==null&&!ZDBGlobal.IS_MOBILE&&c.configMap.REMTOOLBAR=="true"&&(f.style.paddingRight=h>g?h-g-ZDBGlobal.scrollThick+"px":"0px")}},ZDBClientUI.typeDefns.Table={fetchView:ZDBTableGrid.fetchView,dummyView:"dummyGrid"};var ZDBValidator=new function(){this.monthList=["JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],this.monthLenth=12,this.weekList=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],this.weekLength=7,this.isPositive1=function(a,b){return ZDBValidator.isPositive(a,b)&&(ZDBValidator.isBlank(a)||parseInt(a)>0)},this.isYear=function(a,b){if(b&&ZDBValidator.isBlank(a))return!0;var c=parseInt(a,10);return isNaN(c)?!1:c>999&&c<9999},this.isRange=function(a,b,c){try{if(a>=b&&a<=c)return!0}catch(d){}return!1},this.isQuarter=function(a){return/^[Qq]?[1-4]?([ ,]+[1-9]([0-9]){3}){0,1}$/.test(a)},this.isMonth=function(a,b){if(b&&ZDBValidator.isBlank(a))return!0;try{var c=parseInt(a);if(c>0&&c<13)return!0;a=(""+a).toUpperCase();var d=ZDBUtil.indexOf(ZDBValidator.monthList,a,3);if(d>=0)return!0}catch(e){}return!1},this.isDay=function(a,b){if(b&&ZDBValidator.isBlank(a))return!0;try{var c=parseInt(c);return c>0&&c<31}catch(d){}return!1},this.isWeekDay=function(a,b){if(b&&ZDBValidator.isBlank(a))return!0;a=(""+a).toUpperCase();try{var c=ZDBUtil.indexOf(ZDBValidator.weekList,a,3);if(c>=0)return!0}catch(d){}return!1},this.isBlank=function(a){return a!==null&&a!==undefined&&a===""},this.isArgCountOK=function(a,b,c,d){c||(c=",");try{if(a.split(c).length==b)return!0}catch(e){}return!1},this.isPositive=function(a,b,c){if(ZDBValidator.isNumber(a,b,c))if(a===""||parseInt(a)>=0)return!0;return!1},this.isNumber=function(a,b,c){return c||(a=ZDBConvert.trimData(a)),a===""?b:/^[+-]?[0-9]+$/.test(a)},this.isValidImgWidth=function(a,b,c){if(ZDBValidator.isNumber(a,b,c))if(a===""||parseInt(a)>=250&&parseInt(a)<=2e3)return!0;return!1},this.isValidImgHeight=function(a,b,c){if(ZDBValidator.isNumber(a,b,c))if(a===""||parseInt(a)>=200&&parseInt(a)<=2e3)return!0;return!1},this.isDecimal=function(a,b,c){return c||(a=ZDBConvert.trimData(a)),a===""?b:/^[+-]?[0-9]*[.]?[0-9]+$/.test(a)},this.isCurrency=function(a,b,c,d){return c||(a=ZDBConvert.trimData(a),a=ZDBUtil.removeChar(a,d)),a===""?b:ZDBValidator.isDecimal(a)},this.isPercent=function(a,b,c){return c||(a=ZDBConvert.trimData(a),a=ZDBUtil.removeChar(a,"%")),a===""?b:ZDBValidator.isDecimal(a)},this.isEmail=function(a,b,c){c||(a=ZDBConvert.trimData(a));if(a==="")return b;var d=a.indexOf("@"),e=a.indexOf("@"),f=a.lastIndexOf("."),g=a.length;return e<1||d<0||f<0||g<5||f-d<1?!1:!0},this.isUrl=function(a,b,c){return c||(a=ZDBConvert.trimData(a)),a===""?b:!0},this.dataValFn=function(a,b){var c=a.getValue("validate"),d=a.colObj;b==null&&(b=d.type);var e=d.displayName,f="";a.rowObj.rid?f=ZDBI18NMap.f("zrpt.common.table.showinfo.js.invalidDataErr1",ZDBEscapeUtil.encodeForHtml(e),a.rowObj.rid):f=ZDBI18NMap.f("zrpt.common.table.showinfo.js.invalidDataErr",ZDBEscapeUtil.encodeForHtml
(e));switch(b){case"EMAIL":if(!ZDBValidator.isEmail(c,!0,!1))return a.setValidatedInfo(f+ZDBI18NMap.g("zrpt.common.table.showinfo.js.invalidEmail"),"CELL"),!1;break;case"URL":if(!ZDBValidator.isUrl(c,!0,!1))return a.setValidatedInfo(f+ZDBI18NMap.g("zrpt.common.table.showinfo.js.invalidURL"),"CELL"),!1;break;case"NUMBER":if(!ZDBValidator.isNumber(c,!0,!1))return a.setValidatedInfo(f+ZDBI18NMap.g("zrpt.common.table.showinfo.js.invalidNumber"),"CELL"),!1;break;case"POSITIVE_NUMBER":if(!ZDBValidator.isPositive(c,!0,!1))return a.setValidatedInfo(f+ZDBI18NMap.g("zrpt.common.table.showinfo.js.invalidPosNumber"),"CELL"),!1;break;case"DECIMAL_NUMBER":if(!ZDBValidator.isDecimal(c,!0,!1))return a.setValidatedInfo(f+ZDBI18NMap.g("zrpt.common.table.showinfo.js.invalidDeciNumber"),"CELL"),!1;break;case"CURRENCY":var g=d.formatStr?d.formatStr:"$";if(!ZDBValidator.isCurrency(c,!0,!1,g))return a.setValidatedInfo(f+ZDBI18NMap.f("zrpt.common.table.showinfo.js.invalidCurrencyVal",g),"CELL"),!1;break;case"PERCENT":if(!ZDBValidator.isPercent(c,!0,!1))return a.setValidatedInfo(f+ZDBI18NMap.g("zrpt.common.table.showinfo.js.invalidPercentVal"),"CELL"),!1;break;case"DATE":var h=d.dateFormat;if(h&&!ZDBUtil.containsAnyValue(h,["Z","MILLI"])){h=ZDBUtil.calendarDateFormat(h),typeof c=="object"&&(c=c.print(h));var i=ZDBUtil.removeSpace(c.toLowerCase()),j=Date.parseDate(c,h).print(h).toLowerCase();j=ZDBUtil.removeSpace(j);if(i!=j&&!ZDBValidator.isDate(c,!0,!1))return a.setValidatedInfo(f+ZDBI18NMap.g("zrpt.common.table.showinfo.js.invalidDate"),"CELL"),!1}else if(!ZDBValidator.isDate(c,!0,!1))return a.setValidatedInfo(f+ZDBI18NMap.g("zrpt.common.table.showinfo.js.invalidDate"),"CELL"),!1}return a.clearError(!0,!1,!1),!0},this.resetDateSeparator=function(a){try{return a.replace(/[.\-]/g,"/")}catch(b){return a}},this.getYMDConvertedDate=function(a){try{var b=ZDBValidator.resetDateSeparator(a).split("/"),c=parseInt(b[0],10),d=parseInt(b[1],10),e=parseInt(b[2],10),f=month=day=0;c>31?f=c:c>12?day=c:c>0?month=c:0,d>31?f=d:d>12?day=d:d>0?month=d:0,e>31?f=e:e>12?day=e:e>0?month=e:0;if(day&&month&&f){var g=b[0]+"/"+b[1]+"/"+e,h=ZDBUtil.getMonthName(month,!0,!0)+" "+day+", "+f+a.substring(g.length);return h}}catch(i){}return a},this.isDateFieldFound=function(a,b){var c=new Date(Date.parse(a));switch(b.toLowerCase()){case"year":return a.indexOf(c.getFullYear())>=0;case"month":var d=c.getMonth(),e=d+1,f=ZDBUtil.getMonthName(d,!1,!0).toUpperCase();return a.indexOf(e)>=0||a.toUpperCase().indexOf(f)>=0;case"date":return a.indexOf(c.getDate())>=0;case"hour":return a.indexOf(c.getHours())>=0;case"minute":return a.indexOf(c.getMinutes())>=0;case"second":return a.indexOf(c.getSeconds())>=0}},this.isValidDateFound=function(a){var b=new Date(Date.parse(a));return ZDBValidator.isDateFieldFound(a,"date")&&ZDBValidator.isDateFieldFound(a,"month")&&ZDBValidator.isDateFieldFound(a,"year")},this.isValidTimeFound=function(a){var b=a.indexOf(":"),c=a.lastIndexOf(":");return b<0?!1:ZDBValidator.isDateFieldFound(a,"hour")&&ZDBValidator.isDateFieldFound(a,"minute")&&(c<0||b==c||ZDBValidator.isDateFieldFound(a,"second"))},this.isTempDate=function(a){var b=Date.parse(a);if(isNaN(b))return!1;var c=parseInt(a.substring(0,3),10);return c<1e3?!1:!0},this.getReplacedValue=function(a){var b="";if(a)for(var c=0;c<a.length;++c){var d=a.charAt(c);if(d=="."||d=="-")d="/";b+=d}return b},this.isDate=function(a){try{if(a==undefined)return!1;if(a=="")return!0;a=a.replace(/[.\-]/g,"/"),a=a.replace(/\/\d{6}/g,""),a=a.replace(/\/\d{3}\b/g,""),a=ZDBValidator.getYMDConvertedDate(a);var b=Date.parse(a);return isNaN(b)?!1:ZDBValidator.isValidDateFound(a)&&(a.indexOf(":")<0||ZDBValidator.isValidTimeFound(a))}catch(c){return!1}},this.isUnique=function(a){var b=a.parGrid.rowData,c=a.cellPos,d=!0,e=ZDBDataGrid.getFirstRowIndex(b,!1);if(e<0)return d;var f=ZDBDataGrid.getLastRowIndex(b,!1);for(var g=e;g<=f;g++){var h=b[g].values[c],i=h.getValue("validate");i=i.toLowerCase().trim();for(var j=e;j<g;j++){var k=b[j].values[c];if(k.getValue("validate").toLowerCase().trim()==i){h.setValidatedInfo(a.displayName+" "+ZDBI18NMap.g("zrpt.common.showinfo.js.duplicateEntryErr"),"COL"),d=!1;break}}j==g&&h.clearError(!1,!0,!1)}return d},this.isUniqueANC=function(a){var b=a.parGrid.rowData,c=a.cellPos,d=!0,e=ZDBDataGrid.getFirstRowIndex(b,!1),f=ZDBDataGrid.getLastRowIndex(b,!1);for(var g=e;g<f;g++){var h=b[g].values[c],i=h.getValue("validate");for(var j=e;j<g;j++){var k=b[j].values[c];if(i==ZDBDesignGridConst.AUTO_NUMBER&&k.getValue("validate")==i){h.setValidatedInfo(ZDBI18NMap.g("zrpt.common.showinfo.js.multiAutoNumColErr"),"COL"),d=!1;break}}j==g&&h.clearError(!1,!0,!1)}return d},this.isLossLess=function(a,b){return a==b||b==ZDBConst.PLAIN||b==ZDBConst.GEO||b==ZDBConst.MULTI_LINE||b==ZDBConst.URL?!0:a!=ZDBConst.NUMBER&&a!=ZDBConst.POSITIVE_NUMBER||b!=ZDBConst.DECIMAL_NUMBER&&b!=ZDBConst.CURRENCY&&b!=ZDBConst.PERCENT&&b!=ZDBConst.AUTO_NUMBER?a==ZDBConst.POSITIVE_NUMBER&&b==ZDBConst.NUMBER?!0:a!=ZDBConst.DECIMAL_NUMBER&&a!=ZDBConst.CURRENCY&&a!=ZDBConst.PERCENT||b!=ZDBConst.DECIMAL_NUMBER&&b!=ZDBConst.CURRENCY&&b!=ZDBConst.PERCENT&&b!=ZDBConst.AUTO_NUMBER?a===ZDBConst.REFCOL&&a===ZDBConst.RELCOL||b!==ZDBConst.REFCOL&&b!==ZDBConst.RELCOL?!1:!0:!0:!0},this.formulaColDataTypeChg=function(a,b){var c=[ZDBConst.PLAIN,ZDBConst.MULTI_LINE,ZDBConst.EMAIL,ZDBConst.URL,ZDBConst.GEO],d=[ZDBConst.NUMBER,ZDBConst.POSITIVE_NUMBER,ZDBConst.DECIMAL_NUMBER,ZDBConst.CURRENCY,ZDBConst.PERCENT];return ZDBUtil.indexOf(c,a)!=-1&&ZDBUtil.indexOf(c,b)!=-1?!0:ZDBUtil.indexOf(d,a)!=-1&&ZDBUtil.indexOf(d,b)!=-1?!0:!1},this.checkValidInput=function(a){return a=a.trim(),!ZDBValidator.isBlank(a)},this.checkLength=function(a,b){return a=a.trim(),a.length!=0&&a.length<=parseInt(b.getAttribute("zdbfieldlength"))?!0:!1},this.checkFieldLength=function(a,b){try{var c=ZDBUtil.getAttribute(b,"ZDBFIELDLENGTH").split(","),d=parseInt(ZDBConvert.trimData(c[0]),10),e=parseInt(ZDBConvert.trimData(c[1]),10);return ZDBValidator.isRange(ZDBConvert.trimData(a).length,d,e)}catch(f){}return!1},this.validateFindAndReplaceVal=function(a,b,c){switch(a){case"PLAIN":case"MULTI_LINE":case"GEO":case"URL":if(!ZDBValidator.isUrl(b,c,!1))return!1;break;case"NUMBER":if(!ZDBValidator.isNumber(b,c,!1))return!1;break;case"POSITIVE_NUMBER":if(!ZDBValidator.isPositive(b,c,!1))return!1;break;case"DECIMAL_NUMBER":case"CURRENCY":case"PERCENT":if(!ZDBValidator.isDecimal(b,c,!1))return!1}return!0},this.isValidYear=function(a,b){return ZDBValidator.tipValue(a,b)?!0:ZDBValidator.isPositive(a,!1)?a>1901&&a<2038:!1},this.isValidMonth=function(a,b){return ZDBValidator.tipValue(a,b)?!0:ZDBValidator.isMonth(a,!1)?!0:!1},this.isValidDay=function(a,b){return ZDBValidator.tipValue(a,b)?!0:ZDBValidator.isPositive(a,!1)?a>0&&a<=31:!1},this.isValidHour=function(a,b){return ZDBValidator.tipValue(a,b)?!0:ZDBValidator.isPositive(a,!1)?a>=0&&a<24:!1},this.isValidMinSec=function(a,b){return ZDBValidator.tipValue(a,b)?!0:ZDBValidator.isPositive(a,!1)?a>=0&&a<60:!1},this.tipValue=function(a,b){return b.getAttribute("tipValue")==a?!0:!1},this.isValidGSheet=function(a,b){var c=ZDBValidator.tipValue(a,b),d=$("ZDBGSHEETID");return c||d.value==""?!1:!0},this.isValidZDOCS=function(a,b){var c=ZDBValidator.tipValue(a,b),d=$("ZDBFILETYPE")?$("ZDBFILETYPE").value:$("ZDBEXFILETYPE").value,e=d==="GSHEET"?$("ZDBGSHEETID"):$("DOCID"),f=new Array;return f.ZDOCS=ZDBI18NMap.f("zrpt.common.external.js.empty",ZDBI18NMap.g("zrpt.common.external.js.zdocs")),f.DROPBOX=ZDBI18NMap.f("zrpt.common.external.js.empty",ZDBI18NMap.g("zrpt.common.external.js.dropbox")),f.BOX=ZDBI18NMap.f("zrpt.common.external.js.empty",ZDBI18NMap.g("zrpt.common.external.js.box")),f.ONEDRIVE=ZDBI18NMap.f("zrpt.common.external.js.empty",ZDBI18NMap.g("zrpt.common.external.js.skydrive")),f.GSHEET=ZDBI18NMap.f("zrpt.common.external.js.empty",ZDBI18NMap.g("zrpt.common.external.js.gdrive")),b.setAttribute("errormsg",f[d]),c||e.value==""?!1:!0},this.isEmailValue=function(a,b,c){if(a=="")return ZDBValidator.isEmail(b,!0,!1);if(c&&ZDBValidator.isBlank(b))return!0;var d=a.indexOf("@"),e=a.indexOf("."),f=b.indexOf("@"),g=b.indexOf(".");return d!=-1&&f==-1||d==-1&&f!=-1?!1:e!=-1&&g==-1||e==-1&&g!=-1?!1:!0},this.isAlphanumeric=function(a){var b=/^[0-9a-zA-Z\s:]+$/;return b.test(a)?!0:!1},this.ValUserFltrDtFormat=function(a,b){var c=a.value.trim(),d=b?"%d %b %Y %H:%M:%S":"%d %b %Y ",e=ZDBUtil.removeSpace(c.toLowerCase()),f=Date.parseDate(c,d).print(d),g=ZDBUtil.removeSpace(f.toLowerCase());return e!=g&&!ZDBValidator.isDate(c,!0,!1)?(showCustomMessage('"'+ZDBI18NMap.g("zrpt.common.analysis.filter.custommsg.js.invalidDate")+'"',a),"false"):f}};ZDBValidator.functionMap={"ZDBValidator.isPositive1":ZDBValidator.isPositive1,"ZDBValidator.isPositive":ZDBValidator.isPositive,"ZDBValidator.isNumber":ZDBValidator.isNumber,"ZDBValidator.isDecimal":ZDBValidator.isDecimal,"ZDBValidator.isQuarter":ZDBValidator.isQuarter,"ZDBValidator.isMonth":ZDBValidator.isMonth,"ZDBValidator.isWeekDay":ZDBValidator.isWeekDay,"ZDBValidator.isDay":ZDBValidator.isDay,"ZDBValidator.isYear":ZDBValidator.isYear};var ZDBConvert=new function(){this.toMonthNumber=function(a,b){var c=(""+a).toUpperCase(),d=ZDBUtil.indexOf(ZDBValidator.monthList,c,3);return d>=0?b?d:d+1:a},this.toWeekNumber=function(a,b,c){c||(c="SUNDAY");var d=ZDBUtil.indexOf(ZDBValidator.weekList,3),e=ZDBUtil.indexOf(ZDBValidator.weekList,3),f=e-d;return f<0&&(f+=7),b||(f+=1),f},this.trimData=function(a){if(!a.trim)return a;try{return a.trim()}catch(b){return a}},this.toPercent=function(a){return ZDBConvert.trimData(ZDBUtil.removeChar(a,"%"))},this.toCurrency=function(a,b){return b!="undefined"&&(b="$"),ZDBConvert.trimData(ZDBUtil.removeChar(a,b))},this.toDate=function(a,b){if(a==null||!a)return"";var c="%d %b %Y %H:%M:%S.%f",d=b.colObj.dateFormat;return d&&d.toUpperCase().indexOf("MILLI")==-1?d=ZDBUtil.calendarDateFormat(d):d=c,typeof a=="object"&&(a=a.print(d)),a=Date.parseDate(a,d).print(c),a},this.toDateFilter=function(a){function i(a){return a<10?"0"+a:a}if(a==null||!a)return"";a=ZDBValidator.resetDateSeparator(a),a=ZDBValidator.getYMDConvertedDate(a);var b=new Date(a),c=b.getDate(),d=b.getMonth(),e=b.getFullYear(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds();return i(c)+" "+ZDBUtil.getMonthName(d,!1,!0)+" "+e+" "+i(f)+":"+i(g)+":"+i(h)}},ZDBValidationUtil=new function(){email_regex="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890@+-. '",this.applyKeyStrokeRestrictions=function(a){var b=jQuery(a).find("input[allowNumericOnly=true]");for(var c=0;c<b.length;c++)ZDBValidationUtil.allowNumericOnly(b[c])},this.allowNumericOnly=function(a){jQuery(a).bind("keypress",ZDBValidationUtil.bindAllowNumeric)},this.allowNumericOnlyWithSpace=function(a){jQuery(a).bind("keypress",ZDBValidationUtil.bindAllowNumericWithSpace)},this.restrictEmailField=function(a){ZDBValidationUtil.restrict(a,email_regex)},this.restrict=function(a,b){jQuery(a).attr("allowedChars",b),jQuery(a).bind("keypress",ZDBValidationUtil.bindRestrict)},this.bindAllowNumeric=function(){var a=event.keyCode?event.keyCode:event.which,b=String.fromCharCode(a);return isNaN(b)||a==32?!1:!0},this.bindAllowNumericWithSpace=function(){var a=event.keyCode?event.keyCode:event.which,b=String.fromCharCode(a);return isNaN(b)?!1:!0},this.bindRestrict=function(a){var b=a.target,c=jQuery(b).attr("allowedChars"),d=a.keyCode?a.keyCode:a.which,e=String.fromCharCode(d);return d==8?!0:c.indexOf(e)==-1?!1:!0}};ZDBConst.DISLEN=15,ZDBCell.isList=function(a){var b=a.colObj;return b.typeObj&&b.typeObj.editorType=="list"?!0:!1},ZDBCell.prototype.setValue=function(a,b,c,d,e){var f;f=this.colObj;if(f.type=="REFCOL"&&f.refData!==undefined){var g=b;b=a;var h=ZDBUtil.indexOf(f.refData,ZDBEscapeUtil.decodeForHtml(a),null,!0);h>-1?a=f.pkData[h]:a=""}e!=0&&this.clearError(!0,!0,!0);if(a==null||!this.isModified()&&(this.originalValue==a||this.originalValue==null&&a===""&&b!=ZDBConst.NEEDSAVE))return;this.modifiedValue=a;var i=ZDBConst.DECISEPSYMBOL[this.colObj.decimalSeparator];!this.colObj.userLocale&&i!=ZDBConst.DEFAULT_DECISEPSYMBOL&&(this.modifiedValue=ZDBFunctions.replace(this.modifiedValue,i,ZDBConst.DEFAULT_DECISEPSYMBOL)),this.rowObj.setModified(),d?(this.completeValidate(),this.isError()||this.rowObj.parGrid.invokeDerivedFunction(this.rowObj)):this.validate(),this.isError()||(this.modifiedValue=this.getConvertedValue()),b!=null?this.displayValue=b:this.displayValue=this.calculateDispVal(),c&&this.setOnDataEl(this.displayValue,this.isError()),d&&ZDBMsgBox.showErrorIfNeeded(this)},ZDBCell.prototype.completeValidate=function(){if(!this.validate())return!1;var a=this.rowObj.parGrid.validateRowFunc;if(a!=null&&!a(this.rowObj))return!1;var a=this.colObj.validateColFunc;return a!=null&&!a(this.colObj)?!1:!0},ZDBCell.prototype.validate=function(){if(this.rowObj.objType!=ZDBConst.DATA)return!0;var a=this.colObj,b=a.typeObj;return b&&b.dataValFn&&b.dataValFn(this),!a.isNullable&&this.getValue("validate")===""&&(this.rowObj.rid?this.setValidatedInfo(a.displayName+" "+ZDBI18NMap.f("zrpt.common.tbleditdesign.showinfo.js.emptyColNameErr",this.rowObj.rid),"COL"):this.setValidatedInfo(ZDBI18NMap.g("zrpt.toolbar.table.editdesign.js.ColNameEmptyErr"),"COL")),!this.isError()},ZDBCell.prototype.setValidatedInfo=function(a,b){switch(b.toUpperCase()){case"CELL":this.cellLevel=!0;break;case"COL":this.colLevel=!0;break;case"ROW":this.rowLevel=!0}this.errorMsg=a,this.cellEl!=null&&(a!=null?this.cellEl.setAttribute("title",a.replace("<br>","\n").replace("<BR>","\n")):this.cellEl.removeAttribute("title")),this.setClass()},ZDBCell.prototype.isError=function(){return this.cellLevel||this.rowLevel||this.colLevel},ZDBCell.prototype.clearError=function(a,b,c){a&&(this.cellLevel=!1),b&&(this.rowLevel=!1),c&&(this.colLevel=!1),a&&b&&c&&(this.errorMsg=""),this.setClass()},ZDBCell.prototype.setClass=function(a){var b=this.rowObj,c=this.colObj,d=this.className,e=this.cellEl;if(!e)return;var f=e.className;if(c.objType==ZDBConst.ROWHEAD){if(this.selected||c.selected||b.selected)d+=" zdbRowHeadFocus";f!=d&&(e.className=d);return}if(this.isError()||this.refErrorMsg)d+=" zdbDataCellError";a&&(d+=" "+a),f!=d&&(e.className=d)},ZDBCell.prototype.getValue=function(a){return a=a?a.toLowerCase():"default",a=="validate"?this.isModified()?this.modifiedValue:this.originalValue?this.originalValue:"":a=="edit"?this.isError()&&this.isModified()?this.modifiedValue:this.colObj.type=="REFCOL"?this.displayValue:this.colObj.typeObj.editValue?this.colObj.typeObj.editValue(this):this.isModified()?this.colObj.userDateFmt?this.displayValue:this.modifiedValue:this.originalValue==null?"":this.colObj.userDateFmt?this.displayValue:this.originalValue:this.isError()||!this.isModified()?this.originalValue:this.modifiedValue},ZDBCell.prototype.isModified=function(){return this.modifiedValue!=null},ZDBCell.prototype.reset=function(a,b){this.modifiedValue=null,this.clearError(!0,!0,!0);var c=a,d=this.colObj,e=this.rowObj;d instanceof Array&&(d=null);if(a&&d&&e.objType!=ZDBConst.COLHEAD){switch(d.type){case"DECIMAL_NUMBER":case"CURRENCY":case"PERCENT":c=parseFloat(a),isNaN(c)==1&&(c=a)}c+=""}this.originalValue=c,b!=null?this.displayValue=b:this.displayValue=""+this.calculateDispVal(),this.cellEl!=null&&(this.cellEl.removeAttribute("title"),this.setOnDataEl(this.displayValue))},ZDBCell.prototype.setOnDataEl=function(a,b){var c=ZDBEvents.colBaseType(this.colObj);(c=="EMAIL"||c=="URL")&&this.displayValue&&(a=b?ZDBEscapeUtil.encodeForHtml(a):ZDBEvents.generateLinkEl(this,c)),a=a!=null?a:"";var d=this.displayNode,e=this.isHtml;e||this.colObj.parGrid.isSpanData?d.innerHTML=a:d.data=a,this.hiddenDispValue&&(d.innerHTML=this.hiddenDispValue);var f=d.tagName==null?d.parentNode:d;this.bgCol!=null&&this.fontCol!=null&&this.className!="sectionHeader"?(f.style.backgroundColor=this.bgCol,f.style.borderTopColor=this.bgCol,f.style.borderLeftColor=this.bgCol,f.style.color=this.fontCol):(f.style.backgroundColor="",f.style.color="",f.style.borderTopColor="",f.style.borderLeftColor="",f.style.borderBottomColor=""),this.colObj.grouped&&this.className!="sectionHeader"&&this.setBorderColor(f),this.setClass()},ZDBCell.prototype.setBorderColor=function(a){var b=ZDBUtil.getParentWithTagName(a,"DIV");if(this.bgCol!=null&&this.fontCol!=null){var c=this.bgCol,d=this.fontCol,e=[[c,d,c,,c,c],[c,d,,,c],[c,d,c,,,c],[c,d,,,,]];b.style.backgroundColor=e[this.groupStatus][0],b.style.color=e[this.groupStatus][1],b.style.borderTopColor=e[this.groupStatus][2],b.style.borderRightColor=e[this.groupStatus][3],b.style.borderBottomColor=e[this.groupStatus][4],b.style.borderLeftColor=e[this.groupStatus][5]}else b.style.backgroundColor="",b.style.color="",b.style.borderTopColor="",b.style.borderRightColor="",b.style.borderBottomColor="",b.style.borderLeftColor=""},ZDBCell.prototype.getConvertedValue=function(){return this.colObj.typeObj.convertFn?this.colObj.typeObj.convertFn(this.modifiedValue,this):this.modifiedValue},ZDBCell.prototype.calculateDispVal=function(){return!this.refErrorMsg,this.cellLevel?this.modifiedValue:this.colObj.typeObj.dispFn?this.colObj.typeObj.dispFn(this):this.isModified()?this.modifiedValue:this.originalValue==null?"":this.originalValue},ZDBColHeader.prototype.setExprValues=function(a,b,c){var d=!1;for(var e=0;e<b.values.length;e++){var f=b.parGrid.colHeaders[e];for(var g=0;g<c.length;g++)if(f.colName.toLowerCase()==c[g].toLowerCase()){var h=b.values[e],i=h.modifiedValue;i==null&&(i=h.originalValue);if(i==null)return!1;d=!0,f.typeObj.typeValue&&(i=f.typeObj.typeValue(i,h)),a[c[g]]=i}}return d?!0:!1},ZDBColHeader.prototype.getDispNameForHtml=function(){return ZDBEscapeUtil.encodeForHtml(this.displayName)},ZDBColHeader.COLINSTID=0,ZDBRow.prototype.setValues=function(a){this.values=a;var b=a.length-1,c=this.parGrid.colHeaders,d=c.length,e=this.objType,f=a[b--];a.pop(),this.rid=f;var g=a[b];a.pop();if(g===null||g===undefined)g="";a.unshift(new ZDBCell(this,c[0],g,g,"zdbRowHead",-1,!1,-1)),e!==ZDBConst.COLHEAD&&(a.push(this.parGrid.domCache.getDummyCellObj(c[d-2],this)),a.push(this.parGrid.domCache.getDummyCellObj(c[d-1],this)));for(var h=0;h<d;h++){var i=c[h];if(!(a[h]instanceof ZDBCell)){var j=a[h],k=null,l=null,m=null,n=null,o=-1,p=j,q=null,r=null,s=null,t=0,u=null,v=null;if(j instanceof Array){j[1]instanceof Object&&(t=1,r=j[1].BGCOLOR,s=j[1].FONTCOLOR,u=j[1].GEOROLE,v=j[1].GEOSTD),k=j[1+t],l=j[2+t],m=j[3+t],n=j[4+t],o=j[5+t],p=j[0],q=j[6+t];if(q&&q.indexOf("java.lang")==0||k!=="")q=null}i.type=="URL"&&i.altText!=null&&p!=null&&m==null?a[h]=new ZDBCell(this,i,p,i.altText,l,m,n,o,q,r,s,u,v):a[h]=new ZDBCell(this,i,p,k,l,m,n,o,q,r,s,u,v)}}},ZDBRow.prototype.saved=function(){var a=this.values;for(var b=0,c=a.length;b<c;b++)a[b].isModified()&&a[b].reset(a[b].modifiedValue,a[b].displayValue);this.sentStatus=0,this.status=ZDBConst.CLEAR},ZDBRow.prototype.setModified=function(){this.objType==ZDBConst.DUMMY?(this.objType=ZDBConst.DATA,this.status=ZDBConst.CREATED,this.setRID(null,"*"+this.parGrid.newRid++)):this.status==ZDBConst.CLEAR&&(this.status=ZDBConst.MODIFIED,this.parGrid.rowsToUpdate.push(this)),this.sentStatus==1&&(this.sentStatus=2),this.parGrid.setDataModified()},ZDBColHeader.prototype.setValue=function(a){var b=this.parGrid.colHeaders,c=b.length;for(var d=0;d<c;++d)if(a==""||(a.toUpperCase()=="__ZDBID"||b[d].displayName.toLowerCase().trim()==a.toLowerCase().trim())&&b[d]!=this)return!1;return this.displayName=a,this.displayNode.innerHTML=this.getDispNameForHtml(),!0},ZDBColHeader.prototype.setClass=function(){var a="zdbColHeadArea zdbColHeadIcon ",b=this.parGrid;this.cellEl.className=this.className!=null?this.className:"zdbColHead",this.selected&&(this.cellEl.className+=" zdbColHeadFocus");if(this.objType!=ZDBConst.COLHEAD)return;if(b.showDatatype){var c=this.type;c=="REFCOL"&&(c=this.refColType),c=="RELCOL"&&(c=this.relColType);var d=window.location.href,e=d.split("?")[1],f=e.split("&"),g=null,h=null,i=null;for(var j=0,k=f.length;j<k;j++)f[j].substring(0,f[j].indexOf("="))=="OBJID"?g=f[j].split("=")[1]:f[j].substring(0,f[j].indexOf("="))=="DATATYPESYMBOL"?h=f[j].split("=")[1]:f[j].substring(0,f[j].indexOf("="))=="STANDALONE"&&(i=f[j].split("=")[1]);g==b.objId&&i=="true"&&(b.showDatatype=h=="true"?!0:!1),this.typeNode.className="zdbColHeadArea zdbColHeadDataType "+(ZDBColumnType[c]?ZDBColumnType[c].typeClass:"")}else this.typeNode.style.display="none";this.sortOrder==ZDBConst.ASC?a+=" headerSortAsc":this.sortOrder==ZDBConst.DESC&&(a+=" headerSortDesc"),this.iconNode.className=a},ZDBColHeader.prototype.setModified=function(){this.status==ZDBConst.DUMMY?this.status=ZDBConst.CREATED:this.status!=ZDBConst.CREATED&&(this.status=ZDBConst.MODIFIED),this.sentStatus==1&&(this.sentStatus=2)},ZDBColHeader.prototype.getViewIndex=function(){return this.cellPos+(this.cellPos<=this.parGrid.freezeIndex?1:-(this.parGrid.freezeIndex+1))},ZDBRow.prototype.setRID=function(a,b){this.rid=a,this.rDisp=b,this.rIdEl!=null&&(this.rIdEl.data=this.rDisp)},ZDBRow.setEls=function(a,b){b.rIdEl=a[0],a[0].rowObj=b,b.rDisp!=null&&(b.rIdEl.innerHTML=b.rDisp),b.objType!=ZDBConst.FILLER&&(b.rIdEl.className=b.selected?"zdbRowHeadFocus":"zdbRowHead")},ZDBRow.unsetEls=function(a){a.rIdEl&&delete a.rIdEl},ZDBCell.setClass=function(a,b,c){this.colObj.objType!=ZDBConst.ROWHEAD;var d=a.cellEl;if(b&&c===!1){d.className=b;return}var e="";a.className?e=a.className:ZDBCell.getRowClass(a)?e=ZDBCell.getRowClass(a):ZDBCell.getColClass(a)?e=ZDBCell.getColClass(a):e=ZDBCell.getDefaultClass(a),b&&(e+=" "+b),d.className=e},ZDBCell.getDefaultClass=function(a){switch(a.objType){case ZDBConst.COLHEAD:return"zdbColHead";default:return""}},ZDBCell.getRowClass=function(a){var b=a.rowObj;return b.className?b.className:""},ZDBCell.getColClass=function(a){var b=a.colObj;return b.className?b.className:""},ZDBRow.prototype.setClass=function(){var a=this.values[0],b=a.cellEl;if(!b)return;var c=a.colObj,d=a.className;if(c.objType==ZDBConst.ROWHEAD){this.selected||a.selected?b.className=d+" zdbRowHeadFocus":b.className=d;return}},ZDBDataGrid.setIndices=function(a){var b=ZDBDialogUtil.zCounter+1;a.freezeIcon.style.zIndex=b},ZDBDataGrid.setGlobals=function(){ZDBGlobal.moveIndicator=ZDBUtil.addToNode("zdbMoveIndicator"),ZDBGlobal.moveMsg=ZDBUtil.addToNode("zdbMoveMsg"),ZDBGlobal.resizeDIV=ZDBUtil.addToNode("resizeDIV"),ZDBGlobal.freezeIcon=ZDBUtil.getCloned("freezeIcon"),ZDBGlobal.linkIcon=ZDBUtil.addToNode("linkIcon"),ZDBGlobal.dataCell=ZDBUtil.getCloned("zdbDataCell"),ZDBUtil.removeNonElements(ZDBGlobal.dataCell),ZDBGlobal.cellDIV=ZDBUtil.getCloned("zdbCellDIV"),ZDBGlobal.colHead=ZDBUtil.getCloned("zdbColHeadCell"),ZDBGlobal.rowHead=ZDBUtil.getCloned("zdbRowHeadCell"),ZDBUtil.removeNonElements(ZDBGlobal.rowHead),ZDBGlobal.rowHead.appendChild(document.createTextNode(" ")),ZDBGlobal.fillerVCell=ZDBUtil.getCloned("zdbFillerVCell"),ZDBGlobal.fillerHCell=ZDBUtil.getCloned("zdbFillerHCell"),ZDBGlobal.fillerDCell=ZDBUtil.getCloned("zdbFillerDCell"),ZDBGlobal.filterCell=ZDBUtil.getCloned("zdbFilterCell"),ZDBUtil.removeNonElements(ZDBGlobal.filterCell),ZDBGlobal.filterOptionCell=ZDBUtil.getCloned("zdbFilterCell"),ZDBUtil.removeNonElements(ZDBGlobal.filterOptionCell),ZDBGlobal.filterHead=ZDBUtil.getCloned("zdbFilterHeadCell"),ZDBUtil.removeNonElements(ZDBGlobal.filterHead),ZDBGlobal.dummyCell=ZDBUtil.addToNode("zdbDummyCell"),ZDBGlobal.dummyDIV=ZDBUtil.addToNode("zdbDummyDIV"),ZDBGlobal.gridTmpHolder=document.getElementById("gridTmpHolder"),ZDBUtil.addToNode("tabEdit"),ZDBGlobal.isGlobalSet=!0},ZDBDataGrid.prototype.reorderColumns=function(a,b,c){var d=[];if(this.reorderDisabled)return;var e=a.length;if(e==0)return;var f=[],g=this.colHeaders,h=g.length;for(var i=0;i<h;++i)if(g[i].objType==ZDBConst.COLHEAD){if(g[i].freeze){ZDBMsgBox.showInfo(ZDBI18NMap.g("zrpt.common.table.showinfo.js.reorderFreezeColErr"));return}if(i>=b&&i<=c&&g[i].grouped){ZDBMsgBox.showInfo(ZDBI18NMap.g("zrpt.common.table.showinfo.js.reorderGrpColErr"));return}}for(var i=0;i<b;i++)d.push(i);for(var i=b;i<=c;i++)d.push(a[i-b].cellPos),g[i]=a[i-b];for(var i=c+1;i<h;i++)d.push(g[i].cellPos);for(var i=b;i<=c;i++){var j=g[c],k=g[i];this.chAreaRowDiv.insertBefore(k.cellEl,j.cellEl),k.cellPos=i,d.push(k.cellPos)}var l=this.rowData,m=ZDBDataGrid.getFirstRowIndex(l,!0);l[m-1].values=g,this.colHeaders=l[m-1].values;var n=l.length,o=g.length,p;for(var i=0;i<n;++i){if(l[i].values==this.colHeaders)continue;p=l[i].values;var q=[];for(var r=0;r<h;r++)q.push(p[d[r]]);for(var s=b;s<=c;s++){var t=q[c],u=q[s];l[i].rowDataEl.insertBefore(u.cellEl,t.cellEl)}l[i].values=q}this.dataCache.colsReordered(),this.sendClientState(!1,"REORDERCOLUMN")},ZDBDataGrid.prototype.adjustColumnWidth=function(a,b){var c=a.cellPos,d=this.rowData,e=d.length,f,g,h,i,j,k;a.width+=b;for(var l=0;l<e;++l){h=d[l],f=h.values,g=f.length;for(var m=0;m<g;++m){i=f[m],j=i.colObj;if(i.startIndex<0&&j==a||i.startIndex<=c&&i.endIndex>=c){k=i;break}}this.placeCellElement(k,[!1,!1,!1,!0],[!1,!1,!1,!0]),a.freeze?h.objType==ZDBConst.COLHEAD&&!h.rowHeaderEl?this.tcAreaRowDiv.style.width=parseInt(this.tcAreaRowDiv.style.width)+b+"px":h.rowHeaderEl.style.width=parseInt(h.rowHeaderEl.style.width)+b+"px":h.objType==ZDBConst.COLHEAD&&!h.rowDataEl?this.chAreaRowDiv.style.width=parseInt(this.chAreaRowDiv.style.width)+b+"px":h.rowDataEl.style.width=parseInt(h.rowDataEl.style.width)+b+"px"}ZDBDataGrid.setColHeadDisplayWidth(this,a)},ZDBDataGrid.prototype.resizeColumn=function(a,b){this.resizeColumnUI(a,b),this.saveResize(b)},ZDBDataGrid.prototype.saveResize=function(a){if(a.objType==ZDBConst.COLHEAD&&this.canSaveUIChanges()){var b="COLID="+a.colId+"&WIDTH="+a.width+"&"+this.getGridDetailsAsParams();AjaxAPI.sendRequest({URL:CommAPI.RESIZECOLURL,PARAMETERS:b})}},ZDBDataGrid.prototype.resizeColumnUI=function(a,b,c){if(this.resizeDisabled)return!0;c=c?c:parseInt(ZDBEvents.mouseUpPos.x-ZDBEvents.mouseDownPos.x),b.width+c<10&&(c=10),this.resizeGridArea(b,c),this.selectColumn();var d=ZDBDataGrid.getCurrentCell(this);this.type=="TableDesign"&&d&&this.setCellFocus(d,!1);return},ZDBDataGrid.prototype.resizeGridArea=function(a,b){this.adjustColumnWidth(a,b),this.adjustRowHeightOnResize(a),this.adjustDimension(),this.adjustColFill(),this.selectedCols=[a],this.resizeFilterColumn(b),this.setFreezeIcon()},ZDBDataGrid.prototype.adjustFillerSize=function(a){var b=this.rhTbody.childNodes[0].childNodes,c=b.length,d=this.rhFillerRow.childNodes;for(var e=1;e<c;++e)d[e].style.width=b[e].style.width;var f=this.dTbody.childNodes[0].childNodes,g=f.length,h=this.dFillerRow.childNodes;for(var e=0;e<g;++e)h[e].style.width=f[e].style.width;return;var i,j,k},ZDBDataGrid.prototype.adjustRowHeadSize=function(){var a=this.tcDummySpan.innerHTML.length;if(this.recordEnd==null)return;var b=(this.recordEnd+"").length+1;b<4&&(b=4);if(a!=b){var c=Math.pow(10,b-1)+"";this.tcDummySpan.innerHTML=c,this.adjustDimension()}},ZDBDataGrid.prototype.setRefErrors=function(a){var b="",c="";for(var d=0;d<a.length;d++){var e=a[d][0],f=a[d][1],g="";c==""&&(c=f[0]=="DATATYPE"?ZDBI18NMap.g("zrpt.common.referr.errmsg.js.dataTypeChngDlgTtl"):f[0]=="REFERREDCOLUMN"?ZDBI18NMap.g("zrpt.common.lookup.js.changetolookup"):ZDBI18NMap.g("zrpt.common.referr.errmsg.js.delColsDlgTtl"));if(f[0]=="FIELDNAME"){var h=ZDBEscapeUtil.encodeForHtml(this.getDispNameForId(e));h!=""?(h="'"+h+"'",g="<br><b>"+ZDBI18NMap.f("zrpt.common.referr.errmsg.js.delColsDlgText",h)+"</b></br>"):g="<br><b>"+ZDBI18NMap.g("zrpt.common.referr.errmsg.js.delAggFormulaDlgText")+"</b></br>"}else f[0]=="DATATYPE"?g="<br><b>"+ZDBI18NMap.f("zrpt.common.referr.errmsg.js.dataTypeChngDlgText",ZDBEscapeUtil.encodeForHtml(this.getDispNameForId(e)))+"</b></br>":f[0]=="REFERREDCOLUMN"&&(g="<br><b>"+ZDBI18NMap.f("zrpt.common.referr.errmsg.js.chbglookupcol",ZDBEscapeUtil.encodeForHtml(this.getDispNameForId(e)))+"</b></br>");b=b+g+a[d][2]}ZDBUtil.showRefErr(b,c)},ZDBDataGrid.setTemplateLayout=function(a){ZDBDataGrid.ZDBGRIDTPL==null&&(ZDBDataGrid.ZDBGRIDTPL=$("ZDBGRIDTPL"),ZDBUtil.deepRemoveNonElements(ZDBDataGrid.ZDBGRIDTPL),ZDBUtil.setNamedChildEls(ZDBDataGrid.ZDBGRIDTPL,ZDBDataGrid.ZDBGRIDTPL),ZDBUtil.removeNonElements(ZDBDataGrid.ZDBGRIDTPL.chArea),ZDBDataGrid.ZDBGRIDTPL.parentNode.removeChild(ZDBDataGrid.ZDBGRIDTPL));var b=ZDBDataGrid.ZDBGRIDTPL.cloneNode(!0);b.removeAttribute("id"),b.setAttribute("GRIDID",a.ID),ZDBUtil.setNamedChildEls(b,a),a.rightSelect.gridObj=a,a.leftSelect.gridObj=a,a.gArea=b,a.viewComp=a.gArea,a.navigComp&&!ZDBGlobal.IS_MOBILE&&(a.navigComp.parGrid=a)},ZDBDataGrid.prototype.setDataWidth=function(a,b){var c=this.rowData,d=c.length,e=this.colHeaders,f=e.length;a<0&&(a=0);if(b===undefined||b<0)b=f;var g,h;for(var i=a;i<b;++i){h=e[i];for(var j=0;j<d;++j)g=c[j].values[i].dataEl,g.style.width=h[ZDBDataGrid.getPropertyID(h,c[j])]+"px";g=this.fillerRow.values[i].dataEl,g.style.width=h[ZDBDataGrid.getPropertyID(h,this.fillerRow)]+"px"}},ZDBDataGrid.prototype.setFirstRowWidth=function(){this.rowData.length>0?this.setRowWidth(this.rowData[0],!1):this.setRowWidth(this.dummyRowObj,!0)},ZDBDataGrid.prototype.setRowWidth=function(){return},ZDBDataGrid.getVisibleColumn=function(a,b,c,d){var e=a.length,f;for(var g=b;c?g<e:g>=0;c?++g:--g){f=a[g];if(f.objType==ZDBConst.COLHEAD&&f.visible)return d?g:f}return d?-1:null},ZDBDataGrid.getLastVisibleColumn=function(a,b,c,d){var e=a.length,f;for(var g=b;g<e;--g){f=a[g];if((d||f.objType==ZDBConst.COLHEAD)&&f.visible)return c?g:f}return c?-1:null},ZDBDataGrid.getFirstVisibleColumn=function(a,b,c,d){var e=a.length,f;for(var g=b;g<e;++g){f=a[g];if((d||f.objType==ZDBConst.COLHEAD)&&f.visible)return c?g:f}return c?-1:null},ZDBDataGrid.getPreviousVisibleColumn=function(a,b){var c=a.length,d;if(b>=c||b<0)return null;colHead=a[b];for(var e=b-1;e>=0;--e){d=a[e];if(colHead.freeze!=d.freeze)return null;if(d.visible)return d}return null},ZDBDataGrid.prototype.getPivotIndex=function(a,b){var c=this.colData[b],d=c.length,e;for(var f=0;f<d;++f){e=c[f];if(e.startIndex<=a&&e.endIndex>=a)return f}},ZDBDataGrid.getDataHeight=function(a,b){if(a==null)return 0;b!=null&&(b.style.height="");var c=a.dArea.scrollHeight;return c},ZDBDataGrid.prototype.selectColumn=function(){if(this.selectionDisabled||ZDBGlobal.IS_MOBILE||this.type=="TableDesign")return;this.hideSelection(),this.removeCellFocus();var a=2,b=this.selectedCols,c=b.length,d=this.rightSelect,e=this.leftSelect;this.selectionType=ZDBConst.COLHEAD;var f=-1,g=-1,h=0,i=0,j=new Array;for(var k=0;k<c;++k){var l=b[k];l=l.parentNode?l:this.getColHeadFromId(l.colId);if(l==null)continue;j.push(l);var m=this.getCellElPosInGrid(l).cellLeft;if(l.selectDisabled)return;l.selected=!0,l.setClass();if(l.freeze){if(f==-1||m<f)f=m;h+=l.width}else{if(g==-1||m<g)g=m;i+=l.width}}this.selectedCols=j;var n=d.style,o=e.style,p=ZDBDataGrid.getDataHeight(this,h?e:d);h&&(i?(e.className="zdbSelect zdbSelectNoRight",h-=a):(e.className="zdbSelect",h-=2*a),o.top="0px",o.left=f+"px",o.height=p-a*2+"px",o.width=h+"px"),o.display=h?"block":"none",i&&(d.className=h?"zdbSelect zdbSelectNoLeft":"zdbSelect",h?h-=a:i-=2*a,n.top="0px",n.left=g+"px",n.height=p-a*2+"px",n.width=i+"px"),n.display=i?"block":"none",this.removeCellFocus(),this.lastFocusPos={row:-1,col:-1},this.rightSelect.selCols=this.selectedCols.slice()},ZDBDataGrid.prototype.hideSelection=function(a,b){var c=this.rightSelect,d=c.selCols;if(d){var e=d.length;for(var f=0;f<e;++f)d[f].selected=!1,d[f].setClass()}var g=c.selRows;if(g){var e=g.length;for(var f=0;f<e;++f)g[f].selected=!1,g[f].setClass()}c.selCols=[],c.selRows=[],c.style.display="none",this.leftSelect.style.display="none",this.selectionType=ZDBConst.NONE,b&&(this.selectedRows=[]),a&&(this.selectedCols=[])},ZDBDataGrid.prototype.selectRow=function(){if(this.selectionDisabled||ZDBGlobal.IS_MOBILE)return;this.hideSelection(),this.removeCellFocus();var a=2,b=this.selectedRows,c=b.length;if(c==0){this.rowFocus=!1,this.rightSelect.style.display="none",this.leftSelect.style.display="none";return}var d=0,e=c>0?this.getCellElPosInGrid(b[0].values[0]).cellTop:0;for(var f=0;f<c;++f){d+=b[f].height;var g=this.getCellElPosInGrid(b[f].values[0]);g.cellTop<e&&(e=g.cellTop),b[f].selected=!0,b[f].setClass()}var h=this.rightSelect,i=this.leftSelect,j=this.colHeaders,k=j.length;this.selectionType=ZDBConst.ROWHEAD;var l=i.style,m=h.style,n=0,o=0,p;for(var f=1;f<k;++f){p=j[f];if(p.objType!==ZDBConst.COLHEAD)break;var q=this.getCellElPosInGrid(p);p.freeze?n=p.visible?n+p.width:n:o=p.visible?q.cellLeft+p.width:o}d-=2*a;if(n){o?o-=a:o-=2*a,i.className="zdbSelect zdbSelectNoRight",l.top=e+"px";var r=ZDBDataGrid.getVisibleColumn(this.colHeaders,0,!0,!1);l.left=this.getCellElPosInGrid(r).cellLeft+"px",l.height=d+"px",l.width=n+"px"}l.display=n?"block":"none",o&&(n?o-=a:o-=2*a,h.className=n?"zdbSelect zdbSelectNoLeft":"zdbSelect",m.top=e+"px",m.left="0px"
,m.height=d+"px",m.width=o+"px"),m.display=o?"block":"none",this.rightSelect.selRows=this.selectedRows.slice(),this.onFocus(null,!0),this.rowHeadFocus=!0,this.lastFocusPos={row:-1,col:-1}},ZDBDataGrid.prototype.onSelectClick=function(a,b){var c=ZDBEvents.mouseDownPos,d=this.getCellAtPos(c.x,c.y);this.rowHeadFocus=d.colObj.objType===ZDBConst.ROWHEAD,this.setCellFocus(d),this.hideSelection()},ZDBDataGrid.prototype.getCellAtPos=function(a,b){var c=b-this.position.y+this.dArea.scrollTop,d=a-this.position.x+this.dArea.scrollLeft,e=0,f=0,g=this.rowData,h=g.length,i,j,k=0;for(var l=0;l<h;++l){i=g[l];if(e<=c&&e+i.height>=c){k=l;break}e+=i.height}i=g[k];var m=i.values,n,o=m.length,p=0;for(var l=0;l<o;++l){n=m[l].colObj;if(!n.visible)continue;if(f<=d&&f+n.width>=d){p=l;break}f+=n.width}return g[k].values[p]},ZDBDataGrid.prototype.getCellHeadPos=function(a){var b=this.getCellElPosInGrid(a),c=a.colObj,d=a.rowObj,e,f;return c.freeeze?e=b.cellLeft:e=this.tcWidth+b.cellLeft,d.objType===ZDBConst.COLHEAD?f=b.cellTop:f=this.tcHeight+b.cellTop,{x:e,y:f}},ZDBDataGrid.calculateRowHeight=function(a,b){var c=a.cellEl;if(!a)return ZDBGlobal.stdCellHeight;if(!c)return ZDBGlobal.stdCellHeight;if(!a.colObj.visible)return ZDBGlobal.stdCellHeight;var d=a.rowObj,e=d.parGrid,f=ZDBGlobal.heightDIV;f||(f=$("zdbHeightDiv"),ZDBGlobal.heightDIV=f);if(!c.parentNode){var g=e.rhArea,h=e.dArea,i=e.tcArea,j=e.chArea,k=a.colObj.freeze,l=d.objType;(l===ZDBConst.COLHEAD?k?i:j:k?g:h).appendChild(c)}f.parentNode!=e.rwGrid.dArea&&e.rwGrid.dArea.appendChild(f),ZDBDataGrid.checkWrapColHead(e,c,f,d.objType==ZDBConst.COLHEAD),f.className=e.type=="TableDesign"?c.className+" zdbEditGridHeightDiv":c.className+" zdbHeightDiv",f.style.width=(b?b:e.getSize(c,a.colObj.width,!0))+"px",f.innerHTML=c.innerHTML,f.style.lineHeight="";var m=ZDBUtil.getStyleNumeric(f,"height")+ZDBUtil.getElementOuterSize(f,!1),m=f.offsetHeight;return e.type=="TableDesign"&&m-2>ZDBGlobal.stdEditGridCellHeight&&(a.colObj.colName=="FORMULACOLUMN"||a.colObj.colName=="DESCRIPTION")?(f.style.lineHeight="16px",c.style.lineHeight="16px",m=f.offsetHeight,m):e.type=="TableDesign"&&m-2<=ZDBGlobal.stdEditGridCellHeight?(f.style.lineHeight="",ZDBGlobal.stdEditGridCellHeight):m<=ZDBGlobal.stdCellHeight?ZDBGlobal.stdCellHeight:m},ZDBDataGrid.calculateColWidth=function(a,b){if(!a)return console.log("Issue: colObj not found"),ZDBGlobal.stdCellWidth;if(b&&b.defColWidth>0)return b.defColWidth;var c=a.getDispNameForHtml();if((c+"").length<15)return ZDBGlobal.stdCellWidth;var d=a.cellEl,b=a.parGrid,e=ZDBDataGrid.getColHeadNonTextWidth(b),f=ZDBGlobal.widthDIV;f||(f=$("zdbWidthDiv"),ZDBGlobal.widthDIV=f),f.parentNode!=b.rwGrid.dArea&&b.rwGrid.dArea.appendChild(f),ZDBDataGrid.checkWrapColHead(b,d,f,a.rowObj.objType==ZDBConst.COLHEAD),f.className=d.className+" zdbWidthDIV",f.innerHTML=ZDBEscapeUtil.encodeForHtml(c);var g=f.offsetWidth;return g+=e,g<ZDBGlobal.stdCellWidth?ZDBGlobal.stdCellWidth:g},ZDBDataGrid.checkWrapColHead=function(a,b,c,d){d&&a.view&&a.view.chartProp&&a.view.chartProp.zr_wrap_colHead?(jQuery(b).find(".zdbColHeadDisplay").css({whiteSpace:"normal"}),c.style.whiteSpace="normal"):d?(jQuery(b).find(".zdbColHeadDisplay").css({whiteSpace:"nowrap"}),c.style.whiteSpace="nowrap"):c.style.whiteSpace=""},ZDBDataGrid.prototype.adjustRowHeightBasedOnCell=function(a){var b=a.rowObj,c=ZDBDataGrid.calculateRowHeight(a);if(c<=b.height&&b.heightObj!=a)return;b.height=c,this.adjustRowFill()},ZDBDataGrid.prototype.adjustRowHeightOnResize=function(a){var b=this.rowData,c=b.length,d,e=-1,f=c-1,g,h=a.cellPos;for(var i=0;i<c;++i){d=b[i];var j=d.values;g=j[h];if(d.objType==ZDBConst.COLHEAD){if(this.view&&this.view.chartProp&&!this.view.chartProp.zr_wrap_colHead)continue;for(var k=0;k<j.length;k++){if(!(j[k]instanceof ZDBCell))break;if(j[k].endIndex>-1&&j[k].startIndex<=h&&j[k].endIndex>=h){g=j[k];break}}}var l=this.calcPivotHeaderWidth(d,g),m=ZDBDataGrid.calculateRowHeight(g,l);if(m<=d.height&&d.heightObj!=g)continue;e<0&&(e=i),d.height=m,d.heightObj=g;for(var n=0;n<j.length;n++){var o=j[n],p=this.calcPivotHeaderWidth(d,o),q=ZDBDataGrid.calculateRowHeight(o,p);if(q>m){m=q,d.height=m,d.heightObj=o,n=-1;continue}o.height=m,this.placeCellElement(o,[!1,!1,!0,!1],[!1,!1,!0,!1])}d.rowDataEl&&(d.rowDataEl.style.height=m+"px",d.rowHeaderEl.style.height=m+"px")}e>=0&&this.adjustRowFill()},ZDBDataGrid.prototype.calcPivotHeaderWidth=function(a,b){var c=0;if(a.objType==ZDBConst.COLHEAD&&b.startIndex>-1)for(var d=b.startIndex;d<=b.endIndex;d++)c+=this.getSize(b.colObj.parGrid.colHeaders[d].cellEl,b.colObj.parGrid.colHeaders[d].width,!1);return c=c>0?c:!1,c},ZDBDataGrid.getColHeadNonTextWidth=function(a){var b=0;return a.showDatatype&&(b+=16),a.showCheck&&(b+=20),a.showIcon&&(b+=20),a.showRenameIcon&&(b+=20),b},ZDBDataGrid.setColHeadDisplayWidth=function(a,b){var c=parseInt(b.cellEl.style.width);b.objType==ZDBConst.COLHEAD&&(c-=ZDBDataGrid.getColHeadNonTextWidth(a)),c<0&&(c=0),b.displayNode.style.width=c+"px"},ZDBDataGrid.setColHeadDisplayHeight=function(a,b){var c=b.height,d=b.heightObj,e=ZDBDataGrid.calculateRowHeight(a);e>c&&(c=e,d=a),b.heightObj&&(e=ZDBDataGrid.calculateRowHeight(b.heightObj),e>c&&(c=e,d=b.heightObj)),b.heightObj=d,b.height=c},ZDBDataGrid.getFirstRowIndex=function(a,b){return ZDBDataGrid.getRow(a,!0,!0,b)},ZDBDataGrid.getLastRowIndex=function(a,b){return ZDBDataGrid.getRow(a,!1,!0,b)},ZDBDataGrid.getFirstRowObj=function(a,b){return ZDBDataGrid.getRow(a,!0,!1,b)},ZDBDataGrid.getLastRowObj=function(a,b){return ZDBDataGrid.getRow(a,!1,!1,b)},ZDBDataGrid.getRow=function(a,b,c,d){var e=a.length,f=0,g=e,h=1;b||(f=e-1,g=-1,h=-1);var i;for(;b?f<g:f>g;f+=h){i=a[f];switch(i.objType){case ZDBConst.COLHEAD:case ZDBConst.FILLER:continue}if(i.status==ZDBConst.DELETED)continue;if(!d&&ZDBConst.DUMMY==i.objType)continue;return c?f:i}return c?-1:null},ZDBDataGrid.reorderDragAndDrop=function(a,b){var c=a.parGrid;c.addSelectedCol(a);var d=c.colHeaders,e=d.length,f=[],g=c.selectedCols,h=g.length,i=e,j=-1,k;if(b.objType!==ZDBConst.COLHEAD){b=ZDBDataGrid.getLastVisibleColumn(d,b.cellPos-1,!1,!0);if(!b)return}if(b==a)return;for(var l=0;l<h;++l)k=g[l],k.cellPos<i&&(i=k.cellPos),k.cellPos>j&&(j=k.cellPos),f.push(k);var m=b.cellPos<a.cellPos;if(m){f.push(b);for(l=b.cellPos+1;l<i;++l)f.push(d[l])}else{f.unshift(b);for(l=b.cellPos-1;l>j;--l)f.unshift(d[l])}h=g.length;var n=m?b.cellPos:i,o=m?j:b.cellPos;if(n>o){var p=n;n=o,o=p}c.reorderColumns(f,n,o),c.selectColumn()},ZDBDataGrid.setUnfreezeInfo=function(a){a.setAttribute("alt","Fixed column"),a.setAttribute("title","Fixed column"),a.onmousemove=null,a.onmouseout=null,a.onclick=null,a.style.cursor="default"},ZDBDataGrid.setKeyHandlerFocus=function(a,b){!ZDBGlobal.IS_MOBILE&&(a.keyFocusRequired==1||!ZDBClientUI.standAlone)&&a.viewCtx!=null&&a.viewCtx.dashView==null&&ZDBUtil.setTimeout(ZDBUtil.setFocus,null,[a.keyHandler],b)},ZDBDataGrid.setRowCountNavig=function(a,b){a.innerHTML="";var c=ZDBUtil.getSourceElement(b),d=ZDBClientUI.selectedTab.view;if(d.type=="Dashboard"){var e=DOMUtils.getParentWithAttr(a,"isDashBoardDiv");d=e==null?ZDBUtil.getPropertyFromEl(c,"gridObj","object"):e.dlgBody.view}if(d.type=="AnalysisView"||d.type=="Pivot"||d.type=="SummaryView")d=ZDBUtil.getPropertyFromEl(a,"gridObj","object");var f="&ZDBACTION=FETCHROWCOUNT"+d.getCompleteGridDetailsAsParams();d.type=="VUDSheet"?f+="&ISFILTERAPPLIED=true"+ZDBVUDataAPI.getConfigXmlAsParam(d,"VUDSheet"):f+=d.isFilterApplied?"&ISFILTERAPPLIED=true":"&ISFILTERAPPLIED=false",ZDBDataGrid.sendRequestForRowCount("/ZDBDatabaseActionMI.ma?",f,d,c)},ZDBDataGrid.sendRequestForRowCount=function(a,b,c,d){var e=c.totalRecordsDiv;AjaxAPI.sendRequest({URL:a,PARAMETERS:b,ONSUCCESSFUNC:ZDBDataGrid.setRowCountInfo,GRIDOBJ:c,OPSTATUSID:e})},ZDBDataGrid.setRowCountInfo=function(a,b){var c=b.GRIDOBJ;c.setRowCountDiv(parseInt(a.responseText))};var ZDBDialogUtil=new function(){this.i=0,this.zCounter=2e3,this.zStartIndex=2e3,this.blinkCounter=0,this.intervalID=null,this.dialogs=new Array,this.openedDialog=0,this.btnsMonitored=[],this.exceptionOccurred=!1,this.showDialog=function(a,b){for(prop in b)b[prop.toUpperCase()]=b[prop];var c=a;b.ADDFRAME&&(c=this.createDialog(b),c.dlgBodyDIV.innerHTML="",a!=null&&(c.dlgBodyDIV.appendChild(a),c.bodyContent=a)),c.bodyContent==null&&ZDBUtil.setNamedChildEls(c,c,"elname"),ZDBDialogUtil.openedDialog++,ZDBDialogUtil.dialogs[ZDBDialogUtil.openedDialog-1]=c,ZDBDialogUtil.zCounter=ZDBDialogUtil.zCounter+5,b.DLGBODY&&(c.dlgBody.className=b.DLGBODY),b.TITLE&&(c.bodyContent&&!b.DESC&&(c.dlgTitle.style.width=parseInt(c.bodyContent.style.width)-30+"px"),c.dlgTitle.innerHTML=ZDBEscapeUtil.encodeForHtml(b.TITLE)),b.HELPDOC&&(ZDBClientUI.isCustomDomain||(c.dlgHelp.href=ZDBEscapeUtil.encodeForHtml(b.HELPDOC),c.dlgHelpIcon.style.display="")),!c.dlgDesc||!b.DESC,ZDBDialogUtil.currentViewObj=b.VIEW,b.TITLECLASS&&c.dlgIcon&&(c.dlgIcon.className=b.TITLECLASS,c.setIconClass=function(a){c.dlgIcon.className=a}),c.params=b,c.style.position="absolute",c.style.visibility="hidden",c.style.display="block",document.body.appendChild(c);var d=b.CALLOUT;d?(jQuery(c.dlgTitleBar).unbind("mousedown"),ZDBDialogUtil.calloutPosition(c)):(jQuery(c.dlgTitleBar).mousedown(function(a){ZDBDialogUtil.dragDialog(this,a)}),ZDBDialogUtil.positionCenter(c)),ZDBDialogUtil.focusDialog=c,c.view=b.VIEW,c.style.zIndex=ZDBDialogUtil.zCounter,b.ZINDEX&&(c.style.zIndex=b.ZINDEX),b.RESIZE&&(c.maxBtn.style.display="",c.resizeEls.style.display="",c.corner.style.display="",c.resizeLR.style.height=c.offsetHeight-20+"px",c.resizeTB.style.width=c.offsetWidth-20+"px");if(b.ADDFRAME||b.SHADOW){var e=jQuery(c).children("[elname='ZRDlgShadow']")[0];e=e!=null?e:c,ZDBMenu.addShadow(e)}b.MODAL&&this.freezeBackground(ZDBDialogUtil.dialogs[ZDBDialogUtil.openedDialog-1]),c.style.visibility="visible",ZDBUtil.attachEvent(document,"keydown",ZDBDialogUtil.whichEvent),b.NOFOCUS!==!0&&ZDBDialogUtil.setElementIndex(c);if(b.ACTIONBUTTONS){var f=b.ACTIONBUTTONS;if(f instanceof Array&&f instanceof Object&&f.length>0||f instanceof HTMLElement||f instanceof jQuery)f instanceof jQuery&&(f=f.toArray()),this.btnsMonitored=this.btnsMonitored.concat(f),jQuery(f).click(ZDBDialogUtil.btnDisabler)}return c},this.btnDisabler=function(a){if(!ZDBDialogUtil.exceptionOccurred){var b=a.srcElement||a.target;b.tagName==="INPUT"?b.disabled=!0:b.style.pointerEvents&&(b.style.pointerEvents="none")}ZDBDialogUtil.exceptionOccurred=!1},this.calloutPosition=function(a){var b=a.params,c=0,d=0,e=null,f=jQuery(a).height(),g=jQuery(a).width(),h=jQuery(window),i=h.height(),j=h.width();if(j>g&&i>f){var k=jQuery(b.SRCEL),l=k.offset(),m=k.width(),n=k.height(),o=i-l.top,p=j-l.left,q=.2,r=.5,s=11,t=20,u=b.SCASE;if(u)e="ZRSPointerTop",d=l.top+n+s,c=l.left+m/2-g*.8,a.ArrowBefore.style.left=g*.8+"px",a.ArrowAfter.style.left=g*.8+"px";else if(o>f-f*q+t&&p>g+m+s+t){e="ZRSPointerLeft",d=l.top-f*q,c=l.left+m+s;var v=0;if(d<0)d=10,v=l.top+n/2-10;else{var w=f*q+n/2;v=w>f?f/2:w}a.ArrowBefore.style.top=v+"px",a.ArrowAfter.style.top=v+"px"}else if(o>f-f*r+t&&p>g+m+s+t){e="ZRSPointerLeft",d=l.top-f*r,c=l.left+m+s;var v=0;if(d<0)d=10,v=l.top+n/2-10;else{var w=f*r+n/2;v=w>f?f/2:w}a.ArrowBefore.style.top=v+"px",a.ArrowAfter.style.top=v+"px"}else if(o>f-f*q+t&&l.left>g+s+t){e="ZRSPointerRight",d=l.top-f*q,c=l.left-g-s;var v=0;if(d<0)d=10,v=l.top+n/2-10;else{var w=f*q+n/2;v=w>f?f/2:w}a.ArrowBefore.style.top=v+"px",a.ArrowAfter.style.top=v+"px"}else if(o>f-f*r+t&&l.left>g+s+t){e="ZRSPointerRight",d=l.top-f*r,c=l.left-g-s;var v=0;if(d<0)d=10,v=l.top+n/2-10;else{var w=f*r+n/2;v=w>f?f/2:w}a.ArrowBefore.style.top=v+"px",a.ArrowAfter.style.top=v+"px"}else if(o>f+n+s+t&&p>g+m/2-g*q+t&&l.left>g*q)e="ZRSPointerTop",d=l.top+n+s,c=l.left+m/2-g*q,a.ArrowBefore.style.left=g*q+"px",a.ArrowAfter.style.left=g*q+"px";else if(o>f+n+s+t&&p>g+m/2-g*r+t&&l.left>g*r)e="ZRSPointerTop",d=l.top+n+s,c=l.left+m/2-g*r,a.ArrowBefore.style.left=g*r+"px",a.ArrowAfter.style.left=g*r+"px";else if(l.top>f+s+t&&p>g+m/2-g*q+t){e="ZRSPointerBottom",d=l.top-f-s,c=l.left-g*q;var w=g*q+m/2,v=w>g?g/2:w;a.ArrowBefore.style.left=v+"px",a.ArrowAfter.style.left=v+"px"}else if(l.top>f+s+t&&p>g+m/2-g*r+t){e="ZRSPointerBottom",d=l.top-f-s,c=l.left-g*r;var w=g*r+m/2,v=w>g?g/2:w;a.ArrowBefore.style.left=v+"px",a.ArrowAfter.style.left=v+"px"}}if(!e){ZDBDialogUtil.positionCenter(a);return}a.dlgTable.className="dlgBorder font12 "+e,a.ArrowBefore.className=e+"Before",a.ArrowAfter.className=e+"After",a.style.left=parseInt(c)+"px",a.style.top=parseInt(d)+"px"},this.setFocusDialog=function(a){var b=a.getAttribute("isDialog")=="true"?a:DOMUtils.getParentWithAttr(a,"isDialog");if(b==ZDBDialogUtil.focusDialog)return;ZDBDialogUtil.focusDialog=ZDBDialogUtil.openedDialog>1?ZDBDialogUtil.dialogs[ZDBDialogUtil.openedDialog-1]:b},this.positionCenter=function(a){var b=a,c=self.pageYOffset?self.pageYOffset:document.documentElement.scrollTop,d,e;ZDBGlobal.IS_MOBILE?b.params?(d=b.params.LEFT?b.params.LEFT:window.innerWidth/2-b.offsetWidth*.5,e=b.params.TOP?b.params.TOP:window.innerHeight/2-b.offsetHeight*.5+c):(d=window.innerWidth/2-b.offsetWidth*.5,e=window.innerHeight/2-b.offsetHeight*.5+c):b.params?(d=b.params.LEFT?b.params.LEFT:jQuery(window).width()/2-b.offsetWidth*.5,e=b.params.TOP?b.params.TOP:jQuery(window).height()/2-b.offsetHeight*.5+c):(d=jQuery(window).width()/2-b.offsetWidth*.5,e=jQuery(window).height()/2-b.offsetHeight*.5+c),b.style.left=d+"px",b.style.top=e+"px"},this.freezeBackground=function(a,b){if(a.freezeLayer==null){var c=document.createElement("DIV");c.className=b?b:"freezeLayer",c.style.zIndex=parseInt(a.style.zIndex)-1,a.freezeLayer=c}document.body.appendChild(a.freezeLayer),a.params&&a.params.CALLOUT?a.freezeLayer.onclick=ZDBDialogUtil.closeCallout:ZDBUtil.attachEvent(a.freezeLayer,ZDBGlobal.IS_MOBILE?"touchmove":"click",ZDBDialogUtil.alertModalDlfEffect,!0)},this.alertModalDlfEffect=function(a){var b=ZDBDialogUtil.focusDialog;ZDBDialogUtil.blinkCounter=0,ZDBDialogUtil.intervalID=setTimeout(ZDBDialogUtil.blinkEffect,100),ZDBUtil.stopEventBubble()},this.blinkEffect=function(a){var b=ZDBDialogUtil.focusDialog,c=jQuery(b).children("[elname='ZRDlgShadow']")[0];b=c?c:b;if(b==null)return;var d=b.getAttribute("orgClass"),e=b.getAttribute("effectClass"),f="ZRSShadow";d=d==null?b.shadowAdded==1?f:"normalTitleStyle":d,e=e==null?b.shadowAdded==1?"modalBlinkEffect1 shadowAdded":"modalBlinkEffect1":e,ZDBDialogUtil.blinkCounter<3?(ZDBDialogUtil.blinkCounter%2!=0?b.className=d:b.className=e,ZDBDialogUtil.blinkCounter++,setTimeout(ZDBDialogUtil.blinkEffect,100)):b.className=d},this.createDialog=function(a){dlgID=a["FRAMETYPE"]!=null?a.FRAMETYPE:"ZDBDialogTemplate";var b=$(dlgID).cloneNode(!0);return b.id="",ZDBUtil.setNamedChildEls(b,b,"elname"),b},this.whichEvent=function(a){if(document.screenGrabberOpen)return;var b=BROWSER.IE?window.event.keyCode:a.which;if(!ZDBDialogUtil.focusDialog)return;switch(b){case KEY.ESC:if(!ZDBDialogUtil.focusDialog.params.NOESC)return $("extDriveIFrame")==null?(ZDBDialogUtil.closeDialog(),ZDBUtil.stopEventBubble(a)):$("extDriveIFrame")!=null?(ZDBDialogUtil.closeDialog(),ZDBUtil.stopEventBubble(a)):(jQuery("#overlay").css("display","none"),jQuery("#ZDBEXTERNALOPTSTATUS").css("display","none"),jQuery("#ZDBExtDriveIframeDialog").css("display","none"),jQuery("#extDriveIFrame").remove()),!0;ZDBDialogUtil.focusDialog.params.ONESC&&ZDBDialogUtil.focusDialog.params.ONESC.call(window,ZDBDialogUtil.focusDialog.params.ESCARGS);break;case KEY.ENTER:ZDBDialogUtil.focusDialog.params.ONENTER&&ZDBDialogUtil.focusDialog.params.ONENTER.apply(window,[this,a,ZDBDialogUtil.focusDialog.params.ENTERARGS]);break;default:return!0}},this.dragDialog=function(a,b){ZDBDialogUtil.setFocusDialog(a);var c=ZDBDialogUtil.focusDialog;c.style.cursor="move",BROWSER.IE?(this.diffLeft=window.event.clientX+document.body.scrollLeft-parseInt(ZDBUtil.getObjLeft(c)),this.diffTop=window.event.clientY+document.body.scrollTop-parseInt(ZDBUtil.getObjTop(c))):(this.diffLeft=b.pageX-parseInt(ZDBUtil.getObjLeft(c)),this.diffTop=b.pageY-parseInt(ZDBUtil.getObjTop(c))),ZDBUtil.stopEventBubble(b),document.onmousemove=ZDBDialogUtil.moveDialog,document.onmouseup=ZDBDialogUtil.releaseDialog},this.moveDialog=function(a){var b=ZDBDialogUtil.focusDialog;if(BROWSER.IE){var c=window.event.clientX+document.body.scrollLeft-ZDBDialogUtil.diffLeft,d=window.event.clientY+document.body.scrollTop-ZDBDialogUtil.diffTop;c=c>=0?c:0,d=d>=0?d:0,b.style.left=c+"px",b.style.top=d+"px"}else b.style.left=(a.pageX-ZDBDialogUtil.diffLeft>0?a.pageX-ZDBDialogUtil.diffLeft:0)+"px",b.style.top=(a.pageY-ZDBDialogUtil.diffTop>0?a.pageY-ZDBDialogUtil.diffTop:0)+"px";b.iframe!=null&&(b.iframe.style.left=b.style.left,b.iframe.style.top=b.style.top),ZDBUtil.stopEventBubble(a)},this.releaseDialog=function(a){var b=ZDBDialogUtil.focusDialog;b.style.cursor="default",document.onmousemove=null,document.onmouseup=null,ZDBUtil.stopEventBubble(a)},this.closeDialog=function(a,b,c){hideCustomMessage(),ZDBMenuUtil.closeMenu();var d=null;a?d=DOMUtils.getParentWithAttr(a,"isDialog"):d=ZDBDialogUtil.focusDialog,d!=null&&d.dialogStatus&&d.dialogStatus>0&&ZDBInlineDialog.closeDialog(),d&&this.closeThisDialog(d,c),b!=null&&ZDBUtil.stopEventBubble(b),ZDBClientUI.modified&&(ZDBClientUI.modified=!1),jQuery(d).find(this.btnsMonitored).length>0&&this.btnsMonitored.length>0&&(this.btnsMonitored=this.enableButtons(this.btnsMonitored))},this.enableButtons=function(a,b){for(var c=0;c<a.length;c++)a[c].tagName==="INPUT"?a[c].disabled=!1:a[c].style.pointerEvents="",b||jQuery(a[c]).unbind("click",ZDBDialogUtil.btnDisabler);return a=[],a},this.closeThisDialog=function(a,b){if(a.params.ONCLOSE&&!a.params.ONCLOSE(a,b))return!0;a.bodyContent!=null&&(a.bodyContent.style.overflow=""),jQuery(a).unbind("keydown",ZDBDialogUtil.whichEvent),a.params.DONTREMOVE&&a.params.ADDFRAME?$("ZDBDialogHiddenDiv").appendChild(a.bodyContent):a.params.DONTREMOVE&&($("ZDBDialogHiddenDiv").appendChild(a),a.dontRemoveDlg=!0);var c=jQuery.inArray(a,ZDBDialogUtil.dialogs);try{ZDBDialogUtil.dialogs[c].freezeLayer&&document.body.removeChild(ZDBDialogUtil.dialogs[c].freezeLayer)}catch(d){}ZDBMenu.removeIframe(a),a.dontRemoveDlg!=1&&(a.parentNode.removeChild(a),ZDBDialogUtil.dialogs.splice(c,1)),ZDBDialogUtil.openedDialog--,ZDBDialogUtil.openedDialog!=0?ZDBDialogUtil.focusDialog=ZDBDialogUtil.dialogs[ZDBDialogUtil.openedDialog-1]:(ZDBDialogUtil.focusDialog=null,document.onkeydown=null)}};ZDBDialogUtil.setElementIndex=function(a){if(a.params.IOS!=null)return;try{var b=null,c=a.getElementsByTagName("*"),d=c.length,e=["INPUT","SELECT","TEXTAREA"],f=0;for(var g=0;g<d;++g)try{var h=c[g];if(h.tagName&&ZDBUtil.indexOf(e,h.tagName.toUpperCase())>=0){var i=(h.getAttribute("type")+"").toUpperCase();i!="HIDDEN"&&i!="BUTTON"&&(h.setAttribute("tabindex",f++),h.tabIndex=f,b||(b=h))}}catch(j){}}catch(j){}b&&ZDBUtil.setFocus(b,!0)},ZDBDialogUtil.attachResizeEvt=function(a,b,c){var d=ZDBDialogUtil.focusDialog;d.action="RESIZE"+b,document.onmousemove=ZDBDialogUtil.drawLine,document.onmouseup=ZDBDialogUtil.resize,ZDBUtil.stopEventBubble(c)},ZDBDialogUtil.drawLine=function(a){var b=ZDBDialogUtil.focusDialog,c=b.vLine,d=b.hLine,e=ZDBUtil.getObjLeft(b,!1),f=ZDBUtil.getObjTop(b,!1),g=ZDBUtil.getCursorPos(a),h="default",i=g.x-e<ZDBConst.DLG_MIN_WIDTH?ZDBConst.DLG_MIN_WIDTH:g.x-e,j=g.y-f<ZDBConst.DLG_MIN_HEIGHT?ZDBConst.DLG_MIN_HEIGHT:g.y-f;b.width=i,b.height=j;var k=b.action;k=="RESIZELR"?(ZDBUtil.setElPos(c,[b.offsetHeight,"1","0",i]),c.style.display="",h=i==ZDBConst.DLG_MIN_WIDTH?"default":"e-resize"):k=="RESIZETB"?(ZDBUtil.setElPos(d,["1",b.offsetWidth,j,"0"]),d.style.display="",h=j==ZDBConst.DLG_MIN_HEIGHT?"default":"n-resize"):k=="RESIZEALL"&&(ZDBUtil.setElPos(c,[j,"1","0",i]),ZDBUtil.setElPos(d,["1",i,j,"0"]),c.style.display="",d.style.display="",h=j==ZDBConst.DLG_MIN_HEIGHT&&i==ZDBConst.DLG_MIN_WIDTH?"default":"se-resize"),document.body.style.cursor=h,b.style.cursor=h,ZDBUtil.stopEventBubble(a)},ZDBDialogUtil.resize=function(a){document.body.style.cursor="default";var b=ZDBDialogUtil.focusDialog;b.vLine.style.display="none",b.hLine.style.display="none";var c=b.action,d=b.width,e=b.height;ZDBDialogUtil.initContants(),c=="RESIZELR"?e=b.bodyContent.offsetHeight+ZDBDialogUtil.titleBarHeight:c=="RESIZETB"&&(d=b.bodyContent.offsetWidth),b.resizeLR.style.height=e-20+"px",b.resizeTB.style.width=d-20+"px",b.resizeTB.style.top=e+"px",ZDBUtil.setElPos(b,[e,d]),ZDBUtil.setElPos(b.bodyContent,[e-ZDBDialogUtil.titleBarHeight,d]),b.bodyContent.gridHolder!=null&&(!ZDBDialogUtil.focusDialog.view.dialogStatus||ZDBDialogUtil.focusDialog.view.dialogStatus<1)?ZDBDialogUtil.resizeVUDGrid(b,e,d):b.bodyContent.editGridHolder!=null?(ZDBInlineDialog.resizeDialog(),ZDBDialogUtil.resizeEditDesignDialog(b,e,d)):ZDBDialogUtil.focusDialog.view.dialogStatus>0&&(ZDBInlineDialog.resizeDialog(),ZDBDialogUtil.resizeVUDGrid(b,e,d)),ZDBDialogUtil.releaseDialog(a),ZDBMenu.resizeIframe(b),b.action=null},ZDBDialogUtil.resizeEditDesignDialog=function(a,b,c){var d=ZDBDialogUtil.toolbarHeight+ZDBDialogUtil.titleBarHeight;b-=d,a.bodyContent.editGridHolder.style.width=c+"px",a.bodyContent.editGridHolder.style.height=b+"px";var e=a.gridObj;e.resizeGrid(c,b),ZDBInlineDialog.resizeDialog()},ZDBDialogUtil.resizeVUDGrid=function(a,b,c){var d=ZDBDialogUtil.toolbarHeight+ZDBDialogUtil.titleBarHeight;b-=d;var e=a.action,f=a.bodyContent;e!=null&&e=="RESIZELR"&&(b=f.gridHolder.offsetHeight),f.gridHolder.style.width=c+"px",f.gridHolder.style.height=b+"px",f.gridObj.resizeGrid(c,b)},ZDBDialogUtil.minMaxDlg=function(a){var b=ZDBDialogUtil.focusDialog,c="none",d=width=left=0,e=0;a=="max"?(b.width=b.offsetWidth,b.height=b.offsetHeight,b.top=b.style.top,b.left=b.style.left,d=jQuery(window).height(),width=jQuery(window).width(),e=jQuery(window).scrollTop(),left=0,c="none"):a=="min"&&(d=b.height,width=b.width,e=b.top,left=b.left,c=""),b.maxBtn.style.display=c,b.minBtn.style.display=c==""?"none":"",b.resizeLR.style.display=c,b.resizeTB.style.display=c,b.corner.style.display=c,ZDBDialogUtil.initContants(),ZDBUtil.setElPos(b,[d,width,e,left]),ZDBUtil.setElPos(b.bodyContent,[d-ZDBDialogUtil.titleBarHeight,width]),b.bodyContent.editGridHolder!=null?(ZDBDialogUtil.resizeEditDesignDialog(b,d,width),b.isMaximized=a==="max"):ZDBDialogUtil.focusDialog.view.dialogStatus&&ZDBDialogUtil.focusDialog.view.dialogStatus>0?(ZDBInlineDialog.resizeDialog(),ZDBDialogUtil.resizeVUDGrid(b,d,width)):b.bodyContent.gridHolder!=null&&ZDBDialogUtil.resizeVUDGrid(b,d,width)},ZDBDialogUtil.initContants=function(){if(ZDBDialogUtil.toolbarHeight)return;ZDBDialogUtil.toolbarHeight=38,ZDBDialogUtil.titleBarHeight=40};var ZDBInlineDialog=new function(){this.dialogStatus=0,this.resized=!1,this.showDialog=function(a,b){jQuery(a).attr("isdlgContent","true");var c=ZDBClientUI.selectedTab;ToolTip.hide(),a.params=b;if(c.view.dialogStatus>0){var d,e=b.INLINECONTAINER||"ZDBInlineOptsDiv";d=$(e);var f=d.cloneNode(!0);f.setAttribute("id","");var g=b.VIEW?b.VIEW:c.view;a.view=g;var h=c.dialogs[c.view.dialogStatus-1];c.view.dialogStatus+=1;var i=b.TITLE?b.TITLE:jQuery(a).find("[elname='dlgTitle']").html(),j=b.TABTITLE||i;ZDBUtil.setNamedChildEls(f,f),f.oldTabTitle=h.viewTitle,f.viewTitle=i,f.params=b,c.dialogs[c.view.dialogStatus-1]=f,c.focusedDialog=f;var k=$("ZDBViewEl"),l=k.offsetHeight;this.enableOrDisableExistingViewElements(),f.style.height=l+"px",k.removeChild(h),b.MODAL?(jQuery(f).removeClass("greytexture"),jQuery(f.dlg).hide(),jQuery(f.modelDlg).show().html(a)):(jQuery(f).addClass("greytexture"),jQuery(f.dlg).show().append(a),jQuery(f.modelDlg).hide(),b.DESC&&(f.dlgDesc.innerHTML=b.DESC),f.dlgTitle.innerHTML=i,f.dlgBack.onclick=function(){ZDBInlineDialog.closeDialog()}),k.appendChild(f),ZDBClientUI.updateDisplayName(ZDBClientUI.selectedTab,j),g.editMode&&g.typeValue>=2&&g.typeValue<=4&&ZDBAnalysisEditViewMode.disableFields(!0,g)}else{var g=b.VIEW?b.VIEW:c.view;g.dialogStatus=1,a.view=g,ZDBClientUI.selectedTab.view.dialogStatus=1;var i=b.TITLE?b.TITLE:jQuery(a).find("[elname='dlgTitle']").html();g.typeValue==ZDBClientViewAPI.TYPE_ANALYSISVIEW?ZDBI18NMap.g("zrpt.common.analysis.settings.js.help.chart"):"";var j=b.TABTITLE||i,m=b.DESC?b.DESC:jQuery(a).find("[elname='dlgDesc']").html(),n,e=b.INLINECONTAINER||"ZDBInlineOptsDiv";n=$(e);var o=n.cloneNode(!0);o.setAttribute("id",""),o.style.display="",ZDBUtil.setNamedChildEls(o,o),o.oldTabTitle=g.viewCtx&&g.viewCtx.dashView?g.viewCtx.dashView.displayName:g.displayName,o.viewTitle=i,c.dialogs=new Array,o.params=b,c.dialogs[ZDBClientUI.selectedTab.view.dialogStatus-1]=o,b.MODAL?(jQuery(o).removeClass("greytexture"),jQuery(o.dlg).hide(),jQuery(o.modelDlg).show().html(a)):(jQuery(o).addClass("greytexture"),jQuery(o.dlg).show().append(a),jQuery(o.modelDlg).hide(),o.dlgTitle.innerHTML=i,o.dlgDesc&&m&&(o.dlgDesc.innerHTML=m),o.dlgBack.onclick=function(){ZDBInlineDialog.closeDialog()}),c.focusedDialog=o,g.editMode&&g.typeValue>=2&&g.typeValue<=4&&ZDBAnalysisEditViewMode.disableFields(!0,g);if(ZDBDialogUtil.focusDialog){var p=ZDBDialogUtil.focusDialog;p.dialogStatus=1;var q=p.bodyContent,l=q.offsetHeight,r=q.offsetWidth;this.enableOrDisableExistingViewElements(),q.style.height=l+"px",q.style.width=r+"px",q.appendChild(o)}else{var k=$("ZDBViewEl"),l=k.offsetHeight;this.enableOrDisableExistingViewElements(),o.style.height=l+"px",k.appendChild(o),ZDBClientUI.updateDisplayName(c,j)}}b.HELP&&b["HELP"]!=""&&o.dlgHelp&&(o.dlgHelp.style.display="",o.dlgHelp.href=b.HELP);if(a.view.type!=="VUDSheet"&&!b.MODAL&&a.view.type!=="TableDesign"){c.className=c.view.type+"Obj "+"inlineTabSelected";var s=DOMUtils.getFirstMatchingChild(c,"table","id","ZDBExplorerTab");s.className="inlineTabContent"}ev.addEscHandle(ZDBInlineDialog.keyCloseEvent),jQuery(a).find('[elname="defaultFocus"]').focus().select()},this.keyCloseEvent=function(a){if(ZDBClientUI.selectedTab&&ZDBClientUI.selectedTab.dialogStatus<=0)return;var b=BROWSER.IE?window.event.keyCode:a.keyCode;if(b==KEY.ESC){ZRSMenu.closeAllMenu();if(ZDBDialogUtil.focusDialog)ZDBDialogUtil.closeDialog();else{var c=ZDBClientUI.selectedTab.focusedDialog;c.parentNode&&(c.gridObj&&c.gridObj.type=="TableDesign"?ZDBDesignGrid.closeDesign(c):ZDBInlineDialog.closeDialog())}ZDBUtil.stopEventBubble(a)}},this.refreshDialog=function(a,b){var c=ZDBClientUI.selectedTab,d=c.dialogs[c.view.dialogStatus-1],e=jQuery(d).find("[isdlgContent]");e.empty(),e.html(a)},this.resizeDialog=function(){var a=ZDBClientUI.selectedTab;if(ZDBDialogUtil.focusDialog&&a.view.dialogStatus>0){var b=ZDBDialogUtil.focusDialog.bodyContent.offsetHeight;ZDBDialogUtil.focusDialog.bodyContent.style.height=b+"px"}else if(a&&a.view.dialogStatus>0){var c=$("ZDBMainBox")?$("ZDBMainBox").offsetHeight:document.body.clientHeight,d=ZDBUtil.getObjTop($("ZDBViewEl")),e=c-d;a.dialogs[a.view.dialogStatus-1].style.height=e+"px"}this.resizeDlgHeight();var f=$("ZDBERDGCONTAINER");f&&f.panObject.refreshPan();if(a.view.dialogStatus){var g=a.dialogs[a.view.dialogStatus-1];ZDBInlineDialog.customResize(g)}},this.customResize=function(a){a&&a.params.ONRESIZE&&typeof a.params.ONRESIZE=="function"&&a.params.ONRESIZE()},this.closeDialog=function(){var a=ZDBClientUI.selectedTab,b=a.dialogs[a.view.dialogStatus-1];if(!b)return;if(a.view.dialogStatus&&a.view.dialogStatus<1)return;a.view.dialogStatus-=1;var c=ZDBDialogUtil.focusDialog?ZDBDialogUtil.focusDialog.bodyContent:$("ZDBViewEl");c.removeChild(b);if(a.view.dialogStatus==0){ZDBUtil.removeNonElements(c);var d=c.childNodes,e=d.length;for(var f=0,g=e;f<g;f++){var h=d[f];if(h.getAttribute("i18nholderdiv")=="true")continue;d[f].style.display=""}}else{var i=a.dialogs[a.view.dialogStatus-1];a.focusedDialog=i,i.style.display="",c.appendChild(i)}if(!ZDBDialogUtil.focusDialog){var j=b.oldTabTitle;ZDBClientUI.updateDisplayName(a,j);if(a.view.dialogStatus==0){ZDBClientUI.resizePlaceHolder(),a.className=a.view.type+"Obj "+"tabSelected";var k=DOMUtils.getFirstMatchingChild(a,"table","id","ZDBExplorerTab");k.className="tabContent",a.view.resize()}}else{var l=ZDBDialogUtil.focusDialog;l.dialogStatus=0;var m=l.offsetWidth,n=l.offsetHeight;l.bodyContent.gridHolder!=null&&ZDBDialogUtil.resizeVUDGrid(l,n,m)}hideCustomMessage(),a.view.editMode&&a.view.typeValue>=2&&a.view.typeValue<=4&&ZDBAnalysisEditViewMode.disableFields(!1,a.view);if(b.params&&b.params.ONCLOSE&&!b.params.ONCLOSE(b))return!0},this.enableOrDisableExistingViewElements=function(a){var b=ZDBDialogUtil.focusDialog?ZDBDialogUtil.focusDialog.bodyContent:$("ZDBViewEl");ZDBUtil.removeNonElements(b);var c=b.childNodes,d=c.length;for(var e=0,f=d;e<f;e++)c[e].style.display=a?"":"none"},this.showOrHideInlineDlgDiv=function(a,b){var c=$("ZDBViewEl");this.enableOrDisableExistingViewElements(!b),b?(c.appendChild(a.dialogs[a.view.dialogStatus-1]),a.dialogs[a.view.dialogStatus-1].style.display="",this.resizeDialog()):c.removeChild(a.dialogs[a.view.dialogStatus-1]);if(b&&!a.focusedDialog.gridObj){a.className=a.view.type+"Obj "+"inlineTabSelected";var d=DOMUtils.getFirstMatchingChild(a,"table","id","ZDBExplorerTab");d.className="inlineTabContent"}else{a.className=a.view.type+"Obj "+"tabSelected";var d=DOMUtils.getFirstMatchingChild(a,"table","id","ZDBExplorerTab");d.className="tabContent"}},this.showStatusMsg=function(a,b){var c=ZDBClientUI.selectedTab,d=c.dialogs[c.view.dialogStatus-1];ZDBUtil.setNamedChildEls(d,d);var e=ZDBUtil.getElWithTagNAttrWithVal(d,"elname","StatusMsgBar","span");e.innerHTML=a,e.className=b,e.style.display="",ZDBInlineDialog.waitNHide(b,90)},this.waitNHide=function(a,b){var c=ZDBClientUI.selectedTab,d=c.dialogs[c.view.dialogStatus-1];ZDBUtil.setNamedChildEls(d,d);var e=ZDBUtil.getElWithTagNAttrWithVal(d,"elname","StatusMsgBar","span");setTimeout(function(){ZDBInlineDialog.dimNHideStatusMsg(e,a,b)},1e4)},this.dimNHideStatusMsg=function(a,b,c){a.className=b+" dim"+c,c-=10,c>0?setTimeout(function(){ZDBInlineDialog.dimNHideStatusMsg(a,b,c)},50):a.style.display="none"},this.changeTab=function(a,b){this.curFormId=b;var c=typeof b=="string"?$(b):b,d=a.getAttribute("selectionclass");c.className=d,this.resizeDlgHeight();var e=a.getAttribute("focusel");e?ZDBUtil.setFocus($(e),!0):a.focusEl&&ZDBUtil.setFocus(a.focusEl,!0),hideCustomMessage(),$("ApplyShareChrDiv")&&$("ZDBShrChrinfo").removeChild($("ApplyShareChrDiv"))},this.adjustInlineHeader=function(a,b,c){var d=6,e=b.dlgHeader,f=b.dlgHelp?b.dlgTitle.parentElement:b.dlgTitle,g=b.parentNode,h=ZDBUtil.getElWithTagNAttrWithVal(a,"class","leftContr","div"),i=c.offsetWidth,j=h?h.offsetWidth:148,k=i+j+d;f.style.width=i-17+"px",e.style.width=k+"px",k>g.offsetWidth-ZDBGlobal.scrollThick?b.className="mainFloatContr":b.className="mainFixedContr"},this.resizeDlgHeight=function(){var a=$("ZDBViewUDDlg")?$("ZDBViewUDDlg"):$("ZDBViewEl"),b=typeof this.curFormId=="string"?$(this.curFormId):this.curFormId,c=55,d=10,e=ZDBUtil.getParentWithAttributeValue(b,"elname","dlg");if(e==null)return;ZDBUtil.setNamedChildEls(e,e),e.dlgSubmit&&(e.dlgSubmit.style.height=c+"px");var f=ZDBUtil.getElWithTagNAttrWithVal(b,"elname","dlgForm","div");f.style.height="auto";var g=a.offsetHeight,h=b.offsetHeight+e.dlgHeader.offsetHeight+d;if(h<g)e.dlgSubmit?e.dlgSubmit.style.height=c+(g-h)-d+"px":f.style.height=g-e.dlgHeader.offsetHeight-d+"px";else if(e.dlgSubmit)e.dlgSubmit.style.height=c+"px";else{var i=e.dlgSubmit?e.dlgSubmit.offsetHeight+d:d;f.style.height=b.offsetHeight-i+"px"}ZDBInlineDialog.adjustInlineHeader(b,e,f)},this.closeDialogByType=function(a){var b=jQuery(a).parents("[dialogholder='true']").get(0),c=b?jQuery(b).attr("dlgtype"):"default";c==="fullpage"?ZDBFullPageDialog.closeDialog():c==="inline"?ZDBInlineDialog.closeDialog():ZDBDialogUtil.closeDialog()}},ZDBFullPageDialog=new function(){};ZDBFullPageDialog.showDialog=function(a,b,c){ZDBFullPageDialog.dialogStatus||(ZDBFullPageDialog.dialogStatus=0,ZDBFullPageDialog.dialogs=new Array),ZDBFullPageDialog.dialogs[ZDBFullPageDialog.dialogStatus++]=a,a.params=b,ZDBFullPageDialog.currentFullPageDialog=a;var d=jQuery("#ZRSFullPageDlgHolder");c?d.css(c):d.css({"margin-left":"-500px",width:"1000px"}),d.html(a),d.show(10,function(){jQuery(this).find('[elname="defaultFocus"]').focus().select()}),ev.addEscHandle(ZDBFullPageDialog.keyCloseEvent),ZDBDialogUtil.freezeBackground($("ZRSFullPageDlgHolder"),"fullPageFreezeLayer")},ZDBFullPageDialog.closeDialog=function(){var a=ZDBFullPageDialog.currentFullPageDialog;if(a.params&&a.params.ONCLOSE&&!a.params.ONCLOSE(a))return!0;var b=document.querySelector("#ZRSFullPageDlgHolder");b.style.display="none",a.params&&a.params.DONTREMOVE?$("ZDBDialogHiddenDiv").appendChild(a):b.innerHTML="",b.freezeLayer&&document.body.removeChild(b.freezeLayer),ZDBFullPageDialog.dialogs.splice(--ZDBFullPageDialog.dialogStatus,1)},ZDBFullPageDialog.keyCloseEvent=function(a){var b=BROWSER.IE?window.event.
keyCode:a.keyCode;if(b===KEY.ESC){var c=document.querySelector("#ZRSFullPageDlgHolder"),d=c.children,e=d.length>0&&d[0].id,f=["ZDBCREATEDIALOG","ZDBZProjsImpDlg","ZDBZBTImpDlg","GANALWIZARDHOLDER","SFWIZARDHOLDER"];if(f.indexOf(e)!=-1&&typeof ZRUserAnalyticsObject!="undefined"&&ZRUserAnalyticsObject instanceof Object&&!(ZRUserAnalyticsObject instanceof Array)){var g={"import":"fileimport",cloud:"cloudimport",template:"templateimport",scratch:"blankdatabase",enterdata:"enterdata",projectsimport:"projectsimport",bugtrackerimport:"bugtrackerimport",googleAnalyticsimport:"googleanalyticsimport",salesforceimport:"salesforceimport"};submodule=g[window.importType],window.importType=="import"&&ZRUserAnalytics.checkAndPushToServer("closebyesckey","step"+window.curStep,"homefileimportflow",null,null,null,!0),ZRUserAnalytics.checkAndPushToServer("closebyesckey",submodule,ZRUserAnalyticsObject.module,null,null,!0)}ZDBFullPageDialog.closeDialog(),ZDBUtil.stopEventBubble(a)}};var ZDBEscapeUtil=new function(){this.SPECIALCHARS_XML=["&","'",'"',"<",">"],this.REPL_SPECIALCHARS_XML=["&amp;","&apos;","&quot;","&lt;","&gt;"],this.SPECIALCHARS_HTML_WITH_SPACE_ENCODE=["&","'",'"',"<",">"," "],this.REPL_SPECIALCHARS_HTML_WITH_SPACE_ENCODE=["&amp;","&#39;","&quot;","&lt;","&gt;","&nbsp;"],this.SPECIALCHARS_HTML=["&","'",'"',"<",">"],this.REPL_SPECIALCHARS_HTML=["&amp;","&#39;","&quot;","&lt;","&gt;"],this.SPECIALCHARS_JS=["\r","\n",'"',"'","/","\\"],this.REPL_SPECIALCHARS_JS=["\\r","\\n",'\\"',"\\'","\\/","\\\\"],this.DISPLAYCHARS_HTML=["\n"],this.REPL_DISPLAYCHARS_HTML=["<BR />"],this.replaceChar=function(a,b,c){if(a==null)return"";var d=a.toString(),e=null,f=d.length,g=b.length;a:for(var h=0;h<f;h++){var i=d.charAt(h);for(var j=0;j<g;j++)if(b[j]==i){e==null&&(e=d.substring(0,h)),e+=c[j];continue a}e!=null&&(e+=i)}return e!=null?e:d},this.escSplCharAsHTMLWithSpaceEncode=function(a){return this.replaceChar(a,this.SPECIALCHARS_HTML_WITH_SPACE_ENCODE,this.REPL_SPECIALCHARS_HTML_WITH_SPACE_ENCODE)},this.encodeForXML=function(a){return ZDBUtil.replaceStr(this.replaceChar(a,this.SPECIALCHARS_XML,this.REPL_SPECIALCHARS_XML),"\n","&#10;")},this.encodeForHtml=function(a){return a===null?"":(a=a.toString(),jQuery("<div />").text(a).html())},this.decodeForHtml=function(a){return a===null?"":jQuery("<div />").html(a).text()},this.encodeForHtmlDispChar=function(a){return this.replaceChar(a,this.DISPLAYCHARS_HTML,this.REPL_DISPLAYCHARS_HTML)},this.encodeForJs=function(a){return this.replaceChar(a,this.SPECIALCHARS_JS,this.REPL_SPECIALCHARS_JS)},this.encodeHtmlChar=function(a){return window.brTagRe==null&&(window.brTagRe=new RegExp("<br>","gi"),window.endbrTagRe=new RegExp("<br/>","gi"),window.closebrTagRe=new RegExp("</br>","gi"),window.boldTagRe=new RegExp("<b>","gi"),window.endboldTagRe=new RegExp("</b>","gi"),window.sqRe=new RegExp("'","g"),window.dqRe=new RegExp('"',"g"),window.gtRe=new RegExp(">","g"),window.ltRe=new RegExp("<","g"),window.brTag=new RegExp("ZOHO-DB-BR","g"),window.sq=new RegExp("ZOHO-DB-SQ","g"),window.dq=new RegExp("ZOHO-DB-DQ","g"),window.gt=new RegExp("ZOHO-DB-GT","g"),window.lt=new RegExp("ZOHO-DB-LT","g"),window.boldTag=new RegExp("ZOHO-DB-BOLD","gi"),window.endboldTag=new RegExp("ZOHO-DB-END-BOLD","gi")),a=a.trim().replace(window.endbrTagRe,"ZOHO-DB-BR"),a=a.trim().replace(window.brTagRe,"ZOHO-DB-BR"),a=a.trim().replace(window.closebrTagRe,"ZOHO-DB-BR"),a=a.trim().replace(window.boldTagRe,"ZOHO-DB-BOLD"),a=a.trim().replace(window.endboldTagRe,"ZOHO-DB-END-BOLD"),a=a.trim().replace(window.sqRe,"ZOHO-DB-SQ"),a=a.trim().replace(window.dqRe,"ZOHO-DB-DQ"),a=a.trim().replace(window.gtRe,"ZOHO-DB-GT"),a=a.trim().replace(window.ltRe,"ZOHO-DB-LT"),a=a.trim().replace(window.boldTag,"<b>"),a=a.trim().replace(window.endboldTag,"</b>"),a=a.trim().replace(window.brTag,"<BR>"),a=a.trim().replace(window.sq,"&#39;"),a=a.trim().replace(window.dq,"&quot;"),a=a.trim().replace(window.gt,"&gt;"),a=a.trim().replace(window.lt,"&lt;"),a},this.getXMLAttr=function(a,b){return b==null?"":a+"='"+ZDBEscapeUtil.encodeForXML(b)},this.genXMLAttrs=function(a,b){var c=[];for(var d in a){var e=a[d];if(e==null)continue;e=e.toString();if(b&&e==="")continue;c.push(d+"='"+this.encodeForXML(e)+"'")}return c.join(" ")}},ZDBToolTip=new function(){this.tipTimeout=500,this.clientX,this.clientY,this.crId,this.initialized=!1,this.init=function(){this.tipEl=$("ZDBTOOLTIP_DIV"),this.tipInnerDiv=$("ZDBTOOLTIP_INNER_DIV"),this.tipTable=$("ZDBTOOLTIP_TABLE"),this.headerTipTable=$("ZDB_HEADER_TOOLTIP"),ZDBMenu.addShadow(ZDBToolTip.tipEl),this.initialized=!0},this.showTip=function(a,b){if(ZDBGlobal.IS_MOBILE)return;ZDBToolTip.initialized||ZDBToolTip.init();if(ZDBToolTip.isShown==1)return;ZDBToolTip.hideTip(),a=window.event!=null?window.event:a;if(a==null)return;ZDBToolTip.clientX=a.clientX,ZDBToolTip.clientY=a.clientY;var c=ZDBUtil.getSourceElement(a),d=DOMUtils.getParentWithAttr(c,"tiptitle"),e=d!=null?d:c;ZDBToolTip.srcEl=e,ZDBToolTip.showTipAtCursorPos=e.getAttribute("showTipAtCursorPos");if(ZDBMenuUtil.curMenuEl!=null&&ZDBMenuUtil.curMenuEl.srcEl==e||!ZDBToolTip.addHelpEl(e,b))return;ZDBToolTip.crId=setTimeout(ZDBToolTip.setTipVisible,ZDBToolTip.tipTimeout),ZDBToolTip.isShown=!0,ZDBUtil.attachEvent(e,"mouseout",ZDBToolTip.hideTip,!1)},this.addHelpEl=function(a,b){var c=b?b.tipHTML||a.getAttribute("tipdesc1"):a.getAttribute("tipdesc1"),d=c?ZDBToolTip.tipTable:ZDBToolTip.headerTipTable;ZDBUtil.removeAllChildren(ZDBToolTip.tipInnerDiv);var e=this.setTipInfo(d,a,b),f=a.getAttribute("dontwrap")?a.getAttribute("dontwrap").toString():"false";if(e)return;d.style.visibility="hidden",document.body.appendChild(d),d.style.display="";var g=d.offsetWidth;return ZDBToolTip.tipInnerDiv.style.width=(g>200&&f!="true"?201:g)+"px",d.style.visibility="visible",ZDBToolTip.tipInnerDiv.appendChild(d),!0},this.setTipVisible=function(){ZDBToolTip.tipEl.parentNode!=document.body&&document.body.appendChild(ZDBToolTip.tipEl),ZDBToolTip.tipEl.style.display="block";var a=ZDBToolTip.showTipAtCursorPos?ZDBToolTip.clientX+5:ZDBUtil.getObjLeft(ZDBToolTip.srcEl),b=ZDBToolTip.clientY+15||ZDBUtil.getObjTop(ZDBToolTip.srcEl)+ZDBToolTip.srcEl.offsetHeight+5,c=document.body.offsetHeight;b+ZDBToolTip.tipEl.offsetHeight+10>=c&&(b=b-ZDBToolTip.tipEl.offsetHeight-25),ZDBMenuUtil.setPopupPositionWithOffset(ZDBToolTip.tipEl,a,b,0),ZDBMenu.addShadow(ZDBToolTip.tipEl),ZDBMenu.addIframe(ZDBToolTip.tipEl),ZDBToolTip.isShown=!0,ZDBToolTip.tipEl.onmouseover=ZDBToolTip.hideTip},this.hideTip=function(){if(!ZDBToolTip.isShown)return;ZDBToolTip.initialized||ZDBToolTip.init(),ZDBToolTip.crId&&(clearTimeout(ZDBToolTip.crId),ZDBToolTip.crId=null),ZDBMenu.removeIframe(ZDBToolTip.tipEl),ZDBToolTip.tipEl.style.display="none",ZDBToolTip.isShown=!1,ZDBUtil.detachEvent(ZDBToolTip.srcEl,"mouseout",ZDBToolTip.hideTip,!1)},this.setTipInfo=function(a,b,c){ZDBUtil.setNamedChildEls(a,a);var d=c?c.title:b.getAttribute("tiptitle");if(!d&&b.getAttribute("showTipAtCursorPos"))return!0;c&&c.tooltipColor?ZDBToolTip.tipInnerDiv.style.background=c.tooltipColor:ZDBToolTip.tipInnerDiv.style.background="#FAFAFA";var e=c?c.tipHTML:b.getAttribute("tipdesc1"),f=b.getAttribute("tipdesc2"),g=b.getAttribute("tipshortcut"),h=b.getAttribute("tipexample");if(!d&&!e&&!f&&!g&&!h)return!0;if(d&&(e||f||g||h)){a.tipTitle.innerHTML=d,a.tipDesc1.innerHTML=e,a.tipShortCut.innerHTML=g?g:"",a.tipExample.innerHTML=h?h:"",a.tipDesc2.innerHTML=f?f:"";var i=b.getAttribute("dontwrap");a.tipDesc1.style.whiteSpace=i=="true"?"nowrap":"",a.tipDesc2.style.whiteSpace=i=="true"?"nowrap":"";var j=b.getAttribute("onlydesc");a.tipTitleHolder.style.display="",j&&(a.tipTitleHolder.style.display="none")}else c&&c.hasHTML?a.tipTitle.innerHTML=d:a.tipTitle.innerHTML=ZDBEscapeUtil.encodeForHtml(d);return!1},this.showTooltip=function(a,b){var c=a.parentNode,d=ZDBUtil.getObjLeft(c)+c.offsetWidth+10,e=ZDBUtil.getObjTop(a)+10,f=$(b);f.style.position="absolute",f.style.top=e+"px",f.style.left=d+"px",this.tooltipDiv=f,document.body.appendChild(f),f.style.display=""},this.hideTooltip=function(a){var b=$(a);b.style.display="none"},this.showViewDet=function(a){a==null&&(a=window.event);var b=$("ZDBViewDet");ZDBToolTip.setViewDet(this),document.body.appendChild(b),b.style.display="";var c=ZDBUtil.getElementAbsoluteLeft(this)+18,d=ZDBUtil.getElementAbsoluteTop(this)+25;d+b.offsetHeight>=document.body.offsetHeight&&(d=a.clientY-b.offsetHeight-10),b.style.left=c+"px",b.style.top=d+"px",b.style.position="absolute"},this.setViewDet=function(a){var b=$("ZDBViewDetTbl"),c="",d=ZDBUtil.getParentWithTagName(a,"tr").getElementsByTagName("input");for(var e=0;e<d.length;e++)d[e].getAttribute("id")=="ZDBViewDetails"&&(c=d[e]);ZDBUtil.setNamedChildEls(b,b),b.createby.innerHTML=ZDBToolTip.removeEmptyNodeInTbl(c.getAttribute("created_by"),b.createby),b.lastDataMod.innerHTML=ZDBToolTip.removeEmptyNodeInTbl(c.getAttribute("lastdatamodify"),b.lastDataMod),b.lastDesignMod.innerHTML=ZDBToolTip.removeEmptyNodeInTbl(c.getAttribute("last_des_modify"),b.lastDesignMod),b.sharedby.innerHTML=ZDBToolTip.removeEmptyNodeInTbl(c.getAttribute("sh_by"),b.sharedby)},this.removeEmptyNodeInTbl=function(a,b){var c=b.parentNode;if(a&&a.split(",")[0])return c.style.display="",a;c.style.display="none"},this.show=function(a,b,c,d,e){if(a.getAttribute("isError")=="true"){ZDBToolTip.showError(a,b,c);return}if(a.getAttribute("blocked")=="true")return;parentEl=jQuery("#ZRSToolTip")[0],ZDBUtil.setNamedChildEls(parentEl,parentEl,"elname"),ZDBUtil.attachEvent(parentEl,"mouseover",function(a){ZDBUtil.stopEventBubble(a)});var f=parentEl.tipContent,g=parentEl.tipPointer;a=jQuery(a);var h=a.attr("noencode")==="true",i=a.attr("tip");f.innerHTML=h?i:ZDBEscapeUtil.encodeForHtml(i),ZDBToolTip.position(a,b,c),d&&(g.className="ZRSTipTemStyle");if(e){var j=jQuery(parentEl.tipHeader),k=jQuery(parentEl.tipContent2),l=jQuery(parentEl.tipExample),m=jQuery(parentEl.tipLink),n=jQuery(parentEl.tipHeaderContainer),o=a.attr("tipHeaderDesc"),p=a.attr("tipdesc2"),q=a.attr("example"),r=a.attr("tipshortcut");o&&(j.html(h?o:ZDBEscapeUtil.encodeForHtml(o)),n.show()),p&&(k.html(h?p:ZDBEscapeUtil.encodeForHtml(p)),k.show()),q&&(l.html(h?q:ZDBEscapeUtil.encodeForHtml(q)),l.show()),r&&(m.html(h?r:ZDBEscapeUtil.encodeForHtml(r)),n.show()),parentEl=jQuery(parentEl),parentEl.stop(!0,!0);var s=parentEl.css("top");s=parseInt(s.slice(0,s.length-2)),parentEl.css("top",s+5+"px"),parentEl.hide().fadeIn(1e3,"swing");return}a.attr("tipdesc")&&ZDBToolTip.insertDesc(a),parentEl=jQuery(parentEl),parentEl.stop(!0,!0),parentEl.show()},this.showError=function(a,b,c){if(a.getAttribute("blocked")=="true")return;parentEl=jQuery("#ZRSToolTipError")[0],ZDBUtil.setNamedChildEls(parentEl,parentEl,"elname"),ZDBUtil.attachEvent(parentEl,"mouseover",function(a){ZDBUtil.stopEventBubble(a)});var d=parentEl.tipContentError,e=parentEl.tipPointerError;a=jQuery(a);var f=a.attr("noencode")==="true",g=a.attr("tip");d.innerHTML=f?g:ZDBEscapeUtil.encodeForHtml(g),ZDBToolTip.positionError(a,b,c),a.attr("tipdesc")&&ZDBToolTip.insertDesc(a),parentEl=jQuery(parentEl),parentEl.stop(!0,!0),parentEl.show()},this.insertDesc=function(a){var b=$("ZRSToolTipContent");jQuery(b).empty();var c=a.attr("tip"),d=a.attr("tipdesc"),e=document.createElement("span");e.innerHTML=d,e.className="content",b.innerHTML="<b>"+c+"</b>",b.appendChild(e)},this.checkLengthAndShow=function(a,b,c){a.scrollWidth>a.clientWidth&&ZDBToolTip.show(a,b,c)},this.computePointerPos=function(a,b,c,d){var e=a.height(),f=a.width();c=BROWSER.IE?window.event:c;var g=b.offset().left?b.offset():{left:c.clientX,top:c.clientY},h=b.outerWidth(),i=b.outerHeight(),j=jQuery(window).width(),k=jQuery(window).height(),l=15,m=20,n=j-g.left,o=k-g.top,p=.5,q=0,r=0,s="";d||(o>e+i+l+m&&n>f+h/2-f*p+m?d="BOTTOM":g.top>e+l+m&&n>f+h/2-f*p+m?d="TOP":o>e-e*p+m&&n>f+h+l+m?d="RIGHT":d="LEFT");switch(d){case"TOP":s="ZRSTipPointerBottom",r=g.top-e-l,q=g.left+h/2-f*p;break;case"BOTTOM":s="ZRSTipPointerTop",r=g.top+i+l,q=g.left+h/2-f*p;break;case"RIGHT":s="ZRSTipPointerLeft",r=g.top+i*p-e*p,q=g.left+h+l;break;case"LEFT":s="ZRSTipPointerRight",r=g.top+i*p-e*p,q=g.left-f-l;break;case"SCASE":s="ZRSTipPointerBottom",r=g.top-e-l,q=g.left-f*p;break;case"NAVIG":s="ZRSTipPointerLeft",r=g.top+i*p-e*p,q=g.left+h+l+20}return[q,r,s]},this.position=function(a,b,c){var d=jQuery("#ZRSToolTip");d.parentNode!=document.body&&document.body.appendChild(d[0]);var e=this.computePointerPos(d,a,b,c),f=e[0],g=e[1];f=f>0?f:0,g=g>0?g:0,d.css({left:f,top:g}),$("ZRSTipPointer").className=e[2]},this.positionError=function(a,b,c){var d=jQuery("#ZRSToolTipError");d.parentNode!=document.body&&document.body.appendChild(d[0]);var e="",f=.5,g=0,h=0,i=d.height(),j=d.width();b=BROWSER.IE?window.event:b;var k=a.offset().left?a.offset():{left:b.clientX,top:b.clientY},l=a.outerWidth(),m=a.outerHeight(),n=jQuery(window).width(),o=jQuery(window).height(),p=15,q=20,r=n-k.left,s=o-k.top;c?(e="ZRSTipPointerBottomError",h=k.top-i-p,g=k.left-j*f):s>i+m+p+q&&r>j+l/2-j*f+q?(e="ZRSTipPointerTopError",h=k.top+m+p,g=k.left+l/2-j*f):k.top>i+p+q&&r>j+l/2-j*f+q?(e="ZRSTipPointerBottomError",h=k.top-i-p,g=k.left+l/2-j*f):s>i-i*f+q&&r>j+l+p+q?(e="ZRSTipPointerLeftError",h=k.top+m*f-i*f,g=k.left+l+p):(e="ZRSTipPointerRightError",h=k.top+m*f-i*f,g=k.left-j-p),g=g>0?g:0,h=h>0?h:0,d.css({left:g,top:h}),$("ZRSTipPointerError").className=e},this.hide=function(a,b){jQuery("#ZRSToolTipContent2, #ZRSToolTipExample, #ZRSHeaderContainer").hide(),b?(jQuery("#ZRSToolTip").hide(),jQuery("#ZRSToolTipError").hide()):(jQuery("#ZRSToolTip").fadeOut(),jQuery("#ZRSToolTipError").fadeOut())}},ZDBAlertAPI=new function(){this.showErrorMsg=function(a,b,c){this.lastErrorMsg=a,this.showMsg(a,"ZDBERROR",b,null,c);var d=ZDBClientUI.getViewObj($("ZDBAnalysisViewTpl"),"view");c=="\nDROP_X_Y\n"&&ZDBAnalysisEditViewMode.switchView(d.graphButton)},this.showMsg=function(a,b,c,d,e,f,g,h){var i=new Object;i.msg=a,i.msgType=b,i.requestOptions=c,i.objId=h,i.title=d,i.errorCode=e,i.ownFrame=f,i.iconType=g,ZDBAlertAPI.alerts||(ZDBAlertAPI.alerts=new Array),ZDBAlertAPI.alerts.push(i);var j=ZDBAlertAPI.alerts.length;if(j>1)return;this.showAlertMsg(ZDBAlertAPI.alerts[0].msg,ZDBAlertAPI.alerts[0].msgType,ZDBAlertAPI.alerts[0].requestOptions,ZDBAlertAPI.alerts[0].title,ZDBAlertAPI.alerts[0].errorCode,ZDBAlertAPI.alerts[0].ownFrame,ZDBAlertAPI.alerts[0].iconType,ZDBAlertAPI.alerts[0].objId)},this.showAlertMsg=function(a,b,c,d,e,f,g,h){ZDBAlertAPI.ALERTDIV==null&&(ZDBAlertAPI.ALERTDIV=document.getElementById("ZDBALERT"),ZDBAlertAPI.MSGDIV=document.getElementById("ZDBMSG"),ZDBAlertAPI.ZDBERRORTR=document.getElementById("ZDBERRORTR"),ZDBAlertAPI.ZDBSAVETR=document.getElementById("ZDBSAVETR"),ZDBAlertAPI.ZDBYESNOTR=document.getElementById("ZDBYESNOTR"),ZDBAlertAPI.ZDBALERTICON=document.getElementById("ZDBALERTICON"),ZDBAlertAPI.ZDBREFRESHNOTR=document.getElementById("ZDBREFRESHNOTR")),ZDBAlertAPI.requestOptions=c,ZDBAlertAPI.objId=h;if(!c||c.PRESERVENEWLINE!==!0){var i=new RegExp("\n","g");a=a.trim().replace(i,"<br/>")}ZDBAlertAPI.MSGDIV.innerHTML=a,ZDBAlertAPI.ALERTDIV.className=b,d==null&&(d=ZDBI18NMap.g("zrpt.common.zdbalertmsg.js.dlgTtl")),b=b?b:"ZDBERROR",e=e!=null?trimAll(e):"",ZDBAlertAPI.MSGDIV.setAttribute("zdberrorcode",e),ZDBAlertAPI.msgType=b,ZDBAlertAPI.ZDBERRORTR.className=b=="ZDBERROR"?"":"hideelement",ZDBAlertAPI.ZDBSAVETR.className=b=="ZDBSAVE"?"":"hideelement",ZDBAlertAPI.ZDBYESNOTR.className=b=="ZDBYESNO"?"":"hideelement",ZDBAlertAPI.ZDBREFRESHNOTR.className=b=="ZDBREFRESHNO"?"":"hideelement",ZDBAlertAPI.ZDBALERTICON.className=g=="status"?"statusIcon iconitem2":"alert iconbg",ZDBUtil.setNamedChildEls(ZDBAlertAPI.ALERTDIV,ZDBAlertAPI.ALERTDIV),jQuery(ZDBAlertAPI.ALERTDIV).width(c!=null&&c.WIDTH?c.WIDTH:"350px");var j=c!=null?c.VIEW:null,k={TITLE:d,SHADOW:!0,MODAL:!0,ZINDEX:16e3,VIEW:j,ONCLOSE:ZDBAlertAPI.onEscape,ORIGREQOPTIONS:c};c&&c.CALLOUT&&(k.CALLOUT=c.CALLOUT,k.SRCEL=c.SRCEL);if(f!=null){var l=ZDBUtil.getCachedRef(this,f+"Dlg"),m=$(f+"Content");ZDBDialogUtil.showDialog(l,k)}else k.ADDFRAME=!0,ZDBDialogUtil.showDialog(ZDBAlertAPI.ALERTDIV,k)},this.onOptionClick=function(a,b){ZDBClientUI.dontShowAutoGenDlg=document.getElementById("ZDBAutoGenCheckBox");try{b!=1&&ZDBDialogUtil.closeDialog(null,null,a),ZDBAlertAPI.requestOptions!=null&&ZDBAlertAPI.requestOptions["ONCLICK"]!=null&&ZDBAlertAPI.requestOptions.ONCLICK(a,ZDBAlertAPI.requestOptions,ZDBAlertAPI.objId)}finally{var c=ZDBAlertAPI.alerts.length;c>0&&(ZDBAlertAPI.alerts.shift(ZDBAlertAPI.alerts[0]),c>1&&ZDBAlertAPI.openNextAlert(ZDBAlertAPI.alerts[0])),ZDBAlertAPI.requestOptions=null,ZDBAlertAPI.msgType=null}},this.openNextAlert=function(a){this.showAlertMsg(a.msg,a.msgType,a.requestOptions,a.title,a.errorCode,a.ownFrame)},this.onEscape=function(a,b){return b!=null?!0:(b="NO",ZDBAlertAPI.msgType=="ZDBSAVE"&&(b="CANCEL"),ZDBAlertAPI.onOptionClick(b,!0),ZDBAlertAPI.ALERTDIV.viewObj=null,!0)}};MCEffect.CONFIG.INTERVAL=2,StatusMsgAPI.showMsg=function(a,b,c,d){b?ZDBMsgBox.showSuccess(a):ZDBAlertAPI.showMsg(a,"ZDBERROR")},StatusMsgAPI.showErrorMsg=function(a){ZDBAlertAPI.showErrorMsg(a)},AjaxAPI.ONFAILUREFUNCHANDLED=!0,AjaxAPI.onFailureFunc=function(a,b){var c=a.getResponsePart("STATUS_MESSAGE"),d=a.getResponsePart("ERRORCODE");d==""&&(d=null);if(c==null){var e=a.getResponseStatus(),f=a.getResponseStatusText();f!=null&&f!="Unknown"?c=f:e>=400&&e<500?c="Bad Http Request":e>=500&&e<600?c="Internal Server Error.":c=AjaxAPI.getErrorMsgFromCode(e),c==null&&(c="Error Occurred.");var g=b.ERRORPREFIX;g==null&&(g="Unable to process the request.<br> Reason : "),c=g+c+"<br>(Code : "+e+")"}if(d!=null&&d.trim()=="FEATURE_DISABLED"){var h=c.split(";");h[1]="<B>"+(new Date(h[1])).toLocaleString()+"</B>",h[3]="<B>"+(new Date(h[3])).toLocaleString()+"</B>",c=h.join("")}var i=["EXCEEDING_USR_PLN_ROWCOUNT","EXCEEDING_USR_PLN_DBCOUNT","EXCEEDING_USR_PLN_QTCOUNT","EXCEEDING_USR_PLN_USRCOUNT","ROWCNT_VIOLATION_CREATE_TBL","TRIAL_NOT_ALLOWED","ROWCNT_VIOLATION_COPY_DB","MULTIPLE_DBOWNERS_NOT_ALLOWED","QTCNT_VIOLATION_COPY_DB","SCH_IMPORT_NOT_ALLOWED","USRCOUNT_VIOLATION_USRACTIVATE","HACKING_MANAGE_QUERYTABLE_TAB","REBRAND_NOT_ALLOWED","BACKUP_NOT_ALLOWED","NO_EXTRA_USERS_FOR_FREE_PLAN","DEACTIVATED_QRY_TABLE","EXCEEDING_USR_PLN_REPORTCOUNT","REPORTCNT_VIOLATION_COPY_DB","REGENERATE_VIOLATION","PUBLISHCNT_VIOLATION","SHARING_TO_DBGROUP_VIOLATION","CREATE_DBGROUP_VIOLATION","EXCEEDING_USR_PLN_SCHMAILCOUNT","SCHMAIL_NOTSUPPORTED","MAIL_NOTSUPPORTED","PUBLIC_DB_LISTING_REMOVAL_NOT_ALLOWED","ZOHO_PROJECTS_INTEG_NOT_ALLOWED","GANALYTICS_MULTI_CLIENT_NOT_ALLOWED","SLIDESHOW_NOT_ALLOWED"],j=["INVALID_PLANID","INVALID_USERID","PLAN_CHANGE_FAILED","TRIAL_REQUEST_FAILED","TRIAL_DOWNGRADE_FAILED","PLAN_CHANGE_PAYMENT_FAILED"];if(AjaxAPI.isPricingErrorCode(i,d)){var h=c.split(";");if(h[1]!=null){var k=ZDBI18NMap.g("zrpt.domain.pricing.js.upgradelink")||"/ZDBPricing.cc?SHOWPAGE=PricingPlan&STRUCT=true&ZDBACTION=PRICINGPLANS";k=ZDBGlobal.REPORTS_CONTEXT_NAME+k,ZDBGlobal.isCRMPlusUser?(k=ZDBGlobal.crmPlusUpgradeLink,h[1]='<a href="'+k+'">'+h[1]+"</a>"):ZDBGlobal.isOldCRMPlusUser||(h[1]='<a href="'+k+'">'+h[1]+"</a>"),c=h.join("")}}else if(d!=null&&d.trim()=="USER_NOT_EXISTS_IN_CRMPLUS"){var h=c.split(";");h[1]!=null&&(h[1]='<a href="'+ZDBGlobal.crmPlusManageUsersLink+'" target="_blank"">'+h[1]+"</a>"),c=h.join("")}else if(d!=null&&d.trim()=="SHARE_TO_DEACTIVATED_USR"){var h=c.split(";");if(h[1]!=null)if(ZDBGlobal.isCRMPlusUser)h[1]='<a href="'+ZDBGlobal.crmPlusManageUsersLink+'" target="_blank">'+h[1]+"</a>";else{var l=ZDBGlobal.REPORTS_CONTEXT_NAME+"/ZDBPricing.cc?SHOWPAGE=ManageUsers&STRUCT=true&ZDBACTION=MANAGEUSERS";h[1]='<a href="'+l+'">'+h[1]+"</a>"}c=h.join("")}else if(AjaxAPI.isPricingErrorCode(j,d)){var h=c.split(":");h[1]='<a href="mailto:'+h[1]+'">'+h[1]+"</a>",c=h.join("")}ZDBAlertAPI.showErrorMsg(c,null,d),b.ONFAILURECLEANUPFUNC&&b.fn("ONFAILURECLEANUPFUNC")(a,b)},AjaxAPI.isPricingErrorCode=function(a,b){if(b==null)return!1;for(var c=0;c<a.length;c++){var d=a[c];if(b.trim()==d)return!0}return!1},AjaxAPI.getErrorMsgFromCode=function(a){var b=ZDB_ERROR_CODES["XHRERR_"+a];return b!=null?b[1]:null},window.onerror=globalErrorHandler,setInterval(this.saveJSErrorsToServer,3e5),AjaxUtils.extractFromResponse=function(a,b){var c=a.length>1e3?a.length-1e3:0;c=a.indexOf(b+"_START",c),c==-1&&(c=a.length>1e3?1e3:a.length,c=a.lastIndexOf(b+"_START",c));if(c==-1)return null;c=c+b.length+"_START".length;var d=a.indexOf(b+"_END",c);return c==-1?null:a.substring(c,d)},AjaxUtils.handleReLogin=function(a,b){ZDBAlertAPI.showErrorMsg("You seem to have signed out. Please refresh the page to login again.")},AjaxAPI.checkAttrForInvokeScript=!0,AjaxAPI.statusSearchIndex=200,window.findPosX==null&&(findPosX=ZDBUtil.getObjLeft,findPosY=ZDBUtil.getObjTop,getCursorPos=ZDBUtil.getCursorPos);var MCFrame=new function(){this.getMCFrame=function(){return null}},ZDB_ERROR_CODES={XHRERR_12178:["COMM","The proxy for the specified URL cannot be located."],XHRERR_12180:["BROWSER","Unable to discover the URL of the Proxy Auto-Configuration (PAC) file."],XHRERR_12166:["COMM","An error occurred executing the script code in the Proxy Auto-Configuration (PAC) file."],XHRERR_12029:["COMM","Connection to the server failed."],XHRERR_12103:["SCRIPT","Internal Script Error"],XHRERR_12102:["SCRIPT","Internal Script Error"],XHRERR_12100:["SCRIPT","Internal Script Error"],XHRERR_12101:["SCRIPT","Internal Script Error"],XHRERR_12183:["COMM","Communication Error during Parsing Response."],XHRERR_12044:["COMM","Server requires client authentication."],XHRERR_12030:["COMM","The connection with the server has been reset or terminated."],XHRERR_12007:["COMM","The server name cannot be resolved!!.Network connection could be down."],XHRERR_12181:["SERVER","Too many headers in response."],XHRERR_12150:["SERVER","A requested header not found."],XHRERR_12182:["SERVER","Headers in response exeeded the request limit."],XHRERR_12152:["SERVER","The server response cannot be parsed."],XHRERR_12005:["SCRIPT","The URL is not valid."],XHRERR_12015:["SCRIPT","Login Failure."],XHRERR_12019:["BROWSER","Internal Browser Error"],XHRERR_12018:["BROWSER","Internal Browser Error"],XHRERR_12004:["BROWSER","Internal Browser Error"],XHRERR_12009:["SCRIPT","Internal Script Error"],XHRERR_12017:["SCRIPT","Operation canceled"],XHRERR_12011:["SCRIPT","Internal Script Error"],XHRERR_12156:["SCRIPT","Redirection failed"],XHRERR_12032:["SCRIPT","Request Failed. Retry after sometime"],XHRERR_12184:["BROWSER","Response Size exceeds WinHTTP limit"],XHRERR_12038:["AUTH","SSL Certificate failure"],XHRERR_12037:["AUTH","SSL Certificate failure"],XHRERR_12057:["AUTH","SSL Certificate failure"],XHRERR_12170:["AUTH","SSL Certificate failure"],XHRERR_12179:["AUTH","SSL Certificate failure"],XHRERR_12157:["AUTH","Secure Channel failure"],XHRERR_12175:["AUTH","Server SSL Certificate failure"],XHRERR_12045:["AUTH","SSL Certificate Not trusted"],XHRERR_12169:["AUTH","SSL Certificate Invalide"],XHRERR_12012:["BROWSER","The WinHTTP shut down."],XHRERR_12002:["COMM","The request has timed out."],XHRERR_12167:["BROWSER","Proxy Auto-Configuration (PAC) file cannot be downloaded."],XHRERR_12006:["SCRIPT","The request URL specified a scheme other than 'http' or 'https'"],XHRERR_999999:["COMM","Communication Error"],ZDBMETA_DUPLICATEDBNAME:["USERINP","Already a database with the same name exists."]};ZDBSuggestionBox.prototype.initSB=function(a){var b=this.inputEl;b.sbObj=this,b.cellObj.colObj.sbObj=this,a&&(ZDBUtil.attachEvent(b,"keyup",ZDBSuggestionBox.suggestKeyUp,!0),ZDBUtil.attachEvent(b,"keydown",ZDBSuggestionBox.suggestKeyDown,!0)),this.inputEl.onclick=ZDBSuggestionBox.showAllSuggestion,this.createDropDown(),this.expandDefault&&this.requestSuggestions(!0),ZDBUtil.attachEvent(document,"mouseup",ZDBSuggestionBox.mouseUp,!0),ZDBSuggestionBox.showAllRefColSuggestion(b)},ZDBSuggestionBox.showAllSuggestion=function(a){var b=ZDBUtil.getSourceElement(a),c=b.sbObj;if(!c)return;c.autoSuggest(c.suggestData,!1)},ZDBSuggestionBox.showAllRefColSuggestion=function(a){var b=a.sbObj;if(!b)return;b.autoSuggest(b.suggestData,!1)},ZDBSuggestionBox.prototype.closeSB=function(){},ZDBSuggestionBox.suggestBlur=function(a){var b=ZDBUtil.getSourceElement(a),c=b.sbObj;if(c==null||c==undefined)return;if(BROWSER.FIREFOX&&a.keyCode==null&&a.keyCode==undefined&&a.explicitOriginalTarget.nodeName=="INPUT")return!1;if(c){if(c.isMouseDown||c.isIconClick)return!1;var d=ZDBEditors.getEditField("LCDropDown");ZDBEditors.hideElements([d,b]),ZDBUtil.detachEvent(b,"keyup",ZDBSuggestionBox.suggestKeyUp,!0),ZDBUtil.detachEvent(b,"keydown",ZDBSuggestionBox.suggestKeyDown,!0),c.hideSuggestions(),c.closeSB()}return!0},ZDBSuggestionBox.prototype.createDropDown=function(){dropList=document.createElement("div"),dropList.className="zdbSBDropList",dropList.style.width=this.inputEl.offsetWidth-4+"px",dropList.sbObject=this,dropList.onmousedown=ZDBSuggestionBox.mouseDown,dropList.onmouseover=ZDBSuggestionBox.mouseOver,this.inputEl.parentNode.appendChild(dropList),this.dropList=dropList},ZDBSuggestionBox.mouseDown=function(a){var b=ZDBUtil.getSourceElement(a),c=ZDBUtil.getPropertyFromEl(b,"sbObject","object");c&&(c.isMouseDown=!0)},ZDBSuggestionBox.mouseOver=function(a){var b=ZDBUtil.getSourceElement(a),c=ZDBUtil.getPropertyFromEl(b,"sbObject","object");c&&b.isListItem&&c.highlight(b)},ZDBSuggestionBox.mouseUp=function(a){var b=ZDBUtil.getSourceElement(a),c=ZDBUtil.getPropertyFromEl(b,"sbObject","object");if(b.isListItem&&c)c.isMouseDown=!1,c.inputEl.value=b.innerHTML,c.hideSuggestions(),c.inputEl.style.display!="none"&&c.inputEl.focus();else if(c&&b==c.dropList)return ZDBConst.BROWSER_HANDLE_YES;c&&(c.isMouseDown=!1)},ZDBSuggestionBox.prototype.highlight=function(a){var b=this.dropList.getElementsByTagName("div"),c=b.length;for(var d=0;d<c;++d)b[d]==a?b[d].className=ZDBSuggestionBox.selectClass:b[d].className!=ZDBSuggestionBox.normalClass&&(b[d].className=ZDBSuggestionBox.normalClass)},ZDBSuggestionBox.prototype.hideSuggestions=function(){this.dropList.style.display="none",ZDBUtil.detachEvent(document,"mouseup",ZDBSuggestionBox.mouseUp,!0)},ZDBSuggestionBox.prototype.showSuggestions=function(a){var b=this.dropList,c=this.inputEl,d=document.createElement("div");d.className="zdbSBNormalOption",d.isListItem=!0,b.innerHTML="";var e=a.length,f;for(var g=0;g<e;g++)f=d.cloneNode(!0),f.isListItem=!0,f.innerHTML=ZDBEscapeUtil.encodeForHtml(a[g]),b.appendChild(f);b.style.display="block";var h=e*f.offsetHeight;h>150&&(h=150),b.style.height=h+"px",ZDBSuggestionBox.posSuggestion(c,b),ZDBUtil.attachEvent(document,"mouseup",ZDBSuggestionBox.mouseUp,!0)},ZDBSuggestionBox.posSuggestion=function(a,b){var c=a.cellObj.colObj.parGrid.dArea,d=b.offsetHeight,e=parseInt(a.style.top,10),f=a.offsetHeight,g=0;d+e+f>=c.offsetHeight?(g=e-d-2,g<0&&(b.style.height=parseInt(b.style.height)+g,g=0),b.className="zdbSBDropList zdbSBDropListTopPos"):(g=e+f,b.className="zdbSBDropList zdbSBDropListBotPos"),b.style.left=a.style.left,b.style.top=g+"px"},ZDBSuggestionBox.prototype.typeAhead=function(a){var b=this.inputEl;if(b.createTextRange||b.setSelectionRange){var c=b.value.length;b.value=b.value+a.substring(b.value.length),this.selectRange(c,a.length)}},ZDBSuggestionBox.prototype.selectRange=function(a,b){var c=this.inputEl;if(c.createTextRange){var d=c.createTextRange();d.moveStart("character",a),d.moveEnd("character",b-c.value.length),d.select()}else c.setSelectionRange&&c.setSelectionRange(a,b);c.focus()},ZDBSuggestionBox.prototype.nextSuggestion=function(){var a=this.dropList.getElementsByTagName("DIV");if(a.length>0){this.curIndex=(this.curIndex+1)%a.length;var b=a[this.curIndex];this.highlight(b),this.inputEl.value=b.innerHTML}else this.curIndex=++this.curIndex%this.suggestData.length,this.inputEl.value=this.suggestData[this.curIndex]},ZDBSuggestionBox.prototype.previousSuggestion=function(){var a=this.dropList.getElementsByTagName("DIV");if(a.length>0){--this.curIndex,this.curIndex<0&&(this.curIndex=a.length-1);var b=a[this.curIndex];this.highlight(b),this.inputEl.value=b.innerHTML}else--this.curIndex,this.curIndex<0&&(this.curIndex=this.suggestData.length-1),this.inputEl.value=this.suggestData[this.curIndex]},ZDBSuggestionBox.prototype.requestSuggestions=function(a,b){var c=[],d=this.inputEl.value,e=this.suggestData,f=e.length;if(d.length>0)for(var g=0;g<f;g++)e[g].toLowerCase().indexOf(d.toLowerCase())==0&&c.push(e[g]);if(this.listMode&&c.length==0&&d!=""){this.inputEl.value=d.substring(0,d.length-1),d.length>1&&this.requestSuggestions(a);return}if(d==""&&this.showAllOnBlank){for(var g=0;g<f;++g)c.push(e[g]);a=!1}b&&this.autoSuggest(c.sort(),a)},ZDBSuggestionBox.prototype.resetData=function(a){this.suggestData=a},ZDBSuggestionBox.prototype.autoSuggest=function(a,b){a.length>0?(b&&this.typeAhead(a[0]),this.showSuggestions(a)):this.hideSuggestions()},ZDBSuggestionBox.suggestKeyDown=function(a){var b=ZDBUtil.getSourceElement(a),c=b.sbObj;if(c==null)return;var d=ZDBUtil.getGridKeyUpEvent(a);if(!c)return!0;switch(ZDBUtil.getKeyCode(a)){case KEY.UPARROW:return c.previousSuggestion(),!1;case KEY.DOWNARROW:return c.nextSuggestion(),!1;case KEY.ENTER:return BROWSER.FIREFOX?ZDBEditors.onEditorBlur(b,a):(ZDBSuggestionBox.suggestBlur(a),b.blur()),ZDBEditors.callGridMove(b.cellObj,ZDBUtil.getKeyCode(a),d.shiftPressed,d.ctrlPressed,d.altPressed,d.cmdPressed)}return!0},ZDBSuggestionBox.suggestKeyUp=function(a){var b=ZDBUtil.getSourceElement(a),c=b.sbObj;if(c==null)return;var d=ZDBUtil.getKeyCode(a),e=d!=KEY.UPARROW&&d!=KEY.DOWNARROW&&d!=KEY.ENTER;return d==KEY.BACKSPACE||d==KEY.DEL?c.requestSuggestions(!1,e):c.requestSuggestions(!0,e),!0},ZDBSuggestionBox.normalClass="zdbSBNormalOption",ZDBSuggestionBox.selectClass="zdbSBSelectOption";var ZDBMsgBox=new function(){this.eleID="ZDBMsgDiv",this.interval=5e3,this.crId=null,this.slideStarted=!1,this.nextError=null,this.className={error:"ZRSNError",success:"ZRSNSuccess",info:"ZRSNInfo",notification:"ZRSNInfo"},this.showErrorIfNeeded=function(a){a&&a.isError()&&ZDBMsgBox.showError(a.errorMsg)},this.showError=function(a){this.showHintMsg(a,"error")},this.showSuccess=function(a){this.showHintMsg(a,"success")},this.showInfo=function(a){this.showHintMsg(a,"info")},this.showHintMsg=function(a,b,c){this.messagetype=b,this.content=document.getElementById(this.eleID),document.body.appendChild(this.content);if(this.content==null)return;if(a!=null){var d=jQuery(".ZRSNotifyMessage"),e=d.closest(".ZRSNotification"),f=this.className[this.messagetype];e[0].className="ZRSNotification "+f,d.html(a),this.content.style.left=jQuery(window).width()/2-jQuery(this.content).width()/2+"px",this.crId!=null&&(clearTimeout(this.crId),this.crId=null),this.slideStarted?this.nextError=a:(this.content.style.display=="none"&&MCEffect.SlideDown(this.eleID),c||(c=this.interval),this.temp(this.eleID,a,c))}a==null&&this.content.style.display=="block"&&(clearTimeout(this.crId),this.crId=null,MCEffect.SlideUp(this.eleID,{ONCLOSE:ZDBMsgBox.checkNext}))},this.checkNext=function(){ZDBMsgBox.slideStarted=!1;if(ZDBMsgBox.nextError){var a=ZDBMsgBox.nextError;ZDBMsgBox.nextError=null,ZDBMsgBox.showError(a)}},this.temp=function(a,b,c){this.slideStarted=!1,this.crId=window.setTimeout(ZDBMsgBox.hideError,c)},this.hideError=function(){ZDBMsgBox.slideStarted=!0,ZDBMsgBox.currentTimeoutId=null,MCEffect.SlideUp(ZDBMsgBox.eleID,{ONCLOSE:ZDBMsgBox.checkNext}),clearTimeout(ZDBMsgBox.crId)},this.showViewSavedMsg=function(a){ZDBMsgBox.showSuccess(ZDBI18NMap.f("zrpt.common.toolbar.successmsg.js.saveSuccess",ZDBEscapeUtil.encodeForHtml(a)))},this.handleZPMsgBox=function(){var a=$("ZPMsgBox");jQuery(a).slideToggle("slow","linear")}},ZDBMenuUtil=new function(){this.curMenuEl=null,this.subMenuEl=null,this.minMenuHeight=10,this.clearAndSetPopupPosition=function(a,b){a.style.visibility="hidden",a.style.right="auto",a.style.bottom="auto",ZDBMenuUtil.setPopupPosition(a,b),a.style.visibility="visible"},this.setPopupPosition=function(a,b){b.event||(b=window.event!=null?window.event:b),ZDBMenuUtil.setPopupPositionWithOffset(a,b.clientX,b.clientY,0)},this.setPopupPositionWithOffset=function(a,b,c,d){var e=ZDBMenuUtil.getPopupPositionWithOffset(a.offsetWidth,a.offsetHeight,b,c,d);a.style.top=e.top,a.style.left=e.left,a.style.bottom=e.bottom,a.style.right=e.right},this.getPopupPositionWithOffset=function(a,b,c,d,e){var f,g,h={left:"auto",right:"auto",top:"auto",bottom:"auto"};BROWSER.IE?(f=document.body.clientWidth-c,g=document.body.clientHeight-d):(f=window.innerWidth-c,g=window.innerHeight-d);var i=a+e,j=b+e,k,l,m,n;return i>f?h.right="0px":h.left=c+"px",j>g?h.bottom="0px":h.top=d+"px",h},this.closeSubMenu=function(){ZDBMenuUtil.subMenuEl!=null&&(ZDBMenu.removeIframe(ZDBMenuUtil.subMenuEl),ZDBMenuUtil
.subMenuEl.style.display="none",ZDBMenuUtil.subMenuEl=null,ZDBUtil.detachEvent(document,"click",ZDBMenuUtil.closeSubMenu,!1))},this.checkAndClose=function(a){var b=BROWSER.IE?window.event.keyCode:a.which;b==27&&(ZDBMenuUtil.subMenuEl!=null?ZDBMenuUtil.closeSubMenu():ZDBMenuUtil.closeMenu())},this.closeMenu=function(a){var b=a?a.target:null;if(ZDBMenuUtil.curMenuEl!=null){if(ZDBMenuUtil.curMenuEl.isExportSpecific){ZDBMenuUtil.curMenuEl.hide(),ZDBMenuUtil.curMenuEl=null;return}if(ZDBMenuUtil.curMenuEl.onCloseFunc!=null)ZDBMenuUtil.curMenuEl.onCloseFunc();else{var c=ZDBMenuUtil.curMenuEl.srcEl;c!=null&&(ZDBMenu.zdbHighLighter(c,c.getAttribute("baseclass"),""),ZDBUtil.attachEvent(c,"mouseover",ZDBMenuUtil.highLightOver,!1),ZDBUtil.attachEvent(c,"mouseout",ZDBMenuUtil.highLightOut,!1))}ZDBMenuUtil.curMenuEl.menuItemEl!=null&&ZDBMenuUtil.setClass(ZDBMenuUtil.curMenuEl.menuItemEl),ZDBUtil.detachEvent(ZDBMenuUtil.curMenuEl,"mouseover",ZDBMenuUtil.onMouseOver,!1),ZDBUtil.detachEvent(ZDBMenuUtil.curMenuEl,"mouseout",ZDBMenuUtil.onMouseOut,!1),ZDBMenu.removeIframe(ZDBMenuUtil.curMenuEl),ZDBMenuUtil.closeSubMenu(),ZDBToolTip.hideTip(),ZDBUtil.detachEvent(document,"keydown",ZDBMenuUtil.checkAndClose,!1),ZDBUtil.detachEvent(ZDBMenuUtil.curMenuEl,"contextmenu",ZDBUtil.stopEventBubble,!1),ZDBUtil.detachEvent(document,"click",ZDBMenuUtil.closeMenu,!1),ZDBMenuUtil.curMenuEl.style.display="none",ZDBMenuUtil.curMenuEl.onCloseFunc=null,ZDBMenuUtil.curMenuEl=null}},this.highLightOver=function(a){var b=ZDBUtil.getSourceElement(a);ZDBMenu.zdbHighLighter(b,b.getAttribute("baseclass"),"hover")},this.highLightOut=function(a){var b=ZDBUtil.getSourceElement(a);ZDBMenu.zdbHighLighter(b,b.getAttribute("baseclass"),""),ZDBToolTip.hideTip()},this.onMouseOver=function(a){ZDBMenuUtil.setClassName(a,"menuitem_mouseover")},this.onMouseOut=function(a){ZDBMenuUtil.setClassName(a),ZDBToolTip.hideTip()},this.setClassName=function(a,b){var c=ZDBUtil.getSourceElement(a);ZDBMenuUtil.curMenuEl!=null&&(ZDBMenuUtil.curMenuEl.menuItemEl=c,ZDBMenuUtil.setClass(c,b))},this.setClass=function(a,b){while(a.parentNode&&a.parentNode.tagName!="TR")a=a.parentNode;if(!a.parentNode)return;var c=a.parentNode.childNodes;for(var d=0;d<c.length;d++){a=c[d];if(a.getAttribute){var e=a.getAttribute("menuitemclass");if(e!=null){var f=e;b&&(f=f+" "+b),a.className=f}}}},this.positionEl=function(a,b,c){a.style.visibility="hidden",document.body.appendChild(a),a.style.left="0px",a.style.top="0px",a.style.display="";var d=ZDBUtil.getObjLeft(b),e=ZDBUtil.getObjTop(b)+b.offsetHeight,f=c?d+b.offsetWidth-a.offsetWidth:d,g=document.body.clientWidth;f=f+a.offsetWidth>g?f-(f+a.offsetWidth-g):f,a.style.left=f+"px",a.style.top=e+"px",a.style.visibility="visible"}},MenuUtil=new function(){var a=document.documentMode&&document.documentMode<9?!1:!0;this.slideDown=function(b,c,d){c=c?c:250,a?b.slideDown(c,d):b.show()},this.slideUp=function(b,c,d){c=c?c:250,a?b.slideUp(c,d):b.hide()}},ZDBLoadJsAlone=new function(){this.loadJs=function(a,b){var c=jQuery(a),d=c.attr("func"),e=c.attr("opstatusId")?c.attr("opstatusId"):"ZDBMainLoader",f=c.attr("mode"),g=[d,a,f,b],h=c.attr("lzJs"),i=c.attr("lzOper")?c.attr("lzOper"):"APPENDTODOC";if(!ZDBLazyLoadUtil.loadJsAlone(h,i,ZDBLoadJsAlone.invokeFunc,g,e))return;ZDBLoadJsAlone.invokeFunc(d,a,f,b)},this.invokeFunc=function(a,b,c,d){var e=ZDBLazyLoadFuncMap.lazyLoadFuncMap[a];return c?e(b,c,d):e(b,d),StatusMsgAPI.OPSTATUS.FINISHED},this.loadSnippet=function(a){var b=a.getAttribute("func"),c=a.getAttribute("lazyLoad");if(c=="true"){var d=a.getAttribute("lzName"),e=a.getAttribute("lzUrl"),f=a.getAttribute("lzOper"),g=a.getAttribute("lzJs"),h=a.getAttribute("mode");if(!ZDBLazyLoadUtil.loadSnippet(d,e,this,f,g,ZDBLoadJsAlone.invokeGridFunc,[a,h]))return}ZDBLoadJsAlone.invokeGridFunc(b,a,h)},this.invokeGridFunc=function(a,b,c){var d=ZDBLazyLoadFuncMap.lazyLoadFuncMap[a];d(b,c)}},ZDBContentCache=new function(){this.parsedInfo={},this.contents={},this.userInfo={},this.contentCache=function(a){var b=ZDBGlobal.CONTENTPATH+"/"+encodeURIComponent(a);b+=ZDBClientUI.standAlone?"/ViewModeContentNew.txt":"/FullModeContentNew.txt",ZDBLazyLoadUtil.addVersion([b]),AjaxAPI.sendRequest({URL:b,METHOD:"GET",NOSUBREQPARAM:!0,MODULENAME:"GridMenu",ONSUCCESSFUNC:ZDBContentCache.storeContent})},this.storeContent=function(a,b){ZDBContentCache.contents[b.MODULENAME]=a.responseText,ZDBContentCache.updateUserInfo(),ZDBContentCache.dummyDiv=document.createElement("div")},this.appendAndGet=function(a,b,c){var d=this.getContent(a,b);return d==null?null:(c!=null&&d.parentNode!=c&&c.appendChild(d),d)},this.getContent=function(a,b){var c=ZDBContentCache.contents[b];if(c==null)return null;var d=this.parsedInfo[a];if(d!=null)return d;var e=c.indexOf("<!--"+a+"_Start-->");if(e<0)throw new Error(a+" start is not present");var f=c.indexOf("<!--"+a+"_End-->",e);if(f<0)throw new Error(a+" end is not present");var g=c.substring(e,f);g=this.disableElInSnippet(g),ZDBContentCache.dummyDiv.innerHTML=g;var h=ZDBContentCache.dummyDiv.childNodes;for(var i=0,j=h.length;i<j;i++)if(h[i].getAttribute){d=h[i],d.parentNode.removeChild(d);break}if(d==null)throw new Error(a+" has no elements");return this.parsedInfo[a]=d,d},this.disableElInSnippet=function(a){var b=a.indexOf("{{{"),c=-3,d=[];while(b>-1){d.push(a.substring(c+3,b)),c=a.indexOf("}}}",b+3);if(c<0){c=b-3;break}var e=a.substring(b+3,c),f=ZDBContentCache.userInfo[e];d.push(f),b=a.indexOf("{{{",c+3)}return d.push(a.substring(c+3,a.length)),d.join("")},this.updateUserInfo=function(){this.userInfo.hideOnStandAlone=ZDBClientUI.hideOnStandAlone?"style='display:none;' ":"",this.userInfo.hideOnNotDBOwnerAndNotGroupUser=ZDBClientUI.hideOnNotDBOwnerAndNotGroupUser?"style='display:none;' ":"",this.userInfo.isBetaCustomer=ZDBClientUI.isBetaCustomer?"":"style='display:none;'",this.userInfo.hideIfRemoteDB=ZDBClientUI.isRemoteDB?"style='display:none;'":"",this.userInfo.hideIfNotRemoteDB=ZDBClientUI.isRemoteDB?"":"style='display:none;'",this.userInfo.hideifnoSizeComp=ZDBClientUI.isSizeCompEnabled?"":"style='display:none;'",this.userInfo.hideifnoMapComp=ZDBClientUI.isMapchartEnabled?"":"style='display:none;'"},this.appendAndGetEl=function(a,b){var c=$(a);return b!=null&&c.parentNode!=b&&b.appendChild(c),c}},ZDBSearchUtil=new function(){this.clearSearch=function(a,b,c){if(jQuery(a).attr("class")=="ZRSSearchClearIcon"){ZDBSearchUtil.dntBlur=!0;var d=jQuery(a.parentNode),e=d.children("input"),f=e.get(0);if(!e.val())return;e.val("").focus(),b&&b(f)}},this.handleBlur=function(a){if(ZDBSearchUtil.dntBlur)ZDBSearchUtil.dntBlur=!1,setTimeout(function(){jQuery(a).focus(),BROWSER.IE&&BROWSER.VERSION==9&&ZDBSearchUtil.setCursorToTextEnd(a)},200);else{if(a.value.trim()===""){var b=jQuery(a.parentNode);b.children("[elname='ZRSSearchIcon']").removeClass("ZRSSearchClearIcon").addClass("ZRSSearchIcon")}ZDBSearchUtil.showTipString(a)}},this.setCursorToTextEnd=function(a){a=jQuery(a);var b=a.val();a.val(b)},this.handleFocus=function(a){ZDBSearchUtil.hideTipString(a);var b=jQuery(a.parentNode);b.children("[elname='ZRSSearchIcon']").removeClass("ZRSSearchIcon").addClass("ZRSSearchClearIcon")},this.hideTipString=function(a,b){a.getAttribute("tipShown")=="true"&&(a.value="",a.setAttribute("tipShown","false"),jQuery(a).css("color","#000"),b&&(a.className=""));var c=a.parentNode.className;(c.indexOf("searchBox")>-1||c.indexOf("ZRSSearchField")>-1)&&jQuery(a.parentNode).addClass("searchFieldFocus")},this.showTipString=function(a,b){if(a.value==""&&a.getAttribute("tipShown")=="false"){var c=a.getAttribute("tipValue"),d=c!=null?c:ZDBI18NMap.g("zrpt.common.js.search");a.setAttribute("tipShown","true"),b&&(a.className="tipTextColor"),jQuery(a).css("color","#888").attr("value",d)}var e=a.parentNode.className;(e.indexOf("searchBox")>-1||e.indexOf("ZRSSearchField")>-1)&&jQuery(a.parentNode).removeClass("searchFieldFocus")},this.resetSearchBox=function(a){var b=jQuery(a.parentNode);a=jQuery(a),b.children("[elname='ZRSSearchIcon']").removeClass("ZRSSearchClearIcon").addClass("ZRSSearchIcon");var c=a.attr("tipValue"),d=c!=null?c:ZDBI18NMap.g("zrpt.common.js.search");a.css("color","#888").attr({tipShown:"true"}).val(d)},this.search=function(a,b,c,d){a=a.toString().toLowerCase();var e=!1;return b.each(function(){var b=this;b=jQuery(b);var f;c?f=b.attr(d):f=b.html(),f=f.toLowerCase(),f.indexOf(a)!==-1?(b.show(),e=!0):b.hide()}),e},this.checkKeyAndSearch=function(a){return a||(a=window.event),a.keyCode!=13?!0:(this.searchDBObjects(),!0)},this.getSearchValue=function(a){var b=a.value;a.getAttribute("tipShown")=="true"&&(b=null),b!=null&&(b=trimAll(b));if(b==null||b=="")b=null;return b},this.searchDBObjects=function(){var a=$("ZDBObjSearchTxtFld"),b=ZDBSearchUtil.getSearchValue(a);if(b==null||b==""){jQuery("#ZDBObjSearchClearFld").hide(),ZDBNavigation.refreshExplorer(null,!0);return}b=b.toLowerCase(),jQuery("#ZDBObjSearchClearFld").show();var c;ZDBNavigation.searchType!=="All"?(c=jQuery(ZDBClientUI.Objects_TBODY).find("tr[objtype='"+ZDBNavigation.searchType+"']"),jQuery(ZDBClientUI.Objects_TBODY).find("tr[objtype!='"+ZDBNavigation.searchType+"']").hide()):c=ZDBClientUI.Objects_TBODY.getElementsByTagName("tr");var d=0,e=0;for(var f=0;f<c.length;f++){var g=c[f],h=g.getAttribute("dispname"),i=b==null||h!=null&&h.toLowerCase().indexOf(b)>-1;g.style.display=i?ZDBUtil.visibleTrStyle:"none",g.style.display!="none"&&(g.className="depth"+(b==null?g.getAttribute("origDepth"):"0")),d+=i?1:0,i&&jQuery(g).attr("objtype")=="Dashboard"&&e++}var j=ZDBClientUI.Objects_TBODY;j.className=b==null?j.getAttribute("origNavClassName"):"",$("ZDBSearchResults").style.display=b==null?"none":"block",$("ZDBSearchCount").innerHTML=d>0?d:ZDBI18NMap.g("zrpt.common.js.no"),$("ZDBSearchCountInDBEdit").innerHTML=d-e>0?d-e:ZDBI18NMap.g("zrpt.common.js.no")},this.navClearSearch=function(a,b){jQuery(a).siblings("#ZDBObjSearchTxtFld").val("").focus(),this.searchDBObjects(),ZDBUtil.stopEventBubble(b)},this.hideSearchResult=function(){var a=$("ZDBFieldsSearchResults"),b=$("ZRFieldsActionDIV");a.style.display="none",b&&(b.style.display="")},this.handleSearchFieldsResult=function(a,b,c){var d=DOMUtils.getFirstMatchingChild(c,"DIV","searchResultDiv","true"),e=DOMUtils.getFirstMatchingChild(c,"span","searchCountSpan","true"),f=$("ZRFieldsActionDIV");a==null||a==""?(this.hideSearchResult(),d.style.display="none",f&&(f.style.display="")):(d.style.display="",f&&(f.style.display="none")),e.innerHTML=b>0&&a!==""?b:ZDBI18NMap.g("zrpt.common.js.no")},this.clearDBSearch=function(){var a=$("ZDBObjSearchTxtFld");a.value="",this.showTipString(a),this.searchDBObjects()},this.searchOnClick=function(a,b){var c=a.parentNode;ZDBUtil.setNamedChildEls(c,c),a=c.ZRSSearchInput,this.searchValue(a,b)},this.searchInTable=function(a,b,c){b||(b=window.event);if(b.keyCode!=13)return a.setAttribute("searchempty","true"),!0;this.searchValue(a,c),ZDBSearchUtil.dntBlur=!0},this.searchValue=function(a,b){var c=ZDBSearchUtil.getSearchValue(a);if(a.getAttribute("searchempty")==="false"&&c===null)return;b==null&&(b=ZDBUtil.getPropertyFromEl(a,"gridObj","object")),b==null&&(b=ZDBClientUI.selectedTab.view),c!=null?(b.setDirectFilter(encodeURIComponent(c)),a.setAttribute("searchempty","true")):(b.setDirectFilter(""),a.setAttribute("searchempty","false")),b.doFilter()},this.checkKeyForSearch=function(a){return a||(a=window.event),a.keyCode==13?!0:!1},this.checkKeyAndSearchFields=function(a){return a||(a=window.event),a.keyCode!=13?!0:(this.searchDropFields(),!0)},this.searchDropFields=function(a){a==null&&(a=$("ZDBFieldsSearchTxtFld").value.toLowerCase());var b=$("ZDBFieldsIterationTable").getElementsByTagName("div"),c=b.length,d=null,e=null,f=0,g=DOMUtils.filterElements(b,null,"fieldTab","true");if(g.length>1){var h=a==""||a==null,l=h;for(i=0;i<g.length;i++){fieldTab=g[i];var m=fieldTab.getAttribute("displayName"),n=h||m!=null&&m.toLowerCase().indexOf(a)>-1;els=DOMUtils.getChildElsWithAttr(fieldTab,"childSpan","true"),childSpan=els[0],els=DOMUtils.getChildElsWithAttr(fieldTab,"expParent","expParent"),parDiv=els[0],els=DOMUtils.getChildElsWithAttr(fieldTab,"parentHolder","true"),parHolderDiv=els[0];if(n&&!l){f++;var o=DOMUtils.getChildElsWithAttr(fieldTab,"fieldTR","true");for(j=0;j<o.length;j++)e=o[j],e.style.display="";parHolderDiv.style.display="",parDiv.style.display="none",childSpan.className="folderClose"}else{childFieldList=DOMUtils.filterElements(fieldTab.getElementsByTagName("DIV"),"DIV","COLUMN_ID","*");var p=!1;for(k=0;k<childFieldList.length;k++)d=childFieldList[k],childDispName=d.getAttribute("displayName").toLowerCase(),n=h||childDispName!=null&&childDispName.toLowerCase().indexOf(a)>-1,e=ZDBUtil.getParentWithAttr(d,"fieldTR",2),e.style.display=n?"":"none",n&&(p=!0,f++);p?(parHolderDiv.style.display="",parDiv.style.display="",childSpan.className="folderOpen"):(parHolderDiv.style.display="none",parDiv.style.display="none"),l=!1}}}else{fieldList=DOMUtils.filterElements(b,"DIV","COLUMN_ID","*");for(i=0;i<c;i++)if(b[i].getAttribute("COLUMN_ID")){d=b[i],m=d.getAttribute("displayName").toLowerCase();var n=a==""||a==null||m!=null&&m.toLowerCase().indexOf(a)>-1;e=ZDBUtil.getParentWithAttr(b[i],"fieldTR",2),e.style.display=n?"":"none",n&&f++}}ZDBSearchUtil.handleSearchFieldsResult(a,f,$("ZDBFieldsIterationTable"))},this.clearDropFieldsSearch=function(){var a=$("ZDBFieldsSearchTxtFld");a.value="",this.searchDropFields(),ZDBSearchUtil.showTipString(a)},this.clearSearchResults=function(){jQuery("#searchContactStr").val()}},ZDBIntegration=new function(){this.setDomainName=function(){document.domain=$(domainName).innerHTML},this.closeEditorWindow=function(){ZDBIntegration.setDomainName(),window.parent.ViewEditor.closeEditorWindow()},this.init=function(){document.domain=$("domainName").innerHTML,window.parent.ViewEditor.init()},this.getXMLConfig=function(){var a="",b=window.ZDBClientUI.selectedTab.view;return ZDBAnalysisEditViewMode.validateViewCheck(b)?(a=ZDBAnalysisConfig.getCurrentConfig(b,!0),a):a}},ZDBGoogleInteg=new function(){this.gSheetOrginalList,this.gSheetCurrentList,this.gSheetsLen,this.gNavStartInd,this.gNavEndInd,this.googleOrgResp,this.googleCurResp,this.count=0,this.gAppsEnableAPIDiv,this.gAppsEnableAPITitle,this.getGoogleDocs=function(){hideCustomMessage(),$("ZDBGButton").disabled=!0,AjaxAPI.sendRequest({URL:"/ZDBImportAction.ma?ZDBACTION=ZDBFETCHGDOCS",ONSUCCESSFUNC:ZDBGoogleInteg.showGoogleSheets,ONFAILUREFUNC:ZDBGoogleInteg.showGoogleSheetsFailure,OPSTATUSID:"ZDBGSHEETOPTSTATUS"})},this.showGoogleSheets=function(a,b){$("ZDBGButton").disabled=!1;var c=$("ZDBGSheetCnt");if(!c){var d=window.divData.GSheetDlg;$("ZDBAjaxResponseStore").innerHTML=d.innerHTML,ZDBDialogUtil.showDialog($("ZDBGSheetCnt"),{TITLE:ZDBI18NMap.g("zrpt.common.gsheet.js.select.sheet"),ADDFRAME:!0,MODAL:!0})}var e=JSON.parse(a.responseText);e.length>0?(ZDBGoogleInteg.gSheetOrginalList=e,ZDBGoogleInteg.getGSheetNavLimit(!0)):(ZDBGoogleInteg.gSheetOrginalList=e,ZDBGoogleInteg.getGSheetNavLimit(!0)),ZDBGoogleInteg.setLoadingElt("",!1),ZDBClientUI.isGAppUser?$("ZDBSigninAsDiffUser_GSheet").style.display="none":$("ZDBSigninAsDiffUser_GSheet").style.display=""},this.getGSheetNavLimit=function(a){var b,c;$("ZDBGListBody").innerHTML="",a==1&&(ZDBGoogleInteg.gSheetCurrentList=ZDBGoogleInteg.gSheetOrginalList.slice(),ZDBGoogleInteg.gNavStartInd=1,ZDBGoogleInteg.gNavEndInd=10);var d=ZDBGoogleInteg.gSheetsLen=ZDBGoogleInteg.gSheetCurrentList.length;if(d==0){var e=$("ZDBNoGSheets").cloneNode(!0);$("ZDBGListBody").appendChild(e),a==0?(e.innerHTML=ZDBI18NMap.g("zrpt.common.gsheet.js.no.matching.files"),$("ZDBSelectedSheetHolder").style.display="none"):ZDBGoogleInteg.setLoadingElt(ZDBI18NMap.g("zrpt.common.gsheet.js.select.nofiles"),!1),$("ZDBGNavigation").style.display="none"}else ZDBGoogleInteg.gNavStartInd==1?b=!0:b=!1,ZDBGoogleInteg.gNavEndInd>=d?(c=!0,ZDBGoogleInteg.gNavEndInd=d):c=!1,ZDBGoogleInteg.setGSheetNavigation(b,c),ZDBGoogleInteg.appendGSheetsInBody(),a||ZDBUtil.setRadioSelectedValue($("ZDBGSheetForm"),"GSHEETLIST",ZDBGoogleInteg.selectedDocID,"docid")},this.setGSheetNavigation=function(a,b){var c=ZDBGoogleInteg.gNavStartInd+" - "+ZDBGoogleInteg.gNavEndInd+" "+ZDBI18NMap.g("zrpt.common.gsheet.js.of")+" "+ZDBGoogleInteg.gSheetsLen;$("ZDBGSheetNavigation").innerHTML=c;var d=$("GSheetLeftNav"),e=$("GSheetRightNav");a==1?(d.disabled=!0,d.className="gSheetleftNavDisabled"):(d.disabled=!1,d.className="gSheetleftNavEnabled"),b==1?(e.disabled=!0,e.className="gSheetRightNavDisabled"):(e.disabled=!1,e.className="gSheetRightNavEnabled"),$("ZDBGNavigation").style.display=""},this.appendGSheetsInBody=function(a,b){var c=$("ZDBGListBody"),d=parseInt(ZDBGoogleInteg.gNavStartInd)-1,e=parseInt(ZDBGoogleInteg.gNavEndInd)-1;for(var f=d;f<=e;f++){var g=ZDBGoogleInteg.gSheetCurrentList[f];if(g!=null){var h=g.docName,i=g.docId,j=g.docType,k=$("ZDBSheetListTemplate"),l=DOMUtils.getFirstChild(k,"id","ZDBGSampleSheetDiv").cloneNode(!0),m=DOMUtils.getFirstChild(l,"id","ZDBGSheetRadio");m.setAttribute("docId",i),m.setAttribute("docName",h),m.setAttribute("docType",j);var n=DOMUtils.getFirstChild(l,"id","ZDBSheetName");n.setAttribute("value",h),h.length>50&&(h=h.substring(0,50)+".."),n.innerHTML=h,c.appendChild(l)}}$("LoadArea").style.display="none"},this.getNextSheetList=function(a,b){var c=a.id;if(c=="GSheetLeftNav"){if(ZDBGoogleInteg.gNavStartInd-10<=0)return;ZDBGoogleInteg.gNavStartInd=parseInt(ZDBGoogleInteg.gNavStartInd)-10,ZDBGoogleInteg.gNavEndInd=parseInt(ZDBGoogleInteg.gNavStartInd)+9}else if(c=="GSheetRightNav"){if(ZDBGoogleInteg.gNavEndInd>=ZDBGoogleInteg.gSheetsLen)return;ZDBGoogleInteg.gNavStartInd=parseInt(ZDBGoogleInteg.gNavStartInd)+10,ZDBGoogleInteg.gNavEndInd=parseInt(ZDBGoogleInteg.gNavStartInd)+9}ZDBGoogleInteg.getGSheetNavLimit()},this.setLoadingElt=function(a,b){var c=$("ZDBLoadArea");if(c){b==1?$("ZDBLoadArea").style.display="":b==0&&($("ZDBLoadArea").style.display="none");var d=$("LoadArea");d.style.display="",d.innerHTML=a,d.setAttribute("value",a)}},this.checkSheetsList=function(){var a=$("LoadArea"),b=a.getAttribute("value"),c;b=="Authenticating"&&(c=ZDBI18NMap.g("zrpt.common.gsheet.js.auth.with.google")),b=="NoFiles"&&(c=ZDBI18NMap.g("zrpt.common.gsheet.js.no.sheet.available")),ZDBGoogleInteg.setTextInGListBody(c)},this.setTextInGListBody=function(a){$("ZDBGListBody").innerHTML="";var b=$("ZDBNoGSheets").cloneNode(!0);b.innerHTML=a,$("ZDBGListBody").appendChild(b)},this.highLightGsheet=function(a){$(a).className="trHighLight"},this.deHighLightGsheet=function(a){var b=DOMUtils.getFirstChild(a,"id","ZDBGSheetRadio");b.checked||($(a).className="")},this.selectRadio=function(a){var b=a.parentNode,c=DOMUtils.getFirstChild(b,"id","ZDBGSheetRadio");c.checked=!0;var d=ZDBEscapeUtil.decodeForHtml($(a).getAttribute("value"));ZDBGoogleInteg.showSelectedGSheetName(c,d)},this.onRadioSelect=function(a){var b=a.getAttribute("docname");ZDBGoogleInteg.showSelectedGSheetName(a,b)},this.showSelectedGSheetName=function(a,b){var c=document.getElementById("ZDBGListBody"),d=c.getElementsByTagName("div");ZDBGoogleInteg.selectedDocID=a.getAttribute("docid"),ZDBGoogleInteg.selectedDocType=a.getAttribute("docType"),DOMUtils.removeCSSClass(d,"trHighLight"),ZDBGoogleInteg.highLightGsheet(a.parentNode);var e=$("ZDBSelectedGSheetName");e.setAttribute("value",b),b.length>20&&(b=b.substr(0,20)+"..."),$("ZDBSelectedSheetHolder").style.display="",e.innerHTML="",e.innerHTML=b},this.fetchSelectedSheet=function(a){if(!ZDBLazyLoadUtil.loadJsAlone("import/js/ZDBImport.js",this,ZDBGoogleInteg.fetchSelectedSheet,[a]))return;var b=ZDBUtil.getSelectedRadioEltWithAttrVal($("ZDBGListBody"),"name","GSHEETLIST"),c=$("ZDBGListBody"),d=DOMUtils.getFirstChild(c,"id","ZDBGSampleSheetDiv");if(d){if(!b){ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.gsheet.js.select.one.sheet"));return}var e=b.getAttribute("docId"),f=b.getAttribute("docName"),g=b.getAttribute("docType"),h=ZDBImport.getFileExtension(f).toUpperCase();h=g.toLowerCase()=="spreadsheet"?"":h,ZDBDialogUtil.closeDialog(),window.totStep=3,$("ISFROMGDRIVE").value=!1;if(g.toLowerCase()!=="spreadsheet"){$("ISFROMGDRIVE").value=!0,$("ZDBGDRIVEFORMAT").value=h;for(var i=0;i<ZDBImportConst.GDRIVE_CSV_EXTNS.length;i++){var j=ZDBImportConst.GDRIVE_CSV_EXTNS[i].toUpperCase();if(j==h){$("ZDBGDRIVEFORMAT").value=j.replace(".","");for(var k=0;k<ZDBImportConst.GDRIVE_CSV_EXTNS.length;k++)h==ZDBImportConst.GDRIVE_CSV_EXTNS[k].toUpperCase()&&($("ISGDRIVECSV").value=!0,window.totStep=2);break}}}else $("ZDBGDRIVEFORMAT").value="XLSX";$("ZDBGSHEETID").value=e,$("ZDBGSHEETTYPE").value=g,$("ZDBInputGSS").value=f,$("ZDBGSHEETNAME").value=f,$("ZDBInputGSS").setAttribute("tipShown","false")}else ZDBDialogUtil.closeDialog();$("ZDBGButton").disabled=!1},this.searchGSheetsKeyPress=function(a,b){var c;return window.event?c=window.event.keyCode:a&&(c=a.which),c==13&&ZDBGoogleInteg.getSearchList(b),!1},this.getSearchList=function(a){var b=ZDBSearchUtil.getSearchValue($(a));ZDBGoogleInteg.gSheetCurrentList.clear();if(ZDBGoogleInteg.gSheetOrginalList==null){ZDBGoogleInteg.checkSheetsList();return}if(b==null)ZDBGoogleInteg.gSheetCurrentList=ZDBGoogleInteg.gSheetOrginalList.slice();else{var c=0;b=b.toLowerCase();for(var d=0;d<ZDBGoogleInteg.gSheetOrginalList.length;d++){var e=ZDBGoogleInteg.gSheetOrginalList[d],f=e.docName.toLowerCase();f.indexOf(b)>-1&&(ZDBGoogleInteg.gSheetCurrentList[c]=e,c++)}}ZDBGoogleInteg.gNavStartInd=1,ZDBGoogleInteg.gNavEndInd=10,ZDBGoogleInteg.getGSheetNavLimit(!1)},this.showGoogleContacts=function(a){jQuery("#GoogleContacts").find(".zdbselected").addClass("zdbcontactFilter").removeClass("zdbselected"),jQuery("#ZDBAllGoogleContacts").addClass("zdbselected").removeClass("zdbcontactFilter"),ZDBGoogleInteg.showGoogleContactsDlg(a,!0)},this.showGoogleContactsDlg=function(a,b){var c=null,d=null,e=ZDBClientUI.getViewObj(a,"view"),f="ZDBAddUsersProcess";$("GoogleContacts").style.display!="none"&&(f="ZDBUserGContactsProcess"),a!=null&&(c=DOMUtils.getParentWithAttr(a,"isMenu"),d=c.srcEl),jQuery("#GoogleContacts").addClass("ZRSShadow"),AjaxAPI.sendRequest({URL:"/ZDBSecurityAction.ma?ZDBACTION=ZDBGETGOOGLECONTACTS&REFETCH="+b,ONSUCCESSFUNC:ZDBGoogleInteg.handleShowGoogleContacts,ONFAILUREFUNC:ZDBGoogleInteg.handleShowGoogleContactsFailure,SRCEL:d,VIEW:e,OPSTATUSID:f,REFETCH:b})},this.showSearchedGoogleContactsDlg=function(a,b,c){var d=jQuery(c).parent();jQuery(d).find(".zdbselected").addClass("zdbcontactFilter").removeClass("zdbselected"),jQuery(c).addClass("zdbselected").removeClass("zdbcontactFilter"),b=b?!0:!1,AjaxAPI.sendRequest({URL:"/ZDBSecurityAction.ma?ZDBACTION=ZDBGETGOOGLECONTACTS&REFETCH=true&SEARCHSTR="+encodeURIComponent(a)+"&CONTAINSCHECK="+b,ONSUCCESSFUNC:ZDBGoogleInteg.handleShowSearchedGoogleContacts,ONFAILUREFUNC:ZDBGoogleInteg.handleShowGoogleContactsFailure,OPSTATUSID:"ZDBUserGContactsProcess",REFETCH:"true"})},this.showSearchedGoogleAppUsersDlg=function(a,b){b=b?!0:!1,AjaxAPI.sendRequest({URL:"/ZDBSecurityAction.ma?ZDBACTION=ZDBFETCHGAPPUSERS&SEARCHSTR="+encodeURIComponent(a)+"&CONTAINSCHECK="+b,ONSUCCESSFUNC:ZDBGoogleInteg.handleShowSearchedGoogleAppUsers,ONFAILUREFUNC:ZDBGoogleInteg.handleShowSearchedGoogleAppUsersFailure,OPSTATUSID:"ZDBGAppUserProcess"})},this.handleShowSearchedGoogleContacts=function(a,b){$("myGoogleContacts").innerHTML=a.responseText},this.handleShowSearchedGoogleAppUsers=function(a,b){$("myGoogleAppUsers").innerHTML=a.responseText},this.gContactsSearchKeyPress=function(a,b,c){var d;window.event?d=window.event.keyCode:b&&(d=b.which);if(d==13)if(c=="gcontacts"){var e=$("searchGContactStr").value;ZDBGoogleInteg.showSearchedGoogleContactsDlg(e,!0)}else if(c=="gappusers"){var e=$("searchGAppUserStr").value;ZDBGoogleInteg.showSearchedGoogleAppUsersDlg(e,!0)}},this.handleShowGoogleContacts=function(a,b){var c=b.SRCEL,d=b.VIEW;$("myGoogleContacts").innerHTML=a.responseText,ZDBClientUI.isGAppUser==1?$("ZDBSigninAsDiffUser").style.display="none":$("ZDBSigninAsDiffUser").style.display="";var e=$("GoogleContacts");if(d!=null&&d.dialogStatus>0&&ZDBDialogUtil.focusDialog==null){var f=c.parentNode;ZDBSecuritySettings.removeChildsWithAttr(f,"emailcontactsdlg");var g=e.cloneNode(!0);g.id="",g.setAttribute("emailcontactsdlg","true"),f.appendChild(g);var h=g.getElementsByTagName("div")[0];c==$("inlineAddUserFromEl")&&(g.style.zIndex=3),h.className=c==$("inlineAddUserFromEl")?"inlineAddUserFromStyle":"borderwhite",g.style.display="block",g.style.top=ZDBUtil.getObjTop(c,!0,f)+f.offsetHeight+"px",g.style.left=ZDBUtil.getObjLeft(c,!0,f)}else{c==null&&(c=$("ZDBAddUsersFromMenu"));if(c!=null){var h=e.getElementsByTagName("div")[0];h.className=c==$("inlineAddUserFromEl")?"inlineAddUserFromStyle":"borderwhite",document.body.appendChild(e),ZDBMenuUtil.positionEl(e,c,!1)}e.style.display="",ZDBDialogUtil.focusDialog.attachedEl=e}},this.showGoogleSheetsFailure=function(a,b){$("ZDBGButton").disabled=!1;var c=a.getResponsePart("ERRORCODE");c=trimAll(c);if(c=="GOOGLE_AUTH_REQUIRED"){var d=ZDBGlobal.GAPP_EMBED_GADGET_URL+"/gdocs?auth=true&zservice="+ZDBGlobal.GAPP_ZSERVICE+"&border=no&serURL="+ZDBGlobal.REPORTS_SERVER_URL+ZDBGlobal.REPORTS_CONTEXT_NAME+"/integ/GResponseRedirect.jsp?gauth_type=sheets";ZDBGoogleInteg.authGoogle(d)}else{var e=$("ZDBGSheetCnt");if(!e){var f=window.divData.GSheetDlg;$("ZDBAjaxResponseStore").innerHTML=f.innerHTML,ZDBDialogUtil.showDialog($("ZDBGSheetCnt"),{TITLE:ZDBI18NMap.g("zrpt.common.gsheet.js.select.sheet"),ADDFRAME:!0,MODAL:!0})}var g=$("ZDBNoGSheets").cloneNode(!0);g.innerHTML=ZDBI18NMap.g("zrpt.common.gsheet.js.retrieve"),$("ZDBGListBody").appendChild(g),$("ZDBGNavigation").style.display="none",ZDBGoogleInteg.setLoadingElt("",!1)}},this.handleShowGoogleContactsFailure=function(a,b){var c=a.getResponsePart("ERRORCODE");c=trimAll(c);if(c=="GOOGLE_AUTH_REQUIRED")if(ZDBClientUI.isGAppUser==1)ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.share.shareview.js.contact_gapp_admin"));else{var d=ZDBGlobal.GAPP_EMBED_GADGET_URL+"/gcontacts?auth=true&zservice="+ZDBGlobal.GAPP_ZSERVICE+"&border=no&serURL="+ZDBGlobal.REPORTS_SERVER_URL+ZDBGlobal.REPORTS_CONTEXT_NAME+"/integ/GResponseRedirect.jsp?gauth_type=contacts";ZDBGoogleInteg.authGoogle(d)}else{$("myGoogleContacts").innerHTML=a.responseText;var e=$("ZDBAddUsersFromMenu"),f=$("GoogleContacts");document.body.appendChild(f),ZDBMenuUtil.positionEl(f,e,!1),f.style.display="",ZDBDialogUtil.focusDialog.attachedEl=f}},this.revokeGToken=function(a,b){var c=a.getAttribute("gtype");c=="sheets"&&($("ZDBSelectedSheetHolder").style.display="none",ZDBGoogleInteg.selectedDocID=null);var d="/ZDBSecurityAction.ma?ZDBACTION=ZDBREVOKEGTOKEN&GTYPE="+c;AjaxAPI.sendRequest({URL:d,ONSUCCESSFUNC:ZDBGoogleInteg.handleRevokeGToken,ONFAILUREFUNC:ZDBGoogleInteg.handleRevokeGTokenFailure,GOOGLETYPE:c,OPSTATUSID:"ZDBUserGContactsProcess"})},this.handleRevokeGToken=function(a,b){var c=b.GOOGLETYPE,d=ZDBGlobal.GAPP_EMBED_GADGET_URL;c&&c=="contacts"?d=d+"/gcontacts?auth=true&zservice="+ZDBGlobal.GAPP_ZSERVICE+"&border=no&serURL="+ZDBGlobal.REPORTS_SERVER_URL+ZDBGlobal.REPORTS_CONTEXT_NAME+"/integ/GResponseRedirect.jsp":!c||c!="sheets"&&c!="refetch"&&c!="createdb"&&c!="existimport"&&c!="schDialog"?c&&c.toLowerCase()=="gadwords"&&(d=d+"/zgadwords?&zservice=zreports&serURL="+ZDBGlobal.REPORTS_SERVER_URL+ZDBGlobal.REPORTS_CONTEXT_NAME+"/integ/GResponseRedirect.jsp"):d=d+"/gdocs?auth=true&zservice="+ZDBGlobal.GAPP_ZSERVICE+"&border=no&serURL="+ZDBGlobal.REPORTS_SERVER_URL+ZDBGlobal.REPORTS_CONTEXT_NAME+"/integ/GResponseRedirect.jsp",d+="?gauth_type="+c;var e=""+a.responseText.trim();e=="true"?c.toLowerCase()=="gadwords"?ZDBGoogleInteg.authGoogleAdwords(d):ZDBGoogleInteg.authGoogle(d):ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.share.shareview.js.errInGAuth"))},this.handleRevokeGTokenFailure=function(a,b){var c=a.getResponsePart("ERRORCODE");c=trimAll(c);var d=b.GOOGLETYPE;if(c=="CONTAINS_SCHEDULED_GSHEETS"||c=="CONTAINS_SCHEDULED_GADMODULES"){if(d.toLowerCase()=="gadwords"){ZRGADInteg.showScheduledDB();return}schGSheetDlg=$("ZDBSchGSheetDlg"),schGSheetDlg||(schGSheetDlg=window.divData.ScheduledGSheets),$("ZDBAjaxResponseStore").innerHTML=schGSheetDlg.innerHTML,dlg=$("ZDBSchGSheetDlg");var e="zrpt.common.gsheet.js.scheduled_warning.title";ZDBDialogUtil.showDialog(dlg,{TITLE:ZDBI18NMap.g(e),ADDFRAME:!0,MODAL:!0,DONTREMOVE:!0})}else ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.share.shareview.js.errInGAuth"))},this.revokeGDocsToken=function(a){var b=a.getAttribute("gtype"),c="/ZDBSecurityAction.ma?ZDBACTION=ZDBREVOKEGDOCSTOKEN&GTYPE=sheets";AjaxAPI.sendRequest({URL:c,ONSUCCESSFUNC:ZDBGoogleInteg.handleRevokeGToken,ONFAILUREFUNC:ZDBGoogleInteg.handleRevokeGTokenFailure,GOOGLETYPE:b})},this.revokeGDocsTokenAndStopSch=function(){ZDBDialogUtil.closeDialog();var a="/ZDBSecurityAction.ma?ZDBACTION=ZDBREVOKEGDOCSTOKANDSTOPSCH&GTYPE=sheets";AjaxAPI.sendRequest({URL:a,ONSUCCESSFUNC:ZDBGoogleInteg.handleRevokeGToken,ONFAILUREFUNC:ZDBGoogleInteg.handleRevokeGTokenFailure,GOOGLETYPE:"sheets"})},this.showScheduledGAdwordsClients=function(a){var b=$("ZDBSchGAdwordsClients"),c=b.getAttribute("isGAdwordsClientsAvailable");if(c=="true")ZDBGoogleInteg.toggleSchGAdwordsClientsListDiv();else if(c=="false"){var d="/ZDBGADSchProfiles.cc?";AjaxAPI.sendRequest({URL:d,ONSUCCESSFUNC:ZDBGoogleInteg.handleShowSchGAdwordsClients,Element:a})}},this.handleShowSchGAdwordsClients=function(a,b){$("ScheduledGAdwordsClientsHolder").innerHTML=a.responseText,$("ZDBSchGAdwordsClients").setAttribute("isGAdwordsClientsAvailable","true"),ZDBGoogleInteg.toggleSchGAdwordsClientsListDiv()},this.toggleSchGAdwordsClientsListDiv=function(){var a=$("ZDBShowSchGAdwordsClients"),b=a.getAttribute("isGAdwordsClientsListed"),c=b=="true"?"false":"true";a.setAttribute("isGAdwordsClientsListed",c),c=="true"?($("ZDBSchGAdwordsClients").style.display="",$("ZDBSchGAdwordsClientsProceed").style.paddingLeft=""):c=="false"&&($("ZDBSchGAdwordsClients").style.display="none",$("ZDBSchGAdwordsClientsProceed").style.paddingLeft="55px")},this.showScheduledGSheets=function(a){var b=$("ZDBSchGSheets").getAttribute("isGSheetsAvailable");if(b=="true")ZDBGoogleInteg.toggleSchGSheetsListDiv();else if(b=="false"){var c="/ZDBSecurityAction.ma?ZDBACTION=ZDBSHOWSCHEDULEDGSHEETS";AjaxAPI.sendRequest({URL:c,ONSUCCESSFUNC:ZDBGoogleInteg.handleShowSchGSheets,Element:a})}},this.handleShowSchGSheets=function(a,b){var c=a.responseText;$("ScheduledGSheetsHolder").innerHTML=c,$("ZDBSchGSheets").setAttribute("isGSheetsAvailable","true"),ZDBGoogleInteg.toggleSchGSheetsListDiv()},this.toggleSchGSheetsListDiv=function(){var a=$("ZDBShowSchGSheets"),b=a.getAttribute("isGSheetsListed"),c=b=="true"?"false":"true";a.setAttribute("isGSheetsListed",c),c=="true"?($("ZDBSchGSheets").style.display="",$("ZDBSchGSheetProceed").style.paddingLeft=""):c=="false"&&($("ZDBSchGSheets").style.display="none",$("ZDBSchGSheetProceed").style.paddingLeft="55px")},this.authGoogleAdwords=function(a){var b=document.createElement("iframe");b.height="400px",b.width="950px",b.style.border="0px",b.style.overflow="hidden",b.src=a,b.id="authGoogleIFrame",b.name="authGoogleIFrame",ZDBDialogUtil.showDialog(b,{MODAL:!0,DONTREMOVE:!1,ZINDEX:2e4})},this.authGoogle=function(a){var b=ZDBI18NMap.g("zrpt.common.share.shareview.js.authForGoogle"),c=document.createElement("div");c.id="authGoogleDiv",c.style.zIndex=1e6,c.className="gContactsRevokeToken";var d=document.createElement("iframe");d.src=a,d.id="authGoogleIFrame",d.name="authGoogleIFrame",d.className="gContactsRevTokenIframe",c.appendChild(d),ZDBDialogUtil.showDialog(c,{MODAL:!0,ADDFRAME:!0,TITLE:b,SHADOW:!0,DONTREMOVE:!1,ZINDEX:2e4})},this.removeCloseButton=function(){$("header_color").style.display="none"},this.authGoogleResponse=function(a,b,c){if(a=="existimport"&&!ZDBLazyLoadUtil.loadJsAlone("import/js/ZDBImport.js",this,ZDBGoogleInteg.authGoogleResponse,[a,b]))return;ZDBDialogUtil.closeDialog(),a=="contacts"?ZDBGoogleInteg.showGoogleContactsDlg(null,!1):a=="sheets"?(ZDBGoogleInteg.setLoadingElt(ZDBI18NMap.g("zrpt.common.gsheet.js.select.fetching"),!0),ZDBGoogleInteg.getGoogleDocs()):a=="refetch"?ZDBImportSchedule.refreshNow():a=="createdb"?submitCreateDB($("ZDBCreateFrm")):a=="existimport"?ZDBImport.submitExistImportForm($("ZDBEXCreateFrm")):a.toLowerCase()=="gadwords"?ZRGADInteg.downloadClientList(b,c,!0):a.toLowerCase()=="schdialog"?ZDBImportSchedule.showScheduleDetailsDlg($("ZDB_IMP_SCHEDULE_MENUITEM")):a.toLowerCase()==="ganalytics"?ZRGAnalInteg.getDBDetailsDlg(!0,b,c):a.toLowerCase()==="ganalyticsfromedit"?ZRGAnalInteg.updateAuthTokenStatus(b):a.toLowerCase()==="gadfromedit"&&ZRGADInteg.updateAuthTokenStatus(b)},this.openMyGoogleAppUsers=function(a){var b=DOMUtils.getParentWithAttr(a,"isMenu"),c=b.srcEl,d=ZDBClientUI.getViewObj(a,"view");AjaxAPI.sendRequest({URL:"/ZDBSecurityAction.ma?ZDBACTION=ZDBFETCHGAPPUSERS"
,ONSUCCESSFUNC:ZDBGoogleInteg.handleShowGoogleAppUsers,ONFAILUREFUNC:ZDBGoogleInteg.handleShowGoogleAppUsersFailure,SRCEL:c,VIEW:d,OPSTATUSID:"ZDBAddUsersProcess"})},this.handleShowGoogleAppUsers=function(a,b){var c=b.SRCEL,d=b.VIEW;$("myGoogleAppUsers").innerHTML=a.responseText;var e=$("GoogleAppUsers");if(d!=null&&d.dialogStatus>0&&ZDBDialogUtil.focusDialog==null){var f=c.parentNode;ZDBSecuritySettings.removeChildsWithAttr(f,"emailcontactsdlg");var g=e.cloneNode(!0);g.id="",g.setAttribute("emailcontactsdlg","true"),f.appendChild(g);var h=g.getElementsByTagName("div")[0];c==$("inlineAddUserFromEl")&&(g.style.zIndex=3),h.className=c==$("inlineAddUserFromEl")?"inlineAddUserFromStyle":"borderwhite",g.style.display="block",g.style.top=ZDBUtil.getObjTop(c,!0,f)+f.offsetHeight,g.style.left=ZDBUtil.getObjLeft(c,!0,f)}else{if(c!=null){var h=e.getElementsByTagName("div")[0];h.className=c==$("inlineAddUserFromEl")?"inlineAddUserFromStyle":"borderwhite",document.body.appendChild(e),ZDBMenuUtil.positionEl(e,c,!1)}ZDBDialogUtil.focusDialog.attachedEl=e}},this.handleShowGoogleAppUsersFailure=function(a,b){a.getResponsePart("ERRORNUMCODE")==1016?ZDBGoogleInteg.fetchOrShowGoogleAppEnableAPIDIV(null,"contacts"):ZDBGoogleInteg.showGoogleAppContactFetchFailureDlg()},this.fetchOrShowGoogleAppEnableAPIDIV=function(a,b,c){ZDBGoogleInteg.gAppsEnableAPIDiv?ZDBGoogleInteg.showGoogleAppEnableAPIDlg(b):(ZDBGoogleInteg.gAppsEnableAPIDiv=document.createElement("div"),AjaxAPI.sendRequest({URL:"/ZRGAAppsEnableAPI.cc",ONSUCCESSFUNC:ZDBGoogleInteg.handleGoogleAppEnableAPISuccess,ONFAILUREFUNC:ZDBGoogleInteg.showGoogleAppContactFetchFailureDlg,OPSTATUSID:"ZDBAddUsersProcess",FROM:b}))},this.handleGoogleAppEnableAPISuccess=function(a,b){ZDBGoogleInteg.gAppsEnableAPIDiv.innerHTML=a.responseText,document.body.appendChild(ZDBGoogleInteg.gAppsEnableAPIDiv),ZDBGoogleInteg.gAppsEnableAPITitle=ZDBI18NMap.g("zrpt.gapps.api.enable.js.note_tit"),ZDBGoogleInteg.showGoogleAppEnableAPIDlg(b.FROM)},this.showGoogleAppEnableAPIDlg=function(a){ZDBDialogUtil.showDialog(ZDBGoogleInteg.gAppsEnableAPIDiv,{MODAL:!0,TITLE:ZDBGoogleInteg.gAppsEnableAPITitle,ADDFRAME:!0,LEFT:450,TOP:200}),$("ZRGAppsEnableNote").innerHTML=ZDBI18NMap.g("zrpt.gapps.api.enable.js.note_for_gs"),a=="contacts"&&($("ZRGAppsEnableNote").innerHTML=ZDBI18NMap.g("zrpt.gapps.api.enable.js.note_for_contact")),$("ZRGAppsEnableAPIHelp").style.display=""},this.hideGoogleAppEnableAPIDlg=function(){jQuery("#ZRGAppsEnableAPIHelp").hide()},this.showGoogleAppContactFetchFailureDlg=function(){ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.share.shareview.js.google_appusers_fetch_failed"))},this.authGUser=function(a,b,c){if(a=="GOOGLE_AUTH_REQUIRED"){var d=ZDBGlobal.GAPP_EMBED_GADGET_URL+"/gdocs?auth=true&zservice="+ZDBGlobal.GAPP_ZSERVICE+"&border=no&serURL="+ZDBGlobal.REPORTS_SERVER_URL+ZDBGlobal.REPORTS_CONTEXT_NAME+"/integ/GResponseRedirect.jsp?gauth_type="+c;ZDBGoogleInteg.authGoogle(d)}else a=="GSHEETS_NOT_FOUND"?ZDBAlertAPI.showMsg(b,"ZDBYESNO",{ONCLICK:ZDBGoogleInteg.confirmRefetchGSheet,GAUTH_TYPE:c}):a=="GSHEETS_NOAUTH_HEADER_INFO"&&ZDBAlertAPI.showMsg(b)},this.confirmRefetchGSheet=function(a,b){if(a!="YES")return;var c=b.GAUTH_TYPE,d="/ZDBSecurityAction.ma?ZDBACTION=ZDBREVOKEGTOKEN&GTYPE=sheets";AjaxAPI.sendRequest({URL:d,ONSUCCESSFUNC:ZDBGoogleInteg.handleRevokeGToken,ONFAILUREFUNC:ZDBGoogleInteg.handleRevokeGTokenFailure,GOOGLETYPE:c})},this.showGoogleLogin=function(){var a=ZDBGlobal.GAPP_EMBED_GADGET_URL+"/zgadwords?zservice=zreports&serURL="+ZDBGlobal.REPORTS_SERVER_URL+ZDBGlobal.REPORTS_CONTEXT_NAME+"/integ/GResponseRedirect.jsp?gauth_type=gadwords";ZDBGoogleInteg.authGoogleAdwords(a)},this.closeDialog=function(){if(ZDBCreateDB.isInHomePage()){var a=$("ZDBIMPSCHDBID").innerHTML;ZDBCreateDB.changeWindowURL(a)}return!0},this.showDateString=function(a){if(a.value==""&&a.getAttribute("tipShown")=="false"){var b=a.getAttribute("elname");a.value=b=="fromValue"?ZDBI18NMap.g("zrpt.home.ga.js.from"):ZDBI18NMap.g("zrpt.home.ga.js.to");var c=b=="fromValue"?"From":"To";a.setAttribute("inputVal",c)}},this.enableCustomDate=function(a){if(a=="100"){var b=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");$("gadcustomeperiod").style.display="inline";var c=new Date,d=c.getDate();d=d==31?d-1:d;var e=c.getMonth()==0?"Dec":b[c.getMonth()-1],f=c.getMonth()==0?c.getFullYear()-1:c.getFullYear();$("ZDBGAFromDate").value=d+" "+e+" "+f}else $("gadcustomeperiod").style.display="none"},this.initCalender=function(a){hideCustomMessage();var b=new Date,c=1e3,d=b.getFullYear(),e="%d %b %Y ";Calendar.setup({inputField:a,ifFormat:e,showsTime:!1,button:a,singleClick:!0,weekNumbers:!1,range:[c,d],step:1,onClose:function(){this.hide(),this.destroy()}}),a.initialized=!0},this.closeDateDialog=function(a){a.keyCode==27&&ZDBGoogleInteg.showDateString(a)}};ZDBLazyLoadFuncMap.lazyLoadFuncMap["ZDBGoogleInteg.fetchSetupDetails"]=ZDBGoogleInteg.fetchSetupDetails,ZDBLazyLoadFuncMap.lazyLoadFuncMap["ZDBGoogleInteg.getGoogleDocs"]=ZDBGoogleInteg.getGoogleDocs,ZDBLazyLoadFuncMap.lazyLoadFuncMap["ZDBGoogleInteg.openMyGoogleAppUsers"]=ZDBGoogleInteg.openMyGoogleAppUsers,ZDBLazyLoadFuncMap.lazyLoadFuncMap["ZDBGoogleInteg.showAndEditModuleList"]=ZDBGoogleInteg.showAndEditModuleList,ZDBLazyLoadFuncMap.lazyLoadFuncMap["ZDBGoogleInteg.showGoogleContacts"]=ZDBGoogleInteg.showGoogleContacts,ZDBLazyLoadFuncMap.lazyLoadFuncMap["ZDBGoogleInteg.showGoogleLogin"]=ZDBGoogleInteg.showGoogleLogin,ZDBLazyLoadFuncMap.lazyLoadFuncMap["ZDBGoogleInteg.fetchOrShowGoogleAppEnableAPIDIV"]=ZDBGoogleInteg.fetchOrShowGoogleAppEnableAPIDIV;var ZDBFunctions=new function(){this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],this.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],this.monthname=function(a){a=ZDBFunctions.getDateObj(a);var b=a.getMonth();return this.monthNames[b]},this.month=function(a){return a=ZDBFunctions.getDateObj(a),a.getMonth()+1},this.partOfMonth=function(a){var b=ZDBFunctions.monthname(a);return b.substr(0,3)},this.dayname=function(a){a=ZDBFunctions.getDateObj(a);var b=a.getDay();return this.dayNames[b]},this.year=function(a){a=ZDBFunctions.getDateObj(a);var b=a.getYear();return b<1e3&&(b+=1900),b},this.day=function(a){return a=ZDBFunctions.getDateObj(a),a.getDate()},this.hour=function(a){return a=ZDBFunctions.getDateObj(a),a.getHours()},this.minute=function(a){return a=ZDBFunctions.getDateObj(a),a.getMinutes()},this.second=function(a){return a=ZDBFunctions.getDateObj(a),a.getSeconds()},this.quarter=function(a){a=ZDBFunctions.getDateObj(a);var b=a.getMonth(),c=parseInt(b/3)+1,d=isNaN(c)?"":c;return d},this.last_day=function(a){a=ZDBFunctions.getDateObj(a);var b=ZDBFunctions.month(a);return b!=2?(a.setDate(this.daysInMonth[b-1]),a):(this.daysInMonth[1]=this.leapyear(a)?29:28,a.setDate(this.daysInMonth[1]),a)},this.makedate=function(a,b){var c=new Date(a,0,0);return c.setDate(c.getDate()+b),c},this.from_unixtime=function(a){var b=a*1e3,c=new Date(b);return c},this.subdate=function(a,b){a=ZDBFunctions.getDateObj(a);var c=b.split(" "),d=parseInt(c[1]);return a.setDate(a.getDate()-d),a},this.repeat=function(a,b){var c=a;if(b>0){for(var d=0;d<b-1;d++)a+=c;return a}return""},this.concat_ws=function(){var a=arguments,b=a[1];for(var c=2;c<a.length;c++)b=b+a[0]+a[c];return b},this.concat=function(){var a=arguments,b=a[0];for(var c=1;c<a.length;c++)b=b+""+a[c];return b},this.isnull=function(a){var b=a==null?1:0;return b},this.abs=function(a){return Math.abs(a)},this.pow=function(a,b){return Math.pow(a,b)},this.sqrt=function(a){return Math.sqrt(a)},this.round=function(a){return Math.round(a)},this.ceil=function(a){return Math.ceil(a)},this.floor=function(a){return Math.floor(a)},this.replace=function(a,b,c){var d=a;if(b==c)return d;var e=d.indexOf(b);while(e!=-1)d=d.replace(b,c),e=d.indexOf(b);return d},this.substring=function(a,b,c){return a.substr(b-1,c)},this.length=function(a){return a.length},this.char_length=function(a){return a.length},this.lower=function(a){return a.toLowerCase()},this.upper=function(a){return a.toUpperCase()},this.trim=function(a){return a.trim()},this.adddate=function(a,b){a=ZDBFunctions.getDateObj(a);var c=b.split(" "),d=parseInt(c[1]);return a.setDate(a.getDate()+d),a},this.greatest=function(){var a=arguments,b=a[0];for(var c=1;c<a.length;c++)b=a[c]>b?a[c]:b;return b},this.acos=function(a){return Math.acos(a)},this.asin=function(a){return Math.asin(a)},this.atan=function(a){return Math.atan(a)},this.atan2=function(a,b){return Math.atan2(a,b)},this.cos=function(a){return Math.cos(a)},this.cot=function(a){return 1/this.tan(a)},this.exp=function(a){return Math.exp(a)},this.least=function(){var a=arguments,b=a[0];for(var c=1;c<a.length;c++)b=a[c]<b?a[c]:b;return b},this.ln=function(a){return Math.log(a)},this.log10=function(a){return Math.log(a)/Math.log(10)},this.log2=function(a){return Math.log(a)/Math.log(2)},this.mod=function(a,b){return a%b},this.pi=function(){return 3.14159265358979},this.rand=function(){return Math.random()},this.sign=function(a){return a==0?0:a>0?1:-1},this.sin=function(a){return Math.sin(a)},this.tan=function(a){return Math.tan(a)},this.degrees=function(a){return a*180/this.pi()},this.radians=function(a){return a*this.pi()/180},this.insert=function(a,b,c,d){return a.length>=b-1&&b>0&&c>=0?a.substr(0,b-1)+d+a.substr(b-1+c,a.length):a.length>=b-1&&b>0&&c<0?a.substr(0,b-1)+d:a},this.instr=function(a,b){return a.indexOf(b)+1},this.left=function(a,b){return a.substr(0,b)},this.locate=function(a,b,c){if(c>0){var d=b.substr(c-1,b.length);return d.indexOf(a)==-1?0:d.indexOf(a)+c}return 0},this.lpad=function(a,b,c){if(a.length<b){var d=b-a.length,e=this.floor(d/c.length),f=this.mod(d,c.length),g="";for(var h=0;h<e;h++)g+=c;return g+c.substr(0,f)+a}return this.left(a,b)},this.ltrim=function(a){for(var b=0;a.charAt(b)==" ";b++);return a.substring(b,a.length)},this.reverse=function(a){var b="";for(var c=a.length-1;c>=0;c--)b+=a.charAt(c);return b},this.right=function(a,b){return a.substr(a.length-b<=0?0:a.length-b,a.length)},this.rpad=function(a,b,c){if(a.length<b){var d=this.lpad(a,b,c),e=d.substr(0,b-a.length),f=d.substr(b-a.length,d.length);return this.concat(f,e)}return this.left(a,b)},this.rtrim=function(a){for(var b=a.length-1;a.charAt(b)==" ";b--);return a.substring(0,b+1)},this.strcmp=function(a,b){var c=a.toLowerCase(),d=b.toLowerCase();return c==d?0:c>d?1:-1},this.datediff=function(a,b){a=ZDBFunctions.getDateObj(a),b=ZDBFunctions.getDateObj(b),a.setHours(0),b.setHours(0);var c=a-b;return this.round(c/864e5)},this.dayofweek=function(a){return a=ZDBFunctions.getDateObj(a),a.getDay()+1},this.leapyear=function(a){a=ZDBFunctions.getDateObj(a);var b=this.year(a);return b%4!=0||b%100==0&&b%400!=0?!1:!0},this.dayofyear=function(a){a=ZDBFunctions.getDateObj(a);var b=this.day(a),c=this.month(a),d=0;this.daysInMonth[1]=this.leapyear(a)?29:28;for(var e=0;e<c-1;e++)d+=this.daysInMonth[e];return d+b},this.now=function(){return Date()},this.ifnull=function(a,b){},this.iffunc=function(a,b,c){},this.needSave=function(){return ZDBConst.NEEDSAVE}};ZDBFunctions.getDateObj=function(a){return a instanceof Date?a:(a=a.replace(/\.\d{6}/,""),new Date(a))},Calendar=function(a,b,c,d){this.activeDiv=null,this.currentDateEl=null,this.getDateStatus=null,this.getDateToolTip=null,this.getDateText=null,this.timeout=null,this.onSelected=c||null,this.onClose=d||null,this.dragging=!1,this.hidden=!1,this.minYear=1970,this.maxYear=2050,this.dateFormat=Calendar._TT.DEF_DATE_FORMAT,this.ttDateFormat=Calendar._TT.TT_DATE_FORMAT,this.isPopup=!0,this.weekNumbers=!0,this.firstDayOfWeek=typeof a=="number"?a:Calendar._FD,this.showsOtherMonths=!1,this.dateStr=b,this.ar_days=null,this.showsTime=!1,this.time24=!0,this.yearStep=2,this.hiliteToday=!0,this.multiple=null,this.table=null,this.element=null,this.tbody=null,this.firstdayname=null,this.monthsCombo=null,this.yearsCombo=null,this.hilitedMonth=null,this.activeMonth=null,this.hilitedYear=null,this.activeYear=null,this.dateClicked=!1;if(typeof Calendar._SDN=="undefined"){typeof Calendar._SDN_len=="undefined"&&(Calendar._SDN_len=3);var e=new Array;for(var f=8;f>0;)e[--f]=Calendar._DN[f].substr(0,Calendar._SDN_len);Calendar._SDN=e,typeof Calendar._SMN_len=="undefined"&&(Calendar._SMN_len=3),e=new Array;for(var f=12;f>0;)e[--f]=Calendar._MN[f].substr(0,Calendar._SMN_len);Calendar._SMN=e}},Calendar._C=null,Calendar.is_ie=/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent),Calendar.is_ie5=Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent),Calendar.is_opera=/opera/i.test(navigator.userAgent),Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent),Calendar.getAbsolutePos=function(a){var b=0,c=0,d=/^div$/i.test(a.tagName);d&&a.scrollLeft&&(b=a.scrollLeft),d&&a.scrollTop&&(c=a.scrollTop);var e={x:a.offsetLeft-b,y:a.offsetTop-c};if(a.offsetParent){var f=this.getAbsolutePos(a.offsetParent);e.x+=f.x,e.y+=f.y}return e},Calendar.isRelated=function(a,b){var c=b.relatedTarget;if(!c){var d=b.type;d=="mouseover"?c=b.fromElement:d=="mouseout"&&(c=b.toElement)}while(c){if(c==a)return!0;c=c.parentNode}return!1},Calendar.removeClass=function(a,b){if(!a||!a.className)return;var c=a.className.split(" "),d=new Array;for(var e=c.length;e>0;)c[--e]!=b&&(d[d.length]=c[e]);a.className=d.join(" ")},Calendar.addClass=function(a,b){Calendar.removeClass(a,b),a.className+=" "+b},Calendar.getElement=function(a){var b=Calendar.is_ie?window.event.srcElement:a.currentTarget;while(b.nodeType!=1||/^div$/i.test(b.tagName))b=b.parentNode;return b},Calendar.getTargetElement=function(a){var b=Calendar.is_ie?window.event.srcElement:a.target;while(b.nodeType!=1)b=b.parentNode;return b},Calendar.stopEvent=function(a){return a||(a=window.event),Calendar.is_ie?(a.cancelBubble=!0,a.returnValue=!1):(a.preventDefault(),a.stopPropagation()),!1},Calendar.addEvent=function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener?a.addEventListener(b,c,!0):a["on"+b]=c},Calendar.removeEvent=function(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener?a.removeEventListener(b,c,!0):a["on"+b]=null},Calendar.createElement=function(a,b){var c=null;return document.createElementNS?c=document.createElementNS("http://www.w3.org/1999/xhtml",a):c=document.createElement(a),typeof b!="undefined"&&b.appendChild(c),c},Calendar._add_evs=function(el){with(Calendar)addEvent(el,"mouseover",dayMouseOver),addEvent(el,"mousedown",dayMouseDown),addEvent(el,"mouseout",dayMouseOut),is_ie&&(addEvent(el,"dblclick",dayMouseDblClick),el.setAttribute("unselectable",!0))},Calendar.findMonth=function(a){return typeof a.month!="undefined"?a:typeof a.parentNode.month!="undefined"?a.parentNode:null},Calendar.findYear=function(a){return typeof a.year!="undefined"?a:typeof a.parentNode.year!="undefined"?a.parentNode:null},Calendar.showMonthsCombo=function(){var a=Calendar._C;if(!a)return!1;var a=a,b=a.activeDiv,c=a.monthsCombo;a.hilitedMonth&&Calendar.removeClass(a.hilitedMonth,"hilite"),a.activeMonth&&Calendar.removeClass(a.activeMonth,"active");var d=a.monthsCombo.getElementsByTagName("div")[a.date.getMonth()];Calendar.addClass(d,"active"),a.activeMonth=d;var e=c.style;e.display="block";if(b.navtype<0)e.left=b.offsetLeft+"px";else{var f=c.offsetWidth;typeof f=="undefined"&&(f=50),e.left=b.offsetLeft+b.offsetWidth-f+"px"}e.top=b.offsetTop+b.offsetHeight+"px"},Calendar.showYearsCombo=function(a){var b=Calendar._C;if(!b)return!1;var b=b,c=b.activeDiv,d=b.yearsCombo;b.hilitedYear&&Calendar.removeClass(b.hilitedYear,"hilite"),b.activeYear&&Calendar.removeClass(b.activeYear,"active"),b.activeYear=null;var e=b.date.getFullYear()+(a?1:-1),f=d.firstChild,g=!1;for(var h=12;h>0;--h)e>=b.minYear&&e<=b.maxYear?(f.innerHTML=e,f.year=e,f.style.display="block",g=!0):f.style.display="none",f=f.nextSibling,e+=a?b.yearStep:-b.yearStep;if(g){var i=d.style;i.display="block";if(c.navtype<0)i.left=c.offsetLeft+"px";else{var j=d.offsetWidth;typeof j=="undefined"&&(j=50),i.left=c.offsetLeft+c.offsetWidth-j+"px"}i.top=c.offsetTop+c.offsetHeight+"px"}},Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal)return!1;cal.timeout&&clearTimeout(cal.timeout);var el=cal.activeDiv;if(!el)return!1;var target=Calendar.getTargetElement(ev);ev||(ev=window.event),Calendar.removeClass(el,"active"),(target==el||target.parentNode==el)&&Calendar.cellClick(el,ev);var mon=Calendar.findMonth(target),date=null;if(mon)date=new Date(cal.date),mon.month!=date.getMonth()&&(date.setMonth(mon.month),cal.setDate(date),cal.dateClicked=!1,cal.callHandler());else{var year=Calendar.findYear(target);year&&(date=new Date(cal.date),year.year!=date.getFullYear()&&(date.setFullYear(year.year),cal.setDate(date),cal.dateClicked=!1,cal.callHandler()))}with(Calendar)return removeEvent(document,"mouseup",tableMouseUp),removeEvent(document,"mouseover",tableMouseOver),removeEvent(document,"mousemove",tableMouseOver),cal._hideCombos(),_C=null,stopEvent(ev)},Calendar.tableMouseOver=function(a){var b=Calendar._C;if(!b)return;var c=b.activeDiv,d=Calendar.getTargetElement(a);d==c||d.parentNode==c?(Calendar.addClass(c,"hilite active"),Calendar.addClass(c.parentNode,"rowhilite")):((typeof c.navtype=="undefined"||c.navtype!=50&&(c.navtype==0||Math.abs(c.navtype)>2))&&Calendar.removeClass(c,"active"),Calendar.removeClass(c,"hilite"),Calendar.removeClass(c.parentNode,"rowhilite")),a||(a=window.event);if(c.navtype==50&&d!=c){var e=Calendar.getAbsolutePos(c),f=c.offsetWidth,g=a.clientX,h,i=!0;g>e.x+f?(h=g-e.x-f,i=!1):h=e.x-g,h<0&&(h=0);var j=c._range,k=c._current,l=Math.floor(h/10)%j.length;for(var m=j.length;--m>=0;)if(j[m]==k)break;while(l-->0)i?--m<0&&(m=j.length-1):++m>=j.length&&(m=0);var n=j[m];c.innerHTML=n,b.onUpdateTime()}var o=Calendar.findMonth(d);if(o)o.month!=b.date.getMonth()?(b.hilitedMonth&&Calendar.removeClass(b.hilitedMonth,"hilite"),Calendar.addClass(o,"hilite"),b.hilitedMonth=o):b.hilitedMonth&&Calendar.removeClass(b.hilitedMonth,"hilite");else{b.hilitedMonth&&Calendar.removeClass(b.hilitedMonth,"hilite");var p=Calendar.findYear(d);p?p.year!=b.date.getFullYear()?(b.hilitedYear&&Calendar.removeClass(b.hilitedYear,"hilite"),Calendar.addClass(p,"hilite"),b.hilitedYear=p):b.hilitedYear&&Calendar.removeClass(b.hilitedYear,"hilite"):b.hilitedYear&&Calendar.removeClass(b.hilitedYear,"hilite")}return Calendar.stopEvent(a)},Calendar.tableMouseDown=function(a){if(Calendar.getTargetElement(a)==Calendar.getElement(a))return Calendar.stopEvent(a)},Calendar.calDragIt=function(a){var b=Calendar._C;if(!b||!b.dragging)return!1;var c,d;Calendar.is_ie?(d=window.event.clientY+document.body.scrollTop,c=window.event.clientX+document.body.scrollLeft):(c=a.pageX,d=a.pageY),b.hideShowCovered();var e=b.element.style;return e.left=c-b.xOffs+"px",e.top=d-b.yOffs+"px",Calendar.stopEvent(a)},Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal)return!1;cal.dragging=!1;with(Calendar)removeEvent(document,"mousemove",calDragIt),removeEvent(document,"mouseup",calDragEnd),tableMouseUp(ev);cal.hideShowCovered()},Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled)return!1;var cal=el.calendar;cal.activeDiv=el,Calendar._C=cal;if(el.navtype!=300)with(Calendar)el.navtype==50?(el._current=el.innerHTML,addEvent(document,"mousemove",tableMouseOver)):addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver),addClass(el,"hilite active"),addEvent(document,"mouseup",tableMouseUp);else cal.isPopup&&cal._dragStart(ev);return el.navtype==-1||el.navtype==1?(cal.timeout&&clearTimeout(cal.timeout),cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)):el.navtype==-2||el.navtype==2?(cal.timeout&&clearTimeout(cal.timeout),cal.timeout=setTimeout(el.navtype>0?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)):cal.timeout=null,Calendar.stopEvent(ev)},Calendar.dayMouseDblClick=function(a){Calendar.cellClick(Calendar.getElement(a),a||window.event),Calendar.is_ie&&document.selection.empty()},Calendar.dayMouseOver=function(a){var b=Calendar.getElement(a);return Calendar.isRelated(b,a)||Calendar._C||b.disabled?!1:(b.ttip&&(b.ttip.substr(0,1)=="_"&&(b.ttip=b.caldate.print(b.calendar.ttDateFormat)+b.ttip.substr(1)),b.calendar.tooltips.innerHTML=b.ttip),b.navtype!=300&&(Calendar.addClass(b,"hilite"),b.caldate&&Calendar.addClass(b.parentNode,"rowhilite")),Calendar.stopEvent(a))},Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);return isRelated(el,ev)||_C||el.disabled?!1:(removeClass(el,"hilite"),el.caldate&&removeClass(el.parentNode,"rowhilite"),el.calendar&&(el.calendar.tooltips.innerHTML=_TT.SEL_DATE),stopEvent(ev))}},Calendar.cellClick=function(a,b){var c=a.calendar,d=!1,e=!1,f=null;if(typeof a.navtype=="undefined"){c.currentDateEl&&(Calendar.removeClass(c.currentDateEl,"selected"),Calendar.addClass(a,"selected"),d=c.currentDateEl==a,d||(c.currentDateEl=a)),c.date.setDateOnly(a.caldate),f=c.date;var g=!(c.dateClicked=!a.otherMonth);!g&&!c.currentDateEl?c._toggleMultipleDate(new Date(f)):e=!a.disabled,g&&c._init(c.firstDayOfWeek,f)}else{if(a.navtype==200){Calendar.removeClass(a,"hilite"),c.callCloseHandler();return}f=new Date(c.date),a.navtype==0&&f.setDateOnly(new Date),c.dateClicked=!1;var h=f.getFullYear(),i=f.getMonth();function j(a){var b=f.getDate(),c=f.getMonthDays(a);b>c&&f.setDate(c),f.setMonth(a)}switch(a.navtype){case 400:Calendar.removeClass(a,"hilite");var k=Calendar._TT.ABOUT;typeof k!="undefined"?k+=c.showsTime?Calendar._TT.ABOUT_TIME:"":k='Help and about box text is not translated into this language.\nIf you know this language and you feel generous please update\nthe corresponding file in "lang" subdir to match calendar-en.js\nand send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\nThank you!\nhttp://dynarch.com/mishoo/calendar.epl\n',alert(k);return;case-2:h>c.minYear&&f.setFullYear(h-1);break;case-1:i>0?j(i-1):h-->c.minYear&&(f.setFullYear(h),j(11));break;case 1:i<11?j(i+1):h<c.maxYear&&(f.setFullYear(h+1),j(0));break;case 2:h<c.maxYear&&f.setFullYear(h+1);break;case 100:c.setFirstDayOfWeek(a.fdow);return;case 50:var l=a._range,m=a.innerHTML;for(var n=l.length;--n>=0;)if(l[n]==m)break;b&&b.shiftKey?--n<0&&(n=l.length-1):++n>=l.length&&(n=0);var o=l[n];a.innerHTML=o,c.onUpdateTime();return;case 0:if(typeof c.getDateStatus=="function"&&c.getDateStatus(f,f.getFullYear(),f.getMonth(),f.getDate()))return!1}f.equalsTo(c.date)?a.navtype==0&&(e=d=!0):(c.setDate(f),e=!0)}e&&b&&c.callHandler(),d&&(Calendar.removeClass(a,"hilite"),b&&c.callCloseHandler())},Calendar.prototype.create=function(a){var b=null;a?(b=a,this.isPopup=!1):(b=document.getElementsByTagName("body")[0],this.isPopup=!0),this.date=this.dateStr?new Date(this.dateStr):new Date;var c=Calendar.createElement("table");this.table=c,c.cellSpacing=0,c.cellPadding=0,c.calendar=this,Calendar.addEvent(c,"mousedown",Calendar.tableMouseDown);var d=Calendar.createElement("div");this.element=d,d.className="calendar",this.isPopup&&(d.style.position="absolute",d.style.display="none"),d.style.zIndex="6000",d.appendChild(c);var e=Calendar.createElement("thead",c),f=null,g=null,h=this,i=function(a,b,c){return f=Calendar.createElement("td",g),f.colSpan=b,f.className="button",c!=0&&Math.abs(c)<=2&&(f.className+=" nav"),Calendar._add_evs(f),f.calendar=h,f.navtype=c,f.innerHTML="<div unselectable='on'>"+a+"</div>",f};g=Calendar.createElement("tr",e);var j=6;this.isPopup&&--j,this.weekNumbers&&++j,i("?",1,400).ttip=Calendar._TT.INFO,this.title=i("",j,300),this.title.className="title",this.isPopup&&(this.title.ttip=Calendar._TT.DRAG_TO_MOVE,this.title.style.cursor="move",i("&#x00d7;",1,200).ttip=Calendar._TT.CLOSE),g=Calendar.createElement("tr",e),g.className="headrow",this._nav_py=i("&#x00ab;",1,-2),this._nav_py.ttip=Calendar._TT.PREV_YEAR,this._nav_pm=i("&#x2039;",1,-1),this._nav_pm.ttip=Calendar._TT.PREV_MONTH,this._nav_now=i(Calendar._TT.TODAY,this.weekNumbers?4:3,0),this._nav_now.ttip=Calendar._TT.GO_TODAY,this._nav_nm=i("&#x203a;",1,1),this._nav_nm.ttip=Calendar._TT.NEXT_MONTH,this._nav_ny=i("&#x00bb;",1,2),this._nav_ny.ttip=Calendar._TT.NEXT_YEAR,g=Calendar.createElement("tr",e),g.className="daynames",this.weekNumbers&&(f=Calendar.createElement("td",g),f.className="name wn",f.innerHTML=Calendar._TT.WK);for(var k=7;k>0;--k)f=Calendar.createElement("td",g),k||(f.navtype=100,f.calendar=this,Calendar._add_evs(f));this.firstdayname=this.weekNumbers?g.firstChild.nextSibling:g.firstChild,this._displayWeekdays();var l=Calendar.createElement("tbody",c);this.tbody=l;for(k=6;k>0;--k){g=Calendar.createElement("tr",l),this.weekNumbers&&(f=Calendar.createElement("td",g));for(var m=7;m>0;--m)f=Calendar.createElement("td",g),f.calendar=this,Calendar._add_evs(f)}this.showsTime?(g=Calendar.createElement("tr",l),g.className="time",f=Calendar.createElement("td",g),f.className="time",f.colSpan=2,f.innerHTML=Calendar._TT.TIME||"&nbsp;",f=Calendar.createElement("td",g),f.className="time",f.colSpan=this.weekNumbers?4:3,function(){function a(a,b,c,d){var e=Calendar.createElement("span",f);e.className=a,e.innerHTML=b,e.calendar=h,e.ttip=Calendar._TT.TIME_PART,e.navtype=50,e._range=[];if(typeof c!="number")e._range=c;else for(var g=c;g<=d;++g){var i;g<10&&d>=10?i="0"+g:i=""+g,e._range[e._range.length]=i}return Calendar._add_evs(e),e}var b=h.date.getHours(),c=h.date.getMinutes(),d=h.date.getSeconds(),e=!h.time24,i=b>12;e&&i&&(b-=12);var j=a("hour",b,e?1:0,e?12:23),k=Calendar.createElement("span",f);k.innerHTML=":",k.className="colon";var l=a("minute",c,0,59),k=Calendar.createElement("span",f);k.innerHTML=":",k.className="colon";var m=a("second",10,0,59),n=null;f=Calendar.createElement("td",g),f.className="time",f.colSpan=2,e?n=a("ampm",i?"pm":"am",["am","pm"]):f.innerHTML="&nbsp;",h.onSetTime=function(){var a,b=this.date.getHours(),c=this.date.getMinutes();d=this.date.getSeconds(),e&&(a=b>=12,a&&(b-=12),b==0&&(b=12),n.innerHTML=a?"pm":"am"),j.innerHTML=b<10?"0"+b:b,l.innerHTML=c<10?"0"+c:c,m.innerHTML=d<10?"0"+d:d},h.onUpdateTime=function(){var a=this.date,b=parseInt(j.innerHTML,10);e&&(/pm/i.test(n.innerHTML)&&b<12?b+=12:/am/i.test(n.innerHTML)&&b==12&&(b=0));var c=a.getDate(),d=a.getMonth(),f=a.getFullYear();a.setHours(b),a.setMinutes(parseInt(l.innerHTML,10)),a.setSeconds(parseInt(m.innerHTML,10)),a.setFullYear(f),a.setMonth(d),a.setDate(c),this.dateClicked=!1,this.callHandler()}}()):this.onSetTime=this.onUpdateTime=function(){};var n=Calendar.createElement("tfoot",c);g=Calendar.createElement("tr",n),g.className="footrow",f=i(Calendar._TT.SEL_DATE,this.weekNumbers?8:7,300),f.className="ttip",this.isPopup&&(f.ttip=Calendar._TT.DRAG_TO_MOVE,f.style.cursor="move"),this.tooltips=f,d=Calendar.createElement("div",this.element),this.monthsCombo=d,d.className="combo";for(k=0;k<Calendar._MN.length;++k){var o=Calendar.createElement("div");o.className=Calendar.is_ie?"label-IEfix":"label",o.month=k,o.innerHTML=Calendar._SMN[k],d.appendChild(o)}d=Calendar.createElement("div",this.element),this.yearsCombo=d,d.className="combo";for(k=12;k>0;--k){var p=Calendar.createElement("div");p.className=Calendar.is_ie?"label-IEfix":"label",d.appendChild(p)}this._init(this.firstDayOfWeek,this.date),b.appendChild(this.element)},Calendar._keyEvent=function(a){var b=window._dynarch_popupCalendar;if(!b||b.multiple)return!1;Calendar.is_ie&&(a=window.event);var c=Calendar.is_ie||a.type=="keypress",d=a.keyCode;if(a.ctrlKey)switch(d){case 37:c&&Calendar.cellClick(b._nav_pm);break;case 38:c&&Calendar.cellClick(b._nav_py);break;case 39:c&&Calendar.cellClick(b._nav_nm);break;case 40:c&&Calendar.cellClick(b._nav_ny);break;default:return!1}else switch(d){case 32:Calendar.cellClick(b._nav_now);break;case 27:c&&b.callCloseHandler();break;case 37:case 38:case 39:case 40:if(c){var e,f,g,h,i,j;e=d==37||d==38,j=d==37||d==39?1:7;function k(){i=b.currentDateEl;var a=i.pos;f=a&15,g=a>>4,h=b.ar_days[g][f]}k();function l(){var a=new Date(b.date);a.setDate(a.getDate()-j),b.setDate(a)}function m(){var a=new Date(b.date);a.setDate(a.getDate()+j),b.setDate(a)}for(;;){switch(d){case 37:if(!(--f>=0)){f=6,d=38;continue}h=b.ar_days[g][f];break;case 38:--g>=0?h=b.ar_days[g][f]:(l(),k());break;case 39:if(!(++f<7)){f=0,d=40;continue}h=b.ar_days[g][f];break;case 40:++g<b.ar_days.length?h=b.ar_days[g][f]:(m(),k())}break}h&&(h.disabled?e?l():m():Calendar.cellClick(h))}break;case 13:c&&Calendar.cellClick(b.currentDateEl,a);break;default:return!1}return Calendar.stopEvent(a)},Calendar.prototype._init=function(a,b){var c=new Date,d=c.getFullYear(),e=c.getMonth(),f=c.getDate();this.table.style.visibility="hidden";var g=b.getFullYear();g<this.minYear?(g=this.minYear,b.setFullYear(g)):g>this.maxYear&&(g=this.maxYear,b.setFullYear(g)),this.firstDayOfWeek=a,this.date=new Date(b);var h=b.getMonth(),i=b.getDate(),j=b.getMonthDays();b.setDate(1);var k=(b.getDay()-this.firstDayOfWeek)%7;k<0&&(k+=7),b.setDate(-k),b.setDate(b.getDate()+1);var l=this.tbody.firstChild,m=Calendar._SMN[h],n=this.ar_days=new Array,o=Calendar._TT.WEEKEND,p=this.multiple?this.datesCells={}:null;for(var q=0;q<6;++q,l=l.nextSibling){var r=l.firstChild;this.weekNumbers&&(r.className="day wn",r.innerHTML=b.getWeekNumber(),r=r.nextSibling),l.className="daysrow";var s=!1,t,u=n[q]=[];for(var v=0;v<7;++v,r=r.nextSibling,b.setDate(t+1)){t=b.getDate();var w=b.getDay();r.className="day",r.pos=q<<4|v,u[v]=r;var x=b.getMonth()==h;if(!x){if(!this.showsOtherMonths){r.className="emptycell",r.innerHTML="&nbsp;",r.disabled=!0;continue}r.className+=" othermonth",r.otherMonth=!0}else r.otherMonth=!1,s=!0;r.disabled=!1,r.innerHTML=this.getDateText?this.getDateText(b,t):t,p&&(p[b.print("%Y%m%d")]=r);if(this.getDateStatus){var y=this.getDateStatus(b,g,h,t);if(this.getDateToolTip){var z=this.getDateToolTip(b,g,h,t);z&&(r.title=z)}y===!0?(r.className+=" disabled",r.disabled=!0):(/disabled/i.test(y)&&(r.disabled=!0),r.className+=" "+y)}r.disabled||(r.caldate=new Date(b),r.ttip="_",!this.multiple&&x&&t==i&&this.hiliteToday&&(r.className+=" selected",this.currentDateEl=r),b.getFullYear()==d&&b.getMonth()==e&&t==f&&(r.className+=" today",r.ttip+=Calendar._TT.PART_TODAY),o.indexOf(w.toString())!=-1&&(r.className+=r.otherMonth?" oweekend":" weekend"))}!s&&!this.showsOtherMonths&&(l.className="emptyrow")}this.title.innerHTML=Calendar._MN[h]+", "+g,this.onSetTime(),this.table.style.visibility="visible",this._initMultipleDates()},Calendar.prototype._initMultipleDates=function(){if(this.multiple)for(var a in this.multiple){var b=this.datesCells[a],c=this.multiple[a];if(!c)continue;b&&(b.className+=" selected")}},Calendar.prototype._toggleMultipleDate=function(a){if(this.multiple){var b=a.print("%Y%m%d"),c=this.datesCells[b];if(c){var d=this.multiple[b];d?(Calendar.removeClass(c,"selected"),delete this.multiple[b]):(Calendar.addClass(c,"selected"),this.multiple[b]=a)}}},Calendar.prototype.setDateToolTipHandler=function(a){this.getDateToolTip=a},Calendar.prototype.setDate=function(a){a.equalsTo(this.date)||this._init(this.firstDayOfWeek,a)},Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)},Calendar.prototype.setFirstDayOfWeek=function(a){this._init(a,this.date),this._displayWeekdays()},Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(a){this.getDateStatus=a},Calendar.prototype.setRange=function(a,b){this.minYear=a,this.maxYear=b},Calendar.prototype.callHandler=function(){this.onSelected&&this.onSelected(this,this.date.print(this.dateFormat))},Calendar.prototype.callCloseHandler=function(){this.onClose&&this.onClose(this),this.hideShowCovered()},Calendar.prototype.destroy=function(){var a=this.element.parentNode;a&&a.removeChild(this.element),Calendar._C=null,window._dynarch_popupCalendar=null},Calendar.prototype.reparent=function(a){var b=this.element;b.parentNode.removeChild(b),a.appendChild(b)},Calendar._checkCalendar=function(a){var b=window._dynarch_popupCalendar;if(!b)return!1;var c=Calendar.is_ie?Calendar.getElement(a):Calendar.getTargetElement(a);for(;c!=null&&c!=b.element;c=c.parentNode);if(c==null)return window._dynarch_popupCalendar.callCloseHandler(),Calendar.stopEvent(a)},Calendar.prototype.show=function(){var a=this.table.getElementsByTagName("tr");for(var b=a.length;b>0;){var c=a[--b];Calendar.removeClass(c,"rowhilite");var d=c.getElementsByTagName("td");for(var e=d.length;e>0;){var f=d[--e];Calendar.removeClass(f,"hilite"),Calendar.removeClass(f,"active")}}this.element.style.display="block",this.hidden=!1,this.isPopup&&(window._dynarch_popupCalendar=this,Calendar.addEvent(document,"keydown",Calendar._keyEvent),Calendar.addEvent(document,"keypress",Calendar._keyEvent),Calendar.addEvent(document
,"mousedown",Calendar._checkCalendar)),this.hideShowCovered()},Calendar.prototype.hide=function(){this.isPopup&&(Calendar.removeEvent(document,"keydown",Calendar._keyEvent),Calendar.removeEvent(document,"keypress",Calendar._keyEvent),Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)),this.element.style.display="none",this.hidden=!0,this.hideShowCovered()},Calendar.prototype.showAt=function(a,b){var c=this.element.style;c.left=a+"px",c.top=b+"px",this.show()},Calendar.prototype.showAtElement=function(a,b){function e(a){a.x<0&&(a.x=0),a.y<0&&(a.y=0);var b=document.createElement("div"),c=b.style;c.position="absolute",c.right=c.bottom=c.width=c.height="0px",document.body.appendChild(b);var d=Calendar.getAbsolutePos(b);document.body.removeChild(b),Calendar.is_ie?(d.y+=document.body.scrollTop,d.x+=document.body.scrollLeft):(d.y+=window.scrollY,d.x+=window.scrollX);var e=a.x+a.width-d.x;e>0&&(a.x-=e),e=a.y+a.height-d.y,e>0&&(a.y-=e)}var c=this,d=Calendar.getAbsolutePos(a);if(!b||typeof b!="string")return this.showAt(d.x,d.y+a.offsetHeight),!0;this.element.style.display="block",Calendar.continuation_for_the_fucking_khtml_browser=function(){var f=c.element.offsetWidth,g=c.element.offsetHeight;c.element.style.display="none";var h=b.substr(0,1),i="l";b.length>1&&(i=b.substr(1,1));switch(h){case"T":d.y-=g;break;case"B":d.y+=a.offsetHeight;break;case"C":d.y+=(a.offsetHeight-g)/2;break;case"t":d.y+=a.offsetHeight-g;break;case"b":}switch(i){case"L":d.x-=f;break;case"R":d.x+=a.offsetWidth;break;case"C":d.x+=(a.offsetWidth-f)/2;break;case"l":d.x+=a.offsetWidth-f;break;case"r":}d.width=f,d.height=g+40,c.monthsCombo.style.display="none",e(d),c.showAt(d.x,d.y)},Calendar.is_khtml?setTimeout("Calendar.continuation_for_the_fucking_khtml_browser()",10):Calendar.continuation_for_the_fucking_khtml_browser()},Calendar.prototype.setDateFormat=function(a){this.dateFormat=a},Calendar.prototype.setTtDateFormat=function(a){this.ttDateFormat=a},Calendar.prototype.parseDate=function(a,b){b||(b=this.dateFormat),this.setDate(Date.parseDate(a,b))},Calendar.prototype.hideShowCovered=function(){function a(a){var b=a.style.visibility;return b||(document.defaultView&&typeof document.defaultView.getComputedStyle=="function"?Calendar.is_khtml?b="":b=document.defaultView.getComputedStyle(a,"").getPropertyValue("visibility"):a.currentStyle?b=a.currentStyle.visibility:b=""),b}if(!Calendar.is_ie&&!Calendar.is_opera)return;var b=new Array("applet","iframe","select"),c=this.element,d=Calendar.getAbsolutePos(c),e=d.x,f=c.offsetWidth+e,g=d.y,h=c.offsetHeight+g;for(var i=b.length;i>0;){var j=document.getElementsByTagName(b[--i]),k=null;for(var l=j.length;l>0;){k=j[--l],d=Calendar.getAbsolutePos(k);var m=d.x,n=k.offsetWidth+m,o=d.y,p=k.offsetHeight+o;this.hidden||m>f||n<e||o>h||p<g?(k.__msh_save_visibility||(k.__msh_save_visibility=a(k)),k.style.visibility=k.__msh_save_visibility):(k.__msh_save_visibility||(k.__msh_save_visibility=a(k)),k.style.visibility="hidden")}}},Calendar.prototype._displayWeekdays=function(){var a=this.firstDayOfWeek,b=this.firstdayname,c=Calendar._TT.WEEKEND;for(var d=0;d<7;++d){b.className="day name";var e=(d+a)%7;d&&(b.ttip=Calendar._TT.DAY_FIRST.replace("%s",Calendar._DN[e]),b.navtype=100,b.calendar=this,b.fdow=e,Calendar._add_evs(b)),c.indexOf(e.toString())!=-1&&Calendar.addClass(b,"weekend"),b.innerHTML=Calendar._SDN[(d+a)%7],b=b.nextSibling}},Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none",this.yearsCombo.style.display="none"},Calendar.prototype._dragStart=function(ev){if(this.dragging)return;this.dragging=!0;var posX,posY;Calendar.is_ie?(posY=window.event.clientY+document.body.scrollTop,posX=window.event.clientX+document.body.scrollLeft):(posY=ev.clientY+window.scrollY,posX=ev.clientX+window.scrollX);var st=this.element.style;this.xOffs=posX-parseInt(st.left),this.yOffs=posY-parseInt(st.top);with(Calendar)addEvent(document,"mousemove",calDragIt),addEvent(document,"mouseup",calDragEnd)},Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31),Date.SECOND=1e3,Date.MINUTE=60*Date.SECOND,Date.HOUR=60*Date.MINUTE,Date.DAY=24*Date.HOUR,Date.WEEK=7*Date.DAY,Date.parseDate=function(a,b){var c=new Date,d=0,e=-1,f=0,g=a.split(/\W+/),h=b.match(/%./g),i=0,j=0,k=0,l=0,m=0,n=0;for(i=0;i<g.length;++i){if(!g[i])continue;switch(h[i]){case"%d":case"%e":f=parseInt(g[i],10);break;case"%m":e=parseInt(g[i],10)-1;break;case"%Y":case"%y":d=parseInt(g[i],10),d<100&&(d+=d>29?1900:2e3);break;case"%b":case"%B":for(j=0;j<12;++j)if(Calendar._MN[j].substr(0,g[i].length).toLowerCase()==g[i].toLowerCase()){e=j;break}break;case"%H":case"%I":case"%k":case"%l":k=parseInt(g[i],10);break;case"%P":case"%p":/pm/i.test(g[i])&&k<12?k+=12:/am/i.test(g[i])&&k>=12&&(k-=12);break;case"%M":l=parseInt(g[i],10);break;case"%S":m=parseInt(g[i],10);break;case"%f":case"%F":n=g[i]}}isNaN(d)&&(d=c.getFullYear()),isNaN(e)&&(e=c.getMonth()),isNaN(f)&&(f=c.getDate()),isNaN(k)&&(k=c.getHours()),isNaN(l)&&(l=c.getMinutes()),isNaN(m)&&(m=c.getMinutes()),isNaN(n)&&(n=0);var o=n>=1e3?parseInt(n)/1e3:n;if(d!=0&&e!=-1&&f!=0){var p=new Date(d,e,f,k,l,m);return p.setMilliseconds(o),p}d=0,e=-1,f=0;for(i=0;i<g.length;++i)if(g[i].search(/[a-zA-Z]+/)!=-1){var q=-1;for(j=0;j<12;++j)if(Calendar._MN[j].substr(0,g[i].length).toLowerCase()==g[i].toLowerCase()){q=j;break}q!=-1&&(e!=-1&&(f=e+1),e=q)}else parseInt(g[i],10)<=12&&e==-1?e=g[i]-1:parseInt(g[i],10)>31&&d==0?(d=parseInt(g[i],10),d<100&&(d+=d>29?1900:2e3)):f==0&&(f=g[i]);return d==0&&(d=c.getFullYear()),e!=-1&&f!=0?(p=new Date(d,e,f,k,l,m),p.setMilliseconds(o),p):c},Date.prototype.getMonthDays=function(a){var b=this.getFullYear();return typeof a=="undefined"&&(a=this.getMonth()),0!=b%4||0==b%100&&0!=b%400||a!=1?Date._MD[a]:29},Date.prototype.getDayOfYear=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),b=new Date(this.getFullYear(),0,0,0,0,0),c=a-b;return Math.floor(c/Date.DAY)},Date.prototype.getWeekNumber=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),b=a.getDay();a.setDate(a.getDate()-(b+6)%7+3);var c=a.valueOf();return a.setMonth(0),a.setDate(4),Math.round((c-a.valueOf())/6048e5)+1},Date.prototype.equalsTo=function(a){return this.getFullYear()==a.getFullYear()&&this.getMonth()==a.getMonth()&&this.getDate()==a.getDate()&&this.getHours()==a.getHours()&&this.getMinutes()==a.getMinutes()},Date.prototype.setDateOnly=function(a){var b=new Date(a);this.setDate(1),this.setFullYear(b.getFullYear()),this.setMonth(b.getMonth()),this.setDate(b.getDate())},Date.prototype.print=function(a){var b=this.getMonth(),c=this.getDate(),d=this.getFullYear(),e=this.getWeekNumber(),f=this.getDay(),g={},h=this.getHours(),i=h>=12,j=i?h-12:h,k=this.getDayOfYear();j==0&&(j=12);var l=this.getMinutes(),m=this.getSeconds(),n=this.getMilliseconds();g["%a"]=Calendar._SDN[f],g["%A"]=Calendar._DN[f],g["%b"]=Calendar._SMN[b],g["%B"]=Calendar._MN[b],g["%C"]=1+Math.floor(d/100),g["%d"]=c<10?"0"+c:c,g["%e"]=c,g["%f"]=n<100?n<10?"00"+n:"0"+n:n,g["%H"]=h<10?"0"+h:h,g["%I"]=j<10?"0"+j:j,g["%j"]=k<100?k<10?"00"+k:"0"+k:k,g["%k"]=h,g["%l"]=j,g["%m"]=b<9?"0"+(1+b):1+b,g["%M"]=l<10?"0"+l:l,g["%n"]="\n",g["%p"]=i?"PM":"AM",g["%P"]=i?"pm":"am",g["%s"]=Math.floor(this.getTime()/1e3),g["%S"]=m<10?"0"+m:m,g["%t"]="\t",g["%U"]=g["%W"]=g["%V"]=e<10?"0"+e:e,g["%u"]=f+1,g["%w"]=f,g["%y"]=(""+d).substr(2,2),g["%Y"]=d,g["%%"]="%";var o=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml)return a.replace(o,function(a){return g[a]||a});var p=a.match(o);for(var q=0;q<p.length;q++){var r=g[p[q]];r&&(o=new RegExp(p[q],"g"),a=a.replace(o,r))}return a},Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear,Date.prototype.setFullYear=function(a){var b=new Date(this);b.__msh_oldSetFullYear(a),b.getMonth()!=this.getMonth()&&this.setDate(28),this.__msh_oldSetFullYear(a)},window._dynarch_popupCalendar=null,Calendar._DN=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"),Calendar._SDN=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"),Calendar._FD=0,Calendar._MN=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),Calendar._SMN=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),Calendar._TT={},Calendar._TT.INFO="About the calendar",Calendar._TT.ABOUT="DHTML Date/Time Selector\n(c) dynarch.com 2002-2005 / Author: Mihai Bazon\nFor latest version visit: http://www.dynarch.com/projects/calendar/\nDistributed under GNU LGPL.  See http://gnu.org/licenses/lgpl.html for details.\n\nDate selection:\n- Use the ,  buttons to select year\n- Use the "+String.fromCharCode(8249)+", "+String.fromCharCode(8250)+" buttons to select month\n"+"- Hold mouse button on any of the above buttons for faster selection.",Calendar._TT.ABOUT_TIME="\n\nTime selection:\n- Click on any of the time parts to increase it\n- or Shift-click to decrease it\n- or click and drag for faster selection.",Calendar._TT.PREV_YEAR="Prev. year (hold for menu)",Calendar._TT.PREV_MONTH="Prev. month (hold for menu)",Calendar._TT.GO_TODAY="Go Today",Calendar._TT.NEXT_MONTH="Next month (hold for menu)",Calendar._TT.NEXT_YEAR="Next year (hold for menu)",Calendar._TT.SEL_DATE="Select date",Calendar._TT.DRAG_TO_MOVE="Drag to move",Calendar._TT.PART_TODAY=" (today)",Calendar._TT.DAY_FIRST="Display %s first",Calendar._TT.WEEKEND="0,6",Calendar._TT.CLOSE="Close",Calendar._TT.TODAY="Today",Calendar._TT.TIME_PART="(Shift-)Click or drag to change value",Calendar._TT.DEF_DATE_FORMAT="%Y-%m-%d",Calendar._TT.TT_DATE_FORMAT="%a, %b %e",Calendar._TT.WK="wk",Calendar._TT.TIME="Time:",Calendar.setup=function(a){function b(b,c){typeof a[b]=="undefined"&&(a[b]=c)}function e(a){var b=a.params,c=a.dateClicked||b.electric;c&&b.inputField&&(b.inputField.value=a.date.print(b.ifFormat),typeof b.inputField.onchange=="function"&&b.inputField.onchange()),c&&b.displayArea&&(b.displayArea.innerHTML=a.date.print(b.daFormat)),c&&typeof b.onUpdate=="function"&&b.onUpdate(a),c&&b.flat&&typeof b.flatCallback=="function"&&b.flatCallback(a),c&&b.singleClick&&a.dateClicked&&a.callCloseHandler()}b("inputField",null),b("displayArea",null),b("button",null),b("eventName","click"),b("ifFormat","%Y/%m/%d"),b("daFormat","%Y/%m/%d"),b("singleClick",!0),b("disableFunc",null),b("dateStatusFunc",a.disableFunc),b("dateText",null),b("firstDay",null),b("align","Br"),b("range",[1900,2999]),b("weekNumbers",!0),b("flat",null),b("flatCallback",null),b("onSelect",null),b("onClose",null),b("onUpdate",null),b("date",null),b("showsTime",!1),b("timeFormat","24"),b("electric",!0),b("step",2),b("position",null),b("cache",!1),b("showOthers",!1),b("multiple",null);var c=["inputField","displayArea","button"];for(var d in c)typeof a[c[d]]=="string"&&(a[c[d]]=document.getElementById(a[c[d]]));if(!(a.flat||a.multiple||a.inputField||a.displayArea||a.button))return alert("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code"),!1;if(a.flat!=null){typeof a.flat=="string"&&(a.flat=document.getElementById(a.flat));if(!a.flat)return alert("Calendar.setup:\n  Flat specified but can't find parent."),!1;var f=new Calendar(a.firstDay,a.date,a.onSelect||e);return f.showsOtherMonths=a.showOthers,f.showsTime=a.showsTime,f.time24=a.timeFormat=="24",f.params=a,f.weekNumbers=a.weekNumbers,f.setRange(a.range[0],a.range[1]),f.setDateStatusHandler(a.dateStatusFunc),f.getDateText=a.dateText,a.ifFormat&&f.setDateFormat(a.ifFormat),a.inputField&&typeof a.inputField.value=="string"&&f.parseDate(a.inputField.value),f.create(a.flat),f.show(),!1}var g=a.button||a.displayArea||a.inputField;return g["on"+a.eventName]=function(){var b=a.inputField||a.displayArea,c=a.inputField?a.ifFormat:a.daFormat,d=!1,f=window.calendar;b&&(a.date=Date.parseDate(b.value||b.innerHTML,c)),!f||!a.cache?(window.calendar=f=new Calendar(a.firstDay,a.date,a.onSelect||e,a.onClose||function(a){a.hide()}),f.showsTime=a.showsTime,f.time24=a.timeFormat=="24",f.weekNumbers=a.weekNumbers,d=!0):(a.date&&f.setDate(a.date),f.hide());if(a.multiple){f.multiple={};for(var g=a.multiple.length;--g>=0;){var h=a.multiple[g],i=h.print("%Y%m%d");f.multiple[i]=h}}return f.showsOtherMonths=a.showOthers,f.yearStep=a.step,f.setRange(a.range[0],a.range[1]),f.params=a,f.setDateStatusHandler(a.dateStatusFunc),f.getDateText=a.dateText,f.setDateFormat(c),d&&f.create(),f.refresh(),a.position?f.showAt(a.position[0],a.position[1]):f.showAtElement(a.button||a.displayArea||a.inputField,a.align),!1},f};var sampleTableGrid,opts=["scratch","remote","remotedb","template","import"],ZDBCreateDB=new function(){this.changeWindowURL=function(a,b){window.url=ZDBGlobal.CTX+ZDBGlobal.REPORTS_CONTEXT_NAME+"/ZDBDataSheetView.cc?DBID="+a,b!=null&&(url+="&OBJID="+b),setTimeout("window.location.href = window.url;",0)},this.handleDropDownClose=function(){var a=$("ZDBImportFileWithRelation").querySelectorAll("#FKCOLDROPDOWN");for(i=0;i<a.length;i++)a[i].style.display!="none"&&(a[i].style.display="none");var a=$("ZDBImportFileWithRelation").querySelectorAll("#COLUMNLISTDROPDOWN");for(i=0;i<a.length;i++)a[i].style.display!="none"&&(a[i].style.display="none")},this.count=0,this.blink=function(){var a=jQuery(jQuery("#EnclosingDiv").find(".disableJoinIconNew")[0]).parents().find(".ENCDIV")[0];ZDBCreateDB.count<4?(ZDBCreateDB.count%2!=0?a.style.border="1px solid #cccccc":a.style.border="0px solid #cccccc",ZDBCreateDB.count++,setTimeout(ZDBCreateDB.blink,60)):a.style.border="0px solid #cccccc"},this.showRelDialog=function(){ZDBImport.defineRelationship()},this.gotoSheetView=function(a,b){ZDBClientUI.TBLLIST=null;var c=document.getElementById("TABLEID");if(c!=null||c!=undefined){var d=c.innerHTML;AllowedValPopup.cache["T_"+d]=null}var e=a.params.REQPARAMS;if(e["IM_ABORTED"]=="true"||b=="DONT_FETCH_SHEET")return!0;if(ZDBCreateDB.isInHomePage())ZDBCreateDB.changeWindowURL(e.DBID,e.IM_OBJID);else{var f=e.IM_OBJID,g=window.ZDBClientUI.getExistingTab(f);g!=null?ZDBClientUI.fetchView(f,e.DBID,g.view.displayName,"Table",g):(g=ZDBClientUI.selectedTab,ZDBClientUI.fetchView(e.IM_OBJID,e.DBID,e.TABLENAME,"Table",g),ZDBNavigation.refreshExplorer())}return!0},this.showConnections=function(a,b){return jQuery("#connections_list").html(a.responseText),!1},this.showDatabases=function(a,b){return jQuery("#db_list").html(a.responseText),!1},this.isInHomePage=function(){return window.ZDBClientUI==null||window.ZDBClientUI.selectedTab==null},this.showOptions=function(a){jQuery(a).addClass("ZRSDBHighlight")},this.hideOptions=function(a){if(a.isDialogOpen)return;jQuery(a).removeClass("ZRSDBHighlight")},this.showprevformonEsc=function(){var a=jQuery(document.body).width();jQuery("#ZDBImportFileWithRelation").animate({left:a}).hide(),document.body.removeChild($("IMPORTFREEZE")),ev.escKeyPressStack.pop(),ZDBToolTip.hide()},this.removeHighlight=function(a){var b=a.bodyContent.parEl;return b?(b.isDialogOpen=!1,ZDBCreateDB.hideOptions(b),!0):!0},this.showDBInfo=function(a){jQuery(a).find("ul").show()},this.hideDBInfo=function(a){jQuery(a).find("ul").hide()}},switchtabftp=function(a){var b=a.target;b.style.background="#FFFFFF";var c=document.getElementById("ftp"),d=document.getElementById("ftps"),e=document.getElementById("FTPCHKBOX"),f=document.getElementById("ISFTPS");if(b==c){d.style.background="#F3F3F2",e.style.display="none",c.style.borderBottom="1px solid #FFFFFF",d.style.borderBottom="1px solid #C1C1C1";var g=document.getElementById("FTPPORT");g.value=21,f.value="false"}else{c.style.background="#F3F3F2",e.style.display="inline",d.style.borderBottom="1px solid #FFFFFF",c.style.borderBottom="1px solid #C1C1C1",f.value="true";var h=document.getElementById("IMPLICITCHK");h.checked=!1,implicitchk(h)}},implicitchk=function(a){var b=document.getElementById("FTPPORT");a.checked?b.value=990:b.value=21},changePORT=function(a){var b=a.target,c;b!=null&&(c=sel.options[sel.selectedIndex].value);var d=document.getElementById("FTPPORT");"ftpes"==c?d.value=990:d.value=21},ZDBListDB=new function(){this.showMyRange=function(a,b){ZDBListDB.updatePropAndRefreshTable(a,{_FI:b})},this.updatePropAndRefreshTable=function(a,b){var c=DOMUtils.getSelfOrParentWithAttr(a,"_FI"),d=["_FI","_PL","_TL","LISTTYPE"],e={};for(var f=0;f<d.length;f++)e[d[f]]=c.getAttribute(d[f]);var g=ZDBSearchUtil.getSearchValue($("ZDBDBSEARCHBOX"));e.SCRITERIA=g;var h=jQuery("#ZDBHomeTabs").find("li[listtype='"+e.LISTTYPE+"']")[0];for(var i in b)e[i]=b[i];this.refreshTable(c.parentNode,e,h)},this.refreshTable=function(a,b,c){AjaxAPI.sendRequest({URL:"/ZDBListDatabases.cc",METHOD:"POST",PARAMETERS:this.getAsParams(b),ONSUCCESSFUNC:this.handleTblResp,PARENTNODE:a,TAB:c,OPSTATUSID:"ZDBMainLoader",LOADINGTYPE:"FILLINGLOAD",PARENT:c})},this.handleTblResp=function(a,b){var c=$("ZDBPublicSettingsTip");c&&c.parentNode.removeChild(c);var d=document.querySelector("#ZDBHomeTabs li.buttonSelected"),e;if(d){e=d.getAttribute("listtype");var f=b.TAB.getAttribute("listtype");if(e!==f)return}var g=$(b.PARENTNODE);g.innerHTML=a.responseText,document.body.style.overflow="auto",ZDBListDB.fetchShareInfo(),ZRSHomeUtil.handleFooter(),jQuery(window).scrollTop(0),ZRUserAnalyticsAttacher.attachUAMonitorsToDBlist(e)},this.getAsParams=function(a){var b="";for(var c in a){if(a[c]==null)continue;b+="&"+encodeURIComponent(c)+"="+encodeURIComponent(a[c]+"")}return b},this.checkKeyAndSearch=function(a,b){return b||(b=window.event),b.keyCode==13?(ZDBListDB.searchDatabases(a),!1):!0},this.searchDatabases=function(a){var a=$("ZDBListDatabases_Tbl");ZDBListDB.updatePropAndRefreshTable(a,{_FI:null,_PL:null,_TL:null})},this.updateList=function(){var a=$("ZDBListDatabases_Tbl");ZDBListDB.updatePropAndRefreshTable(a,{_FI:null,_PL:null,_TL:null})},this.fetchShareInfo=function(){var a=$("dbIdListDiv");if(!a)return;var b=a.getAttribute("dbIds");if(b.length<=0)return;var c="ZDBACTION=ZDBGETSHAREINFOFORDBLISTING&DBIDS="+b;AjaxAPI.sendRequest({URL:"/ZDBSecurityAction.ma",PARAMETERS:c,ONSUCCESSFUNC:ZDBListDB.handleFetchShareInfoResp})},this.handleFetchShareInfoResp=function(a,b){var c=JSON.parse(a.responseText);for(dbId in c){var d=c[dbId],e=d.SHAREDUSERS,f=d.DBOWNERS,g=$("ZDBSHAREINFO_"+dbId).innerHTML;$("ZDBSHAREINFO_"+dbId).innerHTML='<li><span class="createdUserStyle">'+ZDBI18NMap.g("zrpt.share.home_page.js.shared_user")+'</span> <span class="createdUserOption">'+e+'</span></li><li><span class="createdUserStyle">'+ZDBI18NMap.g("zrpt.share.home_page.js.db_owner")+' </span><span class="createdUserOption">'+f+"</span></li>"+g}},this.showHelpIcon=function(a){var b=a.getElementsByTagName("span");for(var c=0;c<b.length;c++){var d=b[c];d.id=="homePagePublicHelpIcon"&&(d.style.visibility="visible")}},this.hideHelpIcon=function(a){var b=a.getElementsByTagName("span");for(i=0;i<b.length;i++){var c=b[i];c.id=="homePagePublicHelpIcon"&&(c.style.visibility="hidden")}}},ZDBImport=new function(){};ZDBImport.dateSampleList=[{yyyy:"2014"},{yy:"14"},{MMMM:"November"},{MMM:"Nov"},{MM:"11"},{dd:"24"},{EEEE:"Friday"},{EEE:"Fri"},{" a":" AM"},{HH:"22"},{kk:"23"},{KK:"10"},{hh:"02"},{mm:"47"},{ss:"59"},{SSS:"123"},{z:"GMT+05:30"},{Z:"+0530"},{MILLI:"1353492452"}],ZDBImport.showDateFormats=function(a){ZDBToolTip.hideTip(),ZDBImport.curForm=ZDBUtil.getParentWithTagName(a,"FORM");var b=ZDBUtil.getCachedRef(ZDBImport,"ZDBDATEFORMATS");ZDBUtil.getCachedRef(ZDBImport,"CUSTDATEFRM"),ZDBImport.resetDateDlg(b),b.style.display="",ZDBDialogUtil.showDialog(b,{TITLE:ZDBI18NMap.g("zrpt.common.import.dateformat.js.chooseDlg"),ADDFRAME:!0,MODAL:!0,DONTREMOVE:!0,ONENTER:ZDBImport.submitUserDate,CALLOUT:!0,SRCEL:a});var c=ZDBImport.curForm.DATEFORMAT.value;ZDBImport.CUSTDATEFRM.customDateFormat.value=c,ZDBImport.CUSTDATEFRM.customDateSample.value=ZDBImport.getSampleDate(c);var d=ZDBImport.getDateStrTD(c),e=null;if(d){ZDBImport.setDateFormatEnable(d,!0);var f=jQuery(d).closest("div.ZRSDateListHolder").siblings(".ZRSDateHeader");e=f.get(0)}var g=jQuery(b).find(".ZRSDateHeader.selDtHeader").get(),h=g.length;for(var i=0;i<h;i++)ZDBImport.setDateGroupVisible(g[i]);e&&ZDBImport.setDateGroupVisible(e),hideCustomMessage()},ZDBImport.submitUserDate=function(a){var b=ZDBImport.CUSTDATEFRM.customDateFormat.value;if(b.trim()){var c=ZDBImport.curForm.action;c+="?ZDBACTION=DATEFORMATVALIDATE&DATEFORMAT="+encodeURIComponent(b),$("ZDBIMPORTDATESTATUS").style.display="none",AjaxAPI.sendRequest({URL:c,ONSUCCESSFUNC:"ZDBImport.handleImportDateValidate",OPSTATUSID:"ZDBIMPORTDATESTATUS"});return}ZDBImport.updateDateFormat()},ZDBImport.handleMilliSecond=function(a){a.getAttribute("name")=="DATEFORMAT"&&a.value.toUpperCase()=="MILLI"&&(a.value="MILLI")},ZDBImport.setRefreshPending=function(a){return a.previousValue==a.value?!0:(ZDBImport.handleMilliSecond(a),ZDBImport.isRefreshPending=!0,ZDBImport.refreshElement=a,!0)},ZDBImport.importFormElementFocus=function(a,b){var c=ZDBUtil.getSourceElement(a),d=c.getAttribute("IMPNAME"),e=$("impSettingsHintEl");return e!=null&&e!=undefined&&b!=null&&(e.innerHTML=ZDBI18NMap.g(b)),ZDBImport.isRefreshPending&&(refreshSampleForm(ZDBImport.refreshElement),ZDBImport.isRefreshPending=!1),!0},ZDBImport.importCreateClick=function(a,b){ZDBImport.isRefreshPending?(ZDBImport.isCreatePending=!0,refreshSampleForm(ZDBImport.refreshElement),ZDBImport.isRefreshPending=!1):ZDBImport.canProceed&&ZDBImport.importTable(b)},ZDBImport.updateDateFormat=function(){var a=ZDBImport.curForm.DATEFORMAT,b=ZDBImport.CUSTDATEFRM.customDateFormat,c=ZDBImport.CUSTDATEFRM.customDateSample;a.value=b.value,ZDBImport.setOnDateDiv(c.value,a.value),ZDBDialogUtil.closeDialog(),refreshSampleForm(ZDBImport.curForm.DATEFORMAT)},ZDBImport.getDefaultDateGroupTR=function(){return jQuery("#ZDBDateFormatList").find("[DEFAULTDATEGROUP='true']").get(0)},ZDBImport.getDateStrTD=function(a){var b=ZDBUtil.getCachedRef(ZDBImport,"ZDBDATEFORMATS"),c=b.getElementsByTagName("TD"),d=c.length;for(var e=0;e<c.length;++e){var f=c[e];ZDBUtil.getAttribute(f,"DEFAULTDATEGROUP")&&(ZDBImport.DEFAULTDATEGROUP=f.parentNode);if(ZDBUtil.getAttribute(f,"ISDATE")){var g=f.getElementsByTagName("span"),h=g[1].innerHTML.trim();if(h==a)return f}}return null},ZDBImport.getSampleDateStr=function(a){var b=ZDBImport.getDateStrTD(a);if(b){var c=b.getElementsByTagName("span"),d=c[1].innerHTML.trim();if(d==a)return c[0].innerHTML}return""},ZDBImport.setOnDateDiv=function(a,b){if(!a||a.toLowerCase()=="null")a=ZDBImport.getSampleDateStr(b);var c=ZDBImport.curForm.DATEFORMAT,d=ZDBUtil.getParentWithTagName(c,"DIV"),e=d.getElementsByTagName("span");e[0].innerHTML=a;var f="";b&&b!="NODATE"?(e[1].innerHTML="("+b+")",f=b):e[1].innerHTML="",d.tipInfo={title:"Date Format",tipHTML:"Sample: "+(a?a:"None")+"<BR>"+"Format: "+(f?f:"None")}},ZDBImport.setToolTip=function(a,b){var c=ZDBUtil.getSourceElement(a),d=ZDBUtil.getParentWithTagName(c,"DIV");b?ZDBToolTip.showTip(a,d.tipInfo):ZDBToolTip.hideTip()},ZDBImport.onDateKeyDown=function(a){ZDBImport.prevDateTD&&(ZDBImport.prevDateTD.className="optionnotselected",ZDBImport.prevDateTD=null)},ZDBImport.setDateGroupVisible=function(a){var b=jQuery(a).parents(".ZRSDateHeaderPar")[0],c=jQuery(b).children(".ZRSDateHeader").get(0),d=jQuery(b).children(".ZRSDateListHolder").get(0);jQuery(d).toggle();var e=jQuery(b).find("#ZRSOpenRColIcon");e.toggleClass("rotate45 bottomAlign arrowRotate45fix"),jQuery(c).toggleClass("selDtHeader")},ZDBImport.getSampleDate=function(a){var b=ZDBImport.dateSampleList,c=b.length,d=a,e=", -:/";for(var f=0;f<c;++f){var g=b[f];for(x in g)d.indexOf(x)>=0&&(d=ZDBUtil.replaceStr(d,x,g[x]))}return d},ZDBImport.setSampleDate=function(){var a=ZDBImport.CUSTDATEFRM,b=a.customDateFormat.value,c=a.customDateSample;return c.value=ZDBImport.getSampleDate(b),b},ZDBImport.setDateFormatEnable=function(a,b){var c=b?a:ZDBUtil.getSourceElement(a);if(c.tagName!="INPUT"){var d=ZDBImport.CUSTDATEFRM,e=d.customDateFormat,f=d.customDateSample,g=DOMUtils.getElOrParentWithAttr(c,"ISDATE");if(g){ZDBImport.prevDateTD&&(ZDBImport.prevDateTD.className="optionnotselected");var h=g.getElementsByTagName("SPAN");g.className="optionselected",f.value=h[0].innerHTML.trim(),e.value=h[1].innerHTML.trim(),ZDBImport.prevDateTD=g,g.removeAttribute("oldClass")}}},ZDBImport.handleImportDateValidate=function(a,b){if(a.responseText=="true")ZDBImport.updateDateFormat();else{var c=ZDBImport.CUSTDATEFRM,d=c.customDateFormat;showCustomMessage(ZDBI18NMap.g("zrpt.common.import.custommsg.js.wrongDtFmt"),d)}},ZDBImport.importTableForLocalDatabase=function(a,b,c){var d=AjaxAPI.getFormAttrsAsOptions(b);if(d.VALIDATEFUNC&&!d.fn("VALIDATEFUNC")(b))return!1;if(sampleTableGrid==null){ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.import.zdbalertmsg.js.parsingErr"));return}var e=ZRSerialize(b),f="<Fields ",g="<FieldType ",h="<FieldCountry ",i="<JSONNodePath ",j="<FIELDNULLABLE ",k=sampleTableGrid.colHeaders,l=k.length,m=sampleTableGrid.currencyCountries,n=!1,o,p,q,r=0,s=getDataTypeRow(a);if(!isANCTypeUnique(k))return!1;for(var t=0;t<l;t++){q=k[t];if(q.objType!==ZDBConst.COLHEAD)continue;o=q.importNode.getAttribute("checked"),!n&&o=="true"&&(n=!0),p=o=="true"?q.dataType[q.dataType.selectedIndex].value:-2,q.status==ZDBConst.CLEAR&&(f+="F"+r+'="'+ZDBEscapeUtil.encodeForXML(q.displayName)+'" ',g+="F"+r+'="'+p+'" ',h+="FC"+r+'="'+m[r]+'" ',j+="F"+r+'="'+ZDBEscapeUtil.encodeForXML(q.isNullable)+'" ',++r)}f+="/>",g+="/>",h+="/>",i+="/>",j+="/>";if(!n)return alert(ZDBI18NMap.g("zrpt.common.browser.alert.js.selCol2ProceedImport")),!1;var u="<data>\n"+f+"\n"+g+"\n"+h+"\n"+j+"\n";u+="</data>";var v=a?"EXISTIMPORTDBDATA":"IMPORTDBDATA";e=e+"&"+$("ImportLocalDatabaseForm").getAttribute("connParam")+"&TABLECONFIG="+u+"&FILETYPE=DATABASE"+"&LOCATION=LOCALDATABASE"+"&ZDBFILENAME=ONPREMISEDATABASEDATA&FIRSTROWISFIELDS=true&ZOHO_DELIMITER=0&ZOHO_QUOTED=2&ZOHO_SKIPTOP=0&ZOHO_THOUSAND_SEP=0&ZOHO_DECIMAL_SEP=0&ZOHO_COMMENTCHAR=\0",AjaxAPI.sendRequest({URL:"/ZDBOnPremiseDatabase.ve?ZDBACTION="+v,METHOD:"POST",PARAMETERS:e,OPSTATUSID:"ZDBCREATEDBOPTSTATUS",ONSUCCESSFUNC:importReport})},ZDBImport.importTable=function(a,b,c){if(sampleTableGrid==null){ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.import.zdbalertmsg.js.parsingErr"));return}var d=document.forms[a?"ExistImportForm":"ImportForm"],e=d.THOUSANDSEP.value,f=d.DECIMALSEP.value;if(e==1&&f==1||e==2&&f==0){var g=ZDBI18NMap.g("zrpt.common.import.zdbalertmsg.js.separatorsAreSame");return showCustomMessage(g,$("THOUSANDSEP")),!1}if(!isTopCommentValid(d))return!1;var h="<Fields ",i="<FieldType ",j="<FieldCountry ",k="<JSONNodePath ",l="<FIELDNULLABLE ",m="<FieldInfo ",n=sampleTableGrid.colHeaders,o=n.length,p=sampleTableGrid.currencyCountries,q=!1,r,s,t,u=0,v="",w=getDataTypeRow(a);if(!isDateFieldOK(w,d))return!1;if(!isANCTypeUnique(n))return!1;for(var x=0;x<o;x++){t=n[x];if(t.objType!==ZDBConst.COLHEAD)continue;r=t.importNode.getAttribute("checked"),!q&&r=="true"&&(q=!0);var y=t.dataType[t.dataType.selectedIndex];s=r=="true"?y.value:-2;if(t.status==ZDBConst.CLEAR){h+="F"+u+'="'+ZDBEscapeUtil.encodeForXML(t.displayName)+'" ',i+="F"+u+'="'+s+'" ',j+="FC"+u+'="'+p[u]+'" ',l+="F"+u+'="'+ZDBEscapeUtil.encodeForXML(t.isNullable)+'" ';var z=t.colInfo;if(s==ZDBConst.GEO){var A="",B=y.getAttribute("georole");B!=null&&(A+="GEOR:"+B);var C=y.getAttribute("geostd");B!=null&&C!=null&&(A+=";GEOS:"+C),A.trim()!=""&&(v+="FI"+u+'="'+A+'" ')}sampleTableGrid.isJSONOrXMLImp&&(k+="JN"+u+'="'+ZDBEscapeUtil.encodeForXML(t.jsonNodePath)+'" '),++u}}h+="/>",i+="/>",j+="/>",k+="/>",l+="/>",m=v.trim()!=""?m+v+"/>":"";if(!q)return alert(ZDBI18NMap.g("zrpt.common.browser.alert.js.selCol2ProceedImport")),!1;$("IMPORTACTION").value=a?"EXISTIMPORTDATA":"IMPORTDATA";var D="<data>\n"+h+"\n"+i+"\n"+j+"\n"+l+"\n";m!=""&&(D+=m+"\n"),sampleTableGrid.isJSONOrXMLImp&&(D+=k+"\n"),D+="</data>",$("TABLECONFIG").value=D,$("ZOHO_CANOVERRIDE").value=b==1?!0:!1,d.setAttribute("onsuccessfunc","importReport"),d.setAttribute("opstatusid",a?"ZDBEXIMPORTFILEOPSTATUS":"ZDBIMPORTFILEOPSTATUS"),AjaxAPI.submit(d)},ZDBImport.defineRelationship=function(){if($("JOINSLIST").value!=""||jQuery("#ZDBImportFileWithRelation").length>0){var a=jQuery(document.createElement("div"));a.attr("class","freezeLayer"),a.attr("ID","IMPORTFREEZE"),a.css("top",parseInt(jQuery("#ZDBMAINEL").position().top)+parseInt(1)+"px"),jQuery(document.body).append(a),jQuery("#ZDBImportFileWithRelation").show();var b=document.body.offsetWidth-parseInt($("ZDBImportFileWithRelation").offsetWidth);jQuery("#ZDBImportFileWithRelation").animate({left:b+"px"}).show().focus(),$("EnclosingDiv").innerHTML=window.joinFrm.innerHTML,ev.addEscHandle(ZDBCreateDB.showprevformonEsc);return}var c="<Fields ",d="<FieldType ",e=sampleTableGrid.colHeaders,f=e.length,g=!1,h,i,j,k=0;for(var l=0;l<f;l++){j=e[l];if(j.objType!==ZDBConst.COLHEAD)continue;h=j.importNode.getAttribute("checked"),!g&&h=="true"&&(g=!0),i=h=="true"?j.dataType[j.dataType.selectedIndex].value:-2,j.status==ZDBConst.CLEAR&&(c+="F"+k+'="'+encodeURIComponent(ZDBEscapeUtil.encodeForXML(j.displayName))+'" ',d+="F"+k+'="'+i+'" ',++k)}c+="/>",d+="/>";if(!g)return alert(ZDBI18NMap.g("zrpt.common.browser.alert.js.selCol2ProceedImport")),!1;var m="<data>\n"+c+"\n"+d+"\n"+"</data>",n="TABLECONFIG="+m+"&DBID="+ZDBClientUI.dbId;AjaxAPI.sendRequest({URL:"/ZDBImportData.ve?ZDBACTION=SUGGESTRELATIONSHIP",ONSUCCESSFUNC:showRelations,METHOD:"POST",PARAMETERS:n})},ZDBImport.findpossibleJoinsCount=function(){var a="<Fields ",b="<FieldType ",c=sampleTableGrid.colHeaders,d=c.length,e=!1,f,g,h,i=0;for(var j=0;j<d;j++){h=c[j];if(h.objType!==ZDBConst.COLHEAD)continue;f=h.importNode.getAttribute("checked"),!e&&f=="true"&&(e=!0),g=f=="true"?h.dataType[h.dataType.selectedIndex].value:-2,h.status==ZDBConst.CLEAR&&(a+="F"+i+'="'+encodeURIComponent(ZDBEscapeUtil.encodeForXML(h.displayName))+'" ',b+="F"+i+'="'+g+'" ',++i)}a+="/>",b+="/>";if(!e)return alert(ZDBI18NMap.g("zrpt.common.browser.alert.js.selCol2ProceedImport")),!1;var k="<data>\n"+a+"\n"+b+"\n"+"</data>",l="TABLECONFIG="+k+"&DBID="+ZDBClientUI.dbId;AjaxAPI.sendRequest({URL:"/ZDBImportData.ve?ZDBACTION=REFRESHRELATIONSHIPCOUNT",ONSUCCESSFUNC:refreshJoinCount,METHOD:"POST",PARAMETERS:l})},ZDBImport.checkForANColumnType=function(a){var b=a[a.selectedIndex].value,c=!1;if(b==ZDBDesignGridConst.AUTO_NUMBER){var d=sampleTableGrid.colHeaders,e=d.length;for(var f=0;f<e;f++){curHead=d[f];if(curHead.objType!=ZDBConst.COLHEAD||curHead.dataType==a)continue;checked=curHead.importNode.getAttribute("checked"),!c&&checked=="true"&&(c=!0);if(c&&b==curHead.dataType[curHead.dataType.selectedIndex].value)return alert(ZDBI18NMap.g("zrpt.common.browser.alert.js.onlyAutoNumColPerTbl")),a.selectedIndex=a.previousIndex,!1}}return!0},ZDBImport.showLessMore=function(a){var b=a.getAttribute("fileType"),c=a.getAttribute("isGDriveCSV"),d=a.getAttribute("gDriveFormat"),e=a.getAttribute("isFromGDrive"),f=a.getAttribute("fileSubtype"),g=ZDBImport.isExternalFile(b),h="";b=="CSV"||c=="true"||(b=="ZDOCS"||g)&&f=="CSV"?h+=ZDBI18NMap.g("zrpt.common.import.moreorless.js.csv"):h+=ZDBI18NMap.g("zrpt.common.import.moreorless.js.json");var i=a.getAttribute("more");i=="false"?(jQuery(a).find("[elname='moreRLessTxt']").html(ZDBI18NMap.g("zrpt.common.import.moreorless.js.Less")+" "+h+" "+ZDBI18NMap.g("zrpt.common.import.moreorless.js.Settings")),jQuery(a).find("[elname='moreRLessIcon']").removeClass("ZRSMoreIcon").addClass("ZRSLessIcon"),jQuery("#ZDBMORE").slideDown(500,function(){b=="CSV"||(b=="ZDOCS"||g)&&f=="CSV"?$("DELIMITER").focus():b=="JSON"||(b=="ZDOCS"||g)&&f=="JSON"||b==="XML"||(b=="ZDOCS"||g)&&f=="XML"?$("RETAIN_COLNAMES").focus():$("THOUSANDSEP").focus()}),a.setAttribute("more","true")):(jQuery(a).find("[elname='moreRLessTxt']").html(ZDBI18NMap.g("zrpt.common.import.moreorless.js.More")+" "+h+" "+ZDBI18NMap.g("zrpt.common.import.moreorless.js.Settings")),jQuery(a).find("[elname='moreRLessIcon']").removeClass("ZRSLessIcon").addClass("ZRSMoreIcon"),jQuery("#ZDBMORE").slideUp(500),a.setAttribute("more","false"))},ZDBImport.submitExistImportForm=function(a,b,c){hideCustomMessage();var d=a.getAttribute("actionurl");c==0&&($("CHECKFORALERT").value="false");var e=$("ZDBEXOPTIONINP").value,f=$("ZDBEXFILETYPE").value;if(e=="import"){a.setAttribute("useiframe","true");var g=$("ZDBEXWEBOPT").checked;g&&showHideUrlParamDiv(!1);var h=$("ZDBEXPASTEOPT").checked,i=$("ZDBEXFILEOPT").checked,j=["CSV","XLS","HTML","JSON","XML"],k=j.indexOf(f)>-1;if(h&&k)a.ZDBFILENAME.value=" the data you have pasted";else if(i&&k){a.ZDBFILENAME.value=a.FILENAME.value;if(!ZDBImport.isValidFileExtension(a.FILENAME.value))return alert(ZDBI18NMap.g("zrpt.common.browser.alert.js.unSupImportFileType")),h=!0,locationSelected("PASTEDATA","existImport"),!1}else g&&k&&(a.ZDBFILENAME.value=a.URL.value);a.reloadCount=0,ZDBImport.setEncoding(a,"existImport")}else e=="cloud"?(f=="ZDOCS"?
(a.DOCNAME.value=a.ZDBExtIntInput.value,importStepValUpdate("existImport")):f=="GSHEET"?(a.ZDBGSHEETNAME.value=a.ZDBExtIntInput.value,importStepValUpdate("existImport")):ZDBImport.isExternalFile(f)&&(a.DOCNAME.value=a.ZDBExtIntInput.value,importStepValUpdate("existImport")),a.encoding="application/x-www-form-urlencoded"):(a.setAttribute("useiframe","false"),a.removeAttribute("enctype"),ZDBImport.setEncoding(a,"existImport"));return a.action=d,AjaxAPI.submit(a),!0},ZDBImport.isValidFileExtension=function(a){var b=[".bmp",".class",".exe",".gif",".jpg",".mdb",".png"],c=b.length,d=a.length;for(var e=0;e<c;++e){var f=b[e],g=d-f.length;if(g>=0&&a.toLowerCase().lastIndexOf(f.toLowerCase())==g)return!1}return!0},ZDBImport.getFileExtension=function(a){if(a==null||a=="")return"";var b=a.toLowerCase().lastIndexOf("."),c=a.substring(b+1);return c},ZDBImport.setEncoding=function(a,b){var c=b.toLowerCase()=="existimport"?"EX":"";try{$("ZDB"+c+"FILEOPT").checked?a.encoding="multipart/form-data":$("ZDB"+c+"PASTEOPT").checked?a.encoding="application/x-www-form-urlencoded":$("ZDB"+c+"WEBOPT").checked?a.encoding="application/x-www-form-urlencoded":$("ZDBFTPOPT")!=null&&$("ZDB"+c+"FTPOPT").checked&&(a.encoding="application/x-www-form-urlencoded")}catch(d){}},ZDBImport.setExistColumnList=function(a){var b=a.colHeaders,c=b.length,d=$("EXISTCOLROW_TEM").getElementsByTagName("tbody")[0].innerHTML,e=d.split(/\$\$/),f=$("EXISTCOLLISTDIV"),g="";for(var h=0;h<c;++h){var i=b[h];if(i.objType!=ZDBConst.COLHEAD||!i.tobeListed)continue;if(!i.formula){var j=ZDBEscapeUtil.encodeForHtml(i.displayName),k=LangUtils.cloneArray(e);for(var l=1,m=k.length;l<m;l+=2)k[l]=j;g=g.concat(k.join(""))}}var n=document.createElement("div");f.innerHTML="<table width='100%' cellspacing='0' cellpadding='0' border='0'>"+g+"</table>"},ZDBImport.setCheckListColumn=function(a,b){var c=a.colHeaders,d=c.length,e=b,f=$("EXISTCOLLISTDIV");for(var g=0;g<e.length;g++){var h=e[g];for(var i=0;i<d;i++){var j=c[i],k=ZDBEscapeUtil.encodeForHtml(j.colId);if(h==k){var l=f.getElementsByTagName("input");for(var m=0;m<l.length;m++)if(l[m].value==ZDBEscapeUtil.encodeForHtml(j.displayName)){l[m].checked=!0;break}break}}}},ZDBImport.getSelectTables=function(){var a=0;while($("scraptbl_"+a)){if($("scraptbl_"+a).checked)break;a++}return $("ZDBTABLENO").value=a,!0},ZDBImport.resetImportForm=function(){try{ZDBImport.curForm.DATEFORMAT&&(ZDBImport.curForm.DATEFORMAT.value="");var a=document.forms.CreateDBFrm,b=document.forms.ExCreateDBFrm,c=["TABLENAME","DESCRIPTION","tags","PASTEDATA","ZDBInputURL","ZDBPASTEDATA","ZDBEXInputURL"],d=c.length;for(var e=0;e<d;++e)try{a&&a[c[e]]!==undefined&&(a[c[e]].value=""),b&&b[c[e]]!==undefined&&(b[c[e]].value="")}catch(f){}a&&a.ITABLENAME!==undefined&&(a.ITABLENAME.value=ZDBI18NMap.g("zrpt.home.import.step1.js.newtbl"))}catch(f){}},ZDBImport.setHighLight=function(a,b){var c=ZDBUtil.getSourceElement(a),d=ZDBUtil.getParentWithTagName(c,"TD");if(!d||!d.tagName)return;var e=ZDBUtil.getAttribute(d,"ISDATE");if(!e)return;if(b){var f=ZDBUtil.getAttribute(d,"class","className");d.setAttribute("oldClass",f),d.setAttribute("class","optionselected"),d.className="optionselected"}else d.getAttribute("oldClass")&&(d.setAttribute("class",d.getAttribute("oldClass")),d.className=d.getAttribute("oldClass"))},ZDBImport.resetDateDlg=function(a){var b=a.getElementsByTagName("TD"),c=b.length;for(var d=0;d<c;++d){var e=b[d];ZDBUtil.getAttribute(e,"ISDATE")&&ZDBUtil.setAttribute(e,"optionnotselected","class","className")}ZDBImport.CUSTDATEFRM.customDateFormat.value="",ZDBImport.CUSTDATEFRM.customDateSample.value=""},ZDBImport.onDataTypeChange=function(a){var b=ZDBUtil.getSourceElement(a),c=b.selectedIndex,d=b.cellObj,e=d.colObj,f=-1;if(c>-1)var f=b[c].value;if(f==9){x;var g=document.getElementById("DATEFORMAT");g&&!g.value&&showCustomMessage(ZDBI18NMap.g("zrpt.common.import.custommsg.js.wrongDtFmtSel"),ZDBUtil.getParentWithTagName(g,"div"))}if(b[c].getAttribute("zdbDisabled")=="true"){var h=b[c].getAttribute("defaultvaltype");return h=="REFCOL"||h=="RELCOL"?ZDBMsgBox.showHintMsg("Sorry, currently you cannot choose the type of a new column as 'LookUp Column'"):h=="AUTO_NUMBER"&&ZDBMsgBox.showHintMsg("Sorry, currently you cannot choose the type of a new column as 'Auto Number'"),b.selectedIndex=d.colObj.previousIndex,!1}return d.originalValue=b[b.selectedIndex].value,ZDBImport.findpossibleJoinsCount(),!0},ZDBImport.changeFileLocation=function(a,b,c){var d=$(b);ZDBImport.isValidFile(a.value,".csv")||ZDBImport.isValidFile(a.value,".tsv")?d.value="CSV":ZDBImport.isValidFile(a.value,".xls")||ZDBImport.isValidFile(a.value,".xlsx")?d.value="XLS":ZDBImport.isValidFile(a.value,".html")?d.value="HTML":ZDBImport.isValidFile(a.value,".json")?d.value="JSON":ZDBImport.isValidFile(a.value,".xml")&&(d.value="XML"),enableOption(d,c)},ZDBImport.isValidFile=function(a,b){var c=a.length,d=c-b.length;return d>=0&&a.toLowerCase().lastIndexOf(b.toLowerCase())==d?!0:!1};var ZDBXLSImport=new function(){};ZDBXLSImport.sheetSelected=function(a){$("ZDBWorkSheet_"+a).checked="true"},ZDBXLSImport.getSelectSheet=function(){var a=0;while($("ZDBWorkSheet_"+a)){if($("ZDBWorkSheet_"+a).checked)break;a++}return $("ZDBTABLENO").value=a,!0},ZDBImport.newImportedTable=function(a,b){if(!ZDBLazyLoadUtil.loadCssOnly("CSSLIST_GRIDSTYLES","APPENDTODOC",ZDBImport.newImportedTable,[a,b]))return;var c="import";if(a.id=="ZDBImportFrmCldInExistDBImg"||a.id=="ZDBImportFrmCldInExistDB")c="cloud";window.curStep=1,window.totStep=2,ZDBUtil.setIfGAppsUser();var d="PASTEDATA";c=="cloud"&&(d="GSHEET"),window.divData&&window.divData.isNew&&window.divData.location!="inhousedb"?(showTableDialog(d,c),ZDBImport.resetImportForm(),ZDBImport.customizeImportOptions(c),ZDBUtil.setFocus("TABLENAME")):(ZDBImport.removeElIfPresent("ZDBIMPORTTBODY"),ZDBImport.removeElIfPresent("ZDBCreateFrm"),ZDBImport.removeElIfPresent("ZDBCreateDBCntTd"),ZDBImport.removeElIfPresent("ZDBCREATEDIALOG"),window.divData=null,ZDBLazyLoadUtil.loadedSnippets.EXIST_IMPORT_DLG=!1,AjaxAPI.sendRequest({URL:ZDBGlobal.CTX+"/ZDBCreateTableViaImport.cc?DBID="+ZDBClientUI.dbId+"&&OPT="+c,ONSUCCESSFUNC:ZDBImport.placeImport,INVOKESCRIPTS:!0,OPSTATUSID:"ZDBMainLoader",IMPOPTS:c}))},ZDBImport.newCloudTableImport=function(){window.curStep=1,window.totStep=2,AjaxAPI.sendRequest({URL:ZDBGlobal.CTX+"/ZDBCreateTableViaCloud.cc?DBID="+ZDBClientUI.dbId,ONSUCCESSFUNC:ZDBImport.showCloudDialog})},ZDBImport.showCloudDialog=function(a,b){var c=document.createElement("div");c.innerHTML=a.getOnlyHtml(),c.setAttribute("isDialog","true"),ZDBUtil.setFocus("TABLENAME",!0),ZDBDialogUtil.showDialog(c,{MODAL:!0}),ZDBMenu.addIframe(c),enableCloudOption("ZDOCS")},ZDBImport.existImportTable=function(a,b,c,d){var e=ZDBClientUI.selectedTab.view,f="import";if(a.id=="ZDBImportFrmCldInExistDBImg"||a.id=="ZDBImportFrmCldInExistDB")f="cloud";ZDBLazyLoadUtil.loadedSnippets.EXIST_IMPORT_DLG=!1,window.divData=null,AjaxAPI.sendRequest({URL:"/ZDBImportAction.ma?ZDBACTION=IMPORTSETTINGS&OBJID="+e.objId,ONSUCCESSFUNC:ZDBImport.loadSettings,ELEMENT:a,EVENT:b,TABLENAME:c,ISNEWREQUEST:d,IMPOPTS:f})},ZDBImport.showExistImpTable=function(a){AjaxAPI.sendRequest({URL:ZDBGlobal.CTX+"/ZDBOnPremiseDatabase.ve?ZDBACTION=CONNNAMESEXIST&DBID="+ZDBClientUI.dbId,METHOD:"POST",ONSUCCESSFUNC:ZDBImport.cntExistImportShowDialog})},ZDBImport.cntExistImportShowDialog=function(a){var b=a.responseText!=null?jQuery.parseJSON(a.responseText):null,c="";$("EXCANSHOWDBCONN")&&(c="EXCANSHOWDBCONN="+$("EXCANSHOWDBCONN").getAttribute("value")+"&");var d=b!=null?b.SHOW_IMPORT_LOCALDB:"TRUE";if(!ZDBLazyLoadUtil.loadSnippet("IMPORT_INTO_THIS_TABLE","/ZDBImpIntoThisTbl.cc?"+c+"SHOW_LOCAL_DB_IMPORT="+d,this,"APPENDTODOC"))return;var e=ZDBClientUI.$("ZDBIMPINTOTHISTBL"),f=ZDBClientUI.selectedTab.view;e.gridObj=f;if(!ZDBClientUI.checkAskSaveView(f,ZDBI18NMap.g("zrpt.common.js.import"),f))return;ZDBInlineDialog.showDialog(e,{MODAL:!0,TITLE:"Import into this table"})},ZDBImport.loadSettings=function(a,b){if(!ZDBLazyLoadUtil.loadSnippet("EXIST_IMPORT_DLG","/ZDBExistImport.cc",this,"APPENDTODOC"))return;var c=a.responseText!=null?jQuery.parseJSON(a.responseText):{},d=b.ELEMENT,e=b.TABLENAME,f=b.ISNEWREQUEST,g=b.EVENT,h=ZDBClientUI.selectedTab.view,i=ZDBUtil.getPropertyFromEl(d,"gridObj","object");dbId=ZDBClientUI.dbId,objId=i.objId,displayName=e!=undefined?e:i.displayName,ZDBImport.customizeImportOptions(b.IMPOPTS,"EX"),storeAllReferences("existImport");var j=window.divData.EXCREATEDIALOG.cloneNode(!0);j.removeAttribute("id"),j.style.display="block",window.curStep=1,window.totStep=2,j.gridObj=i,ZDBInlineDialog.closeDialog(),ZDBInlineDialog.showDialog(j,{MODAL:!0}),$("importNote").style.display="",b.IMPOPTS=="cloud"&&($("ZRSHelplink")&&$("ZRSHelplink").setAttribute("href",ZDBI18NMap.g("zrpt.links.js.cldimphelp")),$("ZRSVideoDemoHelp")&&($("ZRSVideoDemoHelp").style.display="none"),$("ZRSSnapShotTour")&&($("ZRSSnapShotTour").style.display="none")),$("importExTableName").innerHTML=ZDBEscapeUtil.encodeForHtml(displayName),ZDBImport.resetImportForm(),$("ZDBTABLEDISPLAYNAME").value=displayName,$("ZDBOBJID").value=objId,$("ZDBTABLENAME").value=displayName,ZDBImport.setExistColumnList(i);var k=h.permLevel,l=k.split("$"),m=$("ZDBEXACTION");m=ZDBImport.setImportOption(m,l);if(Object.keys(c).length>0){var n=c.IMPORTTYPE,o=c.FILETYPE;o=o==="XLSX"?"XLS":o;var p=c.FILELOCATION,q=c.MATCHCOLS,r=c.URL,s,t,u,v;if("FTP"==p&&$("ZDBEXFTPOPT")!=null){$("ZDBEXFTPOPT").checked="true";var w=$("ZDBEXCreateFrm");locationSelected("FTP","existImport"),s=c.FTPHOST,t=c.FTPPORT,u=c.FTPPROTOCOL,v=c.FTPPATH,s!=null&&s!=undefined&&(w.FTPHOST.value=s),t!=null&&t!=undefined&&(w.FTPPORT.value=t),v!=null&&v!=undefined&&(w.FTPPATH.value=v),u!=null&&u!=undefined&&(w.FTPPROTOCOL.value=u)}ZDBImport.selectFileTypeElement("ZDBEXFILETYPE",o),b.IMPOPTS=="cloud"&&ZDBImport.locationAndFileTypeSelect(o,p);if(b.IMPOPTS=="import"){if(o=="DATABASE"||o=="GSHEET"||o=="ZDOCS"||ZDBImport.isExternalFile(o))p="PASTEDATA";locationSelected(p,"existImport"),p=="WEB"?(hideURLTip($("ZDBEXInputURL")),$("ZDBEXInputURL").value=r):p=="PASTEDATA"&&(ZDBUtil.setFocus("ZDBPASTEDATA"),$("ZDBPASTEDATA").value="")}if(q!=null){var x=q.split(",");ZDBImport.setCheckListColumn(i,x)}var y=document.getElementById("ZDBEXFILETYPE");enableOption(y,"existImport"),ZDBImport.selectImportType(m,n);var z=c["URLPARAMNAMES"]!=null?c.URLPARAMNAMES:{},A=c["URLPARAMVALUES"]!=null?c.URLPARAMVALUES:{},B=c["URLPARAMTYPES"]!=null?c.URLPARAMTYPES:{},C=c["URLMETHOD"]!=null?c.URLMETHOD:null;p=="WEB"&&(jQuery($("URLPARAMS")).empty(),changeParamCount());if(z.length>0){var D=JSON.parse(z),E=JSON.parse(A),F=JSON.parse(B);$("ZRURLMETHOD").value=C,showHideUrlParamDiv(!1),addUrlParamDiv();for(var G=0;G<D.length;G++)if(G>0){var H=$("PARAMS").cloneNode(!0);H.style.display="block",H.querySelectorAll('[id="ZRURLPARAMNAME"]')[0].value=D[G],H.querySelectorAll('[id="ZRURLPARAMVALUE"]')[0].value=E[G],H.querySelectorAll('[id="ZRURLPARAMTYPE"]')[0].value=F[G],H.querySelectorAll('[id="ZRURLPARAMNAME"]')[0].name="URLPARAMNAME",H.querySelectorAll('[id="ZRURLPARAMVALUE"]')[0].name="URLPARAMVALUE",H.querySelectorAll('[id="ZRURLPARAMTYPE"]')[0].name="URLPARAMTYPE",$("URLPARAMS").appendChild(H),H.style.display="block"}else{var H=jQuery($("URLPARAMS")).find("#PARAMS");H.find("#ZRURLPARAMNAME").val(D[G]),H.find("#ZRURLPARAMVALUE").val(E[G]),H.find("#ZRURLPARAMTYPE").val(F[G]),H.find("#ZRURLPARAMNAME").name="URLPARAMNAME",H.find("#ZRURLPARAMVALUE").name="URLPARAMVALUE",H.find("#ZRURLPARAMTYPE").name="URLPARAMTYPE"}changeParamCount()}}else b.IMPOPTS=="cloud"?($("ZDBEXWEBOPT").checked=!0,locationSelected("GSHEET","existImport")):(f?(locationSelected("PASTEDATA","existImport"),$("ZDBPASTEDATA")&&($("ZDBPASTEDATA").value="")):locationSelected(window.divData.importVia,"existImport"),ZDBUtil.setFocus("ZDBPASTEDATA"));(m.value=="UPDATEADD"||m.value=="DELETEUPDATEADD")&&setColListVisible(!0)},ZDBImport.locationAndFileTypeSelect=function(a,b){a=="GSHEET"?($("ZDBEXWEBOPT").checked=!0,locationSelected("GSHEET","existImport")):a=="ZDOCS"?($("ZDBEXWEBOPT").checked=!0,locationSelected("ZDOCS","existImport")):a=="DROPBOX"?($("ZDBEXWEBOPT").checked=!0,locationSelected("DROPBOX","existImport")):a=="BOX"?($("ZDBEXWEBOPT").checked=!0,locationSelected("BOX","existImport")):a==="ONEDRIVE"?($("ZDBEXWEBOPT").checked=!0,locationSelected("ONEDRIVE","existImport")):($("ZDBEXWEBOPT").checked=!0,locationSelected("GSHEET","existImport"))},ZDBImport.setImportOption=function(a,b){var c=b[7],d=b[8],e=b[9],f=b[10];if(c==1){var g=document.createElement("OPTION");g.text=ZDBI18NMap.g("zrpt.table.existimport.step1.js.importOpt1"),g.value="APPEND",a.options.add(g)}if(e==1){var g=document.createElement("OPTION");g.text=ZDBI18NMap.g("zrpt.table.existimport.step1.js.importOpt2"),g.value="TRUNCATEADD",a.options.add(g)}if(d==1){var g=document.createElement("OPTION");g.text=ZDBI18NMap.g("zrpt.table.existimport.step1.js.importOpt3"),g.value="UPDATEADD",a.options.add(g)}if(f==1){var g=document.createElement("OPTION");g.text=ZDBI18NMap.g("zrpt.table.existimport.step1.js.importOpt4"),g.value="DELETEUPDATEADD",a.options.add(g)}return a},ZDBImport.selectImportType=function(a,b){var c=a.getElementsByTagName("option");for(var d=0;d<c.length;d++){var e=c[d];if(e.value==b){e.selected=!0,(b=="UPDATEADD"||b=="DELETEUPDATEADD")&&setColListVisible(!0);break}}},ZDBImport.selectFileTypeElement=function(a,b){var c=$(a);for(var d=0;d<c.length;d++)if(c.options[d].value===b){c.options[d].selected=!0;break}},ZDBImport.setUserComboSettings=function(a,b){var c=document.getElementById(a);c.options[b].selected=!0},ZDBImport.setUserIPtSettings=function(a,b){var c=document.getElementById(a);c.value=b},ZDBImport.setUserDateSettings=function(a,b){var c=$(a),d=dg.extImpDF,e=b;d&&d!=b&&(e=d),c.value=e,e?ZDBImport.setOnDateDiv(ZDBImport.getSampleDate(e),e):ZDBImport.setOnDateDiv(ZDBI18NMap.g("zrpt.common.import.step2.js.noDtCol"),"NODATE")},ZDBImport.setFirstIsField=function(a,b){var c=$(a);b=="true"?c.options[0].selected=!0:c.options[1].selected=!0},ZDBImport.placeImport=function(a,b){$("ZDBCREATEDIALOGSTORE").innerHTML=a.getOnlyHtml(),ZDBUtil.setFocus("TABLENAME",!0),ZDBImport.resetImportForm(),ZDBImport.customizeImportOptions(b.IMPOPTS)},ZDBImport.setFileType=function(a,b){var c="";b!=null&&(c="EX");var d,e=["DROPBOX","BOX","ONEDRIVE"],f=["zrpt.ext.js.dropbox","zrpt.ext.js.box","zrpt.ext.js.skydrive"],g=["CSV","XLS","HTML","JSON","XML"],h=["zrpt.newtable.import.js.csvformat","zrpt.newtable.import.js.excelformat","zrpt.newtable.import.js.htmlformat","zrpt.newtable.import.js.jsonformat","zrpt.newtable.import.js.xmlformat"];$("ZDB"+c+"FILETYPE").innerHTML="";if(a=="import")for(d=0;d<g.length;d++)jQuery("#ZDB"+c+"FILETYPE").append("<option value="+g[d]+">"+ZDBI18NMap.g(h[d])+"</option>");if(a=="cloud"){ZDBClientUI.isCustomDomain||(ZDBClientUI.showDocs&&ZDBClientUI.showGDrive&&jQuery("#ZDB"+c+"FILETYPE").append("<option value=ZDOCS>"+ZDBI18NMap.g("zrpt.ext.js.zdocs")+"</option>"),ZDBClientUI.showGDrive&&jQuery("#ZDB"+c+"FILETYPE").append("<option value=GSHEET>"+ZDBI18NMap.g("zrpt.newtable.import.js.gsheetformat")+"</option>"));if(!ZDBClientUI.isCustomDomain&&ZDBClientUI.showExt&&ZDBClientUI.showGDrive)for(d=0;d<e.length;d++)jQuery("#ZDB"+c+"FILETYPE").append("<option value="+e[d]+">"+ZDBI18NMap.g(f[d])+"</option>");var i=$("ZDB"+c+"FILETYPE").options;for(d=0;d<i.length;d++)i[d].value=="GSHEET"&&i[d].setAttribute("selected","selected")}},ZDBImport.customizeImportOptions=function(a,b){var c="";b!=null&&(c="EX"),ZDBImport.setFileType(a,b),a=="import"&&($("ZDB"+c+"DataLocation").style.display="",$("ZDB"+c+"PASTEINP").style.display="",$("ZDB"+c+"PASTEOPT").setAttribute("checked","checked"),$("ZDBFILETYPELBL").innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.filetype")),a=="cloud"&&($("ZDBFILETYPELBL").innerHTML=ZDBI18NMap.f("zrpt.newtable.import.js.cloudtype"),$("ZDB"+c+"DataLocation").style.display="none",$("ZDB"+c+"WEBOPT").removeAttribute("checked")),$("ZDB"+c+"OPTIONINP").value=a},ZDBImport.removeElIfPresent=function(a){var b=$(a);b!=null&&b.parentNode!=null&&b.parentNode.removeChild(b)},ZDBImport.showImportPopup=function(a,b){if(ZDBMenu.warnIfNotLoggedIn())return;var c=ZDBClientUI.getViewObj(a,"view");ZDBMenu.showModuleMenuRight(a,b,"Import_Menu","GridMenu",!0,c);var d=$("ZDBImportPopupMenu"),e=$("ZDB_IMP_SCHEDULE_MENUITEM"),f=$("ZDB_LATEST_IMP_DETAILS");f.style.display=c.lastImportStatus==1?ZDBUtil.visibleTrStyle:"none",c.isOnPremiseDB?AjaxAPI.sendRequest({URL:ZDBGlobal.CTX+"/ZDBOnPremiseDatabase.ve?ZDBACTION=CANSHOWSCHEDULEOPT&OBJID="+c.objId,METHOD:"POST",ONSUCCESSFUNC:ZDBImport.canShowScheduleOpt}):e.style.display=c.schImportStatus==2?ZDBUtil.visibleTrStyle:"none"},ZDBImport.canShowScheduleOpt=function(a,b){var c=a.responseText!=null?jQuery.parseJSON(a.responseText):null,d=c!=null?c.CAN_SHOW_SCHEDULE_OPTION:"FALSE";d=="TRUE"?$("ZDB_IMP_SCHEDULE_MENUITEM").style.display=ZDBUtil.visibleTrStyle:$("ZDB_IMP_SCHEDULE_MENUITEM").style.display="none"},ZDBImport.isMatchColSelected=function(a){var b=a.ZOHO_MATCHING_COLUMNS,c=!1;for(var d=0;d<b.length&&c==0;d++){var e=b[d];c=e.checked}return c==0?(showCustomMessage(ZDBI18NMap.f("zrpt.common.url.errmsg"),$("EXISTCOLLISTDIV"),$("EXISTCOLLISTDIV")),!1):!0},ZDBImport.isExternalFile=function(a){return a==="DROPBOX"||a==="BOX"||a==="ONEDRIVE"?!0:a==="ZDOCS"||a==="GSHEET"?!0:!1};var ZDBCreateViewAPI=new function(){this.showImpIntoThsTblDlg=function(){var a=ZDBClientUI.selectedTab.view;if(!ZDBClientUI.checkAskSaveView(a,ZDBI18NMap.g("zrpt.common.js.import"),a))return;ZDBMenuUtil.closeMenu();if(ZDBClientUI.notLoggedIn){ZDBAlertAPI.showMsg(ZDBI18NMap.f("zrpt.common.newrpt.js.signIn2CreateNewRpt",ZDBGlobal.PRODUCTNAME));return}if(!ZDBLazyLoadUtil.loadSnippet("IMPORT_INTO_THIS_TABLE","/ZDBImpIntoThisTbl.cc?OBJID="+a.objId,this,"APPENDTODOC"))return;var b=ZDBClientUI.$$("ZDBEXISTIMPTBLVIEW"),c=b.getElementsByTagName("tr"),d=ZDBClientUI.$$("ZDBEXISTIMPTBLDLG");d.parentNode!=null&&d.parentNode.removeChild(d);var e=ZDBI18NMap.g("zrpt.common.js.existtable"),f=ZDBClientUI.createDummyTab(a.objId,e,d.cloneNode(!0),"NewOption");ZDBClientUI.selectTab(f)},this.showRDBConDlg=function(a){if(!ZDBLazyLoadUtil.loadJsAlone("zdbjs/rdbjs/RDBPage.js",this,ZDBCreateViewAPI.showRDBConDlg))return;ZDBMenuUtil.closeMenu();if(ZDBClientUI.notLoggedIn){ZDBAlertAPI.showMsg("Sign in to use this feature",ZDBGlobal.PRODUCTNAME);return}if(!ZDBClientUI.isDBOwner){ZDBAlertAPI.showMsg("No permissions to use this feature");return}if(!ZDBLazyLoadUtil.loadSnippet("SHOW_RDB","/ZDBRemoteDBConnection.cc?DBID="+ZDBClientUI.dbId,this,"APPENDTODOC"))return;var b=ZDBClientUI.$$("ZDBCREATERDBVIEW"),c=ZDBClientUI.$$("RDBDLG");c.parentNode!=null&&c.parentNode.removeChild(c);if(a)ZDBInlineDialog.showDialog(c,{MODAL:!0}),RDBPage.editConnectionDialog(!0);else{var d=ZDBI18NMap.g("zrpt.databasedata.connname.js.managedb"),e=ZDBClientUI.createDummyTab(ZDBClientUI.curDummyViewId--,d,c.cloneNode(!0),"NewOption");ZDBClientUI.selectTab(e),RDBPage.updateManageDB()}},this.showCreateNewTblDlg=function(a){if(!ZDBLazyLoadUtil.loadJsAlone(["import/js/ZDBImport.js","template/js/ZDBTemplate.js"],this,ZDBCreateViewAPI.showCreateNewTblDlg,[a]))return;ZDBMenuUtil.closeMenu();if(ZDBClientUI.notLoggedIn){ZDBAlertAPI.showMsg(ZDBI18NMap.f("zrpt.common.newrpt.js.signIn2CreateNewRpt",ZDBGlobal.PRODUCTNAME));return}if(!ZDBClientUI.isDBOwner&&!a){ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.newtbl.js.noPerm2CreateNewTbl"));return}var b="";$("CANSHOWDBCONNS")&&(b="CANSHOWDBCONNS="+$("CANSHOWDBCONNS").getAttribute("value"));if(!ZDBLazyLoadUtil.loadSnippet("CREATE_NEW_TABLE","/ZDBCreateNewTbl.cc?"+b+"&DBID="+ZDBClientUI.dbId,this,"APPENDTODOC"))return;var c=ZDBClientUI.$$("ZDBCREATETBLVIEW_TABLE"),d=c.getElementsByTagName("tr"),e=[],f=[];ZDBCreateViewAPI.addTableList(e,f);var g=e.length>0;for(var h=0;h<d.length;h++){var i=d[h],j=i.getAttribute("zdbtype"),k=j==null||j=="view"&&a&&g||j=="table"&&ZDBClientUI.isDBOwner&&!a||j=="autogen"&&(ZDBClientUI.isDBOwner||ZDBClientUI.isGroupMember)&&a&&g||j=="dashboard"&&a;i.style.display=k?ZDBUtil.visibleTrStyle:"none"}var l=ZDBClientUI.$$("ZDBCREATETBLDLG");l.parentNode!=null&&l.parentNode.removeChild(l);var m=a?ZDBI18NMap.g("zrpt.common.js.newReport"):ZDBI18NMap.g("zrpt.common.js.newTable"),n=ZDBClientUI.createDummyTab(ZDBClientUI.curDummyViewId--,m,l.cloneNode(!0),"NewOption");ZDBClientUI.selectTab(n),ZDBTemplate.enableOrDisableTemplateIcons()},this.submitTableForViewDlg=function(a,b){if(!ZDBLazyLoadUtil.loadJsAlone("zdbjs/autogen/ZDBSampleViews.js",this,ZDBCreateViewAPI.submitTableForViewDlg,[a,b]))return;var c=ZDBCreateViewAPI.ZDBTableForViewDlg,d=ZDBCreateViewAPI.ZDB_TABLEPICK,e=d[d.selectedIndex].value,f=null;for(var g=0;g<c.tblList.length;g++)if(c.tblList[g]==e){f=c.tblObjId[g];break}ZDBDialogUtil.closeDialog();if(c.viewType=="AutoGen")ZDBSampleViews.createSampleViews("YES",null,f);else{if(!ZDBClientUI.selectedTab.view.isDummyView)var h="",i=null;else var i=ZDBClientUI.selectedTab,h=i.view.displayName;ZDBClientUI.createView(ZDBClientUI.dbId,f,h,c.viewType,i)}},this.createViewEl=function(a,b,c){var d=ZDBClientUI.selectedTab.view,e=ZDBCreateViewAPI.getTableObjectIdForView(d);e==null?ZDBCreateViewAPI.createViewFromDlg(a,c):ZDBUtil.isNewView(d)?ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.newrpt.zdbalertmsg.js.saveConfirm2CreateNew")):ZDBClientUI.createView(d.dbId,e,d.displayName,c,null)},this.getTableObjectIdForView=function(a){return a.type=="Table"||a.type=="QueryTable"?a.objId:a.parentViewId},this.createViewFromDlg=function(a,b){if(!ZDBLazyLoadUtil.loadSnippet("PICK_TABLE_FOR_VIEW","/ZDBPickTableForView.cc",this,"APPENDTODOC"))return;if(!ZDBLazyLoadUtil.loadCssOnly(["CSSLIST_GRIDSTYLES","CSSLIST_ANALYSISVIEWSTYLES"],this,ZDBCreateViewAPI.createViewFromDlg,[a,b]))return;var c=ZDBUtil.getCachedRef(ZDBCreateViewAPI,"ZDB_TABLEPICK"),d=c.childNodes;for(var e=d.length-1;e>-1;e--)c.removeChild(d[e]);var f=[],g=[];if(!ZDBCreateViewAPI.checkAndGetTableList(f,g))return;for(var e=0;e<f.length;e++){var h=document.createElement("Option");h.text=f[e],h.value=f[e],BROWSER.IE?c.add(h):c.appendChild(h)}var i=ZDBUtil.getCachedRef(ZDBCreateViewAPI,"ZDBTableForViewDlg");i.style.display="block",i.viewType=b,i.tblList=f,i.tblObjId=g,ZDBDialogUtil.showDialog(i,{TITLE:ZDBI18NMap.g("zrpt.common.newrpt.selbasetbl.js.dlgTtl",i),ADDFRAME:!0,MODAL:!0});return},this.createStandAloneView=function(a,b,c,d,e){if(d&&!ZDBCreateViewAPI.checkAndGetTableList([],[]))return;ZDBClientUI.createView(ZDBClientUI.dbId,null,null,c,e?ZDBClientUI.selectedTab:null)},this.addTableList=function(a,b){var c=ZDBClientUI.ObjectsList,d=c.getElementsByTagName("tr");for(var e=0,f=d.length;e<f;e++){var g=d[e];(g.getAttribute("objtype")=="Table"||g.getAttribute("objtype")=="TableDesign"||g.getAttribute("objtype")=="QueryTable")&&g.getAttribute("relview")=="false"&&(a.push(g.getAttribute("dispname")),b.push(g.getAttribute("objid")))}},this.checkAndGetTableList=function(a,b){this.addTableList(a,b);if(a.length==0){var c=ZDBUtil.getCachedRef(this,"ZDBDBNAME");return ZDBAlertAPI.showMsg(ZDBI18NMap.g("zrpt.common.newrpt.zdbalertmsg.js.noTblsFound")+" '"+c.innerHTML+"'"),!1}return!0},this.fetchEnterDataView=function(a,b,c,d,e){if(!ZDBLazyLoadUtil.loadJsAlone("ZDBGridList","APPENDTODOC",ZDBCreateViewAPI.fetchEnterDataView,[a,b,c,d,e]))return;if(!ZDBLazyLoadUtil.loadCssOnly("CSSLIST_GRIDSTYLES","APPENDTODOC",ZDBCreateViewAPI.fetchEnterDataView,[a,b,c,d,e]))return;if(!e){ZDBCreateViewAPI.fetchNextObjectName(c);return}var f=null;d?f=ZDBClientUI.selectedTab:f=ZDBClientUI.createDummyTab(ZDBClientUI.curDummyViewId--,e,ZDBClientUI.dummyGrid,"Table");var g=ZDBDataGridExt.createGrid(c,e);g.enterData=!0,g.setColumnHeaders(g.getColHeaders());var h=g.colHeaders;for(var i=0;i<h.length;i++)h[i].objType==ZDBConst.COLHEAD&&(h[i].isEditable=!0);g.setNavigationInfo(1,0,0),g.showFirstPage(),f.viewCtx.handle(g)},this.confirmCopySettings=function(a){if(a!="YES")return;$("ZDBSaveDlgOkBtn").setAttribute("hugeDataCopy","true"),ZDBCreateViewAPI.handleSaveDlg($("ZDBSaveDlgOkBtn"))},this.fetchNextObjectName=function(a){var b=ZDBClientUI.selectedTab.tabIcon;AjaxAPI.sendRequest({URL:ZDBGlobal.CTX+"/ZDBDatabaseActionMI.ma?ZDBACTION=NEXTOBJECT",PARAMETERS:"DBID="+a,ONSUCCESSFUNC:ZDBCreateViewAPI.fetchDataViewForEntry,ONFAILUREFUNC:ZDBCreateViewAPI.handleFailureForView,OPSTATUSID:b})},this.fetchDataViewForEntry=function(a,b){var c=a.getResponseParams();ZDBCreateViewAPI.fetchEnterDataView(null,null,c.DBID,!0,c.NEXTOBJNAME)},this.handleFailureForView=function(a,b){var c=a.getResponseParams();ZDBClientUI.fetchEnterDataView(null,null,c.DBID,!0,"Untitled-1")},this.getNameForNewView=function(a,b,c){if(!ZDBLazyLoadUtil.loadSnippet("SAVE_DLG","/ZDBSave.cc?",this,"APPENDTODOC"))return;if(a.newName!=null)return!0;ZDBCreateViewAPI.saveDlg==null&&(ZDBCreateViewAPI.saveDlg=$("ZDBSaveDlgFrm"),ZDBUtil.setIdBasedNamedChildEls(ZDBCreateViewAPI.saveDlg,["nameTxtFld","descTxtFld","copyDataChkFld","copyLookupChkFld"],"ZDBObj_"));var d=ZDBCreateViewAPI.saveDlg;d.nameTxtFld.value=a.displayName+(c?ZDBI18NMap.g("zrpt.common.js.copy"):""),d.descTxtFld.value=a.description!=null?a.description:"",d.copyDataChkFld.style.display=a.type!="Table"||!c?"none":"table-Row",d.copyLookupChkFld.style.display=a.type!="Table"||!c?"none":"table-Row",d.curView=a,d.isSaveAs=c,d.origReqOptions=b,ZDBNavigation.loadFolderList("ZDBFolderItemList","ZDBFOLDERLISTOPTSTATUS",null),ZDBDialogUtil.showDialog(d,{MODAL:!0,TITLE:ZDBI18NMap.g("zrpt.common.newrpt.saveas.js.dlgTtl",d),ADDFRAME:!0}),d.nameTxtFld.focus(),$("ZDBSaveDlgOkBtn").setAttribute("hugeDataCopy","false"),$("ZDBDBCPDataChkBox").checked=!0,$("ZDBDBCPLookupChkBox").checked=!0},this.handleSaveDlg=function(a){var b=DOMUtils.getParentWithAttr(a,"isFrm"),c=DOMUtils.getChildElsWithAttr(b,"name","*");if(!validateFormElements(c,b))return;var d=b.curView;try{var e=b.nameTxtFld.value;d.newName=e;var f=b.descTxtFld.value;d.newDesc=f,d.folderId=$("ZDBFolderListCombo").value;var g=$("ZDBSaveDlgOkBtn").getAttribute("hugeDataCopy"),h=d.type,i=d.objId,j=d.dbId;b.isSaveAs?(d.isSaveAs=!0,h=="AnalysisView"||h=="Pivot"||h=="SummaryView"||h=="Dashboard"?this.saveAsNewView(d):h=="Table"?d.saveTableAsNewView(e,i,j,d.folderId,f,g):d.saveAsNewView()):d.save(b.origReqOptions)}finally{d.newName=null,d.newDesc=null}ZDBDialogUtil.closeDialog(a)},this.saveAsNewView=function(a){var b=a.objId,c=a.displayName,d=a.description;try{a.objId=-1;if(!ZDBCreateViewAPI.getNameForNewView(a,null,!0))return;a.displayName=a.newName,a.description=a.newDesc,a.type=="Dashboard"?a.saveCurrentConfig(null,!0,b):a.saveCurrentConfig()}finally{a.objId=b,a.displayName=c,a.description=d,a.isSaveAs=!1}},this.handleViewSaveFailure=function(a,b){var c=a.getResponsePart("ERRORCODE");c=trimAll(c);if(c=="META_DBOBJECT_NAME_DUPLICATED"){var d=ZDBCreateViewAPI.saveDlg;ZDBDialogUtil.showDialog(d,{MODAL:!0,TITLE:ZDBI18NMap.g("zrpt.common.newrpt.saveas.js.dlgTtl",d),ADDFRAME:!0}),ZDBCreateViewAPI.saveDlg.nameTxtFld.focus(),showCustomMessage(a.getResponsePart("STATUS_MESSAGE"),ZDBCreateViewAPI.saveDlg.nameTxtFld),$("customAlertMessage").style.zIndex=20001,$("_CUSTOMALERTFRAME").style.zIndex=2e4}else if(c=="COLUMN_PRESENT_IN_FILTER_CRITERIA"){var e=ZDBI18NMap.g("zrpt.common.zdbalertmsg.js.deletecolwithfiltercriteria"),f=b.ORIGREQOPTIONS,g=b.PREVIOUSURL,h=b.GRIDOBJ;ZDBAlertAPI.showMsg(e,"ZDBYESNO",{ONCLICK:CommAPI.continueSendModData,ORIGREQOPTIONS:f,GRIDOBJ:h,URLTOSEND:g,SKIPFC:!0})}else if(c=="DRILLDOWN_CHANGEDATATYPE_NOTALLOWED"){var e=ZDBI18NMap.g("zrpt.common.zdbalertmsg.js.dtchangenotallowed"),f=b.ORIGREQOPTIONS,g=b.PREVIOUSURL,h=b.GRIDOBJ;g+="&DELETE_INVALID_DRILLFLOW=true",ZDBAlertAPI.showMsg(e,"ZDBYESNO",{ONCLICK:CommAPI.continueSendModData,ORIGREQOPTIONS:f,GRIDOBJ:h,URLTOSEND:g})}else AjaxAPI.onFailureFunc(a,b)},this.getNewNameInfoAsParams=function(a){var b="&DISPLAYNAME="+encodeURIComponent(a.newName);return a.newDesc&&(b+="&DESCRIPTION="+encodeURIComponent(a.newDesc)),a.folderId>0&&(b+="&FOLDERID="+encodeURIComponent(a.folderId)),b},this.handleViewSave=function(a,b,c){var d=b.VIEW,e=d.folderId;ZDBNavigation.openFolderWithFolderId(e);var f=a.responseText.length>0?JSON.parse(a.responseText):{},g=f.WidgetIdMap;if(b.ISNEWVIEW){var h=JSON.parse(a.responseText);ZDBCreateViewAPI.newViewSaved(d,h),window.WidgetUtils&&d.typeValue===ZDBClientViewAPI.TYPE_DASHBOARD&&g&&WidgetUtils.updateWidgetIds(d.widgetIdMap,g,d.objId)}else for(i in f)d[i]=f[i];window.WidgetUtils&&d.typeValue===ZDBClientViewAPI.TYPE_DASHBOARD&&g&&WidgetUtils.updateWidgetIds(d.widgetIdMap,g,d.objId),d.confModified=!1,d.clearModified(),d.widgetIdMap={},d.isSaveAs=!1,c||ZDBMsgBox.showViewSavedMsg(d.displayName),b["ORIGREQOPTIONS"]!=null&&b.ORIGREQOPTIONS.HANDLESAVE(b.ORIGREQOPTIONS)},this.newViewSaved=function(a,b){for(var c in b)a[c]=b[c];a.description==null&&(a.description=""),ZDBClientUI.newViewAdded(a)},this.enableOrDisableTemplateIcons=function(){$("autoGenIcon").style.display=ZDBClientUI.isDBOwner?"":"none",$("autoGenText").style.display=ZDBClientUI.isDBOwner?"":"none"}};ZDBLazyLoadFuncMap.lazyLoadFuncMap["ZDBCreateViewAPI.createViewFromDlg"]=ZDBCreateViewAPI.createViewFromDlg;var ZDBHeader=new function(){this.showUpgradeBarBasedOnState=function(){getCookie("SHOW_UPGRADEBAR")==null&&setCookie("SHOW_UPGRADEBAR","true",null,"/"),$("ZDBUpgradeBar")!=null&&($("ZDBUpgradeBar").style.display=getCookie("SHOW_UPGRADEBAR")=="false"?"none":""),jQuery("#ZDBMainContainer").css("top",jQuery("#ZDBHeader").outerHeight(!0))},this.showNotification=function(){if(getCookie("SHOW_NOTIFICATION")==null||getCookie("SHOW_NOTIFICATION")=="null")ZDBMsgBox.showHintMsg(ZDBI18NMap.g("zrpt.header.nofication.js.ie"),"notification",25e3),setCookie("SHOW_NOTIFICATION","false",null,"/")},this.hideUpgradeBar=function(){$("ZDBUpgradeBar").style.display="none",setCookie("SHOW_UPGRADEBAR","false",null,"/"),document.body.prevClientHeight=0;var a=document.getElementById("ZDBPLACEHOLDER");a?ZDBClientUI.resizeAllDInst():jQuery("#ZDBHomeContainer").length?ZRSHomeUtil.resizeHolders():ZDBClientUI.resizeMain()},this.hideBlogPost=function(){ZDBHeader.hideUpgradeBar();var a="/ZDBUserAction.ma?ZDBACTION=BLOGPOSTVISIT";AjaxAPI.sendRequest({URL:a,ONFAILUREFUNC:ZDBHeader.blogPostDummyFunction})},this.blogPostDummyFunction=function(a,b){},this.logoutAction=function(){setCookie("SHOW_UPGRADEBAR",null,null,"/"),setCookie("SHOW_NOTIFICATION",null,null,"/"),setCookie("APPCHECKSHOWN",null)},this.triggerLogoLink=function(a){var b=a.getAttribute("redirectURL");b!=null&&b!=""&&(window.location=b)},this.showAppList=function(a,b){if(ZDBHeader.isAppListIncluded)ZDBHeader.dispAppList(a,b);else{var c="/switchto";c+=ZDBGlobal.THEMENAME=="brown"?"?bgClr=%23E4DBC9&borderClr=%238E7147&headerClr=%238E7147&hoverClr=%23E4DBC9&txtClr=%23000000":"",AjaxAPI.sendRequest({URL:c,METHOD:"GET",NOSUBREQPARAM:!0,EL:a,EVENT:b,ONSUCCESSFUNC:ZDBHeader.handleResponse,OPSTATUSID:"ZDBMainLoader"})}},this.handleResponse=function(a,b){$("ZohoApps").innerHTML="<br>"+a.responseText,ZDBHeader.dispAppList(b.EL,b.EVENT),ZDBHeader.isAppListIncluded=!0},this.dispAppList=function(a,b){ZDBUtil.attachEvent(document,"click",ZDBHeader.closeApp,!1),ZDBUtil.attachEvent(document,"keydown",ZDBHeader.closeAppList,!1);var c=$("ZohoApps");c.style.display="",ZDBHeader.setPosition(c,a),ZDBUtil.stopEventBubble(b)},this.closeAppList=function(a){var b=BROWSER.IE?window.event.keyCode:a.which;b==27&&ZDBHeader.closeApp()},this.closeApp=function(){$("ZohoApps").style.display="none",ZDBUtil.detachEvent(document,"click",ZDBHeader.closeApp,!1),ZDBUtil.detachEvent(document,"keydown",ZDBHeader.closeAppList,!1)},this.setPosition=function(a,b){var c=$("zc-switch-zapps"),d=c.offsetLeft,e=ZDBUtil.getObjTop(b,!0),f=ZDBUtil.getObjLeft(b,!0);a.style.top=e-22+"px",a.style.left=f-d-8+"px"},this.chngPwdDialog=function(){if(!ZDBLazyLoadUtil.loadSnippet("DOMAINCHGPWD_DLG","/ZDBDomainChngPwd.cc?",this,"APPENDTODOC"))return;var a=$("ZDBDomainChngPwd");a.style.display="block",$("ZDBOldPwd").value="",$("ZDBNewPwd").value="",$("ZDBConfirmPwd").value="",ZDBDialogUtil.showDialog(a,{TITLE:ZDBI18NMap.g("zrpt.common.custdomain.js.chngpwd"),ADDFRAME:!0,MODAL:!0,DONTREMOVE:!0,ONENTER:ZDBDomainRebrand.submitChngPassword})},this.reload=function(){window.location.reload()},this.showDatabases=function(a,b,c){var d=jQuery("#ZRSDBMenu");if(d.is(":visible"))return;AjaxAPI.sendRequest({URL:"/ZDBListDatabases.ve?ZDBACTION=SHOWDATABASES",EVENT:b,ONSUCCESSFUNC:ZDBHeader.createDBMenu,OPSTATUSID:"ZRSDBDropDown"})},this.createDBMenu=function(a,b){ZDBHeader.dbList=JSON.parse(a.responseText);var c=b.EVENT;ZDBHeader.showDBMenu(ZDBHeader.dbList,1,null,c)},this.dbType={1:"",2:ZDBI18NMap.g("zrpt.header.dblistmenu.js.shared")},this.showDBMenu=
function(c,d,e,f){var g=jQuery("#ZRSDBMenu"),h=jQuery("#ZRSALLDBList"),i=h.find("ul"),j=jQuery("<li><div class='ZRSDBMenuItem ZRSBorderBottom'><a class='fLeft ellipsis' style='width:200px;'></a><span class='gray ellipsis'></span></div></li>"),k=j.find("a"),l=$("ZRSDBSearchBox"),m=jQuery("#ZRSDBSearchComp"),n=c.length;n=n>25?25:n,d!=3&&i.empty();for(var o=0;o<n;o++){var p=c[o][0],q=ZDBEscapeUtil.encodeForHtml(c[o][1]),r=c[o][2];k.html(q).attr("href",ZDBGlobal.REPORTS_CONTEXT_NAME+"/ZDBDataSheetView.cc?DBID="+p),k.next().html(ZDBHeader.dbType[r]),j.attr("tip",c[o][1]),j.attr("DBID",p);var s=j.clone();ZDBClientUI.dbId==p&&(s.find("div").addClass("ZRSMenuHover"),s.find("a").removeAttr("href")),s.appendTo(i)}var t=i.find("li"),u=t.size();if(u>10)h.css({height:"310px","overflow-y":"scroll","overflow-x":"hidden"}),m.show();else{var v=ZDBSearchUtil.getSearchValue(l),w=l.searchType;v==null&&w==0&&m.hide(),h.css({height:"","overflow-y":"hidden","overflow-x":"hidden"})}if(d==1){var x=jQuery("#ZRSDBInfo");g.show(),ZRSMenu.position(g,x,5,f);var y=g.position().top;g.css({top:y+12}),l.searchType=0,jQuery(l).val("").focus(),jQuery(document).bind("click",a),jQuery(document).bind("keyup",b)}d!=3&&h.scrollTop(0);var z=0;t.hover(function(a){var b=jQuery(this);b.addClass("ZRSMenuHover");var c=b.find("a")[0];c.scrollWidth>c.clientWidth&&(z=setTimeout(function(){ZDBToolTip.show(b,a)},1e3,b,a))},function(a){jQuery(this).removeClass("ZRSMenuHover"),clearTimeout(z),ZDBToolTip.hide(this,a)})},this.keyHandling=function(a){a||(a=window.event);if(a.keyCode==27){ZDBHeader.closeDBList(a,!0);return}if(a.keyCode==13)return ZDBHeader.searchDatabases(a,null),!1;var b=$("ZRSDBSearchBox"),c=ZDBSearchUtil.getSearchValue(b),d=jQuery("#ZRSDBMenu").find(".ZRSSearchClearIcon");return c==null||c==""?d.hide():d.show(),!0},this.closeDBList=function(c,d){var e=c?ZDBUtil.getSourceElement(c):null;if(e&&!d){var f=jQuery(e),g=f.closest("[id='ZRSDBSearchComp']"),h=f.closest("[id='ZRSDBSearchMenu']");if(g.size()>0||h.size()>0)return}jQuery("#ZRSDBMenu").hide(),ZDBHeader.resetSearch(),jQuery(document).unbind("click",a).unbind("keyup",b)};var a=function(a){ZDBHeader.closeDBList(a)},b=function(a){ZDBHeader.keyHandling(a)},c=0,d=0,e=0;this.scrollDBList=function(a){var b=jQuery("#ZRSALLDBList");if(b.scrollTop()+b.innerHeight()>=b[0].scrollHeight){var f=b.find("li:last").attr("DBID"),g=ZDBHeader.getIndex(f);e=(new Date).getTime();if(d==0||e-d>200)d=e,c=setTimeout(function(){ZDBHeader.searchDatabases(a,g+1)},200,a,g+1)}},this.getIndex=function(a){var b=ZDBHeader.dbList.length;for(var c=0;c<b;c++){var d=ZDBHeader.dbList[c][0];if(d==a)return c}return b},this.searchDatabases=function(a,b){var d=$("ZRSDBSearchBox"),e=ZDBSearchUtil.getSearchValue(d),f=d.searchType,g=[],h=ZDBHeader.dbList.length,i=0,j=2;b&&(i=b,j=3,clearTimeout(c));for(;i<h&&g.length<=25;i++){var k=ZDBHeader.dbList[i][1],l=ZDBHeader.dbList[i][2],m=f==0||f==l;m&&(e==null||k.toLowerCase().indexOf(e.toLowerCase())>-1)&&g.push(ZDBHeader.dbList[i])}ZDBHeader.showDBMenu(g,j,[e,f],a)},this.showDBSearchMenu=function(a,b){var c=ZDBContentCache.appendAndGet("DBSearch_Menu","GridMenu",document.body);ZRSMenu.showMenu(b,a,c,5)},this.setSearchType=function(a,b,c){var d=jQuery("#ZRSDBSearchBox");d[0].searchType=b;var e=jQuery(a).attr("tipValue");d.attr("tipvalue",e),d.attr("tipshown").toString()==="true"&&d.attr("value",e),jQuery("#ZRSDBSearchMenu").find("span").removeClass("sortTickMenu"),jQuery(a).find("span:first").addClass("sortTickMenu"),ZDBHeader.searchDatabases(c,null)},this.clearSearch=function(a,b){jQuery("#ZRSDBSearchBox").val("").focus(),jQuery(a).hide(),ZDBHeader.searchDatabases(b,null),ZDBUtil.stopEventBubble(b)},this.resetSearch=function(){var a=jQuery("#ZRSDBSearchBox"),b=a.attr("defaulttip");a.attr("tipvalue",b),a.attr("tipshown").toString()==="true"&&a.attr("value",b),a.siblings(".ZRSSearchClearIcon").hide();var c=jQuery("#ZRSDBSearchMenu");c.size()>0&&(c.find("span").removeClass("sortTickMenu"),c.find("li:first span:first").addClass("sortTickMenu"))}};ZRUserAnalytics.initialize=function(){if(window.ZRUserAnalytics_Options){var a="ZRUserAnalyticsObject";window[a]?(console.warn("ZRUserAnalytics already Started Successfully"),void 0):window[a]=new ZRUserAnalytics(window.ZRUserAnalytics_Options)}else console.warn("ZRUserAnalytics Not Configured"),void 0},ZRUserAnalytics.indexes={ELEMENT:0,ACTION:1,SUBMODULE:2,MODULE:3,ADDITIONALPARAM:4,TIMERSTART:5,TIMEREND:6},ZRUserAnalytics.checkAndPushToServer=function(a,b,c,d,e,f,g){var h=null;if(typeof ZRUserAnalyticsObject!="undefined"&&ZRUserAnalyticsObject instanceof Object&&!(ZRUserAnalyticsObject instanceof Array))if(f){var i=ZRUserAnalyticsObject.timers[c];i?i.timerStarted&&(h=ZRUserAnalyticsObject.timers[c].getTime()):(ZRUserAnalyticsObject.timers[c]=new ZRUserAnalyticsTimer(c),ZRUserAnalyticsObject.timers[c].startTimer(),h=ZRUserAnalyticsObject.timers[c].getTime())}else if(g){var i=ZRUserAnalyticsObject.timers[c];i&&i.timerStarted&&(h=ZRUserAnalyticsObject.timers[c].getTime(),ZRUserAnalyticsObject.timers[c].stopTimer(),delete ZRUserAnalyticsObject.timers[c])}else{var i=ZRUserAnalyticsObject.timers[c];i&&i.timerStarted?h=ZRUserAnalyticsObject.timers[c].getTime():h="NA"}h||(h="NA"),typeof ZRUserAnalyticsObject!="undefined"&&ZRUserAnalyticsObject instanceof Object&&!(ZRUserAnalyticsObject instanceof Array)&&ZRUserAnalyticsObject.pushUsageToServer(a,b,c,d,e,h)},ZRUserAnalytics.attachPushCodeToElement=function(a,b){a.forEach(function(a,b,c){var d=a[ZRUserAnalytics.indexes.ELEMENT],e=a[ZRUserAnalytics.indexes.ACTION],f=a[ZRUserAnalytics.indexes.SUBMODULE],g=a[ZRUserAnalytics.indexes.MODULE],h=a[ZRUserAnalytics.indexes.ADDITIONALPARAM],i=a[ZRUserAnalytics.indexes.TIMERSTART],j=a[ZRUserAnalytics.indexes.TIMEREND];if(d instanceof Object&&d instanceof Array)for(var k=0;k<d.length;k++){if(d[k].getAttribute(g)==="attached")continue;jQuery(d[k]).on("click",{action:e,subModule:f,module:g,additionalParams:h,timerStart:i,timerEnd:j},ZRUserAnalytics.userAnalyticsEventHandler).attr(g,"attached")}else if(d instanceof Object&&!(d instanceof Array)||d instanceof HTMLElement){if(jQuery(d).attr(g)==="attached")return;jQuery(d).on("click",{action:e,subModule:f,module:g,additionalParams:h,timerStart:i,timerEnd:j},ZRUserAnalytics.userAnalyticsEventHandler).attr(g,"attached")}})},ZRUserAnalytics.userAnalyticsEventHandler=function(a){ZRUserAnalytics.checkAndPushToServer(a.data.action,a.data.subModule,a.data.module,null,a.data.additionalParams,a.data.timerStart,a.data.timerEnd)},ZRUserAnalytics.removeUserAnalyticsEventHandler=function(a,b){if(a instanceof Object&&a instanceof Array)for(var c=0;c<a.length;c++)jQuery(a[c]).off("click",ZRUserAnalytics.userAnalyticsEventHandler).attr(b,null);else(a instanceof Object&&!(a instanceof Array)||a instanceof HTMLElement)&&jQuery(a).off("click",ZRUserAnalytics.userAnalyticsEventHandler).attr(b,null)},ZRUserAnalytics.removeUserAnalyticsEventHandlerThroughID=function(a,b){var c=jQuery($(a));jQuery(c).off("click",ZRUserAnalytics.userAnalyticsEventHandler).attr(b,null)},ZRUserAnalytics.attachPushCodeToId=function(a,b,c,d,e,f,g){var h=jQuery($(a));if(h.attr(d)==="attached")return;h.on("click",{action:b,subModule:c,module:d,additionalParams:e,timerStart:f,timerEnd:g},ZRUserAnalytics.userAnalyticsEventHandler).attr(d,"attached")};var ZRUserAnalyticsAttacher=new function(){this.homePageAttacher=function(a){if(typeof ZRUserAnalyticsObject!="undefined"&&ZRUserAnalyticsObject instanceof Object&&!(ZRUserAnalyticsObject instanceof Array)){var b=document.querySelector("#ZDBDatabaseList");if(b){var c=document.querySelector("#ZDBHomeTabs"),d=document.querySelector("#ZDBDBListParEl"),e=[[c.querySelector("li[listtype='MYDBS']"),"mydatabasestab","databaseactions",a,null,!0],[c.querySelector("li[listtype='SHARED']"),"shareddatabasetab","databaseactions",a,null,!0],[c.querySelector("li.ZRSDBSearchFld"),"dbsearch","databaseactions",a,null,!0],[d.querySelectorAll("a.dbNameFont.fLeft"),"opendatabase","databaseactions",a,null,!0],[d.querySelectorAll("div.defaultDBIcon"),"defaultdb","databaseactions",a,null,!0],[d.querySelectorAll("div.renameDBIcon"),"renamedb","databaseactions",a,null,!0],[d.querySelectorAll("div.copyDBIcon"),"copydb","databaseactions",a,null,!0],[d.querySelectorAll("div.deleteDBIcon"),"deletedb","databaseactions",a,null,!0],[d.querySelectorAll("div.backupDBIcon"),"backupdb","databaseactions",a,null,!0],[d.querySelectorAll("div.dbInfoIcon"),"dbdetails","databaseactions",a,null,!0]];ZRUserAnalytics.attachPushCodeToElement(e,a)}var f=document.querySelector("#ZDBMainHeader"),g=document.querySelector("#ZRSHomeMainDiv");if(f&&g){var e=[[f.querySelector("ul.ZAppsMIcon"),"hamburgermenu","header",a,null,!0],[f.querySelector("#ZRSubscriptionLink"),"subscription","header",a,null,!0],[f.querySelector("a#feedbackLink"),"feedback","header",a,null,!0],[f.querySelector("span#quickHelp"),"quickhelp","header",a,null,!0],[f.querySelector("#showProfileInfo"),"profileinfo","header",a,null,!0],[g.querySelectorAll("div[elname='moreRLessTxt'], div[elname='moreRLessIcon']"),"createdboptions","header",a,null,!0],[g.querySelector("#ZRSGettingStarted"),"gettingstarted","header",a,null,!0]];ZRUserAnalytics.attachPushCodeToElement(e,a)}var h=document.querySelector("#ZRSDBCreationOptions #ZDBDBOptsDiv");if(h){var e=[[h.querySelector("#FileImport"),"fileimport","importfromhome",a,null,!0],[h.querySelector("#FileImport"),"fileimport","fileimportflowstart","homefileimportflow",null,!0],[h.querySelector("#FileImport a.videoDemo"),"fileimportvideohelp","importfromhome",a,null,!0],[h.querySelector("#FileImport a.helpCenter"),"fileimporthelpcenter","importfromhome",a,null,!0],[h.querySelector("#FileImport a.snapShotTour"),"fileimportsnapshottour","importfromhome",a,null,!0],[h.querySelector("#ImportFromCloud"),"cloudimport","importfromhome",a,null,!0],[h.querySelector("#ImportFromCloud a.helpCenter"),"cloudimporthelpcenter","importfromhome",a,null,!0],[h.querySelector("#ImportFromLocalDatabases"),"localdatabaseimport","importfromhome",a,null,!0],[h.querySelector("#ZohoProjectsImport"),"projectsimport","importfromhome",a,null,!0],[h.querySelector("#ZohoProjectsImport a.videoDemo"),"projectsimportvideohelp","importfromhome",a,null,!0],[h.querySelector("#ZohoProjectsImport a.helpCenter"),"projectsimporthelpcenter","importfromhome",a,null,!0],[h.querySelector("#GoogleAnalyticsImport"),"googleanalyticsimport","importfromhome",a,null,!0],[h.querySelector("#GoogleAnalyticsImport a.helpCenter"),"googleanalyticshelpcenter","importfromhome",a,null,!0],[h.querySelector("#SalesForceImport"),"salesforceimport","importfromhome",a,null,!0],[h.querySelector("#SalesForceImport a.videoDemo"),"salesforceimportvideohelp","importfromhome",a,null,!0],[h.querySelector("#SalesForceImport a.helpCenter"),"salesforcehelpcenter","importfromhome",a,null,!0],[h.querySelector("#BugTrackerImport"),"bugtrackerimport","importfromhome",a,null,!0],[h.querySelector("#BugTrackerImport a.helpCenter"),"bugtrackerhelpcenter","importfromhome",a,null,!0],[h.querySelector("#DatabaseFromTemplate"),"databasefromtemplate","importfromhome",a,null,!0],[h.querySelector("#DatabaseFromTemplate a.helpCenter"),"databasefromtemplatehelpcenter","importfromhome",a,null,!0],[h.querySelector("#BlankDatabase"),"createblankdatabase","importfromhome",a,null,!0],[h.querySelector("#BlankDatabase a.helpCenter"),"createblankdatabasehelpcenter","importfromhome",a,null,!0],[h.querySelector("#EnterDataRightAway"),"enterdatarightaway","importfromhome",a,null,!0]];ZRUserAnalytics.attachPushCodeToElement(e,a)}var i=document.querySelector("#ZRSFooter");if(i){var e=[[i.querySelector("#TryDatabaseDemo"),"databasedemo","footer",a,null,!0],[i.querySelector("#TrySampleDatabases"),"sampledatabases","footer",a,null,!0],[i.querySelector("#TryPublicDatabases"),"publicdatabases","footer",a,null,!0]];ZRUserAnalytics.attachPushCodeToElement(e,a)}}},this.importDialogAttacher=function(a,b,c,d){if(typeof ZRUserAnalyticsObject!="undefined"&&ZRUserAnalyticsObject instanceof Object&&!(ZRUserAnalyticsObject instanceof Array)){b||(b=ZRUserAnalyticsObject.module);if(!c){var e={"import":"fileimport",cloud:"cloudimport",template:"templateimport",scratch:"blankdatabase",enterdata:"enterdata"};c=e[a]}var f=document.querySelector("#ZRSFullPageDlgHolder");if(!f)return;var g=f.querySelector("#ZDBCreateDBCntTd"),h=document.querySelector("#importReportDIV");if(g){var i=g.querySelector("#ZRSHEETNAME")?"sheetselector":"htmltableselector",j=[[g.querySelectorAll("#IDBNAME1, #IDBNAME2, #IDBNAME3, #IDBNAME4"),"dbname",c,b,null,!0],[g.querySelectorAll("#IDESCRIPTION, textarea[name='DESCRIPTION']"),"dbdesc",c,b,null,!0],[g.querySelector("#ZDBFILETYPE"),"filetypeselector",c,b,null,!0],[g.querySelectorAll("#ZDBPASTEOPT, div[elname='pastedata']"),"pastedata",c,b,null,!0],[g.querySelectorAll("#ZDBFILEOPT, div[elname='localdrive']"),"localdrive",c,b,null,!0],[g.querySelectorAll("#ZDBWEBOPT, div[elname='web']"),"web",c,b,null,!0],[g.querySelector("#zdbImportDBHelp #ZRSVideoDemoHelp"),"videohelp",c,b,null,!0],[g.querySelector("#zdbImportDBHelp #ZRSHelpCenter"),"helpcenter",c,b,null,!0],[g.querySelector("#zdbImportDBHelp #ZRSSnapShotTour"),"snapshottour",c,b,null,!0],[g.querySelector("#TABLENAME"),"tablename",c,b,null,!0],[g.querySelector("#FIRSTROWISFIELDS"),"firstrowisfieldselector",c,b,null,!0],[g.querySelector("div.zdbdateFormatDIV"),"dateformatselector",c,b,null,!0],[g.querySelector("#ZDBMORELESS"),"moresettings",c,b,null,!0],[g.querySelector("#DELIMITER"),"delimiterselector",c,b,null,!0],[g.querySelector("#SKIPTOP"),"skittoprows",c,b,null,!0],[g.querySelector("#QUOTED"),"quotedselector",c,b,null,!0],[g.querySelector("#COMMENTCHAR"),"commentcharselector",c,b,null,!0],[g.querySelector("#THOUSANDSEP"),"thousandsepselector",c,b,null,!0],[g.querySelector("#DECIMALSEP"),"decimalsepselector",c,b,null,!0],[g.querySelectorAll("#SampleTableHolder div.zdbColHeadArea.zdbColHeadCheck"),"colselectorfromsampletable",c,b,null,!0],[g.querySelectorAll("select.zdbInput.normalFont12"),"coldatatypeselectorfromsampletable",c,b,null,!0],[g.querySelector("#OnImptErrorOption"),"oninputerrorsetting",c,b,null,!0],[g.querySelector("input[value='Next']"),"nextbtn",c,b,null,!0],[g.querySelector("input[value='Previous']"),"previousbtn",c,b,null,!0],[g.querySelector("input[value='Create']"),"createbtn",c,b,null,!0],[g.querySelectorAll("td.tblname"),i,c,b,null,!0],[g.querySelector("#ZDBHiddenRows"),"importhiddenrows",c,b,null,!0],[g.querySelector("#ZDBHiddenCols"),"importhiddencols",c,b,null,!0],[g.querySelectorAll("#ZDBExtIntInput, #ZDBExtIntegButton"),"fileselector",c,b,null,!0],[g.querySelectorAll("#ZDBTemplatesHolder tr"),"dialogtemplates",c,b,null,!0],[g.querySelector("#CDBDATA"),"populatesampledata",c,b,null,!0]];d?(j.push([f.querySelector("div.iconbg.closeDlg"),"closeimporticon",c,b,null,null,!0]),j.push([g.querySelector("input[value='Cancel']"),"cancelbtn",c,b,null,null,!0])):(j.push([f.querySelector("div.iconbg.closeDlg"),"closeimporticon",c,b,null,!0]),j.push([g.querySelector("input[value='Cancel']"),"cancelbtn",c,b,null,!0])),ZRUserAnalytics.attachPushCodeToElement(j,b)}else if(h){var j;d?j=[[h.querySelector("#ZDBImpSchSettingsLnk"),"importschedule","importsuccess",b,null,null,!0],[h.querySelector("input[value='Close']"),"closebtn","importsuccess",b,null,null,!0]]:j=[[h.querySelector("#ZDBImpSchSettingsLnk"),"importschedule",c,b,null,null,!0],[h.querySelector("input[value='Close']"),"closebtn",c,b,null,null,!0]],ZRUserAnalytics.attachPushCodeToElement(j,b)}}},this.attachUAMonitorsToFileTypeDlgInImport=function(a,b,c){if(typeof ZRUserAnalyticsObject!="undefined"&&ZRUserAnalyticsObject instanceof Object&&!(ZRUserAnalyticsObject instanceof Array)){b||(b=ZRUserAnalyticsObject.module);if(!c){var d={"import":"fileimport",cloud:"cloudimport",template:"templateimport",scratch:"blankdatabase",enterdata:"enterdata"};c=d[window.importType]}var e=document.querySelector("#ZDBCREATEDIALOG");switch(a){case"PASTEDATA":var f=[[e.querySelector("#ZDBPASTEDDATA"),"pastedataarea",c,b,null,!0]];ZRUserAnalytics.attachPushCodeToElement(f);break;case"LOCALDRIVE":var f=[[e.querySelector("#ZDBImportFileNameFld"),"fileimportbrowse",c,b,null,!0]];ZRUserAnalytics.attachPushCodeToElement(f);break;case"WEB":var g=e.querySelector("#ZDBURLINP"),h=g.querySelector("#ZDBAUTHURLINP"),f=[[g.querySelector("#ZDBUNAUTHURL"),"unauthurl",c,b,null,!0],[g.querySelector("#ZDBAUTHURL"),"authurl",c,b,null,!0],[g.querySelector("#SAMPLEURLLINK"),"sampleurl",c,b,null,!0],[g.querySelector("#ADDPARAMLINK"),"addparam",c,b,null,!0],[e.querySelector("#ZDBInputURL"),"urlinputarea",c,b,null,!0],[g.querySelector("#ZRURLMETHOD"),"urlmethod",c,b,null,!0],[g.querySelector("#URLINFO #PARAMRESETDIV"),"addextraparam",c,b,null,!0],[h.querySelector(".ZRSHelpIcon"),"helpiconinauthurl",c,b,null,!0],[h.querySelector("#ZDBUSERNAME"),"urlauthusername",c,b,null,!0],[h.querySelector("#ZDBPASSWORD"),"urlauthpass",c,b,null,!0]];ZRUserAnalytics.attachPushCodeToElement(f);break;default:return}}},this.attachUAMonitorsToDBlist=function(a){var b=document.querySelector("#ZDBHomeTabs"),c=document.querySelector("#ZDBDBListParEl"),d=[[c.querySelectorAll("div.defaultDBIcon"),"defaultdb","databaseactions",null,null,!0],[c.querySelectorAll("div.renameDBIcon"),"renamedb","databaseactions",null,null,!0],[c.querySelectorAll("div.copyDBIcon"),"copydb","databaseactions",null,null,!0],[c.querySelectorAll("div.deleteDBIcon"),"deletedb","databaseactions",null,null,!0],[c.querySelectorAll("div.backupDBIcon"),"backupdb","databaseactions",null,null,!0],[c.querySelectorAll("div.dbInfoIcon"),"dbdetails","databaseactions",null,null,!0]];a=="MYDBS"?d.push([c.querySelectorAll("a.dbNameFont.fLeft"),"openmydatabase","databaseactions",null,null,!0]):d.push([c.querySelectorAll("a.dbNameFont.fLeft"),"openshareddatabase","databaseactions",null,null,!0]),ZRUserAnalytics.attachPushCodeToElement(d)},this.attachUAMonitorsToProjectsImportForHome=function(a){var b=document.querySelector("#ZDBProjsCreateDBCntTd"),c=ZRUserAnalyticsObject.module,d=window.importType;if(b){var e;if(a){var f=d=="projectsimport"?"project":"bugtracker";a=a=="yes"?f+"importsuccess":f+"importfailure",e=[[b.querySelector("#ZDBZPImpReportOkBtn"),a,d,c,null,!0],[b.querySelector("#ZRSHelpInfo"),"helpinfo",d,c,null,!0],[b.querySelector("#ZRSVideoDemoHelp"),"videodemo",d,c,null,!0],[b.querySelector("#ZRSHelpCenter"),"helpcenter",d,c,null,!0],[b.querySelector("div.iconbg.closeDlg"),"closeicon",d,c,null,!0]]}else e=[[b.querySelector("#ZDBZPDBNAME"),"dbname",d,c,null,!0],[b.querySelector("#ZDBZPDESCRIPTION"),"dbdesc",d,c,null,!0],[b.querySelector("select[name='ZDBZProjPortals']"),"portalselector",d,c,null,!0],[b.querySelector("#ZPSELECTALLPRJS"),"selectallprojects",d,c,null,!0],[b.querySelector("#ZDBZPSEARCHBOX"),"searchprojects",d,c,null,!0],[b.querySelectorAll("#zpHold #ZProjID"),"individualprojectselector",d,c,null,!0],[b.querySelector("#ZDBZPModules input[module='Tasks']"),"tasksmodule",d,c,null,!0],[b.querySelector("#ZDBZPModules input[module='Milestones']"),"milestonemodule",d,c,null,!0],[b.querySelector("#ZDBZPModules input[module='Timesheets']"),"timesheetmodule",d,c,null,!0],[b.querySelector("#ZDBZPModules input[module='Clients']"),"clientmodule",d,c,null,!0],[b.querySelector("#ZDBZPModules input[module='Groups']"),"groupmodule",d,c,null,!0],[b.querySelector("#ZPSchInterval"),"intervalselector",d,c,null,!0],[b.querySelector("#ZDBZPImpNxtBt"),"nextbtn",d,c,null,!0],[b.querySelector("input[elname='cancel']"),"cancelbtn",d,c,null,!0],[b.querySelector("#ZRSHelpInfo"),"helpinfo",d,c,null,!0],[b.querySelector("#ZRSVideoDemoHelp"),"videodemo",d,c,null,!0],[b.querySelector("#ZRSHelpCenter"),"helpcenter",d,c,null,!0],[b.querySelector("div.iconbg.closeDlg"),"closeicon",d,c,null,!0]];ZRUserAnalytics.attachPushCodeToElement(e)}},this.attachUAMonitorsToGAnalImportForHome=function(){var a=document.querySelector("#GANALWIZARDHOLDER"),b=ZRUserAnalyticsObject.module,c="googleanalyticsimport";if(a){var d;if(ZRGAnalInteg.step==2){var e=a.querySelector("#ZRGAnalTableContainer");d=[[a.querySelector("#GANALDATABASENAME"),"dbname",c,b,null,!0],[a.querySelector("textarea[name='GANALDATABASEDESC']"),"dbdesc",c,b,null,!0],[a.querySelector("#ZRSHelpInfo"),"helpinfo",c,b,null,!0],[a.querySelector("#ZRSHelpCenter"),"helpcenter",c,b,null,!0],[a.querySelector("input[elname='cancel']"),"cancelbtn",c,b,null,!0],[a.querySelector("#GAnalDBDetailsSubmit"),"nextbtn",c,b,null,!0],[a.querySelector("div.iconbg.closeDlg"),"closeicon",c,b,null,!0]],e?d.push([e.querySelectorAll("#ganalprofileradio"),"profileselector",c,b,null,!0]):(d.push([a.querySelector("#GANALSIGNINLINK"),"signinlink",c,b,null,!0]),d.push([a.querySelector("#ganalsearchspace"),"profilesearch",c,b,null,!0]),d.push([a.querySelector("div[elname='signinasdiffuser']"),"signinasdiffuser",c,b,null,!0]))}else ZRGAnalInteg.step==3?d=[[a.querySelector("#ganalimpperiod"),"fetchperiod",c,b,null,!0],[a.querySelector("#ganalcustomeperiod"),"customfetchperiod",c,b,null,!0],[a.querySelector("#GAModuleContainer"),"moduleselector",c,b,null,!0],[a.querySelector("div.fieldsBlock.sffieldbox"),"fieldsselector",c,b,null,!0],[a.querySelector("#repeatinterval"),"repeatintervalselector",c,b,null,!0],[a.querySelector("#CLEANUPSELECT"),"cleanupinterval",c,b,null,!0],[a.querySelector("#ZCDailyHourInt"),"hourselector",c,b,null,!0],[a.querySelector("#ZCDailyMinsInt"),"minuteselector",c,b,null,!0],[a.querySelector("#ZDB_DLY_TIMEZONE_DROPDOWN"),"timezoneselector",c,b,null,!0],[a.querySelector("#GAnalTablePrevious"),"previousbtn",c,b,null,!0],[a.querySelector("input[elname='cancel']"),"cancelbtn",c,b,null,!0],[a.querySelector("#GAnalTableSubmit"),"createbtn",c,b,null,!0],[a.querySelector("#ZRSHelpInfo"),"helpinfo",c,b,null,!0],[a.querySelector("#ZRSHelpCenter"),"helpcenter",c,b,null,!0],[a.querySelector("div.iconbg.closeDlg"),"closeicon",c,b,null,!0]]:ZRGAnalInteg.step==4&&(d=[[a.querySelector("input.buttonCompBoxBg"),"googleanalyticsimportsuccess",c,b,null,!0],[a.querySelector("#ZRSHelpInfo"),"helpinfo",c,b,null,!0],[a.querySelector("div.iconbg.closeDlg"),"closeicon",c,b,null,!0]]);ZRUserAnalytics.attachPushCodeToElement(d)}},this.attachUAMonitorsToSalesforceImportForHome=function(){var a=document.querySelector("#SFWIZARDHOLDER"),b=ZRUserAnalyticsObject.module,c="salesforceimport";if(a){var d;if(ZRSFIntegration.step==2){var e=a.querySelector("#AuthorizeButton");d=[[a.querySelector("#SFDATABASENAME"),"dbname",c,b,null,!0],[a.querySelector("textarea[name='SFDATABASEDESC']"),"dbdesc",c,b,null,!0],[a.querySelector("#ZRSHelpInfo"),"helpinfo",c,b,null,!0],[a.querySelector("#ZRSVideoDemoHelp"),"videodemo",c,b,null,!0],[a.querySelector("#ZRSHelpCenter"),"helpcenter",c,b,null,!0],[a.querySelector("#SFDBCancel"),"cancelbtn",c,b,null,!0],[a.querySelector("#SFDBDetailsSubmit"),"nextbtn",c,b,null,!0],[a.querySelector("#AuthorizeButton"),"signinlink",c,b,null,!0],[a.querySelector("div.iconbg.closeDlg"),"closeicon",c,b,null,!0]]}else ZRSFIntegration.step==3?d=[[a.querySelector("#ZRSFSearchFields"),"searchfields",c,b,null,!0],[a.querySelector("#SFModuleContainer"),"moduleselector",c,b,null,!0],[a.querySelector("div.fieldsBlock.sffieldbox"),"fieldsselector",c,b,null,!0],[a.querySelector("#SFCreateCancel"),"cancelbtn",c,b,null,!0],[a.querySelector("#SFCreatePrevious"),"previousbtn",c,b,null,!0],[a.querySelector("#SFCreate"),"createbtn",c,b,null,!0],[a.querySelector("#ZRSHelpInfo"),"helpinfo",c,b,null,!0],[a.querySelector("#ZRSVideoDemoHelp"),"videodemo",c,b,null,!0],[a.querySelector("#ZRSHelpCenter"),"helpcenter",c,b,null,!0],[a.querySelector("div.iconbg.closeDlg"),"closeicon",c,b,null,!0],[a.querySelector("#SFTIMEZONE"),"timezoneselector",c,b,null,!0],[a.querySelector("#SFSchRepeatInt"),"repeatinterval",c,b,null,!0],[a.querySelector("#SFDailyHourInt"),"hoursselector",c,b,null,!0],[a.querySelector("#SFDailyMinsInt"),"minutesselector",c,b,null,!0],[a.querySelector("div.iconbg.closeDlg"),"closeicon",c,b,null,!0]]:ZRSFIntegration.step==4&&(d=[[a.querySelector("#SFCREATEOK"),"salesforceimportsuccess",c,b,null,!0],[a.querySelector("#ZRSHelpInfo"),"helpinfo",c,b,null,!0],[a.querySelector("#ZRSVideoDemoHelp"),"videodemo",c,b,null,!0],[a.querySelector("#ZRSHelpCenter"),"helpcenter",c,b,null,!0],[a.querySelector("div.iconbg.closeDlg"),"closeicon",c,b,null,!0]]);ZRUserAnalytics.attachPushCodeToElement(d)}}};